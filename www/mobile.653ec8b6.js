function e(e,t,r,i){Object.defineProperty(e,t,{get:r,set:i,enumerable:!0,configurable:!0})}var t=globalThis;function r(e){return e&&e.__esModule?e.default:e}var i={},s={},n=t.parcelRequirea81d;null==n&&((n=function(e){if(e in i)return i[e].exports;if(e in s){var t=s[e];delete s[e];var r={id:e,exports:{}};return i[e]=r,t.call(r.exports,r,r.exports),r.exports}var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}).register=function(e,t){s[e]=t},t.parcelRequirea81d=n);var o=n.register;o("9EePZ",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0});var r=n("3kKyL");r.__exportStar(n("fUPCt"),e.exports),r.__exportStar(n("3NXE9"),e.exports)}),o("3kKyL",function(t,r){e(t.exports,"__exportStar",()=>i);function i(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}}),o("fUPCt",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.delay=void 0,e.exports.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}}),o("3NXE9",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.fromMiliseconds=e.exports.toMiliseconds=void 0;var r=n("2MWZl");e.exports.toMiliseconds=function(e){return e*r.ONE_THOUSAND},e.exports.fromMiliseconds=function(e){return Math.floor(e/r.ONE_THOUSAND)}}),o("2MWZl",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0});var r=n("3kKyL");r.__exportStar(n("lfr75"),e.exports),r.__exportStar(n("1qmVT"),e.exports)}),o("lfr75",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ONE_THOUSAND=e.exports.ONE_HUNDRED=void 0,e.exports.ONE_HUNDRED=100,e.exports.ONE_THOUSAND=1e3}),o("1qmVT",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ONE_YEAR=e.exports.FOUR_WEEKS=e.exports.THREE_WEEKS=e.exports.TWO_WEEKS=e.exports.ONE_WEEK=e.exports.THIRTY_DAYS=e.exports.SEVEN_DAYS=e.exports.FIVE_DAYS=e.exports.THREE_DAYS=e.exports.ONE_DAY=e.exports.TWENTY_FOUR_HOURS=e.exports.TWELVE_HOURS=e.exports.SIX_HOURS=e.exports.THREE_HOURS=e.exports.ONE_HOUR=e.exports.SIXTY_MINUTES=e.exports.THIRTY_MINUTES=e.exports.TEN_MINUTES=e.exports.FIVE_MINUTES=e.exports.ONE_MINUTE=e.exports.SIXTY_SECONDS=e.exports.THIRTY_SECONDS=e.exports.TEN_SECONDS=e.exports.FIVE_SECONDS=e.exports.ONE_SECOND=void 0,e.exports.ONE_SECOND=1,e.exports.FIVE_SECONDS=5,e.exports.TEN_SECONDS=10,e.exports.THIRTY_SECONDS=30,e.exports.SIXTY_SECONDS=60,e.exports.ONE_MINUTE=e.exports.SIXTY_SECONDS,e.exports.FIVE_MINUTES=5*e.exports.ONE_MINUTE,e.exports.TEN_MINUTES=10*e.exports.ONE_MINUTE,e.exports.THIRTY_MINUTES=30*e.exports.ONE_MINUTE,e.exports.SIXTY_MINUTES=60*e.exports.ONE_MINUTE,e.exports.ONE_HOUR=e.exports.SIXTY_MINUTES,e.exports.THREE_HOURS=3*e.exports.ONE_HOUR,e.exports.SIX_HOURS=6*e.exports.ONE_HOUR,e.exports.TWELVE_HOURS=12*e.exports.ONE_HOUR,e.exports.TWENTY_FOUR_HOURS=24*e.exports.ONE_HOUR,e.exports.ONE_DAY=e.exports.TWENTY_FOUR_HOURS,e.exports.THREE_DAYS=3*e.exports.ONE_DAY,e.exports.FIVE_DAYS=5*e.exports.ONE_DAY,e.exports.SEVEN_DAYS=7*e.exports.ONE_DAY,e.exports.THIRTY_DAYS=30*e.exports.ONE_DAY,e.exports.ONE_WEEK=e.exports.SEVEN_DAYS,e.exports.TWO_WEEKS=2*e.exports.ONE_WEEK,e.exports.THREE_WEEKS=3*e.exports.ONE_WEEK,e.exports.FOUR_WEEKS=4*e.exports.ONE_WEEK,e.exports.ONE_YEAR=365*e.exports.ONE_DAY}),o("iD73S",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){let t=this.get(e);if(void 0!==t.elapsed)throw Error(`Watch already stopped for label: ${e}`);let r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){let t=this.timestamps.get(e);if(void 0===t)throw Error(`No timestamp found for label: ${e}`);return t}elapsed(e){let t=this.get(e);return t.elapsed||Date.now()-t.started}}e.exports.Watch=r,e.exports.default=r}),o("dTXLC",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),n("3kKyL").__exportStar(n("b5rRE"),e.exports)}),o("b5rRE",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.IWatch=void 0,e.exports.IWatch=class{}}),o("lgCxf",function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.wNAF=function(e,t){return{constTimeNegate:a,hasPrecomputes:e=>1!==g(e),unsafeLadder(t,r,i=e.ZERO){let n=t;for(;r>s;)r&o&&(i=i.add(n)),n=n.double(),r>>=o;return i},precomputeWindow(e,r){let{windows:i,windowSize:s}=c(r,t),n=[],o=e,a=o;for(let e=0;e<i;e++){a=o,n.push(a);for(let e=1;e<s;e++)a=a.add(o),n.push(a);o=a.double()}return n},wNAF(r,i,s){let n=e.ZERO,o=e.BASE,h=c(r,t);for(let e=0;e<h.windows;e++){let{nextN:t,offset:r,isZero:c,isNeg:l,isNegF:f,offsetF:d}=u(s,e,h);s=t,c?o=o.add(a(f,i[d])):n=n.add(a(l,i[r]))}return{p:n,f:o}},wNAFUnsafe(r,i,n,o=e.ZERO){let a=c(r,t);for(let e=0;e<a.windows&&n!==s;e++){let{nextN:t,offset:r,isZero:s,isNeg:h}=u(n,e,a);if(n=t,!s){let e=i[r];o=o.add(h?e.negate():e)}}return o},getPrecomputes(e,t,r){let i=d.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&d.set(t,r(i))),i},wNAFCached(e,t,r){let i=g(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let s=g(e);return 1===s?this.unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)},setWindowSize(e,r){h(r,t),p.set(e,r),d.delete(e)}}},t.pippenger=function(e,t,r,s){l(r,e),f(s,t);let n=r.length,o=s.length;if(n!==o)throw Error("arrays of points and scalars must have equal length");let a=e.ZERO,h=(0,i.bitLen)(BigInt(n)),c=1;h>12?c=h-3:h>4?c=h-2:h>0&&(c=2);let u=(0,i.bitMask)(c),d=Array(Number(u)+1).fill(a),p=Math.floor((t.BITS-1)/c)*c,g=a;for(let e=p;e>=0;e-=c){d.fill(a);for(let t=0;t<o;t++){let i=Number(s[t]>>BigInt(e)&u);d[i]=d[i].add(r[t])}let t=a;for(let e=d.length-1,r=a;e>0;e--)r=r.add(d[e]),t=t.add(r);if(g=g.add(t),0!==e)for(let e=0;e<c;e++)g=g.double()}return g},t.precomputeMSMUnsafe=function(e,t,r,s){h(s,t.BITS),l(r,e);let n=e.ZERO,o=2**s-1,a=Math.ceil(t.BITS/s),c=(0,i.bitMask)(s),u=r.map(e=>{let t=[];for(let r=0,i=e;r<o;r++)t.push(i),i=i.add(e);return t});return e=>{if(f(e,t),e.length>r.length)throw Error("array of scalars must be smaller than array of points");let i=n;for(let t=0;t<a;t++){if(i!==n)for(let e=0;e<s;e++)i=i.double();let r=BigInt(a*s-(t+1)*s);for(let t=0;t<e.length;t++){let s=Number(e[t]>>r&c);s&&(i=i.add(u[t][s-1]))}}return i}},t.validateBasic=function(e){return(0,r.validateField)(e.Fp),(0,i.validateObject)(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,r.nLength)(e.n,e.nBitLength),...e,p:e.Fp.ORDER})};var r=n("es3xL"),i=n("5l7pf");let s=BigInt(0),o=BigInt(1);function a(e,t){let r=t.negate();return e?r:t}function h(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function c(e,t){h(e,t);let r=Math.ceil(t/e)+1,s=2**(e-1),n=2**e;return{windows:r,windowSize:s,mask:(0,i.bitMask)(e),maxNumber:n,shiftBy:BigInt(e)}}function u(e,t,r){let{windowSize:i,mask:s,maxNumber:n,shiftBy:a}=r,h=Number(e&s),c=e>>a;h>i&&(h-=n,c+=o);let u=t*i;return{nextN:c,offset:u+Math.abs(h)-1,isZero:0===h,isNeg:h<0,isNegF:t%2!=0,offsetF:u}}function l(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}function f(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}let d=new WeakMap,p=new WeakMap;function g(e){return p.get(e)||1}}),o("es3xL",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isNegativeLE=void 0,e.exports.mod=f,e.exports.pow=function(e,t,r){return v(E(r),e,t)},e.exports.pow2=function(e,t,r){let i=e;for(;t-- >s;)i*=i,i%=r;return i},e.exports.invert=d,e.exports.tonelliShanks=b,e.exports.FpSqrt=y,e.exports.validateField=function(e){let t=m.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"});return(0,i.validateObject)(e,t)},e.exports.FpPow=v,e.exports.FpInvertBatch=w,e.exports.FpDiv=function(e,t,r){return e.mul(t,"bigint"==typeof r?d(r,e.ORDER):e.inv(r))},e.exports.FpLegendre=D,e.exports.FpIsSquare=function(e,t){return 1===D(e,t)},e.exports.nLength=x,e.exports.Field=E,e.exports.FpSqrtOdd=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?r:e.neg(r)},e.exports.FpSqrtEven=function(e,t){if(!e.isOdd)throw Error("Field doesn't have isOdd");let r=e.sqrt(t);return e.isOdd(r)?e.neg(r):r},e.exports.hashToPrivateScalar=function(e,t,r=!1){let s=(e=(0,i.ensureBytes)("privateHash",e)).length,n=x(t).nByteLength+8;if(n<24||s<n||s>1024)throw Error("hashToPrivateScalar: expected "+n+"-1024 bytes of input, got "+s);return f(r?(0,i.bytesToNumberLE)(e):(0,i.bytesToNumberBE)(e),t-o)+o},e.exports.getFieldBytesLength=_,e.exports.getMinHashLength=S,e.exports.mapHashToField=function(e,t,r=!1){let s=e.length,n=_(t),a=S(t);if(s<16||s<a||s>1024)throw Error("expected "+a+"-1024 bytes of input, got "+s);let h=f(r?(0,i.bytesToNumberLE)(e):(0,i.bytesToNumberBE)(e),t-o)+o;return r?(0,i.numberToBytesLE)(h,n):(0,i.numberToBytesBE)(h,n)};var r=n("cLJKR"),i=n("5l7pf");let s=BigInt(0),o=BigInt(1),a=BigInt(2),h=BigInt(3),c=BigInt(4),u=BigInt(5),l=BigInt(8);function f(e,t){let r=e%t;return r>=s?r:t+r}function d(e,t){if(e===s)throw Error("invert: expected non-zero number");if(t<=s)throw Error("invert: expected positive modulus, got "+t);let r=f(e,t),i=t,n=s,a=o,h=o,c=s;for(;r!==s;){let e=i/r,t=i%r,s=n-h*e,o=a-c*e;i=r,r=t,n=h,a=c,h=s,c=o}if(i!==o)throw Error("invert: does not exist");return f(n,t)}function p(e,t){let r=(e.ORDER+o)/c,i=e.pow(t,r);if(!e.eql(e.sqr(i),t))throw Error("Cannot find square root");return i}function g(e,t){let r=(e.ORDER-u)/l,i=e.mul(t,a),s=e.pow(i,r),n=e.mul(t,s),o=e.mul(e.mul(n,a),s),h=e.mul(n,e.sub(o,e.ONE));if(!e.eql(e.sqr(h),t))throw Error("Cannot find square root");return h}function b(e){if(e<BigInt(3))throw Error("sqrt is not defined for small field");let t=e-o,r=0;for(;t%a===s;)t/=a,r++;let i=a,n=E(e);for(;1===D(n,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return p;let h=n.pow(i,t),c=(t+o)/a;return function(e,i){if(e.is0(i))return i;if(1!==D(e,i))throw Error("Cannot find square root");let s=r,n=e.mul(e.ONE,h),a=e.pow(i,t),u=e.pow(i,c);for(;!e.eql(a,e.ONE);){if(e.is0(a))return e.ZERO;let t=1,r=e.sqr(a);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===s)throw Error("Cannot find square root");let i=o<<BigInt(s-t-1),h=e.pow(n,i);s=t,n=e.sqr(h),a=e.mul(a,n),u=e.mul(u,h)}return u}}function y(e){return e%c===h?p:e%l===u?g:b(e)}e.exports.isNegativeLE=(e,t)=>(f(e,t)&o)===o;let m=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function v(e,t,r){if(r<s)throw Error("invalid exponent, negatives unsupported");if(r===s)return e.ONE;if(r===o)return t;let i=e.ONE,n=t;for(;r>s;)r&o&&(i=e.mul(i,n)),n=e.sqr(n),r>>=o;return i}function w(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),s=t.reduce((t,r,s)=>e.is0(r)?t:(i[s]=t,e.mul(t,r)),e.ONE),n=e.inv(s);return t.reduceRight((t,r,s)=>e.is0(r)?t:(i[s]=e.mul(t,i[s]),e.mul(t,r)),n),i}function D(e,t){let r=(e.ORDER-o)/a,i=e.pow(t,r),s=e.eql(i,e.ONE),n=e.eql(i,e.ZERO),h=e.eql(i,e.neg(e.ONE));if(!s&&!n&&!h)throw Error("invalid Legendre symbol result");return s?1:n?0:-1}function x(e,t){void 0!==t&&(0,r.anumber)(t);let i=void 0!==t?t:e.toString(2).length,s=Math.ceil(i/8);return{nBitLength:i,nByteLength:s}}function E(e,t,r=!1,n={}){let a;if(e<=s)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:h,nByteLength:c}=x(e,t);if(c>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let u=Object.freeze({ORDER:e,isLE:r,BITS:h,BYTES:c,MASK:(0,i.bitMask)(h),ZERO:s,ONE:o,create:t=>f(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return s<=t&&t<e},is0:e=>e===s,isOdd:e=>(e&o)===o,neg:t=>f(-t,e),eql:(e,t)=>e===t,sqr:t=>f(t*t,e),add:(t,r)=>f(t+r,e),sub:(t,r)=>f(t-r,e),mul:(t,r)=>f(t*r,e),pow:(e,t)=>v(u,e,t),div:(t,r)=>f(t*d(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>d(t,e),sqrt:n.sqrt||(t=>(a||(a=y(e)),a(u,t))),toBytes:e=>r?(0,i.numberToBytesLE)(e,c):(0,i.numberToBytesBE)(e,c),fromBytes:e=>{if(e.length!==c)throw Error("Field.fromBytes: expected "+c+" bytes, got "+e.length);return r?(0,i.bytesToNumberLE)(e):(0,i.bytesToNumberBE)(e)},invertBatch:e=>w(u,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(u)}function _(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function S(e){let t=_(e);return t+Math.ceil(t/2)}}),o("cLJKR",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.wrapXOFConstructorWithOpts=e.exports.wrapConstructorWithOpts=e.exports.wrapConstructor=e.exports.Hash=e.exports.nextTick=e.exports.swap32IfBE=e.exports.byteSwapIfBE=e.exports.swap8IfBE=e.exports.isLE=void 0,e.exports.isBytes=i,e.exports.anumber=s,e.exports.abytes=o,e.exports.ahash=function(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");s(e.outputLen),s(e.blockLen)},e.exports.aexists=function(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")},e.exports.aoutput=function(e,t){o(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)},e.exports.u8=function(e){return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)},e.exports.u32=function(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))},e.exports.clean=function(...e){for(let t=0;t<e.length;t++)e[t].fill(0)},e.exports.createView=function(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)},e.exports.rotr=function(e,t){return e<<32-t|e>>>t},e.exports.rotl=function(e,t){return e<<t|e>>>32-t>>>0},e.exports.byteSwap=a,e.exports.byteSwap32=h,e.exports.bytesToHex=function(e){if(o(e),c)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=u[e[r]];return t},e.exports.hexToBytes=function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(c)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=l(e.charCodeAt(s)),n=l(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i},e.exports.asyncLoop=d,e.exports.utf8ToBytes=p,e.exports.bytesToUtf8=function(e){return new TextDecoder().decode(e)},e.exports.toBytes=g,e.exports.kdfInputToBytes=function(e){return"string"==typeof e&&(e=p(e)),o(e),e},e.exports.concatBytes=function(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];o(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r},e.exports.checkOpts=function(e,t){if(void 0!==t&&"[object Object]"!==({}).toString.call(t))throw Error("options should be object or undefined");return Object.assign(e,t)},e.exports.createHasher=b,e.exports.createOptHasher=y,e.exports.createXOFer=m,e.exports.randomBytes=function(e=32){if(r.crypto&&"function"==typeof r.crypto.getRandomValues)return r.crypto.getRandomValues(new Uint8Array(e));if(r.crypto&&"function"==typeof r.crypto.randomBytes)return Uint8Array.from(r.crypto.randomBytes(e));throw Error("crypto.getRandomValues must be defined")};var r=n("eW4mz");function i(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function s(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function o(e,...t){if(!i(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function a(e){return e<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}function h(e){for(let t=0;t<e.length;t++)e[t]=a(e[t]);return e}e.exports.isLE=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0],e.exports.swap8IfBE=e.exports.isLE?e=>e:e=>a(e),e.exports.byteSwapIfBE=e.exports.swap8IfBE,e.exports.swap32IfBE=e.exports.isLE?e=>e:h;let c="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,u=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function l(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}let f=async()=>{};async function d(t,r,i){let s=Date.now();for(let n=0;n<t;n++){i(n);let t=Date.now()-s;t>=0&&t<r||(await (0,e.exports.nextTick)(),s+=t)}}function p(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function g(e){return"string"==typeof e&&(e=p(e)),o(e),e}function b(e){let t=t=>e().update(g(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function y(e){let t=(t,r)=>e(r).update(g(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}function m(e){let t=(t,r)=>e(r).update(g(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}e.exports.nextTick=f,e.exports.Hash=class{},e.exports.wrapConstructor=b,e.exports.wrapConstructorWithOpts=y,e.exports.wrapXOFConstructorWithOpts=m}),o("eW4mz",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.crypto=void 0,e.exports.crypto="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0}),o("5l7pf",function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.notImplemented=e.exports.bitMask=void 0,e.exports.isBytes=s,e.exports.abytes=n,e.exports.abool=function(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)},e.exports.numberToHexUnpadded=o,e.exports.hexToNumber=a,e.exports.bytesToHex=u,e.exports.hexToBytes=f,e.exports.bytesToNumberBE=function(e){return a(u(e))},e.exports.bytesToNumberLE=function(e){return n(e),a(u(Uint8Array.from(e).reverse()))},e.exports.numberToBytesBE=d,e.exports.numberToBytesLE=function(e,t){return d(e,t).reverse()},e.exports.numberToVarBytesBE=function(e){return f(o(e))},e.exports.ensureBytes=function(e,t,r){let i;if("string"==typeof t)try{i=f(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(s(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let n=i.length;if("number"==typeof r&&n!==r)throw Error(e+" of length "+r+" expected, got "+n);return i},e.exports.concatBytes=p,e.exports.equalBytes=function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r},e.exports.utf8ToBytes=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))},e.exports.inRange=b,e.exports.aInRange=function(e,t,r,i){if(!b(t,r,i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)},e.exports.bitLen=function(e){let t;for(t=0;e>r;e>>=i,t+=1);return t},e.exports.bitGet=function(e,t){return e>>BigInt(t)&i},e.exports.bitSet=function(e,t,s){return e|(s?i:r)<<BigInt(t)},e.exports.createHmacDrbg=function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=y(e),s=y(e),n=0,o=()=>{i.fill(1),s.fill(0),n=0},a=(...e)=>r(s,i,...e),h=(e=y(0))=>{s=a(m([0]),e),i=a(),0!==e.length&&(s=a(m([1]),e),i=a())},c=()=>{if(n++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(i=a()).slice();r.push(t),e+=i.length}return p(...r)};return(e,t)=>{let r;for(o(),h(e);!(r=t(c()));)h();return o(),r}},e.exports.validateObject=function(e,t,r={}){let i=(t,r,i)=>{let s=v[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if((!i||void 0!==n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e},e.exports.memoized=function(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}};let r=BigInt(0),i=BigInt(1);function s(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function n(e){if(!s(e))throw Error("Uint8Array expected")}function o(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function a(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?r:BigInt("0x"+e)}let h="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,c=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function u(e){if(n(e),h)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=c[e[r]];return t}function l(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function f(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(h)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=l(e.charCodeAt(s)),n=l(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function d(e,t){return f(e.toString(16).padStart(2*t,"0"))}function p(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];n(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}let g=e=>"bigint"==typeof e&&r<=e;function b(e,t,r){return g(e)&&g(t)&&g(r)&&t<=e&&e<r}e.exports.bitMask=e=>(i<<BigInt(e))-i;let y=e=>new Uint8Array(e),m=e=>Uint8Array.from(e),v={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||s(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};e.exports.notImplemented=()=>{throw Error("not implemented")}}),o("ljFVp",function(e,r){function i(){return(null==t?void 0:t.crypto)||(null==t?void 0:t.msCrypto)||{}}function s(){let e=i();return e.subtle||e.webkitSubtle}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isBrowserCryptoAvailable=e.exports.getSubtleCrypto=e.exports.getBrowerCrypto=void 0,e.exports.getBrowerCrypto=i,e.exports.getSubtleCrypto=s,e.exports.isBrowserCryptoAvailable=function(){return!!i()&&!!s()}}),o("5vmD7",function(e,t){function r(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isBrowser=e.exports.isNode=e.exports.isReactNative=void 0,e.exports.isReactNative=r,e.exports.isNode=function(){return!1},e.exports.isBrowser=function(){return!r()}}),o("fvaAM",function(e,t){e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}}),o("dEXSZ",function(e,t){!function(e,t){function r(e,t){if(!e)throw Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{l="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:n("kjyEk").Buffer}catch(e){}function o(e,t){var i=e.charCodeAt(t);return i>=48&&i<=57?i-48:i>=65&&i<=70?i-55:i>=97&&i<=102?i-87:void r(!1,"Invalid character in "+e)}function a(e,t,r){var i=o(e,r);return r-1>=t&&(i|=o(e,r-1)<<4),i}function h(e,t,i,s){for(var n=0,o=0,a=Math.min(e.length,i),h=t;h<a;h++){var c=e.charCodeAt(h)-48;n*=s,o=c>=49?c-49+10:c>=17?c-17+10:c,r(c>=0&&o<s,"Invalid character"),n+=o}return n}function c(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return 0>e.cmp(t)?e:t},s.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var s=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(s++,this.negative=1),s<e.length&&(16===t?this._parseHex(e,s,i):(this._parseBase(e,t,s),"le"===i&&this._initArray(this.toArray(),t,i)))},s.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<0x4000000?(this.words=[0x3ffffff&e],this.length=1):e<0x10000000000000?(this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff],this.length=2):(r(e<0x20000000000000),this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},s.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var s,n,o=0;o<this.length;o++)this.words[o]=0;var a=0;if("be"===i)for(o=e.length-1,s=0;o>=0;o-=3)n=e[o]|e[o-1]<<8|e[o-2]<<16,this.words[s]|=n<<a&0x3ffffff,this.words[s+1]=n>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);else if("le"===i)for(o=0,s=0;o<e.length;o+=3)n=e[o]|e[o+1]<<8|e[o+2]<<16,this.words[s]|=n<<a&0x3ffffff,this.words[s+1]=n>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);return this._strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var i,s=0;s<this.length;s++)this.words[s]=0;var n=0,o=0;if("be"===r)for(s=e.length-1;s>=t;s-=2)i=a(e,t,s)<<n,this.words[o]|=0x3ffffff&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;else for(s=(e.length-t)%2==0?t+1:t;s<e.length;s+=2)i=a(e,t,s)<<n,this.words[o]|=0x3ffffff&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;this._strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var i=0,s=1;s<=0x3ffffff;s*=t)i++;i--,s=s/t|0;for(var n=e.length-r,o=n%i,a=Math.min(n,n-o)+r,c=0,u=r;u<a;u+=i)c=h(e,u,u+i,t),this.imuln(s),this.words[0]+c<0x4000000?this.words[0]+=c:this._iaddn(c);if(0!==o){var l=1;for(c=h(e,u,e.length,t),u=0;u<o;u++)l*=t;this.imuln(l),this.words[0]+c<0x4000000?this.words[0]+=c:this._iaddn(c)}this._strip()},s.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype._move=function(e){c(e,this)},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=u}catch(e){s.prototype.inspect=u}else s.prototype.inspect=u;function u(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var l,f=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,0x2000000,0x290d741,0x1000000,0x2e90edd,0x39aa400,0x267bf47,0x1000000,0x290d741,1e7,0x12959c3,0x222c000,0x3bd7765,7529536,0xadcea1,0x1000000,0x1704f61,0x206fc40,0x2cddcf9,64e6,4084101,5153632,6436343,7962624,9765625,0xb54ba0,0xdaf26b,0x1069c00,0x138f9ad,243e5,0x1b4d89f,0x2000000,0x25528a1,0x2b54a20,0x3216b93,0x39aa400];function g(e,t,r){r.negative=t.negative^e.negative;var i=e.length+t.length|0;r.length=i,i=i-1|0;var s=0|e.words[0],n=0|t.words[0],o=s*n,a=0x3ffffff&o,h=o/0x4000000|0;r.words[0]=a;for(var c=1;c<i;c++){for(var u=h>>>26,l=0x3ffffff&h,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;u+=(o=(s=0|e.words[p])*(n=0|t.words[d])+l)/0x4000000|0,l=0x3ffffff&o}r.words[c]=0|l,h=0|u}return 0!==h?r.words[c]=0|h:r.length--,r._strip()}s.prototype.toString=function(e,t){if(t=0|t||1,16===(e=e||10)||"hex"===e){for(var i="",s=0,n=0,o=0;o<this.length;o++){var a=this.words[o],h=((a<<s|n)&0xffffff).toString(16);n=a>>>24-s&0xffffff,(s+=2)>=26&&(s-=26,o--),i=0!==n||o!==this.length-1?f[6-h.length]+h+i:h+i}for(0!==n&&(i=n.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],u=p[e];i="";var l=this.clone();for(l.negative=0;!l.isZero();){var g=l.modrn(u).toString(e);i=(l=l.idivn(u)).isZero()?g+i:f[c-g.length]+g+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=0x4000000*this.words[1]:3===this.length&&1===this.words[2]?e+=0x10000000000000+0x4000000*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16,2)},l&&(s.prototype.toBuffer=function(e,t){return this.toArrayLike(l,e,t)}),s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,i){this._strip();var s=this.byteLength(),n=i||Math.max(1,s);r(s<=n,"byte array longer than desired length"),r(n>0,"Requested array length <= 0");var o=e.allocUnsafe?e.allocUnsafe(n):new e(n);return this["_toArrayLike"+("le"===t?"LE":"BE")](o,s),o},s.prototype._toArrayLikeLE=function(e,t){for(var r=0,i=0,s=0,n=0;s<this.length;s++){var o=this.words[s]<<n|i;e[r++]=255&o,r<e.length&&(e[r++]=o>>8&255),r<e.length&&(e[r++]=o>>16&255),6===n?(r<e.length&&(e[r++]=o>>24&255),i=0,n=0):(i=o>>>24,n+=2)}if(r<e.length)for(e[r++]=i;r<e.length;)e[r++]=0},s.prototype._toArrayLikeBE=function(e,t){for(var r=e.length-1,i=0,s=0,n=0;s<this.length;s++){var o=this.words[s]<<n|i;e[r--]=255&o,r>=0&&(e[r--]=o>>8&255),r>=0&&(e[r--]=o>>16&255),6===n?(r>=0&&(e[r--]=o>>24&255),i=0,n=0):(i=o>>>24,n+=2)}if(r>=0)for(e[r--]=i;r>=0;)e[r--]=0},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return(8191&t)==0&&(r+=13,t>>>=13),(127&t)==0&&(r+=7,t>>>=7),(15&t)==0&&(r+=4,t>>>=4),(3&t)==0&&(r+=2,t>>>=2),(1&t)==0&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return(this.length-1)*26+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},s.prototype.ior=function(e){return r((this.negative|e.negative)==0),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this._strip()},s.prototype.iand=function(e){return r((this.negative|e.negative)==0),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){this.length>e.length?(t=this,r=e):(t=e,r=this);for(var t,r,i=0;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this._strip()},s.prototype.ixor=function(e){return r((this.negative|e.negative)==0),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var s=0;s<t;s++)this.words[s]=0x3ffffff&~this.words[s];return i>0&&(this.words[s]=~this.words[s]&0x3ffffff>>26-i),this._strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,s=e%26;return this._expand(i+1),t?this.words[i]=this.words[i]|1<<s:this.words[i]=this.words[i]&~(1<<s),this._strip()},s.prototype.iadd=function(e){if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,i=e):(r=e,i=this);for(var t,r,i,s=0,n=0;n<i.length;n++)t=(0|r.words[n])+(0|i.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;for(;0!==s&&n<r.length;n++)t=(0|r.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;if(this.length=r.length,0!==s)this.words[this.length]=s,this.length++;else if(r!==this)for(;n<r.length;n++)this.words[n]=r.words[n];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t,r,i=this.iadd(e);return e.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s=this.cmp(e);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(t=this,r=e):(t=e,r=this);for(var n=0,o=0;o<r.length;o++)n=(i=(0|t.words[o])-(0|r.words[o])+n)>>26,this.words[o]=0x3ffffff&i;for(;0!==n&&o<t.length;o++)n=(i=(0|t.words[o])+n)>>26,this.words[o]=0x3ffffff&i;if(0===n&&o<t.length&&t!==this)for(;o<t.length;o++)this.words[o]=t.words[o];return this.length=Math.max(this.length,o),t!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var b=function(e,t,r){var i,s,n,o=e.words,a=t.words,h=r.words,c=0,u=0|o[0],l=8191&u,f=u>>>13,d=0|o[1],p=8191&d,g=d>>>13,b=0|o[2],y=8191&b,m=b>>>13,v=0|o[3],w=8191&v,D=v>>>13,x=0|o[4],E=8191&x,_=x>>>13,S=0|o[5],I=8191&S,A=S>>>13,M=0|o[6],O=8191&M,C=M>>>13,P=0|o[7],R=8191&P,T=P>>>13,N=0|o[8],B=8191&N,L=N>>>13,U=0|o[9],k=8191&U,q=U>>>13,j=0|a[0],z=8191&j,F=j>>>13,$=0|a[1],K=8191&$,V=$>>>13,H=0|a[2],G=8191&H,W=H>>>13,Y=0|a[3],J=8191&Y,Z=Y>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,et=0|a[5],er=8191&et,ei=et>>>13,es=0|a[6],en=8191&es,eo=es>>>13,ea=0|a[7],eh=8191&ea,ec=ea>>>13,eu=0|a[8],el=8191&eu,ef=eu>>>13,ed=0|a[9],ep=8191&ed,eg=ed>>>13;r.negative=e.negative^t.negative,r.length=19,i=Math.imul(l,z);var eb=(c+i|0)+((8191&(s=(s=Math.imul(l,F))+Math.imul(f,z)|0))<<13)|0;c=((n=Math.imul(f,F))+(s>>>13)|0)+(eb>>>26)|0,eb&=0x3ffffff,i=Math.imul(p,z),s=(s=Math.imul(p,F))+Math.imul(g,z)|0,n=Math.imul(g,F),i=i+Math.imul(l,K)|0;var ey=(c+i|0)+((8191&(s=(s=s+Math.imul(l,V)|0)+Math.imul(f,K)|0))<<13)|0;c=((n=n+Math.imul(f,V)|0)+(s>>>13)|0)+(ey>>>26)|0,ey&=0x3ffffff,i=Math.imul(y,z),s=(s=Math.imul(y,F))+Math.imul(m,z)|0,n=Math.imul(m,F),i=i+Math.imul(p,K)|0,s=(s=s+Math.imul(p,V)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,V)|0,i=i+Math.imul(l,G)|0;var em=(c+i|0)+((8191&(s=(s=s+Math.imul(l,W)|0)+Math.imul(f,G)|0))<<13)|0;c=((n=n+Math.imul(f,W)|0)+(s>>>13)|0)+(em>>>26)|0,em&=0x3ffffff,i=Math.imul(w,z),s=(s=Math.imul(w,F))+Math.imul(D,z)|0,n=Math.imul(D,F),i=i+Math.imul(y,K)|0,s=(s=s+Math.imul(y,V)|0)+Math.imul(m,K)|0,n=n+Math.imul(m,V)|0,i=i+Math.imul(p,G)|0,s=(s=s+Math.imul(p,W)|0)+Math.imul(g,G)|0,n=n+Math.imul(g,W)|0,i=i+Math.imul(l,J)|0;var ev=(c+i|0)+((8191&(s=(s=s+Math.imul(l,Z)|0)+Math.imul(f,J)|0))<<13)|0;c=((n=n+Math.imul(f,Z)|0)+(s>>>13)|0)+(ev>>>26)|0,ev&=0x3ffffff,i=Math.imul(E,z),s=(s=Math.imul(E,F))+Math.imul(_,z)|0,n=Math.imul(_,F),i=i+Math.imul(w,K)|0,s=(s=s+Math.imul(w,V)|0)+Math.imul(D,K)|0,n=n+Math.imul(D,V)|0,i=i+Math.imul(y,G)|0,s=(s=s+Math.imul(y,W)|0)+Math.imul(m,G)|0,n=n+Math.imul(m,W)|0,i=i+Math.imul(p,J)|0,s=(s=s+Math.imul(p,Z)|0)+Math.imul(g,J)|0,n=n+Math.imul(g,Z)|0,i=i+Math.imul(l,Q)|0;var ew=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ee)|0)+Math.imul(f,Q)|0))<<13)|0;c=((n=n+Math.imul(f,ee)|0)+(s>>>13)|0)+(ew>>>26)|0,ew&=0x3ffffff,i=Math.imul(I,z),s=(s=Math.imul(I,F))+Math.imul(A,z)|0,n=Math.imul(A,F),i=i+Math.imul(E,K)|0,s=(s=s+Math.imul(E,V)|0)+Math.imul(_,K)|0,n=n+Math.imul(_,V)|0,i=i+Math.imul(w,G)|0,s=(s=s+Math.imul(w,W)|0)+Math.imul(D,G)|0,n=n+Math.imul(D,W)|0,i=i+Math.imul(y,J)|0,s=(s=s+Math.imul(y,Z)|0)+Math.imul(m,J)|0,n=n+Math.imul(m,Z)|0,i=i+Math.imul(p,Q)|0,s=(s=s+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,n=n+Math.imul(g,ee)|0,i=i+Math.imul(l,er)|0;var eD=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ei)|0)+Math.imul(f,er)|0))<<13)|0;c=((n=n+Math.imul(f,ei)|0)+(s>>>13)|0)+(eD>>>26)|0,eD&=0x3ffffff,i=Math.imul(O,z),s=(s=Math.imul(O,F))+Math.imul(C,z)|0,n=Math.imul(C,F),i=i+Math.imul(I,K)|0,s=(s=s+Math.imul(I,V)|0)+Math.imul(A,K)|0,n=n+Math.imul(A,V)|0,i=i+Math.imul(E,G)|0,s=(s=s+Math.imul(E,W)|0)+Math.imul(_,G)|0,n=n+Math.imul(_,W)|0,i=i+Math.imul(w,J)|0,s=(s=s+Math.imul(w,Z)|0)+Math.imul(D,J)|0,n=n+Math.imul(D,Z)|0,i=i+Math.imul(y,Q)|0,s=(s=s+Math.imul(y,ee)|0)+Math.imul(m,Q)|0,n=n+Math.imul(m,ee)|0,i=i+Math.imul(p,er)|0,s=(s=s+Math.imul(p,ei)|0)+Math.imul(g,er)|0,n=n+Math.imul(g,ei)|0,i=i+Math.imul(l,en)|0;var ex=(c+i|0)+((8191&(s=(s=s+Math.imul(l,eo)|0)+Math.imul(f,en)|0))<<13)|0;c=((n=n+Math.imul(f,eo)|0)+(s>>>13)|0)+(ex>>>26)|0,ex&=0x3ffffff,i=Math.imul(R,z),s=(s=Math.imul(R,F))+Math.imul(T,z)|0,n=Math.imul(T,F),i=i+Math.imul(O,K)|0,s=(s=s+Math.imul(O,V)|0)+Math.imul(C,K)|0,n=n+Math.imul(C,V)|0,i=i+Math.imul(I,G)|0,s=(s=s+Math.imul(I,W)|0)+Math.imul(A,G)|0,n=n+Math.imul(A,W)|0,i=i+Math.imul(E,J)|0,s=(s=s+Math.imul(E,Z)|0)+Math.imul(_,J)|0,n=n+Math.imul(_,Z)|0,i=i+Math.imul(w,Q)|0,s=(s=s+Math.imul(w,ee)|0)+Math.imul(D,Q)|0,n=n+Math.imul(D,ee)|0,i=i+Math.imul(y,er)|0,s=(s=s+Math.imul(y,ei)|0)+Math.imul(m,er)|0,n=n+Math.imul(m,ei)|0,i=i+Math.imul(p,en)|0,s=(s=s+Math.imul(p,eo)|0)+Math.imul(g,en)|0,n=n+Math.imul(g,eo)|0,i=i+Math.imul(l,eh)|0;var eE=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ec)|0)+Math.imul(f,eh)|0))<<13)|0;c=((n=n+Math.imul(f,ec)|0)+(s>>>13)|0)+(eE>>>26)|0,eE&=0x3ffffff,i=Math.imul(B,z),s=(s=Math.imul(B,F))+Math.imul(L,z)|0,n=Math.imul(L,F),i=i+Math.imul(R,K)|0,s=(s=s+Math.imul(R,V)|0)+Math.imul(T,K)|0,n=n+Math.imul(T,V)|0,i=i+Math.imul(O,G)|0,s=(s=s+Math.imul(O,W)|0)+Math.imul(C,G)|0,n=n+Math.imul(C,W)|0,i=i+Math.imul(I,J)|0,s=(s=s+Math.imul(I,Z)|0)+Math.imul(A,J)|0,n=n+Math.imul(A,Z)|0,i=i+Math.imul(E,Q)|0,s=(s=s+Math.imul(E,ee)|0)+Math.imul(_,Q)|0,n=n+Math.imul(_,ee)|0,i=i+Math.imul(w,er)|0,s=(s=s+Math.imul(w,ei)|0)+Math.imul(D,er)|0,n=n+Math.imul(D,ei)|0,i=i+Math.imul(y,en)|0,s=(s=s+Math.imul(y,eo)|0)+Math.imul(m,en)|0,n=n+Math.imul(m,eo)|0,i=i+Math.imul(p,eh)|0,s=(s=s+Math.imul(p,ec)|0)+Math.imul(g,eh)|0,n=n+Math.imul(g,ec)|0,i=i+Math.imul(l,el)|0;var e_=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ef)|0)+Math.imul(f,el)|0))<<13)|0;c=((n=n+Math.imul(f,ef)|0)+(s>>>13)|0)+(e_>>>26)|0,e_&=0x3ffffff,i=Math.imul(k,z),s=(s=Math.imul(k,F))+Math.imul(q,z)|0,n=Math.imul(q,F),i=i+Math.imul(B,K)|0,s=(s=s+Math.imul(B,V)|0)+Math.imul(L,K)|0,n=n+Math.imul(L,V)|0,i=i+Math.imul(R,G)|0,s=(s=s+Math.imul(R,W)|0)+Math.imul(T,G)|0,n=n+Math.imul(T,W)|0,i=i+Math.imul(O,J)|0,s=(s=s+Math.imul(O,Z)|0)+Math.imul(C,J)|0,n=n+Math.imul(C,Z)|0,i=i+Math.imul(I,Q)|0,s=(s=s+Math.imul(I,ee)|0)+Math.imul(A,Q)|0,n=n+Math.imul(A,ee)|0,i=i+Math.imul(E,er)|0,s=(s=s+Math.imul(E,ei)|0)+Math.imul(_,er)|0,n=n+Math.imul(_,ei)|0,i=i+Math.imul(w,en)|0,s=(s=s+Math.imul(w,eo)|0)+Math.imul(D,en)|0,n=n+Math.imul(D,eo)|0,i=i+Math.imul(y,eh)|0,s=(s=s+Math.imul(y,ec)|0)+Math.imul(m,eh)|0,n=n+Math.imul(m,ec)|0,i=i+Math.imul(p,el)|0,s=(s=s+Math.imul(p,ef)|0)+Math.imul(g,el)|0,n=n+Math.imul(g,ef)|0,i=i+Math.imul(l,ep)|0;var eS=(c+i|0)+((8191&(s=(s=s+Math.imul(l,eg)|0)+Math.imul(f,ep)|0))<<13)|0;c=((n=n+Math.imul(f,eg)|0)+(s>>>13)|0)+(eS>>>26)|0,eS&=0x3ffffff,i=Math.imul(k,K),s=(s=Math.imul(k,V))+Math.imul(q,K)|0,n=Math.imul(q,V),i=i+Math.imul(B,G)|0,s=(s=s+Math.imul(B,W)|0)+Math.imul(L,G)|0,n=n+Math.imul(L,W)|0,i=i+Math.imul(R,J)|0,s=(s=s+Math.imul(R,Z)|0)+Math.imul(T,J)|0,n=n+Math.imul(T,Z)|0,i=i+Math.imul(O,Q)|0,s=(s=s+Math.imul(O,ee)|0)+Math.imul(C,Q)|0,n=n+Math.imul(C,ee)|0,i=i+Math.imul(I,er)|0,s=(s=s+Math.imul(I,ei)|0)+Math.imul(A,er)|0,n=n+Math.imul(A,ei)|0,i=i+Math.imul(E,en)|0,s=(s=s+Math.imul(E,eo)|0)+Math.imul(_,en)|0,n=n+Math.imul(_,eo)|0,i=i+Math.imul(w,eh)|0,s=(s=s+Math.imul(w,ec)|0)+Math.imul(D,eh)|0,n=n+Math.imul(D,ec)|0,i=i+Math.imul(y,el)|0,s=(s=s+Math.imul(y,ef)|0)+Math.imul(m,el)|0,n=n+Math.imul(m,ef)|0,i=i+Math.imul(p,ep)|0;var eI=(c+i|0)+((8191&(s=(s=s+Math.imul(p,eg)|0)+Math.imul(g,ep)|0))<<13)|0;c=((n=n+Math.imul(g,eg)|0)+(s>>>13)|0)+(eI>>>26)|0,eI&=0x3ffffff,i=Math.imul(k,G),s=(s=Math.imul(k,W))+Math.imul(q,G)|0,n=Math.imul(q,W),i=i+Math.imul(B,J)|0,s=(s=s+Math.imul(B,Z)|0)+Math.imul(L,J)|0,n=n+Math.imul(L,Z)|0,i=i+Math.imul(R,Q)|0,s=(s=s+Math.imul(R,ee)|0)+Math.imul(T,Q)|0,n=n+Math.imul(T,ee)|0,i=i+Math.imul(O,er)|0,s=(s=s+Math.imul(O,ei)|0)+Math.imul(C,er)|0,n=n+Math.imul(C,ei)|0,i=i+Math.imul(I,en)|0,s=(s=s+Math.imul(I,eo)|0)+Math.imul(A,en)|0,n=n+Math.imul(A,eo)|0,i=i+Math.imul(E,eh)|0,s=(s=s+Math.imul(E,ec)|0)+Math.imul(_,eh)|0,n=n+Math.imul(_,ec)|0,i=i+Math.imul(w,el)|0,s=(s=s+Math.imul(w,ef)|0)+Math.imul(D,el)|0,n=n+Math.imul(D,ef)|0,i=i+Math.imul(y,ep)|0;var eA=(c+i|0)+((8191&(s=(s=s+Math.imul(y,eg)|0)+Math.imul(m,ep)|0))<<13)|0;c=((n=n+Math.imul(m,eg)|0)+(s>>>13)|0)+(eA>>>26)|0,eA&=0x3ffffff,i=Math.imul(k,J),s=(s=Math.imul(k,Z))+Math.imul(q,J)|0,n=Math.imul(q,Z),i=i+Math.imul(B,Q)|0,s=(s=s+Math.imul(B,ee)|0)+Math.imul(L,Q)|0,n=n+Math.imul(L,ee)|0,i=i+Math.imul(R,er)|0,s=(s=s+Math.imul(R,ei)|0)+Math.imul(T,er)|0,n=n+Math.imul(T,ei)|0,i=i+Math.imul(O,en)|0,s=(s=s+Math.imul(O,eo)|0)+Math.imul(C,en)|0,n=n+Math.imul(C,eo)|0,i=i+Math.imul(I,eh)|0,s=(s=s+Math.imul(I,ec)|0)+Math.imul(A,eh)|0,n=n+Math.imul(A,ec)|0,i=i+Math.imul(E,el)|0,s=(s=s+Math.imul(E,ef)|0)+Math.imul(_,el)|0,n=n+Math.imul(_,ef)|0,i=i+Math.imul(w,ep)|0;var eM=(c+i|0)+((8191&(s=(s=s+Math.imul(w,eg)|0)+Math.imul(D,ep)|0))<<13)|0;c=((n=n+Math.imul(D,eg)|0)+(s>>>13)|0)+(eM>>>26)|0,eM&=0x3ffffff,i=Math.imul(k,Q),s=(s=Math.imul(k,ee))+Math.imul(q,Q)|0,n=Math.imul(q,ee),i=i+Math.imul(B,er)|0,s=(s=s+Math.imul(B,ei)|0)+Math.imul(L,er)|0,n=n+Math.imul(L,ei)|0,i=i+Math.imul(R,en)|0,s=(s=s+Math.imul(R,eo)|0)+Math.imul(T,en)|0,n=n+Math.imul(T,eo)|0,i=i+Math.imul(O,eh)|0,s=(s=s+Math.imul(O,ec)|0)+Math.imul(C,eh)|0,n=n+Math.imul(C,ec)|0,i=i+Math.imul(I,el)|0,s=(s=s+Math.imul(I,ef)|0)+Math.imul(A,el)|0,n=n+Math.imul(A,ef)|0,i=i+Math.imul(E,ep)|0;var eO=(c+i|0)+((8191&(s=(s=s+Math.imul(E,eg)|0)+Math.imul(_,ep)|0))<<13)|0;c=((n=n+Math.imul(_,eg)|0)+(s>>>13)|0)+(eO>>>26)|0,eO&=0x3ffffff,i=Math.imul(k,er),s=(s=Math.imul(k,ei))+Math.imul(q,er)|0,n=Math.imul(q,ei),i=i+Math.imul(B,en)|0,s=(s=s+Math.imul(B,eo)|0)+Math.imul(L,en)|0,n=n+Math.imul(L,eo)|0,i=i+Math.imul(R,eh)|0,s=(s=s+Math.imul(R,ec)|0)+Math.imul(T,eh)|0,n=n+Math.imul(T,ec)|0,i=i+Math.imul(O,el)|0,s=(s=s+Math.imul(O,ef)|0)+Math.imul(C,el)|0,n=n+Math.imul(C,ef)|0,i=i+Math.imul(I,ep)|0;var eC=(c+i|0)+((8191&(s=(s=s+Math.imul(I,eg)|0)+Math.imul(A,ep)|0))<<13)|0;c=((n=n+Math.imul(A,eg)|0)+(s>>>13)|0)+(eC>>>26)|0,eC&=0x3ffffff,i=Math.imul(k,en),s=(s=Math.imul(k,eo))+Math.imul(q,en)|0,n=Math.imul(q,eo),i=i+Math.imul(B,eh)|0,s=(s=s+Math.imul(B,ec)|0)+Math.imul(L,eh)|0,n=n+Math.imul(L,ec)|0,i=i+Math.imul(R,el)|0,s=(s=s+Math.imul(R,ef)|0)+Math.imul(T,el)|0,n=n+Math.imul(T,ef)|0,i=i+Math.imul(O,ep)|0;var eP=(c+i|0)+((8191&(s=(s=s+Math.imul(O,eg)|0)+Math.imul(C,ep)|0))<<13)|0;c=((n=n+Math.imul(C,eg)|0)+(s>>>13)|0)+(eP>>>26)|0,eP&=0x3ffffff,i=Math.imul(k,eh),s=(s=Math.imul(k,ec))+Math.imul(q,eh)|0,n=Math.imul(q,ec),i=i+Math.imul(B,el)|0,s=(s=s+Math.imul(B,ef)|0)+Math.imul(L,el)|0,n=n+Math.imul(L,ef)|0,i=i+Math.imul(R,ep)|0;var eR=(c+i|0)+((8191&(s=(s=s+Math.imul(R,eg)|0)+Math.imul(T,ep)|0))<<13)|0;c=((n=n+Math.imul(T,eg)|0)+(s>>>13)|0)+(eR>>>26)|0,eR&=0x3ffffff,i=Math.imul(k,el),s=(s=Math.imul(k,ef))+Math.imul(q,el)|0,n=Math.imul(q,ef),i=i+Math.imul(B,ep)|0;var eT=(c+i|0)+((8191&(s=(s=s+Math.imul(B,eg)|0)+Math.imul(L,ep)|0))<<13)|0;c=((n=n+Math.imul(L,eg)|0)+(s>>>13)|0)+(eT>>>26)|0,eT&=0x3ffffff,i=Math.imul(k,ep);var eN=(c+i|0)+((8191&(s=(s=Math.imul(k,eg))+Math.imul(q,ep)|0))<<13)|0;return c=((n=Math.imul(q,eg))+(s>>>13)|0)+(eN>>>26)|0,eN&=0x3ffffff,h[0]=eb,h[1]=ey,h[2]=em,h[3]=ev,h[4]=ew,h[5]=eD,h[6]=ex,h[7]=eE,h[8]=e_,h[9]=eS,h[10]=eI,h[11]=eA,h[12]=eM,h[13]=eO,h[14]=eC,h[15]=eP,h[16]=eR,h[17]=eT,h[18]=eN,0!==c&&(h[19]=c,r.length++),r};function y(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var i=0,s=0,n=0;n<r.length-1;n++){var o=s;s=0;for(var a=0x3ffffff&i,h=Math.min(n,t.length-1),c=Math.max(0,n-e.length+1);c<=h;c++){var u=n-c,l=(0|e.words[u])*(0|t.words[c]),f=0x3ffffff&l;o=o+(l/0x4000000|0)|0,a=0x3ffffff&(f=f+a|0),s+=(o=o+(f>>>26)|0)>>>26,o&=0x3ffffff}r.words[n]=a,i=o,o=s}return 0!==i?r.words[n]=i:r.length--,r._strip()}function m(e,t){this.x=e,this.y=t}Math.imul||(b=g),s.prototype.mulTo=function(e,t){var r,i=this.length+e.length;return 10===this.length&&10===e.length?r=b(this,e,t):i<63?r=g(this,e,t):r=y(this,e,t),r},m.prototype.makeRBT=function(e){for(var t=Array(e),r=s.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var i=0,s=0;s<t;s++)i|=(1&e)<<t-s-1,e>>=1;return i},m.prototype.permute=function(e,t,r,i,s,n){for(var o=0;o<n;o++)i[o]=t[e[o]],s[o]=r[e[o]]},m.prototype.transform=function(e,t,r,i,s,n){this.permute(n,e,t,r,i,s);for(var o=1;o<s;o<<=1)for(var a=o<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<s;u+=a)for(var l=h,f=c,d=0;d<o;d++){var p=r[u+d],g=i[u+d],b=r[u+d+o],y=i[u+d+o],m=l*b-f*y;y=l*y+f*b,b=m,r[u+d]=p+b,i[u+d]=g+y,r[u+d+o]=p-b,i[u+d+o]=g-y,d!==a&&(m=h*l-c*f,f=h*f+c*l,l=m)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),i=1&r,s=0;for(r=r/2|0;r;r>>>=1)s++;return 1<<s+1+i},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var i=0;i<r/2;i++){var s=e[i];e[i]=e[r-i-1],e[r-i-1]=s,s=t[i],t[i]=-t[r-i-1],t[r-i-1]=-s}},m.prototype.normalize13b=function(e,t){for(var r=0,i=0;i<t/2;i++){var s=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+r;e[i]=0x3ffffff&s,r=s<0x4000000?0:s/0x4000000|0}return e},m.prototype.convert13b=function(e,t,i,s){for(var n=0,o=0;o<t;o++)n+=0|e[o],i[2*o]=8191&n,n>>>=13,i[2*o+1]=8191&n,n>>>=13;for(o=2*t;o<s;++o)i[o]=0;r(0===n),r((-8192&n)==0)},m.prototype.stub=function(e){for(var t=Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var i=2*this.guessLen13b(e.length,t.length),s=this.makeRBT(i),n=this.stub(i),o=Array(i),a=Array(i),h=Array(i),c=Array(i),u=Array(i),l=Array(i),f=r.words;f.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,c,i),this.transform(o,n,a,h,i,s),this.transform(c,n,u,l,i,s);for(var d=0;d<i;d++){var p=a[d]*u[d]-h[d]*l[d];h[d]=a[d]*l[d]+h[d]*u[d],a[d]=p}return this.conjugate(a,h,i),this.transform(a,h,f,n,i,s),this.conjugate(f,n,i),this.normalize13b(f,i),r.negative=e.negative^t.negative,r.length=e.length+t.length,r._strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=Array(this.length+e.length),y(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){var t=e<0;t&&(e=-e),r("number"==typeof e),r(e<0x4000000);for(var i=0,s=0;s<this.length;s++){var n=(0|this.words[s])*e,o=(0x3ffffff&n)+(0x3ffffff&i);i>>=26,i+=(n/0x4000000|0)+(o>>>26),this.words[s]=0x3ffffff&o}return 0!==i&&(this.words[s]=i,this.length++),this.length=0===e?1:this.length,t?this.ineg():this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),r=0;r<t.length;r++){var i=r/26|0,s=r%26;t[r]=e.words[i]>>>s&1}return t}(e);if(0===t.length)return new s(1);for(var r=this,i=0;i<t.length&&0===t[i];i++,r=r.sqr());if(++i<t.length)for(var n=r.sqr();i<t.length;i++,n=n.sqr())0!==t[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,s=(e-i)/26,n=0x3ffffff>>>26-i<<26-i;if(0!==i){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&n,h=(0|this.words[t])-a<<i;this.words[t]=h|o,o=a>>>26-i}o&&(this.words[t]=o,this.length++)}if(0!==s){for(t=this.length-1;t>=0;t--)this.words[t+s]=this.words[t];for(t=0;t<s;t++)this.words[t]=0;this.length+=s}return this._strip()},s.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,i){r("number"==typeof e&&e>=0);var s=t?(t-t%26)/26:0,n=e%26,o=Math.min((e-n)/26,this.length),a=0x3ffffff^0x3ffffff>>>n<<n;if(s-=o,s=Math.max(0,s),i){for(var h=0;h<o;h++)i.words[h]=this.words[h];i.length=o}if(0===o);else if(this.length>o)for(this.length-=o,h=0;h<this.length;h++)this.words[h]=this.words[h+o];else this.words[0]=0,this.length=1;var c=0;for(h=this.length-1;h>=0&&(0!==c||h>=s);h--){var u=0|this.words[h];this.words[h]=c<<26-n|u>>>n,c=u&a}return i&&0!==c&&(i.words[i.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return!(this.length<=i)&&!!(this.words[i]&1<<t)},s.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)?this:(0!==t&&i++,this.length=Math.min(i,this.length),0!==t&&(this.words[this.length-1]&=0x3ffffff^0x3ffffff>>>t<<t),this._strip())},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return(r("number"==typeof e),r(e<0x4000000),e<0)?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=0x4000000;t++)this.words[t]-=0x4000000,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(r("number"==typeof e),r(e<0x4000000),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=0x4000000,this.words[t+1]-=1;return this._strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,i){var s,n,o=e.length+i;this._expand(o);var a=0;for(s=0;s<e.length;s++){n=(0|this.words[s+i])+a;var h=(0|e.words[s])*t;n-=0x3ffffff&h,a=(n>>26)-(h/0x4000000|0),this.words[s+i]=0x3ffffff&n}for(;s<this.length-i;s++)a=(n=(0|this.words[s+i])+a)>>26,this.words[s+i]=0x3ffffff&n;if(0===a)return this._strip();for(r(-1===a),a=0,s=0;s<this.length;s++)a=(n=-(0|this.words[s])+a)>>26,this.words[s]=0x3ffffff&n;return this.negative=1,this._strip()},s.prototype._wordDiv=function(e,t){var r,i=this.length-e.length,n=this.clone(),o=e,a=0|o.words[o.length-1];0!=(i=26-this._countBits(a))&&(o=o.ushln(i),n.iushln(i),a=0|o.words[o.length-1]);var h=n.length-o.length;if("mod"!==t){(r=new s(null)).length=h+1,r.words=Array(r.length);for(var c=0;c<r.length;c++)r.words[c]=0}var u=n.clone()._ishlnsubmul(o,1,h);0===u.negative&&(n=u,r&&(r.words[h]=1));for(var l=h-1;l>=0;l--){var f=(0|n.words[o.length+l])*0x4000000+(0|n.words[o.length+l-1]);for(f=Math.min(f/a|0,0x3ffffff),n._ishlnsubmul(o,f,l);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(o,1,l),n.isZero()||(n.negative^=1);r&&(r.words[l]=f)}return r&&r._strip(),n._strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:r||null,mod:n}},s.prototype.divmod=function(e,t,i){var n,o,a;return(r(!e.isZero()),this.isZero())?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(n=a.div.neg()),"div"!==t&&(o=a.mod.neg(),i&&0!==o.negative&&o.iadd(e)),{div:n,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(n=a.div.neg()),{div:n,mod:a.mod}):(this.negative&e.negative)!=0?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),i&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||0>this.cmp(e)?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modrn(e.words[0]))}:this._wordDiv(e,t)},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),s=e.andln(1),n=r.cmp(i);return n<0||1===s&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modrn=function(e){var t=e<0;t&&(e=-e),r(e<=0x3ffffff);for(var i=0x4000000%e,s=0,n=this.length-1;n>=0;n--)s=(i*s+(0|this.words[n]))%e;return t?-s:s},s.prototype.modn=function(e){return this.modrn(e)},s.prototype.idivn=function(e){var t=e<0;t&&(e=-e),r(e<=0x3ffffff);for(var i=0,s=this.length-1;s>=0;s--){var n=(0|this.words[s])+0x4000000*i;this.words[s]=n/e|0,i=n%e}return this._strip(),t?this.ineg():this},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new s(1),o=new s(0),a=new s(0),h=new s(1),c=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++c;for(var u=i.clone(),l=t.clone();!t.isZero();){for(var f=0,d=1;(t.words[0]&d)==0&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(u),o.isub(l)),n.iushrn(1),o.iushrn(1);for(var p=0,g=1;(i.words[0]&g)==0&&p<26;++p,g<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(u),h.isub(l)),a.iushrn(1),h.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(a),o.isub(h)):(i.isub(t),a.isub(n),h.isub(o))}return{a:a,b:h,gcd:i.iushln(c)}},s.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t,i=this,n=e.clone();i=0!==i.negative?i.umod(e):i.clone();for(var o=new s(1),a=new s(0),h=n.clone();i.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,u=1;(i.words[0]&u)==0&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);for(var l=0,f=1;(n.words[0]&f)==0&&l<26;++l,f<<=1);if(l>0)for(n.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);i.cmp(n)>=0?(i.isub(n),o.isub(a)):(n.isub(i),a.isub(o))}return 0>(t=0===i.cmpn(1)?o:a).cmpn(0)&&t.iadd(e),t},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var i=0;t.isEven()&&r.isEven();i++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var s=t.cmp(r);if(s<0){var n=t;t=r,r=n}else if(0===s||0===r.cmpn(1))break;t.isub(r)}return r.iushln(i)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return(1&this.words[0])==0},s.prototype.isOdd=function(){return(1&this.words[0])==1},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,s=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=s,this;for(var n=s,o=i;0!==n&&o<this.length;o++){var a=0|this.words[o];a+=n,n=a>>>26,a&=0x3ffffff,this.words[o]=a}return 0!==n&&(this.words[o]=n,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return -1;if(0===this.negative&&i)return 1;if(this._strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=0x3ffffff,"Number is too big");var s=0|this.words[0];t=s===e?0:s<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],s=0|e.words[r];if(i!==s){i<s?t=-1:i>s&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return -1===this.cmpn(e)},s.prototype.lt=function(e){return -1===this.cmp(e)},s.prototype.lten=function(e){return 0>=this.cmpn(e)},s.prototype.lte=function(e){return 0>=this.cmp(e)},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new S(e)},s.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var v={k256:null,p224:null,p192:null,p25519:null};function w(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function D(){w.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function x(){w.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function E(){w.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function _(){w.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function I(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}w.prototype._tmp=function(){var e=new s(null);return e.words=Array(Math.ceil(this.n/13)),e},w.prototype.ireduce=function(e){var t,r=e;do this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(t>this.n)var i=t<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},w.prototype.split=function(e,t){e.iushrn(this.n,0,t)},w.prototype.imulK=function(e){return e.imul(this.k)},i(D,w),D.prototype.split=function(e,t){for(var r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9){e.words[0]=0,e.length=1;return}var s=e.words[9];for(i=10,t.words[t.length++]=4194303&s;i<e.length;i++){var n=0|e.words[i];e.words[i-10]=(4194303&n)<<4|s>>>22,s=n}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},D.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var i=0|e.words[r];t+=977*i,e.words[r]=0x3ffffff&t,t=64*i+(t/0x4000000|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(x,w),i(E,w),i(_,w),_.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var i=(0|e.words[r])*19+t,s=0x3ffffff&i;i>>>=26,e.words[r]=s,t=i}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){var t;if(v[e])return v[e];if("k256"===e)t=new D;else if("p224"===e)t=new x;else if("p192"===e)t=new E;else if("p25519"===e)t=new _;else throw Error("Unknown prime "+e);return v[e]=t,t},S.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){r((e.negative|t.negative)==0,"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(c(e,e.umod(this.m)._forceRed(this)),e)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},S.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new s(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);r(!n.isZero());var a=new s(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,c).cmp(h);)u.redIAdd(h);for(var l=this.pow(u,n),f=this.pow(e,n.addn(1).iushrn(1)),d=this.pow(e,n),p=o;0!==d.cmp(a);){for(var g=d,b=0;0!==g.cmp(a);b++)g=g.redSqr();r(b<p);var y=this.pow(l,new s(1).iushln(p-b-1));f=f.redMul(y),l=y.redSqr(),d=d.redMul(l),p=b}return f},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var n=r[0],o=0,a=0,h=t.bitLength()%26;for(0===h&&(h=26),i=t.length-1;i>=0;i--){for(var c=t.words[i],u=h-1;u>=0;u--){var l=c>>u&1;if(n!==r[0]&&(n=this.sqr(n)),0===l&&0===o){a=0;continue}o<<=1,o|=l,(4==++a||0===i&&0===u)&&(n=this.mul(n,r[o]),a=0,o=0)}h=26}return n},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new I(e)},i(I,S),I.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},I.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},I.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),n=s;return s.cmp(this.m)>=0?n=s.isub(this.m):0>s.cmpn(0)&&(n=s.iadd(this.m)),n._forceRed(this)},I.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):0>n.cmpn(0)&&(o=n.iadd(this.m)),o._forceRed(this)},I.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}),o("kjyEk",function(e,t){}),o("btcbI",function(t,r){e(t.exports,"inherits",()=>i,e=>i=e),e(t.exports,"toArray",()=>s,e=>s=e),e(t.exports,"toHex",()=>o,e=>o=e),e(t.exports,"htonl",()=>a,e=>a=e),e(t.exports,"toHex32",()=>h,e=>h=e),e(t.exports,"zero2",()=>c,e=>c=e),e(t.exports,"zero8",()=>u,e=>u=e),e(t.exports,"join32",()=>l,e=>l=e),e(t.exports,"split32",()=>f,e=>f=e),e(t.exports,"rotr32",()=>d,e=>d=e),e(t.exports,"rotl32",()=>p,e=>p=e),e(t.exports,"sum32",()=>g,e=>g=e),e(t.exports,"sum32_3",()=>b,e=>b=e),e(t.exports,"sum32_4",()=>y,e=>y=e),e(t.exports,"sum32_5",()=>m,e=>m=e),e(t.exports,"sum64",()=>v,e=>v=e),e(t.exports,"sum64_hi",()=>w,e=>w=e),e(t.exports,"sum64_lo",()=>D,e=>D=e),e(t.exports,"sum64_4_hi",()=>x,e=>x=e),e(t.exports,"sum64_4_lo",()=>E,e=>E=e),e(t.exports,"sum64_5_hi",()=>_,e=>_=e),e(t.exports,"sum64_5_lo",()=>S,e=>S=e),e(t.exports,"rotr64_hi",()=>I,e=>I=e),e(t.exports,"rotr64_lo",()=>A,e=>A=e),e(t.exports,"shr64_hi",()=>M,e=>M=e),e(t.exports,"shr64_lo",()=>O,e=>O=e);var i,s,o,a,h,c,u,l,f,d,p,g,b,y,m,v,w,D,x,E,_,S,I,A,M,O,C=n("koC21");function P(e){return(e>>>24|e>>>8&65280|e<<8&0xff0000|(255&e)<<24)>>>0}function R(e){return 1===e.length?"0"+e:e}function T(e){if(7===e.length)return"0"+e;if(6===e.length)return"00"+e;if(5===e.length)return"000"+e;if(4===e.length)return"0000"+e;if(3===e.length)return"00000"+e;else if(2===e.length)return"000000"+e;else if(1===e.length)return"0000000"+e;else return e}i=n("dlqwk"),s=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e),s=0;s<e.length;s+=2)r.push(parseInt(e[s]+e[s+1],16))}else for(var i=0,s=0;s<e.length;s++){var n,o,a=e.charCodeAt(s);a<128?r[i++]=a:(a<2048?r[i++]=a>>6|192:((n=e,o=s,(64512&n.charCodeAt(o))!=55296||o<0||o+1>=n.length?1:(64512&n.charCodeAt(o+1))!=56320)?r[i++]=a>>12|224:(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++s)),r[i++]=a>>18|240,r[i++]=a>>12&63|128),r[i++]=a>>6&63|128),r[i++]=63&a|128)}else for(s=0;s<e.length;s++)r[s]=0|e[s];return r},o=function(e){for(var t="",r=0;r<e.length;r++)t+=R(e[r].toString(16));return t},a=P,h=function(e,t){for(var r="",i=0;i<e.length;i++){var s=e[i];"little"===t&&(s=P(s)),r+=T(s.toString(16))}return r},c=R,u=T,l=function(e,t,r,i){var s,n=r-t;C(n%4==0);for(var o=Array(n/4),a=0,h=t;a<o.length;a++,h+=4)s="big"===i?e[h]<<24|e[h+1]<<16|e[h+2]<<8|e[h+3]:e[h+3]<<24|e[h+2]<<16|e[h+1]<<8|e[h],o[a]=s>>>0;return o},f=function(e,t){for(var r=Array(4*e.length),i=0,s=0;i<e.length;i++,s+=4){var n=e[i];"big"===t?(r[s]=n>>>24,r[s+1]=n>>>16&255,r[s+2]=n>>>8&255,r[s+3]=255&n):(r[s+3]=n>>>24,r[s+2]=n>>>16&255,r[s+1]=n>>>8&255,r[s]=255&n)}return r},d=function(e,t){return e>>>t|e<<32-t},p=function(e,t){return e<<t|e>>>32-t},g=function(e,t){return e+t>>>0},b=function(e,t,r){return e+t+r>>>0},y=function(e,t,r,i){return e+t+r+i>>>0},m=function(e,t,r,i,s){return e+t+r+i+s>>>0},v=function(e,t,r,i){var s=e[t],n=i+e[t+1]>>>0;e[t]=+(n<i)+r+s>>>0,e[t+1]=n},w=function(e,t,r,i){return+(t+i>>>0<t)+e+r>>>0},D=function(e,t,r,i){return t+i>>>0},x=function(e,t,r,i,s,n,o,a){var h,c=t;return e+r+s+o+(h=0+ +((c=c+i>>>0)<t)+ +((c=c+n>>>0)<n)+ +((c=c+a>>>0)<a))>>>0},E=function(e,t,r,i,s,n,o,a){return t+i+n+a>>>0},_=function(e,t,r,i,s,n,o,a,h,c){var u,l=t;return e+r+s+o+h+(u=0+ +((l=l+i>>>0)<t)+ +((l=l+n>>>0)<n)+ +((l=l+a>>>0)<a)+ +((l=l+c>>>0)<c))>>>0},S=function(e,t,r,i,s,n,o,a,h,c){return t+i+n+a+c>>>0},I=function(e,t,r){return(t<<32-r|e>>>r)>>>0},A=function(e,t,r){return(e<<32-r|t>>>r)>>>0},M=function(e,t,r){return e>>>r},O=function(e,t,r){return(e<<32-r|t>>>r)>>>0}}),o("koC21",function(e,t){function r(e,t){if(!e)throw Error(t||"Assertion failed")}e.exports=r,r.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)}}),o("dlqwk",function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}}),o("aAb7n",function(t,r){e(t.exports,"BlockHash",()=>i,e=>i=e);var i,s=n("btcbI"),o=n("koC21");function a(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i=a,a.prototype.update=function(e,t){if(e=s.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=s.join32(e,0,e.length-r,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this},a.prototype.digest=function(e){return this.update(this._pad()),o(null===this.pending),this._digest(e)},a.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,i=Array(r+this.padLength);i[0]=128;for(var s=1;s<r;s++)i[s]=0;if(e<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=e>>>24&255,i[s++]=e>>>16&255,i[s++]=e>>>8&255,i[s++]=255&e}else for(n=8,i[s++]=255&e,i[s++]=e>>>8&255,i[s++]=e>>>16&255,i[s++]=e>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0;n<this.padLength;n++)i[s++]=0;return i}}),o("2wnQk",function(t,r){var i,s,o,a,h;e(t.exports,"sha1",()=>i,e=>i=e),e(t.exports,"sha224",()=>s,e=>s=e),e(t.exports,"sha256",()=>o,e=>o=e),e(t.exports,"sha384",()=>a,e=>a=e),e(t.exports,"sha512",()=>h,e=>h=e),i=n("IUW6G"),s=n("gBE2w"),o=n("a9EzX"),a=n("7j4cV"),h=n("lMBCM")}),o("IUW6G",function(e,t){var r=n("btcbI"),i=n("aAb7n"),s=n("dV8oa"),o=r.rotl32,a=r.sum32,h=r.sum32_5,c=s.ft_1,u=i.BlockHash,l=[0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xca62c1d6];function f(){if(!(this instanceof f))return new f;u.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.W=Array(80)}r.inherits(f,u),e.exports=f,f.blockSize=512,f.outSize=160,f.hmacStrength=80,f.padLength=64,f.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=o(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var s=this.h[0],n=this.h[1],u=this.h[2],f=this.h[3],d=this.h[4];for(i=0;i<r.length;i++){var p=~~(i/20),g=h(o(s,5),c(p,n,u,f),d,r[i],l[p]);d=f,f=u,u=o(n,30),n=s,s=g}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],u),this.h[3]=a(this.h[3],f),this.h[4]=a(this.h[4],d)},f.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}),o("dV8oa",function(t,r){e(t.exports,"ft_1",()=>i,e=>i=e),e(t.exports,"ch32",()=>s,e=>s=e),e(t.exports,"maj32",()=>o,e=>o=e),e(t.exports,"s0_256",()=>a,e=>a=e),e(t.exports,"s1_256",()=>h,e=>h=e),e(t.exports,"g0_256",()=>c,e=>c=e),e(t.exports,"g1_256",()=>u,e=>u=e);var i,s,o,a,h,c,u,l=n("btcbI").rotr32;function f(e,t,r){return e&t^e&r^t&r}i=function(e,t,r,i){var s;return 0===e?(s=t)&r^~s&i:1===e||3===e?t^r^i:2===e?f(t,r,i):void 0},s=function(e,t,r){return e&t^~e&r},o=f,a=function(e){return l(e,2)^l(e,13)^l(e,22)},h=function(e){return l(e,6)^l(e,11)^l(e,25)},c=function(e){return l(e,7)^l(e,18)^e>>>3},u=function(e){return l(e,17)^l(e,19)^e>>>10}}),o("gBE2w",function(e,t){var r=n("btcbI"),i=n("a9EzX");function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]}r.inherits(s,i),e.exports=s,s.blockSize=512,s.outSize=224,s.hmacStrength=192,s.padLength=64,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}}),o("a9EzX",function(e,t){var r=n("btcbI"),i=n("aAb7n"),s=n("dV8oa"),o=n("koC21"),a=r.sum32,h=r.sum32_4,c=r.sum32_5,u=s.ch32,l=s.maj32,f=s.s0_256,d=s.s1_256,p=s.g0_256,g=s.g1_256,b=i.BlockHash,y=[0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2];function m(){if(!(this instanceof m))return new m;b.call(this),this.h=[0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19],this.k=y,this.W=Array(64)}r.inherits(m,b),e.exports=m,m.blockSize=512,m.outSize=256,m.hmacStrength=192,m.padLength=64,m.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=h(g(r[i-2]),r[i-7],p(r[i-15]),r[i-16]);var s=this.h[0],n=this.h[1],b=this.h[2],y=this.h[3],m=this.h[4],v=this.h[5],w=this.h[6],D=this.h[7];for(o(this.k.length===r.length),i=0;i<r.length;i++){var x=c(D,d(m),u(m,v,w),this.k[i],r[i]),E=a(f(s),l(s,n,b));D=w,w=v,v=m,m=a(y,x),y=b,b=n,n=s,s=a(x,E)}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],b),this.h[3]=a(this.h[3],y),this.h[4]=a(this.h[4],m),this.h[5]=a(this.h[5],v),this.h[6]=a(this.h[6],w),this.h[7]=a(this.h[7],D)},m.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}),o("7j4cV",function(e,t){var r=n("btcbI"),i=n("lMBCM");function s(){if(!(this instanceof s))return new s;i.call(this),this.h=[0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]}r.inherits(s,i),e.exports=s,s.blockSize=1024,s.outSize=384,s.hmacStrength=192,s.padLength=128,s.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}}),o("lMBCM",function(e,t){var r=n("btcbI"),i=n("aAb7n"),s=n("koC21"),o=r.rotr64_hi,a=r.rotr64_lo,h=r.shr64_hi,c=r.shr64_lo,u=r.sum64,l=r.sum64_hi,f=r.sum64_lo,d=r.sum64_4_hi,p=r.sum64_4_lo,g=r.sum64_5_hi,b=r.sum64_5_lo,y=i.BlockHash,m=[0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817];function v(){if(!(this instanceof v))return new v;y.call(this),this.h=[0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179],this.k=m,this.W=Array(160)}r.inherits(v,y),e.exports=v,v.blockSize=1024,v.outSize=512,v.hmacStrength=192,v.padLength=128,v.prototype._prepareBlock=function(e,t){for(var r=this.W,i=0;i<32;i++)r[i]=e[t+i];for(;i<r.length;i+=2){var s=function(e,t){var r=o(e,t,19)^o(t,e,29)^h(e,t,6);return r<0&&(r+=0x100000000),r}(r[i-4],r[i-3]),n=function(e,t){var r=a(e,t,19)^a(t,e,29)^c(e,t,6);return r<0&&(r+=0x100000000),r}(r[i-4],r[i-3]),u=r[i-14],l=r[i-13],f=function(e,t){var r=o(e,t,1)^o(e,t,8)^h(e,t,7);return r<0&&(r+=0x100000000),r}(r[i-30],r[i-29]),g=function(e,t){var r=a(e,t,1)^a(e,t,8)^c(e,t,7);return r<0&&(r+=0x100000000),r}(r[i-30],r[i-29]),b=r[i-32],y=r[i-31];r[i]=d(s,n,u,l,f,g,b,y),r[i+1]=p(s,n,u,l,f,g,b,y)}},v.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,i=this.h[0],n=this.h[1],h=this.h[2],c=this.h[3],d=this.h[4],p=this.h[5],y=this.h[6],m=this.h[7],v=this.h[8],w=this.h[9],D=this.h[10],x=this.h[11],E=this.h[12],_=this.h[13],S=this.h[14],I=this.h[15];s(this.k.length===r.length);for(var A=0;A<r.length;A+=2){var M=S,O=I,C=function(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=0x100000000),r}(v,w),P=function(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=0x100000000),r}(v,w),R=function(e,t,r,i,s){var n=e&r^~e&s;return n<0&&(n+=0x100000000),n}(v,0,D,0,E,_),T=function(e,t,r,i,s,n){var o=t&i^~t&n;return o<0&&(o+=0x100000000),o}(0,w,0,x,0,_),N=this.k[A],B=this.k[A+1],L=r[A],U=r[A+1],k=g(M,O,C,P,R,T,N,B,L,U),q=b(M,O,C,P,R,T,N,B,L,U);M=function(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=0x100000000),r}(i,n),O=function(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=0x100000000),r}(i,n);var j=l(M,O,C=function(e,t,r,i,s){var n=e&r^e&s^r&s;return n<0&&(n+=0x100000000),n}(i,0,h,0,d,p),P=function(e,t,r,i,s,n){var o=t&i^t&n^i&n;return o<0&&(o+=0x100000000),o}(0,n,0,c,0,p)),z=f(M,O,C,P);S=E,I=_,E=D,_=x,D=v,x=w,v=l(y,m,k,q),w=f(m,m,k,q),y=d,m=p,d=h,p=c,h=i,c=n,i=l(k,q,j,z),n=f(k,q,j,z)}u(this.h,0,i,n),u(this.h,2,h,c),u(this.h,4,d,p),u(this.h,6,y,m),u(this.h,8,v,w),u(this.h,10,D,x),u(this.h,12,E,_),u(this.h,14,S,I)},v.prototype._digest=function(e){return"hex"===e?r.toHex32(this.h,"big"):r.split32(this.h,"big")}}),o("05eZB",function(t,r){e(t.exports,"ripemd160",()=>i,e=>i=e);var i,s=n("btcbI"),o=n("aAb7n"),a=s.rotl32,h=s.sum32,c=s.sum32_3,u=s.sum32_4,l=o.BlockHash;function f(){if(!(this instanceof f))return new f;l.call(this),this.h=[0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0],this.endian="little"}function d(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}s.inherits(f,l),i=f,f.blockSize=512,f.outSize=160,f.hmacStrength=192,f.padLength=64,f.prototype._update=function(e,t){for(var r=this.h[0],i=this.h[1],s=this.h[2],n=this.h[3],o=this.h[4],l=r,f=i,m=s,v=n,w=o,D=0;D<80;D++){var x,E,_=h(a(u(r,d(D,i,s,n),e[p[D]+t],(x=D)<=15?0:x<=31?0x5a827999:x<=47?0x6ed9eba1:x<=63?0x8f1bbcdc:0xa953fd4e),b[D]),o);r=o,o=n,n=a(s,10),s=i,i=_,_=h(a(u(l,d(79-D,f,m,v),e[g[D]+t],(E=D)<=15?0x50a28be6:E<=31?0x5c4dd124:E<=47?0x6d703ef3:0x7a6d76e9*!!(E<=63)),y[D]),w),l=w,w=v,v=a(m,10),m=f,f=_}_=c(this.h[1],s,v),this.h[1]=c(this.h[2],n,w),this.h[2]=c(this.h[3],o,l),this.h[3]=c(this.h[4],r,f),this.h[4]=c(this.h[0],i,m),this.h[0]=_},f.prototype._digest=function(e){return"hex"===e?s.toHex32(this.h,"little"):s.split32(this.h,"little")};var p=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],y=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]}),o("ap2lu",function(e,t){var r=n("btcbI"),i=n("koC21");function s(e,t,i){if(!(this instanceof s))return new s(e,t,i);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(t,i))}e.exports=s,s.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),i(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(t=0,this.inner=new this.Hash().update(e);t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},s.prototype.update=function(e,t){return this.inner.update(e,t),this},s.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}}),o("laOt8",function(t,r){function i(e,t){return t=t||{},new Promise(function(r,i){var s=new XMLHttpRequest,n=[],o=[],a={},h=function(){return{ok:2==(s.status/100|0),statusText:s.statusText,status:s.status,url:s.responseURL,text:function(){return Promise.resolve(s.responseText)},json:function(){return Promise.resolve(s.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([s.response]))},clone:h,headers:{keys:function(){return n},entries:function(){return o},get:function(e){return a[e.toLowerCase()]},has:function(e){return e.toLowerCase()in a}}}};for(var c in s.open(t.method||"get",e,!0),s.onload=function(){s.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(e,t,r){n.push(t=t.toLowerCase()),o.push([t,r]),a[t]=a[t]?a[t]+","+r:r}),r(h())},s.onerror=i,s.withCredentials="include"==t.credentials,t.headers)s.setRequestHeader(c,t.headers[c]);s.send(t.body||null)})}Object.defineProperty(t.exports,"__esModule",{value:!0,configurable:!0}),e(t.exports,"default",()=>i)}),o("5Jl2z",function(e,t){e.exports=JSON.parse('{"name":"elliptic","version":"6.5.7","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}')}),o("85hQD",function(e,t){var r=e.exports,i=n("eSnEe"),s=n("koC21"),o=n("lC4vN");r.assert=s,r.toArray=o.toArray,r.zero2=o.zero2,r.toHex=o.toHex,r.encode=o.encode,r.getNAF=function(e,t,r){var i=Array(Math.max(e.bitLength(),r)+1);for(o=0;o<i.length;o+=1)i[o]=0;var s=1<<t+1,n=e.clone();for(o=0;o<i.length;o++){var o,a,h=n.andln(s-1);n.isOdd()?(a=h>(s>>1)-1?(s>>1)-h:h,n.isubn(a)):a=0,i[o]=a,n.iushrn(1)}return i},r.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var n,o,a,h=e.andln(3)+i&3,c=t.andln(3)+s&3;3===h&&(h=-1),3===c&&(c=-1),o=(1&h)==0?0:(3==(n=e.andln(7)+i&7)||5===n)&&2===c?-h:h,r[0].push(o),a=(1&c)==0?0:(3==(n=t.andln(7)+s&7)||5===n)&&2===h?-c:c,r[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},r.cachedProperty=function(e,t,r){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},r.parseBytes=function(e){return"string"==typeof e?r.toArray(e,"hex"):e},r.intFromLE=function(e){return new i(e,"hex","le")}}),o("eSnEe",function(e,t){!function(e,t){function r(e,t){if(!e)throw Error(t||"Assertion failed")}function i(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function s(e,t,r){if(s.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof e?e.exports=s:t.BN=s,s.BN=s,s.wordSize=26;try{c="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:n("kjyEk").Buffer}catch(e){}function o(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function a(e,t,r){var i=o(e,r);return r-1>=t&&(i|=o(e,r-1)<<4),i}function h(e,t,r,i){for(var s=0,n=Math.min(e.length,r),o=t;o<n;o++){var a=e.charCodeAt(o)-48;s*=i,a>=49?s+=a-49+10:a>=17?s+=a-17+10:s+=a}return s}s.isBN=function(e){return e instanceof s||null!==e&&"object"==typeof e&&e.constructor.wordSize===s.wordSize&&Array.isArray(e.words)},s.max=function(e,t){return e.cmp(t)>0?e:t},s.min=function(e,t){return 0>e.cmp(t)?e:t},s.prototype._init=function(e,t,i){if("number"==typeof e)return this._initNumber(e,t,i);if("object"==typeof e)return this._initArray(e,t,i);"hex"===t&&(t=16),r(t===(0|t)&&t>=2&&t<=36);var s=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(s++,this.negative=1),s<e.length&&(16===t?this._parseHex(e,s,i):(this._parseBase(e,t,s),"le"===i&&this._initArray(this.toArray(),t,i)))},s.prototype._initNumber=function(e,t,i){e<0&&(this.negative=1,e=-e),e<0x4000000?(this.words=[0x3ffffff&e],this.length=1):e<0x10000000000000?(this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff],this.length=2):(r(e<0x20000000000000),this.words=[0x3ffffff&e,e/0x4000000&0x3ffffff,1],this.length=3),"le"===i&&this._initArray(this.toArray(),t,i)},s.prototype._initArray=function(e,t,i){if(r("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var s,n,o=0;o<this.length;o++)this.words[o]=0;var a=0;if("be"===i)for(o=e.length-1,s=0;o>=0;o-=3)n=e[o]|e[o-1]<<8|e[o-2]<<16,this.words[s]|=n<<a&0x3ffffff,this.words[s+1]=n>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);else if("le"===i)for(o=0,s=0;o<e.length;o+=3)n=e[o]|e[o+1]<<8|e[o+2]<<16,this.words[s]|=n<<a&0x3ffffff,this.words[s+1]=n>>>26-a&0x3ffffff,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var i,s=0;s<this.length;s++)this.words[s]=0;var n=0,o=0;if("be"===r)for(s=e.length-1;s>=t;s-=2)i=a(e,t,s)<<n,this.words[o]|=0x3ffffff&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;else for(s=(e.length-t)%2==0?t+1:t;s<e.length;s+=2)i=a(e,t,s)<<n,this.words[o]|=0x3ffffff&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;this.strip()},s.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var i=0,s=1;s<=0x3ffffff;s*=t)i++;i--,s=s/t|0;for(var n=e.length-r,o=n%i,a=Math.min(n,n-o)+r,c=0,u=r;u<a;u+=i)c=h(e,u,u+i,t),this.imuln(s),this.words[0]+c<0x4000000?this.words[0]+=c:this._iaddn(c);if(0!==o){var l=1;for(c=h(e,u,e.length,t),u=0;u<o;u++)l*=t;this.imuln(l),this.words[0]+c<0x4000000?this.words[0]+=c:this._iaddn(c)}this.strip()},s.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},s.prototype.clone=function(){var e=new s(null);return this.copy(e),e},s.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c,u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],f=[0,0,0x2000000,0x290d741,0x1000000,0x2e90edd,0x39aa400,0x267bf47,0x1000000,0x290d741,1e7,0x12959c3,0x222c000,0x3bd7765,7529536,0xadcea1,0x1000000,0x1704f61,0x206fc40,0x2cddcf9,64e6,4084101,5153632,6436343,7962624,9765625,0xb54ba0,0xdaf26b,0x1069c00,0x138f9ad,243e5,0x1b4d89f,0x2000000,0x25528a1,0x2b54a20,0x3216b93,0x39aa400];function d(e,t,r){r.negative=t.negative^e.negative;var i=e.length+t.length|0;r.length=i,i=i-1|0;var s=0|e.words[0],n=0|t.words[0],o=s*n,a=0x3ffffff&o,h=o/0x4000000|0;r.words[0]=a;for(var c=1;c<i;c++){for(var u=h>>>26,l=0x3ffffff&h,f=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=f;d++){var p=c-d|0;u+=(o=(s=0|e.words[p])*(n=0|t.words[d])+l)/0x4000000|0,l=0x3ffffff&o}r.words[c]=0|l,h=0|u}return 0!==h?r.words[c]=0|h:r.length--,r.strip()}s.prototype.toString=function(e,t){if(t=0|t||1,16===(e=e||10)||"hex"===e){for(var i="",s=0,n=0,o=0;o<this.length;o++){var a=this.words[o],h=((a<<s|n)&0xffffff).toString(16);n=a>>>24-s&0xffffff,(s+=2)>=26&&(s-=26,o--),i=0!==n||o!==this.length-1?u[6-h.length]+h+i:h+i}for(0!==n&&(i=n.toString(16)+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(e===(0|e)&&e>=2&&e<=36){var c=l[e],d=f[e];i="";var p=this.clone();for(p.negative=0;!p.isZero();){var g=p.modn(d).toString(e);i=(p=p.idivn(d)).isZero()?g+i:u[c-g.length]+g+i}for(this.isZero()&&(i="0"+i);i.length%t!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}r(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=0x4000000*this.words[1]:3===this.length&&1===this.words[2]?e+=0x10000000000000+0x4000000*this.words[1]:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(e,t){return r(void 0!==c),this.toArrayLike(c,e,t)},s.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},s.prototype.toArrayLike=function(e,t,i){var s,n,o=this.byteLength(),a=i||Math.max(1,o);r(o<=a,"byte array longer than desired length"),r(a>0,"Requested array length <= 0"),this.strip();var h=new e(a),c=this.clone();if("le"===t){for(n=0;!c.isZero();n++)s=c.andln(255),c.iushrn(8),h[n]=s;for(;n<a;n++)h[n]=0}else{for(n=0;n<a-o;n++)h[n]=0;for(n=0;!c.isZero();n++)s=c.andln(255),c.iushrn(8),h[a-n-1]=s}return h},Math.clz32?s.prototype._countBits=function(e){return 32-Math.clz32(e)}:s.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},s.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return(8191&t)==0&&(r+=13,t>>>=13),(127&t)==0&&(r+=7,t>>>=7),(15&t)==0&&(r+=4,t>>>=4),(3&t)==0&&(r+=2,t>>>=2),(1&t)==0&&r++,r},s.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return(this.length-1)*26+t},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},s.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},s.prototype.ior=function(e){return r((this.negative|e.negative)==0),this.iuor(e)},s.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},s.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},s.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},s.prototype.iand=function(e){return r((this.negative|e.negative)==0),this.iuand(e)},s.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},s.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},s.prototype.iuxor=function(e){this.length>e.length?(t=this,r=e):(t=e,r=this);for(var t,r,i=0;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this.strip()},s.prototype.ixor=function(e){return r((this.negative|e.negative)==0),this.iuxor(e)},s.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},s.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},s.prototype.inotn=function(e){r("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),i=e%26;this._expand(t),i>0&&t--;for(var s=0;s<t;s++)this.words[s]=0x3ffffff&~this.words[s];return i>0&&(this.words[s]=~this.words[s]&0x3ffffff>>26-i),this.strip()},s.prototype.notn=function(e){return this.clone().inotn(e)},s.prototype.setn=function(e,t){r("number"==typeof e&&e>=0);var i=e/26|0,s=e%26;return this._expand(i+1),t?this.words[i]=this.words[i]|1<<s:this.words[i]=this.words[i]&~(1<<s),this.strip()},s.prototype.iadd=function(e){if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,i=e):(r=e,i=this);for(var t,r,i,s=0,n=0;n<i.length;n++)t=(0|r.words[n])+(0|i.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;for(;0!==s&&n<r.length;n++)t=(0|r.words[n])+s,this.words[n]=0x3ffffff&t,s=t>>>26;if(this.length=r.length,0!==s)this.words[this.length]=s,this.length++;else if(r!==this)for(;n<r.length;n++)this.words[n]=r.words[n];return this},s.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},s.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t,r,i=this.iadd(e);return e.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s=this.cmp(e);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(t=this,r=e):(t=e,r=this);for(var n=0,o=0;o<r.length;o++)n=(i=(0|t.words[o])-(0|r.words[o])+n)>>26,this.words[o]=0x3ffffff&i;for(;0!==n&&o<t.length;o++)n=(i=(0|t.words[o])+n)>>26,this.words[o]=0x3ffffff&i;if(0===n&&o<t.length&&t!==this)for(;o<t.length;o++)this.words[o]=t.words[o];return this.length=Math.max(this.length,o),t!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,r){var i,s,n,o=e.words,a=t.words,h=r.words,c=0,u=0|o[0],l=8191&u,f=u>>>13,d=0|o[1],p=8191&d,g=d>>>13,b=0|o[2],y=8191&b,m=b>>>13,v=0|o[3],w=8191&v,D=v>>>13,x=0|o[4],E=8191&x,_=x>>>13,S=0|o[5],I=8191&S,A=S>>>13,M=0|o[6],O=8191&M,C=M>>>13,P=0|o[7],R=8191&P,T=P>>>13,N=0|o[8],B=8191&N,L=N>>>13,U=0|o[9],k=8191&U,q=U>>>13,j=0|a[0],z=8191&j,F=j>>>13,$=0|a[1],K=8191&$,V=$>>>13,H=0|a[2],G=8191&H,W=H>>>13,Y=0|a[3],J=8191&Y,Z=Y>>>13,X=0|a[4],Q=8191&X,ee=X>>>13,et=0|a[5],er=8191&et,ei=et>>>13,es=0|a[6],en=8191&es,eo=es>>>13,ea=0|a[7],eh=8191&ea,ec=ea>>>13,eu=0|a[8],el=8191&eu,ef=eu>>>13,ed=0|a[9],ep=8191&ed,eg=ed>>>13;r.negative=e.negative^t.negative,r.length=19,i=Math.imul(l,z);var eb=(c+i|0)+((8191&(s=(s=Math.imul(l,F))+Math.imul(f,z)|0))<<13)|0;c=((n=Math.imul(f,F))+(s>>>13)|0)+(eb>>>26)|0,eb&=0x3ffffff,i=Math.imul(p,z),s=(s=Math.imul(p,F))+Math.imul(g,z)|0,n=Math.imul(g,F),i=i+Math.imul(l,K)|0;var ey=(c+i|0)+((8191&(s=(s=s+Math.imul(l,V)|0)+Math.imul(f,K)|0))<<13)|0;c=((n=n+Math.imul(f,V)|0)+(s>>>13)|0)+(ey>>>26)|0,ey&=0x3ffffff,i=Math.imul(y,z),s=(s=Math.imul(y,F))+Math.imul(m,z)|0,n=Math.imul(m,F),i=i+Math.imul(p,K)|0,s=(s=s+Math.imul(p,V)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,V)|0,i=i+Math.imul(l,G)|0;var em=(c+i|0)+((8191&(s=(s=s+Math.imul(l,W)|0)+Math.imul(f,G)|0))<<13)|0;c=((n=n+Math.imul(f,W)|0)+(s>>>13)|0)+(em>>>26)|0,em&=0x3ffffff,i=Math.imul(w,z),s=(s=Math.imul(w,F))+Math.imul(D,z)|0,n=Math.imul(D,F),i=i+Math.imul(y,K)|0,s=(s=s+Math.imul(y,V)|0)+Math.imul(m,K)|0,n=n+Math.imul(m,V)|0,i=i+Math.imul(p,G)|0,s=(s=s+Math.imul(p,W)|0)+Math.imul(g,G)|0,n=n+Math.imul(g,W)|0,i=i+Math.imul(l,J)|0;var ev=(c+i|0)+((8191&(s=(s=s+Math.imul(l,Z)|0)+Math.imul(f,J)|0))<<13)|0;c=((n=n+Math.imul(f,Z)|0)+(s>>>13)|0)+(ev>>>26)|0,ev&=0x3ffffff,i=Math.imul(E,z),s=(s=Math.imul(E,F))+Math.imul(_,z)|0,n=Math.imul(_,F),i=i+Math.imul(w,K)|0,s=(s=s+Math.imul(w,V)|0)+Math.imul(D,K)|0,n=n+Math.imul(D,V)|0,i=i+Math.imul(y,G)|0,s=(s=s+Math.imul(y,W)|0)+Math.imul(m,G)|0,n=n+Math.imul(m,W)|0,i=i+Math.imul(p,J)|0,s=(s=s+Math.imul(p,Z)|0)+Math.imul(g,J)|0,n=n+Math.imul(g,Z)|0,i=i+Math.imul(l,Q)|0;var ew=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ee)|0)+Math.imul(f,Q)|0))<<13)|0;c=((n=n+Math.imul(f,ee)|0)+(s>>>13)|0)+(ew>>>26)|0,ew&=0x3ffffff,i=Math.imul(I,z),s=(s=Math.imul(I,F))+Math.imul(A,z)|0,n=Math.imul(A,F),i=i+Math.imul(E,K)|0,s=(s=s+Math.imul(E,V)|0)+Math.imul(_,K)|0,n=n+Math.imul(_,V)|0,i=i+Math.imul(w,G)|0,s=(s=s+Math.imul(w,W)|0)+Math.imul(D,G)|0,n=n+Math.imul(D,W)|0,i=i+Math.imul(y,J)|0,s=(s=s+Math.imul(y,Z)|0)+Math.imul(m,J)|0,n=n+Math.imul(m,Z)|0,i=i+Math.imul(p,Q)|0,s=(s=s+Math.imul(p,ee)|0)+Math.imul(g,Q)|0,n=n+Math.imul(g,ee)|0,i=i+Math.imul(l,er)|0;var eD=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ei)|0)+Math.imul(f,er)|0))<<13)|0;c=((n=n+Math.imul(f,ei)|0)+(s>>>13)|0)+(eD>>>26)|0,eD&=0x3ffffff,i=Math.imul(O,z),s=(s=Math.imul(O,F))+Math.imul(C,z)|0,n=Math.imul(C,F),i=i+Math.imul(I,K)|0,s=(s=s+Math.imul(I,V)|0)+Math.imul(A,K)|0,n=n+Math.imul(A,V)|0,i=i+Math.imul(E,G)|0,s=(s=s+Math.imul(E,W)|0)+Math.imul(_,G)|0,n=n+Math.imul(_,W)|0,i=i+Math.imul(w,J)|0,s=(s=s+Math.imul(w,Z)|0)+Math.imul(D,J)|0,n=n+Math.imul(D,Z)|0,i=i+Math.imul(y,Q)|0,s=(s=s+Math.imul(y,ee)|0)+Math.imul(m,Q)|0,n=n+Math.imul(m,ee)|0,i=i+Math.imul(p,er)|0,s=(s=s+Math.imul(p,ei)|0)+Math.imul(g,er)|0,n=n+Math.imul(g,ei)|0,i=i+Math.imul(l,en)|0;var ex=(c+i|0)+((8191&(s=(s=s+Math.imul(l,eo)|0)+Math.imul(f,en)|0))<<13)|0;c=((n=n+Math.imul(f,eo)|0)+(s>>>13)|0)+(ex>>>26)|0,ex&=0x3ffffff,i=Math.imul(R,z),s=(s=Math.imul(R,F))+Math.imul(T,z)|0,n=Math.imul(T,F),i=i+Math.imul(O,K)|0,s=(s=s+Math.imul(O,V)|0)+Math.imul(C,K)|0,n=n+Math.imul(C,V)|0,i=i+Math.imul(I,G)|0,s=(s=s+Math.imul(I,W)|0)+Math.imul(A,G)|0,n=n+Math.imul(A,W)|0,i=i+Math.imul(E,J)|0,s=(s=s+Math.imul(E,Z)|0)+Math.imul(_,J)|0,n=n+Math.imul(_,Z)|0,i=i+Math.imul(w,Q)|0,s=(s=s+Math.imul(w,ee)|0)+Math.imul(D,Q)|0,n=n+Math.imul(D,ee)|0,i=i+Math.imul(y,er)|0,s=(s=s+Math.imul(y,ei)|0)+Math.imul(m,er)|0,n=n+Math.imul(m,ei)|0,i=i+Math.imul(p,en)|0,s=(s=s+Math.imul(p,eo)|0)+Math.imul(g,en)|0,n=n+Math.imul(g,eo)|0,i=i+Math.imul(l,eh)|0;var eE=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ec)|0)+Math.imul(f,eh)|0))<<13)|0;c=((n=n+Math.imul(f,ec)|0)+(s>>>13)|0)+(eE>>>26)|0,eE&=0x3ffffff,i=Math.imul(B,z),s=(s=Math.imul(B,F))+Math.imul(L,z)|0,n=Math.imul(L,F),i=i+Math.imul(R,K)|0,s=(s=s+Math.imul(R,V)|0)+Math.imul(T,K)|0,n=n+Math.imul(T,V)|0,i=i+Math.imul(O,G)|0,s=(s=s+Math.imul(O,W)|0)+Math.imul(C,G)|0,n=n+Math.imul(C,W)|0,i=i+Math.imul(I,J)|0,s=(s=s+Math.imul(I,Z)|0)+Math.imul(A,J)|0,n=n+Math.imul(A,Z)|0,i=i+Math.imul(E,Q)|0,s=(s=s+Math.imul(E,ee)|0)+Math.imul(_,Q)|0,n=n+Math.imul(_,ee)|0,i=i+Math.imul(w,er)|0,s=(s=s+Math.imul(w,ei)|0)+Math.imul(D,er)|0,n=n+Math.imul(D,ei)|0,i=i+Math.imul(y,en)|0,s=(s=s+Math.imul(y,eo)|0)+Math.imul(m,en)|0,n=n+Math.imul(m,eo)|0,i=i+Math.imul(p,eh)|0,s=(s=s+Math.imul(p,ec)|0)+Math.imul(g,eh)|0,n=n+Math.imul(g,ec)|0,i=i+Math.imul(l,el)|0;var e_=(c+i|0)+((8191&(s=(s=s+Math.imul(l,ef)|0)+Math.imul(f,el)|0))<<13)|0;c=((n=n+Math.imul(f,ef)|0)+(s>>>13)|0)+(e_>>>26)|0,e_&=0x3ffffff,i=Math.imul(k,z),s=(s=Math.imul(k,F))+Math.imul(q,z)|0,n=Math.imul(q,F),i=i+Math.imul(B,K)|0,s=(s=s+Math.imul(B,V)|0)+Math.imul(L,K)|0,n=n+Math.imul(L,V)|0,i=i+Math.imul(R,G)|0,s=(s=s+Math.imul(R,W)|0)+Math.imul(T,G)|0,n=n+Math.imul(T,W)|0,i=i+Math.imul(O,J)|0,s=(s=s+Math.imul(O,Z)|0)+Math.imul(C,J)|0,n=n+Math.imul(C,Z)|0,i=i+Math.imul(I,Q)|0,s=(s=s+Math.imul(I,ee)|0)+Math.imul(A,Q)|0,n=n+Math.imul(A,ee)|0,i=i+Math.imul(E,er)|0,s=(s=s+Math.imul(E,ei)|0)+Math.imul(_,er)|0,n=n+Math.imul(_,ei)|0,i=i+Math.imul(w,en)|0,s=(s=s+Math.imul(w,eo)|0)+Math.imul(D,en)|0,n=n+Math.imul(D,eo)|0,i=i+Math.imul(y,eh)|0,s=(s=s+Math.imul(y,ec)|0)+Math.imul(m,eh)|0,n=n+Math.imul(m,ec)|0,i=i+Math.imul(p,el)|0,s=(s=s+Math.imul(p,ef)|0)+Math.imul(g,el)|0,n=n+Math.imul(g,ef)|0,i=i+Math.imul(l,ep)|0;var eS=(c+i|0)+((8191&(s=(s=s+Math.imul(l,eg)|0)+Math.imul(f,ep)|0))<<13)|0;c=((n=n+Math.imul(f,eg)|0)+(s>>>13)|0)+(eS>>>26)|0,eS&=0x3ffffff,i=Math.imul(k,K),s=(s=Math.imul(k,V))+Math.imul(q,K)|0,n=Math.imul(q,V),i=i+Math.imul(B,G)|0,s=(s=s+Math.imul(B,W)|0)+Math.imul(L,G)|0,n=n+Math.imul(L,W)|0,i=i+Math.imul(R,J)|0,s=(s=s+Math.imul(R,Z)|0)+Math.imul(T,J)|0,n=n+Math.imul(T,Z)|0,i=i+Math.imul(O,Q)|0,s=(s=s+Math.imul(O,ee)|0)+Math.imul(C,Q)|0,n=n+Math.imul(C,ee)|0,i=i+Math.imul(I,er)|0,s=(s=s+Math.imul(I,ei)|0)+Math.imul(A,er)|0,n=n+Math.imul(A,ei)|0,i=i+Math.imul(E,en)|0,s=(s=s+Math.imul(E,eo)|0)+Math.imul(_,en)|0,n=n+Math.imul(_,eo)|0,i=i+Math.imul(w,eh)|0,s=(s=s+Math.imul(w,ec)|0)+Math.imul(D,eh)|0,n=n+Math.imul(D,ec)|0,i=i+Math.imul(y,el)|0,s=(s=s+Math.imul(y,ef)|0)+Math.imul(m,el)|0,n=n+Math.imul(m,ef)|0,i=i+Math.imul(p,ep)|0;var eI=(c+i|0)+((8191&(s=(s=s+Math.imul(p,eg)|0)+Math.imul(g,ep)|0))<<13)|0;c=((n=n+Math.imul(g,eg)|0)+(s>>>13)|0)+(eI>>>26)|0,eI&=0x3ffffff,i=Math.imul(k,G),s=(s=Math.imul(k,W))+Math.imul(q,G)|0,n=Math.imul(q,W),i=i+Math.imul(B,J)|0,s=(s=s+Math.imul(B,Z)|0)+Math.imul(L,J)|0,n=n+Math.imul(L,Z)|0,i=i+Math.imul(R,Q)|0,s=(s=s+Math.imul(R,ee)|0)+Math.imul(T,Q)|0,n=n+Math.imul(T,ee)|0,i=i+Math.imul(O,er)|0,s=(s=s+Math.imul(O,ei)|0)+Math.imul(C,er)|0,n=n+Math.imul(C,ei)|0,i=i+Math.imul(I,en)|0,s=(s=s+Math.imul(I,eo)|0)+Math.imul(A,en)|0,n=n+Math.imul(A,eo)|0,i=i+Math.imul(E,eh)|0,s=(s=s+Math.imul(E,ec)|0)+Math.imul(_,eh)|0,n=n+Math.imul(_,ec)|0,i=i+Math.imul(w,el)|0,s=(s=s+Math.imul(w,ef)|0)+Math.imul(D,el)|0,n=n+Math.imul(D,ef)|0,i=i+Math.imul(y,ep)|0;var eA=(c+i|0)+((8191&(s=(s=s+Math.imul(y,eg)|0)+Math.imul(m,ep)|0))<<13)|0;c=((n=n+Math.imul(m,eg)|0)+(s>>>13)|0)+(eA>>>26)|0,eA&=0x3ffffff,i=Math.imul(k,J),s=(s=Math.imul(k,Z))+Math.imul(q,J)|0,n=Math.imul(q,Z),i=i+Math.imul(B,Q)|0,s=(s=s+Math.imul(B,ee)|0)+Math.imul(L,Q)|0,n=n+Math.imul(L,ee)|0,i=i+Math.imul(R,er)|0,s=(s=s+Math.imul(R,ei)|0)+Math.imul(T,er)|0,n=n+Math.imul(T,ei)|0,i=i+Math.imul(O,en)|0,s=(s=s+Math.imul(O,eo)|0)+Math.imul(C,en)|0,n=n+Math.imul(C,eo)|0,i=i+Math.imul(I,eh)|0,s=(s=s+Math.imul(I,ec)|0)+Math.imul(A,eh)|0,n=n+Math.imul(A,ec)|0,i=i+Math.imul(E,el)|0,s=(s=s+Math.imul(E,ef)|0)+Math.imul(_,el)|0,n=n+Math.imul(_,ef)|0,i=i+Math.imul(w,ep)|0;var eM=(c+i|0)+((8191&(s=(s=s+Math.imul(w,eg)|0)+Math.imul(D,ep)|0))<<13)|0;c=((n=n+Math.imul(D,eg)|0)+(s>>>13)|0)+(eM>>>26)|0,eM&=0x3ffffff,i=Math.imul(k,Q),s=(s=Math.imul(k,ee))+Math.imul(q,Q)|0,n=Math.imul(q,ee),i=i+Math.imul(B,er)|0,s=(s=s+Math.imul(B,ei)|0)+Math.imul(L,er)|0,n=n+Math.imul(L,ei)|0,i=i+Math.imul(R,en)|0,s=(s=s+Math.imul(R,eo)|0)+Math.imul(T,en)|0,n=n+Math.imul(T,eo)|0,i=i+Math.imul(O,eh)|0,s=(s=s+Math.imul(O,ec)|0)+Math.imul(C,eh)|0,n=n+Math.imul(C,ec)|0,i=i+Math.imul(I,el)|0,s=(s=s+Math.imul(I,ef)|0)+Math.imul(A,el)|0,n=n+Math.imul(A,ef)|0,i=i+Math.imul(E,ep)|0;var eO=(c+i|0)+((8191&(s=(s=s+Math.imul(E,eg)|0)+Math.imul(_,ep)|0))<<13)|0;c=((n=n+Math.imul(_,eg)|0)+(s>>>13)|0)+(eO>>>26)|0,eO&=0x3ffffff,i=Math.imul(k,er),s=(s=Math.imul(k,ei))+Math.imul(q,er)|0,n=Math.imul(q,ei),i=i+Math.imul(B,en)|0,s=(s=s+Math.imul(B,eo)|0)+Math.imul(L,en)|0,n=n+Math.imul(L,eo)|0,i=i+Math.imul(R,eh)|0,s=(s=s+Math.imul(R,ec)|0)+Math.imul(T,eh)|0,n=n+Math.imul(T,ec)|0,i=i+Math.imul(O,el)|0,s=(s=s+Math.imul(O,ef)|0)+Math.imul(C,el)|0,n=n+Math.imul(C,ef)|0,i=i+Math.imul(I,ep)|0;var eC=(c+i|0)+((8191&(s=(s=s+Math.imul(I,eg)|0)+Math.imul(A,ep)|0))<<13)|0;c=((n=n+Math.imul(A,eg)|0)+(s>>>13)|0)+(eC>>>26)|0,eC&=0x3ffffff,i=Math.imul(k,en),s=(s=Math.imul(k,eo))+Math.imul(q,en)|0,n=Math.imul(q,eo),i=i+Math.imul(B,eh)|0,s=(s=s+Math.imul(B,ec)|0)+Math.imul(L,eh)|0,n=n+Math.imul(L,ec)|0,i=i+Math.imul(R,el)|0,s=(s=s+Math.imul(R,ef)|0)+Math.imul(T,el)|0,n=n+Math.imul(T,ef)|0,i=i+Math.imul(O,ep)|0;var eP=(c+i|0)+((8191&(s=(s=s+Math.imul(O,eg)|0)+Math.imul(C,ep)|0))<<13)|0;c=((n=n+Math.imul(C,eg)|0)+(s>>>13)|0)+(eP>>>26)|0,eP&=0x3ffffff,i=Math.imul(k,eh),s=(s=Math.imul(k,ec))+Math.imul(q,eh)|0,n=Math.imul(q,ec),i=i+Math.imul(B,el)|0,s=(s=s+Math.imul(B,ef)|0)+Math.imul(L,el)|0,n=n+Math.imul(L,ef)|0,i=i+Math.imul(R,ep)|0;var eR=(c+i|0)+((8191&(s=(s=s+Math.imul(R,eg)|0)+Math.imul(T,ep)|0))<<13)|0;c=((n=n+Math.imul(T,eg)|0)+(s>>>13)|0)+(eR>>>26)|0,eR&=0x3ffffff,i=Math.imul(k,el),s=(s=Math.imul(k,ef))+Math.imul(q,el)|0,n=Math.imul(q,ef),i=i+Math.imul(B,ep)|0;var eT=(c+i|0)+((8191&(s=(s=s+Math.imul(B,eg)|0)+Math.imul(L,ep)|0))<<13)|0;c=((n=n+Math.imul(L,eg)|0)+(s>>>13)|0)+(eT>>>26)|0,eT&=0x3ffffff,i=Math.imul(k,ep);var eN=(c+i|0)+((8191&(s=(s=Math.imul(k,eg))+Math.imul(q,ep)|0))<<13)|0;return c=((n=Math.imul(q,eg))+(s>>>13)|0)+(eN>>>26)|0,eN&=0x3ffffff,h[0]=eb,h[1]=ey,h[2]=em,h[3]=ev,h[4]=ew,h[5]=eD,h[6]=ex,h[7]=eE,h[8]=e_,h[9]=eS,h[10]=eI,h[11]=eA,h[12]=eM,h[13]=eO,h[14]=eC,h[15]=eP,h[16]=eR,h[17]=eT,h[18]=eN,0!==c&&(h[19]=c,r.length++),r};function g(e,t,r){return new b().mulp(e,t,r)}function b(e,t){this.x=e,this.y=t}Math.imul||(p=d),s.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?p(this,e,t):r<63?d(this,e,t):r<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var i=0,s=0,n=0;n<r.length-1;n++){var o=s;s=0;for(var a=0x3ffffff&i,h=Math.min(n,t.length-1),c=Math.max(0,n-e.length+1);c<=h;c++){var u=n-c,l=(0|e.words[u])*(0|t.words[c]),f=0x3ffffff&l;o=o+(l/0x4000000|0)|0,a=0x3ffffff&(f=f+a|0),s+=(o=o+(f>>>26)|0)>>>26,o&=0x3ffffff}r.words[n]=a,i=o,o=s}return 0!==i?r.words[n]=i:r.length--,r.strip()}(this,e,t):g(this,e,t)},b.prototype.makeRBT=function(e){for(var t=Array(e),r=s.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,r,e);return t},b.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var i=0,s=0;s<t;s++)i|=(1&e)<<t-s-1,e>>=1;return i},b.prototype.permute=function(e,t,r,i,s,n){for(var o=0;o<n;o++)i[o]=t[e[o]],s[o]=r[e[o]]},b.prototype.transform=function(e,t,r,i,s,n){this.permute(n,e,t,r,i,s);for(var o=1;o<s;o<<=1)for(var a=o<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<s;u+=a)for(var l=h,f=c,d=0;d<o;d++){var p=r[u+d],g=i[u+d],b=r[u+d+o],y=i[u+d+o],m=l*b-f*y;y=l*y+f*b,b=m,r[u+d]=p+b,i[u+d]=g+y,r[u+d+o]=p-b,i[u+d+o]=g-y,d!==a&&(m=h*l-c*f,f=h*f+c*l,l=m)}},b.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),i=1&r,s=0;for(r=r/2|0;r;r>>>=1)s++;return 1<<s+1+i},b.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var i=0;i<r/2;i++){var s=e[i];e[i]=e[r-i-1],e[r-i-1]=s,s=t[i],t[i]=-t[r-i-1],t[r-i-1]=-s}},b.prototype.normalize13b=function(e,t){for(var r=0,i=0;i<t/2;i++){var s=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+r;e[i]=0x3ffffff&s,r=s<0x4000000?0:s/0x4000000|0}return e},b.prototype.convert13b=function(e,t,i,s){for(var n=0,o=0;o<t;o++)n+=0|e[o],i[2*o]=8191&n,n>>>=13,i[2*o+1]=8191&n,n>>>=13;for(o=2*t;o<s;++o)i[o]=0;r(0===n),r((-8192&n)==0)},b.prototype.stub=function(e){for(var t=Array(e),r=0;r<e;r++)t[r]=0;return t},b.prototype.mulp=function(e,t,r){var i=2*this.guessLen13b(e.length,t.length),s=this.makeRBT(i),n=this.stub(i),o=Array(i),a=Array(i),h=Array(i),c=Array(i),u=Array(i),l=Array(i),f=r.words;f.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,c,i),this.transform(o,n,a,h,i,s),this.transform(c,n,u,l,i,s);for(var d=0;d<i;d++){var p=a[d]*u[d]-h[d]*l[d];h[d]=a[d]*l[d]+h[d]*u[d],a[d]=p}return this.conjugate(a,h,i),this.transform(a,h,f,n,i,s),this.conjugate(f,n,i),this.normalize13b(f,i),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},s.prototype.mul=function(e){var t=new s(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},s.prototype.mulf=function(e){var t=new s(null);return t.words=Array(this.length+e.length),g(this,e,t)},s.prototype.imul=function(e){return this.clone().mulTo(e,this)},s.prototype.imuln=function(e){r("number"==typeof e),r(e<0x4000000);for(var t=0,i=0;i<this.length;i++){var s=(0|this.words[i])*e,n=(0x3ffffff&s)+(0x3ffffff&t);t>>=26,t+=(s/0x4000000|0)+(n>>>26),this.words[i]=0x3ffffff&n}return 0!==t&&(this.words[i]=t,this.length++),this.length=0===e?1:this.length,this},s.prototype.muln=function(e){return this.clone().imuln(e)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),r=0;r<t.length;r++){var i=r/26|0,s=r%26;t[r]=(e.words[i]&1<<s)>>>s}return t}(e);if(0===t.length)return new s(1);for(var r=this,i=0;i<t.length&&0===t[i];i++,r=r.sqr());if(++i<t.length)for(var n=r.sqr();i<t.length;i++,n=n.sqr())0!==t[i]&&(r=r.mul(n));return r},s.prototype.iushln=function(e){r("number"==typeof e&&e>=0);var t,i=e%26,s=(e-i)/26,n=0x3ffffff>>>26-i<<26-i;if(0!==i){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&n,h=(0|this.words[t])-a<<i;this.words[t]=h|o,o=a>>>26-i}o&&(this.words[t]=o,this.length++)}if(0!==s){for(t=this.length-1;t>=0;t--)this.words[t+s]=this.words[t];for(t=0;t<s;t++)this.words[t]=0;this.length+=s}return this.strip()},s.prototype.ishln=function(e){return r(0===this.negative),this.iushln(e)},s.prototype.iushrn=function(e,t,i){r("number"==typeof e&&e>=0);var s=t?(t-t%26)/26:0,n=e%26,o=Math.min((e-n)/26,this.length),a=0x3ffffff^0x3ffffff>>>n<<n;if(s-=o,s=Math.max(0,s),i){for(var h=0;h<o;h++)i.words[h]=this.words[h];i.length=o}if(0===o);else if(this.length>o)for(this.length-=o,h=0;h<this.length;h++)this.words[h]=this.words[h+o];else this.words[0]=0,this.length=1;var c=0;for(h=this.length-1;h>=0&&(0!==c||h>=s);h--){var u=0|this.words[h];this.words[h]=c<<26-n|u>>>n,c=u&a}return i&&0!==c&&(i.words[i.length++]=c),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(e,t,i){return r(0===this.negative),this.iushrn(e,t,i)},s.prototype.shln=function(e){return this.clone().ishln(e)},s.prototype.ushln=function(e){return this.clone().iushln(e)},s.prototype.shrn=function(e){return this.clone().ishrn(e)},s.prototype.ushrn=function(e){return this.clone().iushrn(e)},s.prototype.testn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return!(this.length<=i)&&!!(this.words[i]&1<<t)},s.prototype.imaskn=function(e){r("number"==typeof e&&e>=0);var t=e%26,i=(e-t)/26;return(r(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)?this:(0!==t&&i++,this.length=Math.min(i,this.length),0!==t&&(this.words[this.length-1]&=0x3ffffff^0x3ffffff>>>t<<t),this.strip())},s.prototype.maskn=function(e){return this.clone().imaskn(e)},s.prototype.iaddn=function(e){return(r("number"==typeof e),r(e<0x4000000),e<0)?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},s.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=0x4000000;t++)this.words[t]-=0x4000000,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},s.prototype.isubn=function(e){if(r("number"==typeof e),r(e<0x4000000),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=0x4000000,this.words[t+1]-=1;return this.strip()},s.prototype.addn=function(e){return this.clone().iaddn(e)},s.prototype.subn=function(e){return this.clone().isubn(e)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(e,t,i){var s,n,o=e.length+i;this._expand(o);var a=0;for(s=0;s<e.length;s++){n=(0|this.words[s+i])+a;var h=(0|e.words[s])*t;n-=0x3ffffff&h,a=(n>>26)-(h/0x4000000|0),this.words[s+i]=0x3ffffff&n}for(;s<this.length-i;s++)a=(n=(0|this.words[s+i])+a)>>26,this.words[s+i]=0x3ffffff&n;if(0===a)return this.strip();for(r(-1===a),a=0,s=0;s<this.length;s++)a=(n=-(0|this.words[s])+a)>>26,this.words[s]=0x3ffffff&n;return this.negative=1,this.strip()},s.prototype._wordDiv=function(e,t){var r,i=this.length-e.length,n=this.clone(),o=e,a=0|o.words[o.length-1];0!=(i=26-this._countBits(a))&&(o=o.ushln(i),n.iushln(i),a=0|o.words[o.length-1]);var h=n.length-o.length;if("mod"!==t){(r=new s(null)).length=h+1,r.words=Array(r.length);for(var c=0;c<r.length;c++)r.words[c]=0}var u=n.clone()._ishlnsubmul(o,1,h);0===u.negative&&(n=u,r&&(r.words[h]=1));for(var l=h-1;l>=0;l--){var f=(0|n.words[o.length+l])*0x4000000+(0|n.words[o.length+l-1]);for(f=Math.min(f/a|0,0x3ffffff),n._ishlnsubmul(o,f,l);0!==n.negative;)f--,n.negative=0,n._ishlnsubmul(o,1,l),n.isZero()||(n.negative^=1);r&&(r.words[l]=f)}return r&&r.strip(),n.strip(),"div"!==t&&0!==i&&n.iushrn(i),{div:r||null,mod:n}},s.prototype.divmod=function(e,t,i){var n,o,a;return(r(!e.isZero()),this.isZero())?{div:new s(0),mod:new s(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(n=a.div.neg()),"div"!==t&&(o=a.mod.neg(),i&&0!==o.negative&&o.iadd(e)),{div:n,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(n=a.div.neg()),{div:n,mod:a.mod}):(this.negative&e.negative)!=0?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),i&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||0>this.cmp(e)?{div:new s(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new s(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new s(this.modn(e.words[0]))}:this._wordDiv(e,t)},s.prototype.div=function(e){return this.divmod(e,"div",!1).div},s.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},s.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},s.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),s=e.andln(1),n=r.cmp(i);return n<0||1===s&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},s.prototype.modn=function(e){r(e<=0x3ffffff);for(var t=0x4000000%e,i=0,s=this.length-1;s>=0;s--)i=(t*i+(0|this.words[s]))%e;return i},s.prototype.idivn=function(e){r(e<=0x3ffffff);for(var t=0,i=this.length-1;i>=0;i--){var s=(0|this.words[i])+0x4000000*t;this.words[i]=s/e|0,t=s%e}return this.strip()},s.prototype.divn=function(e){return this.clone().idivn(e)},s.prototype.egcd=function(e){r(0===e.negative),r(!e.isZero());var t=this,i=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var n=new s(1),o=new s(0),a=new s(0),h=new s(1),c=0;t.isEven()&&i.isEven();)t.iushrn(1),i.iushrn(1),++c;for(var u=i.clone(),l=t.clone();!t.isZero();){for(var f=0,d=1;(t.words[0]&d)==0&&f<26;++f,d<<=1);if(f>0)for(t.iushrn(f);f-- >0;)(n.isOdd()||o.isOdd())&&(n.iadd(u),o.isub(l)),n.iushrn(1),o.iushrn(1);for(var p=0,g=1;(i.words[0]&g)==0&&p<26;++p,g<<=1);if(p>0)for(i.iushrn(p);p-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(u),h.isub(l)),a.iushrn(1),h.iushrn(1);t.cmp(i)>=0?(t.isub(i),n.isub(a),o.isub(h)):(i.isub(t),a.isub(n),h.isub(o))}return{a:a,b:h,gcd:i.iushln(c)}},s.prototype._invmp=function(e){r(0===e.negative),r(!e.isZero());var t,i=this,n=e.clone();i=0!==i.negative?i.umod(e):i.clone();for(var o=new s(1),a=new s(0),h=n.clone();i.cmpn(1)>0&&n.cmpn(1)>0;){for(var c=0,u=1;(i.words[0]&u)==0&&c<26;++c,u<<=1);if(c>0)for(i.iushrn(c);c-- >0;)o.isOdd()&&o.iadd(h),o.iushrn(1);for(var l=0,f=1;(n.words[0]&f)==0&&l<26;++l,f<<=1);if(l>0)for(n.iushrn(l);l-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);i.cmp(n)>=0?(i.isub(n),o.isub(a)):(n.isub(i),a.isub(o))}return 0>(t=0===i.cmpn(1)?o:a).cmpn(0)&&t.iadd(e),t},s.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var i=0;t.isEven()&&r.isEven();i++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var s=t.cmp(r);if(s<0){var n=t;t=r,r=n}else if(0===s||0===r.cmpn(1))break;t.isub(r)}return r.iushln(i)},s.prototype.invm=function(e){return this.egcd(e).a.umod(e)},s.prototype.isEven=function(){return(1&this.words[0])==0},s.prototype.isOdd=function(){return(1&this.words[0])==1},s.prototype.andln=function(e){return this.words[0]&e},s.prototype.bincn=function(e){r("number"==typeof e);var t=e%26,i=(e-t)/26,s=1<<t;if(this.length<=i)return this._expand(i+1),this.words[i]|=s,this;for(var n=s,o=i;0!==n&&o<this.length;o++){var a=0|this.words[o];a+=n,n=a>>>26,a&=0x3ffffff,this.words[o]=a}return 0!==n&&(this.words[o]=n,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(e){var t,i=e<0;if(0!==this.negative&&!i)return -1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)t=1;else{i&&(e=-e),r(e<=0x3ffffff,"Number is too big");var s=0|this.words[0];t=s===e?0:s<e?-1:1}return 0!==this.negative?0|-t:t},s.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},s.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],s=0|e.words[r];if(i!==s){i<s?t=-1:i>s&&(t=1);break}}return t},s.prototype.gtn=function(e){return 1===this.cmpn(e)},s.prototype.gt=function(e){return 1===this.cmp(e)},s.prototype.gten=function(e){return this.cmpn(e)>=0},s.prototype.gte=function(e){return this.cmp(e)>=0},s.prototype.ltn=function(e){return -1===this.cmpn(e)},s.prototype.lt=function(e){return -1===this.cmp(e)},s.prototype.lten=function(e){return 0>=this.cmpn(e)},s.prototype.lte=function(e){return 0>=this.cmp(e)},s.prototype.eqn=function(e){return 0===this.cmpn(e)},s.prototype.eq=function(e){return 0===this.cmp(e)},s.red=function(e){return new E(e)},s.prototype.toRed=function(e){return r(!this.red,"Already a number in reduction context"),r(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},s.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(e){return this.red=e,this},s.prototype.forceRed=function(e){return r(!this.red,"Already a number in reduction context"),this._forceRed(e)},s.prototype.redAdd=function(e){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},s.prototype.redIAdd=function(e){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},s.prototype.redSub=function(e){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},s.prototype.redISub=function(e){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},s.prototype.redShl=function(e){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},s.prototype.redMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},s.prototype.redIMul=function(e){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},s.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(e){return r(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function m(e,t){this.name=e,this.p=new s(t,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){m.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){m.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function D(){m.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function x(){m.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function E(e){if("string"==typeof e){var t=s._prime(e);this.m=t.p,this.prime=t}else r(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function _(e){E.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}m.prototype._tmp=function(){var e=new s(null);return e.words=Array(Math.ceil(this.n/13)),e},m.prototype.ireduce=function(e){var t,r=e;do this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(t>this.n)var i=t<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},m.prototype.split=function(e,t){e.iushrn(this.n,0,t)},m.prototype.imulK=function(e){return e.imul(this.k)},i(v,m),v.prototype.split=function(e,t){for(var r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9){e.words[0]=0,e.length=1;return}var s=e.words[9];for(i=10,t.words[t.length++]=4194303&s;i<e.length;i++){var n=0|e.words[i];e.words[i-10]=(4194303&n)<<4|s>>>22,s=n}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var i=0|e.words[r];t+=977*i,e.words[r]=0x3ffffff&t,t=64*i+(t/0x4000000|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},i(w,m),i(D,m),i(x,m),x.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var i=(0|e.words[r])*19+t,s=0x3ffffff&i;i>>>=26,e.words[r]=s,t=i}return 0!==t&&(e.words[e.length++]=t),e},s._prime=function(e){var t;if(y[e])return y[e];if("k256"===e)t=new v;else if("p224"===e)t=new w;else if("p192"===e)t=new D;else if("p25519"===e)t=new x;else throw Error("Unknown prime "+e);return y[e]=t,t},E.prototype._verify1=function(e){r(0===e.negative,"red works only with positives"),r(e.red,"red works only with red numbers")},E.prototype._verify2=function(e,t){r((e.negative|t.negative)==0,"red works only with positives"),r(e.red&&e.red===t.red,"red works only with red numbers")},E.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},E.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},E.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},E.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},E.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r._forceRed(this)},E.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r},E.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},E.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},E.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},E.prototype.isqr=function(e){return this.imul(e,e.clone())},E.prototype.sqr=function(e){return this.mul(e,e)},E.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(r(t%2==1),3===t){var i=this.m.add(new s(1)).iushrn(2);return this.pow(e,i)}for(var n=this.m.subn(1),o=0;!n.isZero()&&0===n.andln(1);)o++,n.iushrn(1);r(!n.isZero());var a=new s(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,c).cmp(h);)u.redIAdd(h);for(var l=this.pow(u,n),f=this.pow(e,n.addn(1).iushrn(1)),d=this.pow(e,n),p=o;0!==d.cmp(a);){for(var g=d,b=0;0!==g.cmp(a);b++)g=g.redSqr();r(b<p);var y=this.pow(l,new s(1).iushln(p-b-1));f=f.redMul(y),l=y.redSqr(),d=d.redMul(l),p=b}return f},E.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},E.prototype.pow=function(e,t){if(t.isZero())return new s(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=Array(16);r[0]=new s(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var n=r[0],o=0,a=0,h=t.bitLength()%26;for(0===h&&(h=26),i=t.length-1;i>=0;i--){for(var c=t.words[i],u=h-1;u>=0;u--){var l=c>>u&1;if(n!==r[0]&&(n=this.sqr(n)),0===l&&0===o){a=0;continue}o<<=1,o|=l,(4==++a||0===i&&0===u)&&(n=this.mul(n,r[o]),a=0,o=0)}h=26}return n},E.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},E.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},s.mont=function(e){return new _(e)},i(_,E),_.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},_.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},_.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),n=s;return s.cmp(this.m)>=0?n=s.isub(this.m):0>s.cmpn(0)&&(n=s.iadd(this.m)),n._forceRed(this)},_.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new s(0)._forceRed(this);var r=e.mul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),n=r.isub(i).iushrn(this.shift),o=n;return n.cmp(this.m)>=0?o=n.isub(this.m):0>n.cmpn(0)&&(o=n.iadd(this.m)),o._forceRed(this)},_.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)}),o("lC4vN",function(e,t){var r=e.exports;function i(e){return 1===e.length?"0"+e:e}function s(e){for(var t="",r=0;r<e.length;r++)t+=i(e[r].toString(16));return t}r.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)r[i]=0|e[i];return r}if("hex"===t){(e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e);for(var i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var i=0;i<e.length;i++){var s=e.charCodeAt(i),n=s>>8,o=255&s;n?r.push(n,o):r.push(o)}return r},r.zero2=i,r.toHex=s,r.encode=function(e,t){return"hex"===t?s(e):e}}),o("7JHF0",function(e,t){var r;function i(e){this.rand=e}if(e.exports=function(e){return r||(r=new i(null)),r.generate(e)},e.exports.Rand=i,i.prototype.generate=function(e){return this._rand(e)},i.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?i.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(i.prototype._rand=function(){throw Error("Not implemented yet")});else try{var s=n("kjyEk");if("function"!=typeof s.randomBytes)throw Error("Not supported");i.prototype._rand=function(e){return s.randomBytes(e)}}catch(e){}}),o("eOn6d",function(e,t){var r=e.exports;r.base=n("ci9lD"),r.short=n("2L80b"),r.mont=n("iBzjI"),r.edwards=n("dM3w2")}),o("ci9lD",function(e,t){var r=n("eSnEe"),i=n("85hQD"),s=i.getNAF,o=i.getJSF,a=i.assert;function h(e,t){this.type=e,this.p=new r(t.p,16),this.red=t.prime?r.red(t.prime):r.mont(this.p),this.zero=new r(0).toRed(this.red),this.one=new r(1).toRed(this.red),this.two=new r(2).toRed(this.red),this.n=t.n&&new r(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,],this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=h,h.prototype.point=function(){throw Error("Not implemented")},h.prototype.validate=function(){throw Error("Not implemented")},h.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r,i,n=e._getDoubles(),o=s(t,1,this._bitLength),h=(1<<n.step+1)-(n.step%2==0?2:1);h/=3;var c=[];for(r=0;r<o.length;r+=n.step){i=0;for(var u=r+n.step-1;u>=r;u--)i=(i<<1)+o[u];c.push(i)}for(var l=this.jpoint(null,null,null),f=this.jpoint(null,null,null),d=h;d>0;d--){for(r=0;r<c.length;r++)(i=c[r])===d?f=f.mixedAdd(n.points[r]):i===-d&&(f=f.mixedAdd(n.points[r].neg()));l=l.add(f)}return l.toP()},h.prototype._wnafMul=function(e,t){var r=4,i=e._getNAFPoints(r);r=i.wnd;for(var n=i.points,o=s(t,r,this._bitLength),h=this.jpoint(null,null,null),c=o.length-1;c>=0;c--){for(var u=0;c>=0&&0===o[c];c--)u++;if(c>=0&&u++,h=h.dblp(u),c<0)break;var l=o[c];a(0!==l),h="affine"===e.type?l>0?h.mixedAdd(n[l-1>>1]):h.mixedAdd(n[-l-1>>1].neg()):l>0?h.add(n[l-1>>1]):h.add(n[-l-1>>1].neg())}return"affine"===e.type?h.toP():h},h.prototype._wnafMulAdd=function(e,t,r,i,n){var a,h,c,u=this._wnafT1,l=this._wnafT2,f=this._wnafT3,d=0;for(a=0;a<i;a++){var p=(c=t[a])._getNAFPoints(e);u[a]=p.wnd,l[a]=p.points}for(a=i-1;a>=1;a-=2){var g=a-1,b=a;if(1!==u[g]||1!==u[b]){f[g]=s(r[g],u[g],this._bitLength),f[b]=s(r[b],u[b],this._bitLength),d=Math.max(f[g].length,d),d=Math.max(f[b].length,d);continue}var y=[t[g],null,null,t[b]];0===t[g].y.cmp(t[b].y)?(y[1]=t[g].add(t[b]),y[2]=t[g].toJ().mixedAdd(t[b].neg())):0===t[g].y.cmp(t[b].y.redNeg())?(y[1]=t[g].toJ().mixedAdd(t[b]),y[2]=t[g].add(t[b].neg())):(y[1]=t[g].toJ().mixedAdd(t[b]),y[2]=t[g].toJ().mixedAdd(t[b].neg()));var m=[-3,-1,-5,-7,0,7,5,1,3],v=o(r[g],r[b]);for(h=0,d=Math.max(v[0].length,d),f[g]=Array(d),f[b]=Array(d);h<d;h++){var w=0|v[0][h],D=0|v[1][h];f[g][h]=m[(w+1)*3+(D+1)],f[b][h]=0,l[g]=y}}var x=this.jpoint(null,null,null),E=this._wnafT4;for(a=d;a>=0;a--){for(var _=0;a>=0;){var S=!0;for(h=0;h<i;h++)E[h]=0|f[h][a],0!==E[h]&&(S=!1);if(!S)break;_++,a--}if(a>=0&&_++,x=x.dblp(_),a<0)break;for(h=0;h<i;h++){var I=E[h];0!==I&&(I>0?c=l[h][I-1>>1]:I<0&&(c=l[h][-I-1>>1].neg()),x="affine"===c.type?x.mixedAdd(c):x.add(c))}}for(a=0;a<i;a++)l[a]=null;return n?x:x.toP()},h.BasePoint=c,c.prototype.eq=function(){throw Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},h.prototype.decodePoint=function(e,t){e=i.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return i.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,s=0;s<t;s+=e){for(var n=0;n<e;n++)i=i.dbl();r.push(i)}return{step:e,points:r}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,i=1===r?null:this.dbl(),s=1;s<r;s++)t[s]=t[s-1].add(i);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}}),o("2L80b",function(e,t){var r=n("85hQD"),i=n("eSnEe"),s=n("dlqwk"),o=n("ci9lD"),a=r.assert;function h(e){o.call(this,"short",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}function c(e,t,r,s){o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new i(t,16),this.y=new i(r,16),s&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function u(e,t,r,s){o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===s?(this.x=this.curve.one,this.y=this.curve.one,this.z=new i(0)):(this.x=new i(t,16),this.y=new i(r,16),this.z=new i(s,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}s(h,o),e.exports=h,h.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){if(e.beta)t=new i(e.beta,16).toRed(this.red);else{var t,r,s,n=this._getEndoRoots(this.p);t=(t=0>n[0].cmp(n[1])?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new i(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?r=o[0]:(r=o[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return s=e.basis?e.basis.map(function(e){return{a:new i(e.a,16),b:new i(e.b,16)}}):this._getEndoBasis(r),{beta:t,lambda:r,basis:s}}},h.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:i.mont(e),r=new i(2).toRed(t).redInvm(),s=r.redNeg(),n=new i(3).toRed(t).redNeg().redSqrt().redMul(r);return[s.redAdd(n).fromRed(),s.redSub(n).fromRed()]},h.prototype._getEndoBasis=function(e){for(var t,r,s,n,o,a,h,c,u,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=e,d=this.n.clone(),p=new i(1),g=new i(0),b=new i(0),y=new i(1),m=0;0!==f.cmpn(0);){var v=d.div(f);c=d.sub(v.mul(f)),u=b.sub(v.mul(p));var w=y.sub(v.mul(g));if(!s&&0>c.cmp(l))t=h.neg(),r=p,s=c.neg(),n=u;else if(s&&2==++m)break;h=c,d=f,f=c,b=p,p=u,y=g,g=w}o=c.neg(),a=u;var D=s.sqr().add(n.sqr());return o.sqr().add(a.sqr()).cmp(D)>=0&&(o=t,a=r),s.negative&&(s=s.neg(),n=n.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:s,b:n},{a:o,b:a}]},h.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],i=t[1],s=i.b.mul(e).divRound(this.n),n=r.b.neg().mul(e).divRound(this.n),o=s.mul(r.a),a=n.mul(i.a),h=s.mul(r.b),c=n.mul(i.b);return{k1:e.sub(o).sub(a),k2:h.add(c).neg()}},h.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=r.redSqrt();if(0!==s.redSqr().redSub(r).cmp(this.zero))throw Error("invalid point");var n=s.fromRed().isOdd();return(t&&!n||!t&&n)&&(s=s.redNeg()),this.point(e,s)},h.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(s).cmpn(0)},h.prototype._endoWnafMulAdd=function(e,t,r){for(var i=this._endoWnafT1,s=this._endoWnafT2,n=0;n<e.length;n++){var o=this._endoSplit(t[n]),a=e[n],h=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),h=h.neg(!0)),i[2*n]=a,i[2*n+1]=h,s[2*n]=o.k1,s[2*n+1]=o.k2}for(var c=this._wnafMulAdd(1,i,s,2*n,r),u=0;u<2*n;u++)i[u]=null,s[u]=null;return c},s(c,o.BasePoint),h.prototype.point=function(e,t,r){return new c(this,e,t,r)},h.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,i=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],r);if(!t[2])return i;function s(t){return e.point(t[0],t[1],r)}var n=t[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(s))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(s))}},i},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e)||0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),i=e.redInvm(),s=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(i),n=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return(e=new i(e,16),this.isInfinity())?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},c.prototype.jmulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},s(u,o.BasePoint),h.prototype.jpoint=function(e,t,r){return new u(this,e,t,r)},u.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(r,i)},u.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},u.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t),s=e.x.redMul(r),n=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=i.redSub(s),h=n.redSub(o);if(0===a.cmpn(0))if(0!==h.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var c=a.redSqr(),u=c.redMul(a),l=i.redMul(c),f=h.redSqr().redIAdd(u).redISub(l).redISub(l),d=h.redMul(l.redISub(f)).redISub(n.redMul(u)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(f,d,p)},u.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,i=e.x.redMul(t),s=this.y,n=e.y.redMul(t).redMul(this.z),o=r.redSub(i),a=s.redSub(n);if(0===o.cmpn(0))if(0!==a.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var h=o.redSqr(),c=h.redMul(o),u=r.redMul(h),l=a.redSqr().redIAdd(c).redISub(u).redISub(u),f=a.redMul(u.redISub(l)).redISub(s.redMul(c)),d=this.z.redMul(o);return this.curve.jpoint(l,f,d)},u.prototype.dblp=function(e){if(0===e||this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t,r=this;for(t=0;t<e;t++)r=r.dbl();return r}var i=this.curve.a,s=this.curve.tinv,n=this.x,o=this.y,a=this.z,h=a.redSqr().redSqr(),c=o.redAdd(o);for(t=0;t<e;t++){var u=n.redSqr(),l=c.redSqr(),f=l.redSqr(),d=u.redAdd(u).redIAdd(u).redIAdd(i.redMul(h)),p=n.redMul(l),g=d.redSqr().redISub(p.redAdd(p)),b=p.redISub(g),y=d.redMul(b);y=y.redIAdd(y).redISub(f);var m=c.redMul(a);t+1<e&&(h=h.redMul(f)),n=g,a=m,c=y}return this.curve.jpoint(n,c.redMul(s),a)},u.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},u.prototype._zeroDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i),h=a.redSqr().redISub(o).redISub(o),c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),e=h,t=a.redMul(o.redISub(h)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),l=this.y.redSqr(),f=l.redSqr(),d=this.x.redAdd(l).redSqr().redISub(u).redISub(f);d=d.redIAdd(d);var p=u.redAdd(u).redIAdd(u),g=p.redSqr(),b=f.redIAdd(f);b=(b=b.redIAdd(b)).redIAdd(b),e=g.redISub(d).redISub(d),t=p.redMul(d.redISub(e)).redISub(b),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},u.prototype._threeDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),h=a.redSqr().redISub(o).redISub(o);e=h;var c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),t=a.redMul(o.redISub(h)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),l=this.y.redSqr(),f=this.x.redMul(l),d=this.x.redSub(u).redMul(this.x.redAdd(u));d=d.redAdd(d).redIAdd(d);var p=f.redIAdd(f),g=(p=p.redIAdd(p)).redAdd(p);e=d.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(l).redISub(u);var b=l.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=d.redMul(p.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,r)},u.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,i=this.z,s=i.redSqr().redSqr(),n=t.redSqr(),o=r.redSqr(),a=n.redAdd(n).redIAdd(n).redIAdd(e.redMul(s)),h=t.redAdd(t),c=(h=h.redIAdd(h)).redMul(o),u=a.redSqr().redISub(c.redAdd(c)),l=c.redISub(u),f=o.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=a.redMul(l).redISub(f),p=r.redAdd(r).redMul(i);return this.curve.jpoint(u,d,p)},u.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=t.redSqr(),s=e.redAdd(e).redIAdd(e),n=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(i),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(n)).redSqr(),h=i.redIAdd(i);h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var c=s.redIAdd(o).redSqr().redISub(n).redISub(a).redISub(h),u=t.redMul(c);u=(u=u.redIAdd(u)).redIAdd(u);var l=this.x.redMul(a).redISub(u);l=(l=l.redIAdd(l)).redIAdd(l);var f=this.y.redMul(c.redMul(h.redISub(c)).redISub(o.redMul(a)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(l,f,d)},u.prototype.mul=function(e,t){return e=new i(e,t),this.curve._wnafMul(this,e)},u.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),s=r.redMul(e.z);return 0===this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)},u.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var i=e.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(s),0===this.x.cmp(r))return!0}},u.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}}),o("iBzjI",function(e,t){var r=n("eSnEe"),i=n("dlqwk"),s=n("ci9lD"),o=n("85hQD");function a(e){s.call(this,"mont",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.i4=new r(4).toRed(this.red).redInvm(),this.two=new r(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function h(e,t,i){s.BasePoint.call(this,e,"projective"),null===t&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new r(t,16),this.z=new r(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}i(a,s),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),i=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},i(h,s.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new h(this,e,t)},a.prototype.pointFromJSON=function(e){return h.fromJSON(this,e)},h.prototype.precompute=function(){},h.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},h.fromJSON=function(e,t){return new h(e,t[0],t[1]||e.one)},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},h.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),s=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,s)},h.prototype.add=function(){throw Error("Not supported on Montgomery curve")},h.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),n=e.x.redSub(e.z).redMul(r),o=s.redMul(i),a=t.z.redMul(n.redAdd(o).redSqr()),h=t.x.redMul(n.redISub(o).redSqr());return this.curve.point(a,h)},h.prototype.mul=function(e){for(var t=e.clone(),r=this,i=this.curve.point(null,null),s=[];0!==t.cmpn(0);t.iushrn(1))s.push(t.andln(1));for(var n=s.length-1;n>=0;n--)0===s[n]?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},h.prototype.mulAdd=function(){throw Error("Not supported on Montgomery curve")},h.prototype.jumlAdd=function(){throw Error("Not supported on Montgomery curve")},h.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},h.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()}}),o("dM3w2",function(e,t){var r=n("85hQD"),i=n("eSnEe"),s=n("dlqwk"),o=n("ci9lD"),a=r.assert;function h(e){this.twisted=(0|e.a)!=1,this.mOneA=this.twisted&&(0|e.a)==-1,this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new i(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new i(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new i(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=(0|e.c)==1}function c(e,t,r,s,n){o.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===s?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new i(t,16),this.y=new i(r,16),this.z=s?new i(s,16):this.curve.one,this.t=n&&new i(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}s(h,o),e.exports=h,h.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},h.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},h.prototype.jpoint=function(e,t,r,i){return this.point(e,t,r,i)},h.prototype.pointFromX=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),s=this.c2.redSub(this.a.redMul(r)),n=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=s.redMul(n.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");var h=a.fromRed().isOdd();return(t&&!h||!t&&h)&&(a=a.redNeg()),this.point(e,a)},h.prototype.pointFromY=function(e,t){(e=new i(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),s=r.redSub(this.c2),n=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=s.redMul(n.redInvm());if(0===o.cmp(this.zero))if(!t)return this.point(this.zero,e);else throw Error("invalid point");var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},h.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),i=t.redMul(this.a).redAdd(r),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===i.cmp(s)},s(c,o.BasePoint),h.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},h.prototype.point=function(e,t,r,i){return new c(this,e,t,r,i)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),n=i.redAdd(t),o=n.redSub(r),a=i.redSub(t),h=s.redMul(o),c=n.redMul(a),u=s.redMul(a),l=o.redMul(n);return this.curve.point(h,c,l,u)},c.prototype._projDbl=function(){var e,t,r,i,s,n,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),h=this.y.redSqr();if(this.curve.twisted){var c=(i=this.curve._mulA(a)).redAdd(h);this.zOne?(e=o.redSub(a).redSub(h).redMul(c.redSub(this.curve.two)),t=c.redMul(i.redSub(h)),r=c.redSqr().redSub(c).redSub(c)):(s=this.z.redSqr(),n=c.redSub(s).redISub(s),e=o.redSub(a).redISub(h).redMul(n),t=c.redMul(i.redSub(h)),r=c.redMul(n))}else i=a.redAdd(h),s=this.curve._mulC(this.z).redSqr(),n=i.redSub(s).redSub(s),e=this.curve._mulC(o.redISub(i)).redMul(n),t=this.curve._mulC(i).redMul(a.redISub(h)),r=i.redMul(n);return this.curve.point(e,t,r)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),n=r.redSub(t),o=s.redSub(i),a=s.redAdd(i),h=r.redAdd(t),c=n.redMul(o),u=a.redMul(h),l=n.redMul(h),f=o.redMul(a);return this.curve.point(c,u,f,l)},c.prototype._projAdd=function(e){var t,r,i=this.z.redMul(e.z),s=i.redSqr(),n=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(n).redMul(o),h=s.redSub(a),c=s.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(o),l=i.redMul(h).redMul(u);return this.curve.twisted?(t=i.redMul(c).redMul(o.redSub(this.curve._mulA(n))),r=h.redMul(c)):(t=i.redMul(c).redMul(o.redSub(n)),r=this.curve._mulC(h).redMul(c)),this.curve.point(l,t,r)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},c.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add}),o("3HkkL",function(e,t){var r,i=e.exports,s=n("kiSKt"),o=n("eOn6d"),a=n("85hQD").assert;function h(e){"short"===e.type?this.curve=new o.short(e):"edwards"===e.type?this.curve=new o.edwards(e):this.curve=new o.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,a(this.g.validate(),"Invalid curve"),a(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(i,e,{configurable:!0,enumerable:!0,get:function(){var r=new h(t);return Object.defineProperty(i,e,{configurable:!0,enumerable:!0,value:r}),r}})}i.PresetCurve=h,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{r=n("c8OrP")}catch(e){r=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",r]})}),o("kiSKt",function(e,t){var r=e.exports;r.utils=n("btcbI"),r.common=n("aAb7n"),r.sha=n("2wnQk"),r.ripemd=n("05eZB"),r.hmac=n("ap2lu"),r.sha1=r.sha.sha1,r.sha256=r.sha.sha256,r.sha224=r.sha.sha224,r.sha384=r.sha.sha384,r.sha512=r.sha.sha512,r.ripemd160=r.ripemd.ripemd160}),o("c8OrP",function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}}),o("hkMcO",function(e,t){var r=n("eSnEe"),i=n("kKonu"),s=n("85hQD"),o=n("3HkkL"),a=n("7JHF0"),h=s.assert,c=n("8luVW"),u=n("5Orvh");function l(e){if(!(this instanceof l))return new l(e);"string"==typeof e&&(h(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=l,l.prototype.keyPair=function(e){return new c(this,e)},l.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},l.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},l.prototype.genKeyPair=function(e){e||(e={});for(var t=new i({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),s=this.n.byteLength(),n=this.n.sub(new r(2));;){var o=new r(t.generate(s));if(!(o.cmp(n)>0))return o.iaddn(1),this.keyFromPrivate(o)}},l.prototype._truncateToN=function(e,t){var r=8*e.byteLength()-this.n.bitLength();return(r>0&&(e=e.ushrn(r)),!t&&e.cmp(this.n)>=0)?e.sub(this.n):e},l.prototype.sign=function(e,t,s,n){"object"==typeof s&&(n=s,s=null),n||(n={}),t=this.keyFromPrivate(t,s),e=this._truncateToN(new r(e,16));for(var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),h=e.toArray("be",o),c=new i({hash:this.hash,entropy:a,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new r(1)),f=0;;f++){var d=n.k?n.k(f):new r(c.generate(this.n.byteLength()));if(0>=(d=this._truncateToN(d,!0)).cmpn(1)||d.cmp(l)>=0)continue;var p=this.g.mul(d);if(!p.isInfinity()){var g=p.getX(),b=g.umod(this.n);if(0!==b.cmpn(0)){var y=d.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(y=y.umod(this.n)).cmpn(0)){var m=!!p.getY().isOdd()|2*(0!==g.cmp(b));return n.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),m^=1),new u({r:b,s:y,recoveryParam:m})}}}}},l.prototype.verify=function(e,t,i,s){e=this._truncateToN(new r(e,16)),i=this.keyFromPublic(i,s);var n,o=(t=new u(t,"hex")).r,a=t.s;if(0>o.cmpn(1)||o.cmp(this.n)>=0||0>a.cmpn(1)||a.cmp(this.n)>=0)return!1;var h=a.invm(this.n),c=h.mul(e).umod(this.n),l=h.mul(o).umod(this.n);return this.curve._maxwellTrick?!(n=this.g.jmulAdd(c,i.getPublic(),l)).isInfinity()&&n.eqXToP(o):!(n=this.g.mulAdd(c,i.getPublic(),l)).isInfinity()&&0===n.getX().umod(this.n).cmp(o)},l.prototype.recoverPubKey=function(e,t,i,s){h((3&i)===i,"The recovery param is more than two bits"),t=new u(t,s);var n=this.n,o=new r(e),a=t.r,c=t.s,l=1&i,f=i>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw Error("Unable to find sencond key candinate");a=f?this.curve.pointFromX(a.add(this.curve.n),l):this.curve.pointFromX(a,l);var d=t.r.invm(n),p=n.sub(o).mul(d).umod(n),g=c.mul(d).umod(n);return this.g.mulAdd(p,a,g)},l.prototype.getKeyRecoveryParam=function(e,t,r,i){if(null!==(t=new u(t,i)).recoveryParam)return t.recoveryParam;for(var s,n=0;n<4;n++){try{s=this.recoverPubKey(e,t,n)}catch(e){continue}if(s.eq(r))return n}throw Error("Unable to find valid recovery factor")}}),o("kKonu",function(e,t){var r=n("kiSKt"),i=n("lC4vN"),s=n("koC21");function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=i.toArray(e.entropy,e.entropyEnc||"hex"),r=i.toArray(e.nonce,e.nonceEnc||"hex"),n=i.toArray(e.pers,e.persEnc||"hex");s(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,n)}e.exports=o,o.prototype._init=function(e,t,r){var i=e.concat(t).concat(r);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=0x1000000000000},o.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,r,n){"string"!=typeof t&&(n=r,r=t,t=null),e=i.toArray(e,t),r=i.toArray(r,n),s(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},o.prototype.generate=function(e,t,r,s){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");"string"!=typeof t&&(s=r,r=t,t=null),r&&(r=i.toArray(r,s||"hex"),this._update(r));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var o=n.slice(0,e);return this._update(r),this._reseed++,i.encode(o,t)}}),o("8luVW",function(e,t){var r=n("eSnEe"),i=n("85hQD").assert;function s(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=s,s.fromPublic=function(e,t,r){return t instanceof s?t:new s(e,{pub:t,pubEnc:r})},s.fromPrivate=function(e,t,r){return t instanceof s?t:new s(e,{priv:t,privEnc:r})},s.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},s.prototype.getPublic=function(e,t){return("string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t)?this.pub.encode(t,e):this.pub},s.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},s.prototype._importPrivate=function(e,t){this.priv=new r(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},s.prototype._importPublic=function(e,t){if(e.x||e.y){"mont"===this.ec.curve.type?i(e.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&i(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)},s.prototype.derive=function(e){return e.validate()||i(e.validate(),"public point not validated"),e.mul(this.priv).getX()},s.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},s.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},s.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}}),o("5Orvh",function(e,t){var r=n("eSnEe"),i=n("85hQD"),s=i.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(s(e.r&&e.s,"Signature without r or s"),this.r=new r(e.r,16),this.s=new r(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function h(e,t){var r=e[t.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4||0===e[t.place])return!1;for(var s=0,n=0,o=t.place;n<i;n++,o++)s<<=8,s|=e[o],s>>>=0;return!(s<=127)&&(t.place=o,s)}function c(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function u(e,t){if(t<128)return void e.push(t);var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}e.exports=o,o.prototype._importDER=function(e,t){e=i.toArray(e,t);var s=new a;if(48!==e[s.place++])return!1;var n=h(e,s);if(!1===n||n+s.place!==e.length||2!==e[s.place++])return!1;var o=h(e,s);if(!1===o||(128&e[s.place])!=0)return!1;var c=e.slice(s.place,o+s.place);if(s.place+=o,2!==e[s.place++])return!1;var u=h(e,s);if(!1===u||e.length!==u+s.place||(128&e[s.place])!=0)return!1;var l=e.slice(s.place,u+s.place);if(0===c[0])if(!(128&c[1]))return!1;else c=c.slice(1);if(0===l[0])if(!(128&l[1]))return!1;else l=l.slice(1);return this.r=new r(c),this.s=new r(l),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=c(t),r=c(r);!r[0]&&!(128&r[1]);)r=r.slice(1);var s=[2];u(s,t.length),(s=s.concat(t)).push(2),u(s,r.length);var n=s.concat(r),o=[48];return u(o,n.length),o=o.concat(n),i.encode(o,e)}}),o("4kGlE",function(e,t){var r=n("kiSKt"),i=n("3HkkL"),s=n("85hQD"),o=s.assert,a=s.parseBytes,h=n("hJAxD"),c=n("8TPbV");function u(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof u))return new u(e);e=i[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=r.sha512}e.exports=u,u.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),i=this.hashInt(r.messagePrefix(),e),s=this.g.mul(i),n=this.encodePoint(s),o=this.hashInt(n,r.pubBytes(),e).mul(r.priv()),h=i.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:h,Rencoded:n})},u.prototype.verify=function(e,t,r){if(e=a(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var i=this.keyFromPublic(r),s=this.hashInt(t.Rencoded(),i.pubBytes(),e),n=this.g.mul(t.S());return t.R().add(i.pub().mul(s)).eq(n)},u.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return s.intFromLE(e.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(e){return h.fromPublic(this,e)},u.prototype.keyFromSecret=function(e){return h.fromSecret(this,e)},u.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},u.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=128*!!e.getX().isOdd(),t},u.prototype.decodePoint=function(e){var t=(e=s.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),i=(128&e[t])!=0,n=s.intFromLE(r);return this.curve.pointFromY(n,i)},u.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},u.prototype.decodeInt=function(e){return s.intFromLE(e)},u.prototype.isPoint=function(e){return e instanceof this.pointClass}}),o("hJAxD",function(e,t){var r=n("85hQD"),i=r.assert,s=r.parseBytes,o=r.cachedProperty;function a(e,t){this.eddsa=e,this._secret=s(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=s(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),o(a,"privBytes",function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),o(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(e){return i(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return i(this._secret,"KeyPair is public only"),r.encode(this.secret(),e)},a.prototype.getPublic=function(e){return r.encode(this.pubBytes(),e)},e.exports=a}),o("8TPbV",function(e,t){var r=n("eSnEe"),i=n("85hQD"),s=i.assert,o=i.cachedProperty,a=i.parseBytes;function h(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(s(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),s(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof r&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(h,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(h,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(h,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(h,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),h.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},h.prototype.toHex=function(){return i.encode(this.toBytes(),"hex").toUpperCase()},e.exports=h}),o("6cqMT",function(e,r){var i,s,n,o="__lodash_hash_undefined__",a="[object Arguments]",h="[object Array]",c="[object Boolean]",u="[object Date]",l="[object Error]",f="[object Function]",d="[object Map]",p="[object Number]",g="[object Object]",b="[object Promise]",y="[object RegExp]",m="[object Set]",v="[object String]",w="[object WeakMap]",D="[object ArrayBuffer]",x="[object DataView]",E=/^\[object .+?Constructor\]$/,_=/^(?:0|[1-9]\d*)$/,S={};S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S[a]=S[h]=S[D]=S[c]=S[x]=S[u]=S[l]=S[f]=S[d]=S[p]=S[g]=S[y]=S[m]=S[v]=S[w]=!1;var I="object"==typeof t&&t&&t.Object===Object&&t,A="object"==typeof self&&self&&self.Object===Object&&self,M=I||A||Function("return this")(),O=r&&!r.nodeType&&r,C=O&&e&&!e.nodeType&&e,P=C&&C.exports===O,R=P&&I.process,T=function(){try{return R&&R.binding&&R.binding("util")}catch(e){}}(),N=T&&T.isTypedArray;function B(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function L(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var U=Array.prototype,k=Function.prototype,q=Object.prototype,j=M["__core-js_shared__"],z=k.toString,F=q.hasOwnProperty,$=(i=/[^.]+$/.exec(j&&j.keys&&j.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",K=q.toString,V=RegExp("^"+z.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),H=P?M.Buffer:void 0,G=M.Symbol,W=M.Uint8Array,Y=q.propertyIsEnumerable,J=U.splice,Z=G?G.toStringTag:void 0,X=Object.getOwnPropertySymbols,Q=H?H.isBuffer:void 0,ee=(s=Object.keys,n=Object,function(e){return s(n(e))}),et=eS(M,"DataView"),er=eS(M,"Map"),ei=eS(M,"Promise"),es=eS(M,"Set"),en=eS(M,"WeakMap"),eo=eS(Object,"create"),ea=eM(et),eh=eM(er),ec=eM(ei),eu=eM(es),el=eM(en),ef=G?G.prototype:void 0,ed=ef?ef.valueOf:void 0;function ep(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eb(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ey(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new eb;++t<r;)this.add(e[t])}function em(e){var t=this.__data__=new eg(e);this.size=t.size}function ev(e,t){for(var r=e.length;r--;)if(eO(e[r][0],t))return r;return -1}function ew(e){var t;return null==e?void 0===e?"[object Undefined]":"[object Null]":Z&&Z in Object(e)?function(e){var t=F.call(e,Z),r=e[Z];try{e[Z]=void 0;var i=!0}catch(e){}var s=K.call(e);return i&&(t?e[Z]=r:delete e[Z]),s}(e):(t=e,K.call(t))}function eD(e){return eL(e)&&ew(e)==a}function ex(e,t,r,i,s,n){var o=1&r,a=e.length,h=t.length;if(a!=h&&!(o&&h>a))return!1;var c=n.get(e);if(c&&n.get(t))return c==t;var u=-1,l=!0,f=2&r?new ey:void 0;for(n.set(e,t),n.set(t,e);++u<a;){var d=e[u],p=t[u];if(i)var g=o?i(p,d,u,t,e,n):i(d,p,u,e,t,n);if(void 0!==g){if(g)continue;l=!1;break}if(f){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!f.has(t)&&(d===e||s(d,e,r,i,n)))return f.push(t)})){l=!1;break}}else if(!(d===p||s(d,p,r,i,n))){l=!1;break}}return n.delete(e),n.delete(t),l}function eE(e){var t;return t=ek(e),eP(e)?t:function(e,t){for(var r=-1,i=t.length,s=e.length;++r<i;)e[s+r]=t[r];return e}(t,eI(e))}function e_(e,t){var r,i,s=e.__data__;return("string"==(i=typeof(r=t))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==r:null===r)?s["string"==typeof t?"string":"hash"]:s.map}function eS(e,t){var r,i=null==e?void 0:e[t];return!(!eB(i)||(r=i,$&&$ in r))&&(eT(i)?V:E).test(eM(i))?i:void 0}ep.prototype.clear=function(){this.__data__=eo?eo(null):{},this.size=0},ep.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},ep.prototype.get=function(e){var t=this.__data__;if(eo){var r=t[e];return r===o?void 0:r}return F.call(t,e)?t[e]:void 0},ep.prototype.has=function(e){var t=this.__data__;return eo?void 0!==t[e]:F.call(t,e)},ep.prototype.set=function(e,t){var r=this.__data__;return this.size+=+!this.has(e),r[e]=eo&&void 0===t?o:t,this},eg.prototype.clear=function(){this.__data__=[],this.size=0},eg.prototype.delete=function(e){var t=this.__data__,r=ev(t,e);return!(r<0)&&(r==t.length-1?t.pop():J.call(t,r,1),--this.size,!0)},eg.prototype.get=function(e){var t=this.__data__,r=ev(t,e);return r<0?void 0:t[r][1]},eg.prototype.has=function(e){return ev(this.__data__,e)>-1},eg.prototype.set=function(e,t){var r=this.__data__,i=ev(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},eb.prototype.clear=function(){this.size=0,this.__data__={hash:new ep,map:new(er||eg),string:new ep}},eb.prototype.delete=function(e){var t=e_(this,e).delete(e);return this.size-=!!t,t},eb.prototype.get=function(e){return e_(this,e).get(e)},eb.prototype.has=function(e){return e_(this,e).has(e)},eb.prototype.set=function(e,t){var r=e_(this,e),i=r.size;return r.set(e,t),this.size+=+(r.size!=i),this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,o),this},ey.prototype.has=function(e){return this.__data__.has(e)},em.prototype.clear=function(){this.__data__=new eg,this.size=0},em.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},em.prototype.get=function(e){return this.__data__.get(e)},em.prototype.has=function(e){return this.__data__.has(e)},em.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eg){var i=r.__data__;if(!er||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new eb(i)}return r.set(e,t),this.size=r.size,this};var eI=X?function(e){return null==e?[]:function(e,t){for(var r=-1,i=null==e?0:e.length,s=0,n=[];++r<i;){var o=e[r];t(o,r,e)&&(n[s++]=o)}return n}(X(e=Object(e)),function(t){return Y.call(e,t)})}:function(){return[]},eA=ew;function eM(e){if(null!=e){try{return z.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eO(e,t){return e===t||e!=e&&t!=t}(et&&eA(new et(new ArrayBuffer(1)))!=x||er&&eA(new er)!=d||ei&&eA(ei.resolve())!=b||es&&eA(new es)!=m||en&&eA(new en)!=w)&&(eA=function(e){var t=ew(e),r=t==g?e.constructor:void 0,i=r?eM(r):"";if(i)switch(i){case ea:return x;case eh:return d;case ec:return b;case eu:return m;case el:return w}return t});var eC=eD(function(){return arguments}())?eD:function(e){return eL(e)&&F.call(e,"callee")&&!Y.call(e,"callee")},eP=Array.isArray,eR=Q||function(){return!1};function eT(e){if(!eB(e))return!1;var t=ew(e);return t==f||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eN(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff}function eB(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function eL(e){return null!=e&&"object"==typeof e}var eU=N?function(e){return N(e)}:function(e){return eL(e)&&eN(e.length)&&!!S[ew(e)]};function ek(e){return null!=e&&eN(e.length)&&!eT(e)?function(e,t){var r,i,s=eP(e),n=!s&&eC(e),o=!s&&!n&&eR(e),a=!s&&!n&&!o&&eU(e),h=s||n||o||a,c=h?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],u=c.length;for(var l in e){F.call(e,l)&&!(h&&("length"==l||o&&("offset"==l||"parent"==l)||a&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||(r=l,(i=null==(i=u)?0x1fffffffffffff:i)&&("number"==typeof r||_.test(r))&&r>-1&&r%1==0&&r<i)))&&c.push(l)}return c}(e):function(e){if(r=(t=e)&&t.constructor,t!==("function"==typeof r&&r.prototype||q))return ee(e);var t,r,i=[];for(var s in Object(e))F.call(e,s)&&"constructor"!=s&&i.push(s);return i}(e)}e.exports=function(e,t){return function e(t,r,i,s,n){return t===r||(null!=t&&null!=r&&(eL(t)||eL(r))?function(e,t,r,i,s,n){var o=eP(e),f=eP(t),b=o?h:eA(e),w=f?h:eA(t);b=b==a?g:b,w=w==a?g:w;var E=b==g,_=w==g,S=b==w;if(S&&eR(e)){if(!eR(t))return!1;o=!0,E=!1}if(S&&!E)return n||(n=new em),o||eU(e)?ex(e,t,r,i,s,n):function(e,t,r,i,s,n,o){switch(r){case x:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case D:if(e.byteLength!=t.byteLength||!n(new W(e),new W(t)))break;return!0;case c:case u:case p:return eO(+e,+t);case l:return e.name==t.name&&e.message==t.message;case y:case v:return e==t+"";case d:var a=B;case m:var h=1&i;if(a||(a=L),e.size!=t.size&&!h)break;var f=o.get(e);if(f)return f==t;i|=2,o.set(e,t);var g=ex(a(e),a(t),i,s,n,o);return o.delete(e),g;case"[object Symbol]":if(ed)return ed.call(e)==ed.call(t)}return!1}(e,t,b,r,i,s,n);if(!(1&r)){var I=E&&F.call(e,"__wrapped__"),A=_&&F.call(t,"__wrapped__");if(I||A){var M=I?e.value():e,O=A?t.value():t;return n||(n=new em),s(M,O,r,i,n)}}return!!S&&(n||(n=new em),function(e,t,r,i,s,n){var o=1&r,a=eE(e),h=a.length;if(h!=eE(t).length&&!o)return!1;for(var c=h;c--;){var u=a[c];if(!(o?u in t:F.call(t,u)))return!1}var l=n.get(e);if(l&&n.get(t))return l==t;var f=!0;n.set(e,t),n.set(t,e);for(var d=o;++c<h;){var p=e[u=a[c]],g=t[u];if(i)var b=o?i(g,p,u,t,e,n):i(p,g,u,e,t,n);if(!(void 0===b?p===g||s(p,g,r,i,n):b)){f=!1;break}d||(d="constructor"==u)}if(f&&!d){var y=e.constructor,m=t.constructor;y!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof m&&m instanceof m)&&(f=!1)}return n.delete(e),n.delete(t),f}(e,t,r,i,s,n))}(t,r,i,s,e,n):t!=t&&r!=r)}(e,t)}});var a={},h="object"==typeof Reflect?Reflect:null,c=h&&"function"==typeof h.apply?h.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Me=h&&"function"==typeof h.ownKeys?h.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var u=Number.isNaN||function(e){return e!=e};function l(){l.init.call(this)}(a=l).once=function(e,t){return new Promise(function(r,i){var s,n,o;function a(r){e.removeListener(t,h),i(r)}function h(){"function"==typeof e.removeListener&&e.removeListener("error",a),r([].slice.call(arguments))}D(e,t,h,{once:!0}),"error"!==t&&(s=e,n=a,o={once:!0},"function"==typeof s.on&&D(s,"error",n,o))})},l.EventEmitter=l,l.prototype._events=void 0,l.prototype._eventsCount=0,l.prototype._maxListeners=void 0;var f=10;function d(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function p(e){return void 0===e._maxListeners?l.defaultMaxListeners:e._maxListeners}function g(e,t,r,i){if(d(r),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),n=e._events),o=n[t]),void 0===o)o=n[t]=r,++e._eventsCount;else if("function"==typeof o?o=n[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(s=p(e))>0&&o.length>s&&!o.warned){o.warned=!0;var s,n,o,a=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn&&console.warn(a)}return e}function b(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function y(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=b.bind(i);return s.listener=r,i.wrapFn=s,s}function m(e,t,r){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):w(s,s.length)}function v(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function w(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function D(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function s(n){i.once&&e.removeEventListener(t,s),r(n)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e||e<0||u(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),l.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},l.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||u(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},l.prototype.getMaxListeners=function(){return p(this)},l.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){if(t.length>0&&(n=t[0]),n instanceof Error)throw n;var n,o=Error("Unhandled error."+(n?" ("+n.message+")":""));throw o.context=n,o}var a=s[e];if(void 0===a)return!1;if("function"==typeof a)c(a,this,t);else for(var h=a.length,u=w(a,h),r=0;r<h;++r)c(u[r],this,t);return!0},l.prototype.addListener=function(e,t){return g(this,e,t,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(e,t){return g(this,e,t,!0)},l.prototype.once=function(e,t){return d(t),this.on(e,y(this,e,t)),this},l.prototype.prependOnceListener=function(e,t){return d(t),this.prependListener(e,y(this,e,t)),this},l.prototype.removeListener=function(e,t){var r,i,s,n,o;if(d(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,n=r.length-1;n>=0;n--)if(r[n]===t||r[n].listener===t){o=r[n].listener,s=n;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},l.prototype.off=l.prototype.removeListener,l.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var s,n=Object.keys(r);for(i=0;i<n.length;++i)"removeListener"!==(s=n[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},l.prototype.listeners=function(e){return m(this,e,!0)},l.prototype.rawListeners=function(e){return m(this,e,!1)},l.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):v.call(e,t)},l.prototype.listenerCount=v,l.prototype.eventNames=function(){return this._eventsCount>0?Me(this._events):[]};var x={};Object.defineProperty(x,"__esModule",{value:!0});var E=n("3kKyL");E.__exportStar(n("9EePZ"),x),E.__exportStar(n("iD73S"),x),E.__exportStar(n("dTXLC"),x),E.__exportStar(n("2MWZl"),x);class _{}class S extends _{constructor(e){super()}}const I=x.FIVE_SECONDS,A="heartbeat_pulse";class M extends S{constructor(e){super(e),this.events=new(0,a.EventEmitter),this.interval=I,this.interval=e?.interval||I}static async init(e){let t=new M(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,x.toMiliseconds)(this.interval))}pulse(){this.events.emit(A)}}const O=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,C=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,P=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function R(e,t){var r;return"__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t?void(r=e,console.warn(`[destr] Dropping "${r}" key to prevent prototype pollution.`)):t}function T(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);let r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return NaN;case"infinity":return 1/0;case"-infinity":return-1/0}if(!P.test(e)){if(t.strict)throw SyntaxError("[destr] Invalid JSON");return e}try{if(O.test(e)||C.test(e)){if(t.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(e,R)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}Mt=function(e){for(var t,r=e.length,i=r%3,s=[],n=0,o=r-i;n<o;n+=16383)s.push(function(e,t,r){for(var i,s=[],n=t;n<r;n+=3)i=(e[n]<<16&0xff0000)+(e[n+1]<<8&65280)+(255&e[n+2]),s.push(N[i>>18&63]+N[i>>12&63]+N[i>>6&63]+N[63&i]);return s.join("")}(e,n,n+16383>o?o:n+16383));return 1===i?s.push(N[(t=e[r-1])>>2]+N[t<<4&63]+"=="):2===i&&s.push(N[(t=(e[r-2]<<8)+e[r-1])>>10]+N[t>>4&63]+N[t<<2&63]+"="),s.join("")};for(var N=[],B=[],L="undefined"!=typeof Uint8Array?Uint8Array:Array,U="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",k=0,q=U.length;k<q;++k)N[k]=U[k],B[U.charCodeAt(k)]=k;B[45]=62,B[95]=63,Mr=function(e,t,r,i,s){var n,o,a=8*s-i-1,h=(1<<a)-1,c=h>>1,u=-7,l=r?s-1:0,f=r?-1:1,d=e[t+l];for(l+=f,n=d&(1<<-u)-1,d>>=-u,u+=a;u>0;n=256*n+e[t+l],l+=f,u-=8);for(o=n&(1<<-u)-1,n>>=-u,u+=i;u>0;o=256*o+e[t+l],l+=f,u-=8);if(0===n)n=1-c;else{if(n===h)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),n-=c}return(d?-1:1)*o*Math.pow(2,n-i)},Mi=function(e,t,r,i,s,n){var o,a,h,c=8*n-s-1,u=(1<<c)-1,l=u>>1,f=5960464477539062e-23*(23===s),d=i?0:n-1,p=i?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-o))<1&&(o--,h*=2),o+l>=1?t+=f/h:t+=f*Math.pow(2,1-l),t*h>=2&&(o++,h/=2),o+l>=u?(a=0,o=u):o+l>=1?(a=(t*h-1)*Math.pow(2,s),o+=l):(a=t*Math.pow(2,l-1)*Math.pow(2,s),o=0));s>=8;e[r+d]=255&a,d+=p,a/=256,s-=8);for(o=o<<s|a,c+=s;c>0;e[r+d]=255&o,d+=p,o/=256,c-=8);e[r+d-p]|=128*g};var j="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function z(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,F.prototype),t}function F(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return V(e)}return $(e,t,r)}function $(e,t,r){if("string"==typeof e){var i=e,s=t;if(("string"!=typeof s||""===s)&&(s="utf8"),!F.isEncoding(s))throw TypeError("Unknown encoding: "+s);var n=0|Y(i,s),o=z(n),a=o.write(i,s);return a!==n&&(o=o.slice(0,a)),o}if(ArrayBuffer.isView(e)){var h=e;if(eu(h,Uint8Array)){var c=new Uint8Array(h);return G(c.buffer,c.byteOffset,c.byteLength)}return H(h)}if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(eu(e,ArrayBuffer)||e&&eu(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(eu(e,SharedArrayBuffer)||e&&eu(e.buffer,SharedArrayBuffer)))return G(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var u=e.valueOf&&e.valueOf();if(null!=u&&u!==e)return F.from(u,t,r);var l=function(e){if(F.isBuffer(e)){var t=0|W(e.length),r=z(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?z(0):H(e):"Buffer"===e.type&&Array.isArray(e.data)?H(e.data):void 0}(e);if(l)return l;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return F.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function K(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function V(e){return K(e),z(e<0?0:0|W(e))}function H(e){for(var t=e.length<0?0:0|W(e.length),r=z(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function G(e,t,r){var i;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),F.prototype),i}function W(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function Y(e,t){if(F.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||eu(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var s=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return ea(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return eh(e).length;default:if(s)return i?-1:ea(e).length;t=(""+t).toLowerCase(),s=!0}}function J(e,t,r){var i,s,n,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var s="",n=t;n<r;++n)s+=el[e[n]];return s}(this,t,r);case"utf8":case"utf-8":return ee(this,t,r);case"ascii":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var s=t;s<r;++s)i+=String.fromCharCode(127&e[s]);return i}(this,t,r);case"latin1":case"binary":return function(e,t,r){var i="";r=Math.min(e.length,r);for(var s=t;s<r;++s)i+=String.fromCharCode(e[s]);return i}(this,t,r);case"base64":return i=this,s=t,n=r,0===s&&n===i.length?Mt(i):Mt(i.slice(s,n));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var i=e.slice(t,r),s="",n=0;n<i.length-1;n+=2)s+=String.fromCharCode(i[n]+256*i[n+1]);return s}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function Z(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function X(e,t,r,i,s){var n;if(0===e.length)return -1;if("string"==typeof r?(i=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(n=r*=1)!=n&&(r=s?0:e.length-1),r<0&&(r=e.length+r),r>=e.length)if(s)return -1;else r=e.length-1;else if(r<0)if(!s)return -1;else r=0;if("string"==typeof t&&(t=F.from(t,i)),F.isBuffer(t))return 0===t.length?-1:Q(e,t,r,i,s);if("number"==typeof t){if(t&=255,"function"==typeof Uint8Array.prototype.indexOf)if(s)return Uint8Array.prototype.indexOf.call(e,t,r);else return Uint8Array.prototype.lastIndexOf.call(e,t,r);return Q(e,[t],r,i,s)}throw TypeError("val must be string, number or Buffer")}function Q(e,t,r,i,s){var n,o=1,a=e.length,h=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return -1;o=2,a/=2,h/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(s){var u=-1;for(n=r;n<a;n++)if(c(e,n)===c(t,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===h)return u*o}else -1!==u&&(n-=n-u),u=-1}else for(r+h>a&&(r=a-h),n=r;n>=0;n--){for(var l=!0,f=0;f<h;f++)if(c(e,n+f)!==c(t,f)){l=!1;break}if(l)return n}return -1}function ee(e,t,r){r=Math.min(e.length,r);for(var i=[],s=t;s<r;){var n,o,a,h,c=e[s],u=null,l=c>239?4:c>223?3:c>191?2:1;if(s+l<=r)switch(l){case 1:c<128&&(u=c);break;case 2:(192&(n=e[s+1]))==128&&(h=(31&c)<<6|63&n)>127&&(u=h);break;case 3:n=e[s+1],o=e[s+2],(192&n)==128&&(192&o)==128&&(h=(15&c)<<12|(63&n)<<6|63&o)>2047&&(h<55296||h>57343)&&(u=h);break;case 4:n=e[s+1],o=e[s+2],a=e[s+3],(192&n)==128&&(192&o)==128&&(192&a)==128&&(h=(15&c)<<18|(63&n)<<12|(63&o)<<6|63&a)>65535&&h<1114112&&(u=h)}null===u?(u=65533,l=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),s+=l}var f=i,d=f.length;if(d<=4096)return String.fromCharCode.apply(String,f);for(var p="",g=0;g<d;)p+=String.fromCharCode.apply(String,f.slice(g,g+=4096));return p}function et(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function er(e,t,r,i,s,n){if(!F.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>s||t<n)throw RangeError('"value" argument is out of bounds');if(r+i>e.length)throw RangeError("Index out of range")}function ei(e,t,r,i,s,n){if(r+i>e.length||r<0)throw RangeError("Index out of range")}function es(e,t,r,i,s){return t*=1,r>>>=0,s||ei(e,t,r,4,34028234663852886e22,-34028234663852886e22),Mi(e,t,r,i,23,4),r+4}function en(e,t,r,i,s){return t*=1,r>>>=0,s||ei(e,t,r,8,17976931348623157e292,-17976931348623157e292),Mi(e,t,r,i,52,8),r+8}F.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),F.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(F.prototype,"parent",{enumerable:!0,get:function(){if(F.isBuffer(this))return this.buffer}}),Object.defineProperty(F.prototype,"offset",{enumerable:!0,get:function(){if(F.isBuffer(this))return this.byteOffset}}),F.poolSize=8192,F.from=function(e,t,r){return $(e,t,r)},Object.setPrototypeOf(F.prototype,Uint8Array.prototype),Object.setPrototypeOf(F,Uint8Array),F.alloc=function(e,t,r){return(K(e),e<=0)?z(e):void 0!==t?"string"==typeof r?z(e).fill(t,r):z(e).fill(t):z(e)},F.allocUnsafe=function(e){return V(e)},F.allocUnsafeSlow=function(e){return V(e)},F.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==F.prototype},F.compare=function(e,t){if(eu(e,Uint8Array)&&(e=F.from(e,e.offset,e.byteLength)),eu(t,Uint8Array)&&(t=F.from(t,t.offset,t.byteLength)),!F.isBuffer(e)||!F.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,s=0,n=Math.min(r,i);s<n;++s)if(e[s]!==t[s]){r=e[s],i=t[s];break}return r<i?-1:+(i<r)},F.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},F.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return F.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,i=F.allocUnsafe(t),s=0;for(r=0;r<e.length;++r){var n=e[r];if(eu(n,Uint8Array))s+n.length>i.length?F.from(n).copy(i,s):Uint8Array.prototype.set.call(i,n,s);else if(F.isBuffer(n))n.copy(i,s);else throw TypeError('"list" argument must be an Array of Buffers');s+=n.length}return i},F.byteLength=Y,F.prototype._isBuffer=!0,F.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)Z(this,t,t+1);return this},F.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)Z(this,t,t+3),Z(this,t+1,t+2);return this},F.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)Z(this,t,t+7),Z(this,t+1,t+6),Z(this,t+2,t+5),Z(this,t+3,t+4);return this},F.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?ee(this,0,e):J.apply(this,arguments)},F.prototype.toLocaleString=F.prototype.toString,F.prototype.equals=function(e){if(!F.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===F.compare(this,e)},F.prototype.inspect=function(){var e="";return e=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(e+=" ... "),"<Buffer "+e+">"},j&&(F.prototype[j]=F.prototype.inspect),F.prototype.compare=function(e,t,r,i,s){if(eu(e,Uint8Array)&&(e=F.from(e,e.offset,e.byteLength)),!F.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===s&&(s=this.length),t<0||r>e.length||i<0||s>this.length)throw RangeError("out of range index");if(i>=s&&t>=r)return 0;if(i>=s)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,i>>>=0,s>>>=0,this===e)return 0;for(var n=s-i,o=r-t,a=Math.min(n,o),h=this.slice(i,s),c=e.slice(t,r),u=0;u<a;++u)if(h[u]!==c[u]){n=h[u],o=c[u];break}return n<o?-1:+(o<n)},F.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},F.prototype.indexOf=function(e,t,r){return X(this,e,t,r,!0)},F.prototype.lastIndexOf=function(e,t,r){return X(this,e,t,r,!1)},F.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var s,n,o,a,h,c,u,l,f=this.length-t;if((void 0===r||r>f)&&(r=f),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var d=!1;;)switch(i){case"hex":return function(e,t,r,i){r=Number(r)||0;var s=e.length-r;i?(i=Number(i))>s&&(i=s):i=s;var n=t.length;i>n/2&&(i=n/2);for(var o=0;o<i;++o){var a,h=parseInt(t.substr(2*o,2),16);if((a=h)!=a)break;e[r+o]=h}return o}(this,e,t,r);case"utf8":case"utf-8":return s=t,n=r,ec(ea(e,this.length-s),this,s,n);case"ascii":case"latin1":case"binary":return o=t,a=r,ec(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,o,a);case"base64":return h=t,c=r,ec(eh(e),this,h,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return u=t,l=r,ec(function(e,t){for(var r,i,s=[],n=0;n<e.length&&!((t-=2)<0);++n)i=(r=e.charCodeAt(n))>>8,s.push(r%256),s.push(i);return s}(e,this.length-u),this,u,l);default:if(d)throw TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),d=!0}},F.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},F.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,F.prototype),i},F.prototype.readUintLE=F.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||et(e,t,this.length);for(var i=this[e],s=1,n=0;++n<t&&(s*=256);)i+=this[e+n]*s;return i},F.prototype.readUintBE=F.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||et(e,t,this.length);for(var i=this[e+--t],s=1;t>0&&(s*=256);)i+=this[e+--t]*s;return i},F.prototype.readUint8=F.prototype.readUInt8=function(e,t){return e>>>=0,t||et(e,1,this.length),this[e]},F.prototype.readUint16LE=F.prototype.readUInt16LE=function(e,t){return e>>>=0,t||et(e,2,this.length),this[e]|this[e+1]<<8},F.prototype.readUint16BE=F.prototype.readUInt16BE=function(e,t){return e>>>=0,t||et(e,2,this.length),this[e]<<8|this[e+1]},F.prototype.readUint32LE=F.prototype.readUInt32LE=function(e,t){return e>>>=0,t||et(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},F.prototype.readUint32BE=F.prototype.readUInt32BE=function(e,t){return e>>>=0,t||et(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},F.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||et(e,t,this.length);for(var i=this[e],s=1,n=0;++n<t&&(s*=256);)i+=this[e+n]*s;return i>=(s*=128)&&(i-=Math.pow(2,8*t)),i},F.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||et(e,t,this.length);for(var i=t,s=1,n=this[e+--i];i>0&&(s*=256);)n+=this[e+--i]*s;return n>=(s*=128)&&(n-=Math.pow(2,8*t)),n},F.prototype.readInt8=function(e,t){return(e>>>=0,t||et(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},F.prototype.readInt16LE=function(e,t){e>>>=0,t||et(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},F.prototype.readInt16BE=function(e,t){e>>>=0,t||et(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},F.prototype.readInt32LE=function(e,t){return e>>>=0,t||et(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},F.prototype.readInt32BE=function(e,t){return e>>>=0,t||et(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},F.prototype.readFloatLE=function(e,t){return e>>>=0,t||et(e,4,this.length),Mr(this,e,!0,23,4)},F.prototype.readFloatBE=function(e,t){return e>>>=0,t||et(e,4,this.length),Mr(this,e,!1,23,4)},F.prototype.readDoubleLE=function(e,t){return e>>>=0,t||et(e,8,this.length),Mr(this,e,!0,52,8)},F.prototype.readDoubleBE=function(e,t){return e>>>=0,t||et(e,8,this.length),Mr(this,e,!1,52,8)},F.prototype.writeUintLE=F.prototype.writeUIntLE=function(e,t,r,i){if(e*=1,t>>>=0,r>>>=0,!i){var s=Math.pow(2,8*r)-1;er(this,e,t,r,s,0)}var n=1,o=0;for(this[t]=255&e;++o<r&&(n*=256);)this[t+o]=e/n&255;return t+r},F.prototype.writeUintBE=F.prototype.writeUIntBE=function(e,t,r,i){if(e*=1,t>>>=0,r>>>=0,!i){var s=Math.pow(2,8*r)-1;er(this,e,t,r,s,0)}var n=r-1,o=1;for(this[t+n]=255&e;--n>=0&&(o*=256);)this[t+n]=e/o&255;return t+r},F.prototype.writeUint8=F.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,1,255,0),this[t]=255&e,t+1},F.prototype.writeUint16LE=F.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},F.prototype.writeUint16BE=F.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},F.prototype.writeUint32LE=F.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},F.prototype.writeUint32BE=F.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},F.prototype.writeIntLE=function(e,t,r,i){if(e*=1,t>>>=0,!i){var s=Math.pow(2,8*r-1);er(this,e,t,r,s-1,-s)}var n=0,o=1,a=0;for(this[t]=255&e;++n<r&&(o*=256);)e<0&&0===a&&0!==this[t+n-1]&&(a=1),this[t+n]=(e/o|0)-a&255;return t+r},F.prototype.writeIntBE=function(e,t,r,i){if(e*=1,t>>>=0,!i){var s=Math.pow(2,8*r-1);er(this,e,t,r,s-1,-s)}var n=r-1,o=1,a=0;for(this[t+n]=255&e;--n>=0&&(o*=256);)e<0&&0===a&&0!==this[t+n+1]&&(a=1),this[t+n]=(e/o|0)-a&255;return t+r},F.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},F.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},F.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},F.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},F.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||er(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},F.prototype.writeFloatLE=function(e,t,r){return es(this,e,t,!0,r)},F.prototype.writeFloatBE=function(e,t,r){return es(this,e,t,!1,r)},F.prototype.writeDoubleLE=function(e,t,r){return en(this,e,t,!0,r)},F.prototype.writeDoubleBE=function(e,t,r){return en(this,e,t,!1,r)},F.prototype.copy=function(e,t,r,i){if(!F.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(i<0)throw RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var s=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),s},F.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw TypeError("encoding must be a string");if("string"==typeof i&&!F.isEncoding(i))throw TypeError("Unknown encoding: "+i);if(1===e.length){var s,n=e.charCodeAt(0);("utf8"===i&&n<128||"latin1"===i)&&(e=n)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var o=F.isBuffer(e)?e:F.from(e,i),a=o.length;if(0===a)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<r-t;++s)this[s+t]=o[s%a]}return this};var eo=/[^+/0-9A-Za-z-_]/g;function ea(e,t){t=t||1/0;for(var r,i=e.length,s=null,n=[],o=0;o<i;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!s){if(r>56319||o+1===i){(t-=3)>-1&&n.push(239,191,189);continue}s=r;continue}if(r<56320){(t-=3)>-1&&n.push(239,191,189),s=r;continue}r=(s-55296<<10|r-56320)+65536}else s&&(t-=3)>-1&&n.push(239,191,189);if(s=null,r<128){if((t-=1)<0)break;n.push(r)}else if(r<2048){if((t-=2)<0)break;n.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;n.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;n.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return n}function eh(e){return function(e){var t,r,i=function(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var i=r===t?0:4-r%4;return[r,i]}(e),s=i[0],n=i[1],o=new L((s+n)*3/4-n),a=0,h=n>0?s-4:s;for(r=0;r<h;r+=4)t=B[e.charCodeAt(r)]<<18|B[e.charCodeAt(r+1)]<<12|B[e.charCodeAt(r+2)]<<6|B[e.charCodeAt(r+3)],o[a++]=t>>16&255,o[a++]=t>>8&255,o[a++]=255&t;return 2===n&&(t=B[e.charCodeAt(r)]<<2|B[e.charCodeAt(r+1)]>>4,o[a++]=255&t),1===n&&(t=B[e.charCodeAt(r)]<<10|B[e.charCodeAt(r+1)]<<4|B[e.charCodeAt(r+2)]>>2,o[a++]=t>>8&255,o[a++]=255&t),o}(function(e){if((e=(e=e.split("=")[0]).trim().replace(eo,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function ec(e,t,r,i){for(var s=0;s<i&&!(s+r>=t.length)&&!(s>=e.length);++s)t[s+r]=e[s];return s}function eu(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var el=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var i=16*r,s=0;s<16;++s)t[i+s]=e[r]+e[s];return t}();function ef(e,...t){try{var r;return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}}function ed(e){if(function(e){let t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){let t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return ed(e.toJSON());throw Error("[unstorage] Cannot stringify value!")}const ep="base64:";function eg(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function eb(e){return(e=eg(e))?e+":":""}function ey(e,t,r){return e.watch?e.watch((e,i)=>t(e,r+i)):()=>{}}async function em(e){"function"==typeof e.dispose&&await ef(e.dispose)}function ev(e){return new Promise(function(t,r){e.oncomplete=e.onsuccess=function(){return t(e.result)},e.onabort=e.onerror=function(){return r(e.error)}})}function ew(e,t){var r,i=function(){if(r)return r;var i=indexedDB.open(e);return i.onupgradeneeded=function(){return i.result.createObjectStore(t)},(r=ev(i)).then(function(e){e.onclose=function(){return r=void 0}},function(){}),r};return function(e,r){return i().then(function(i){return r(i.transaction(t,e).objectStore(t))})}}function eD(){return Ms||(Ms=ew("keyval-store","keyval")),Ms}function ex(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD();return t("readonly",function(t){return ev(t.get(e))})}function eE(e){if("string"!=typeof e)throw Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3'),(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t)}catch(t){return e}}function e_(e){return"string"==typeof e?e:JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t)||""}class eS{constructor(){this.indexedDb=function(e={}){let t={mounts:{"":e.driver||(()=>{let e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}})()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(let r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),s=(e,r)=>{if(t.watching)for(let i of(r=eg(r),t.watchListeners))i(e,r)},n=async()=>{if(!t.watching)for(let e in t.watching=!0,t.mounts)t.unwatch[e]=await ey(t.mounts[e],s,e)},o=async()=>{if(t.watching){for(let e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},a=(e,t,i)=>{let s=new Map,n=e=>{let t=s.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},s.set(e.base,t)),t};for(let i of e){let e="string"==typeof i,s=eg(e?i:i.key),o=e?void 0:i.value,a=e||!i.options?t:{...t,...i.options},h=r(s);n(h).items.push({key:s,value:o,relativeKey:h.relativeKey,options:a})}return Promise.all([...s.values()].map(e=>i(e))).then(e=>e.flat())},h={hasItem(e,t={}){let{relativeKey:i,driver:s}=r(e=eg(e));return ef(s.hasItem,i,t)},getItem(e,t={}){let{relativeKey:i,driver:s}=r(e=eg(e));return ef(s.getItem,i,t).then(e=>T(e))},getItems:(e,t={})=>a(e,t,e=>e.driver.getItems?ef(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:function(...e){return eg(e.join(":"))}(e.base,t.key),value:T(t.value)}))):Promise.all(e.items.map(t=>ef(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:T(e)}))))),getItemRaw(e,t={}){let{relativeKey:i,driver:s}=r(e=eg(e));return s.getItemRaw?ef(s.getItemRaw,i,t):ef(s.getItem,i,t).then(e=>{var t;return"string"==typeof e&&e.startsWith(ep)?(t=e.slice(ep.length),globalThis.Buffer?F.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))):e})},async setItem(e,t,i={}){if(void 0===t)return h.removeItem(e);let{relativeKey:n,driver:o}=r(e=eg(e));o.setItem&&(await ef(o.setItem,n,ed(t),i),o.watch||s("update",e))},async setItems(e,t){await a(e,t,async e=>{if(e.driver.setItems)return ef(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:ed(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>ef(e.driver.setItem,t.relativeKey,ed(t.value),t.options)))})},async setItemRaw(e,t,i={}){if(void 0===t)return h.removeItem(e,i);let{relativeKey:n,driver:o}=r(e=eg(e));if(o.setItemRaw)await ef(o.setItemRaw,n,t,i);else{var a;if(!o.setItem)return;await ef(o.setItem,n,"string"==typeof t?t:ep+(a=t,globalThis.Buffer?F.from(a).toString("base64"):globalThis.btoa(String.fromCodePoint(...a))),i)}o.watch||s("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t});let{relativeKey:i,driver:n}=r(e=eg(e));n.removeItem&&(await ef(n.removeItem,i,t),(t.removeMeta||t.removeMata)&&await ef(n.removeItem,i+"$",t),n.watch||s("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t});let{relativeKey:i,driver:s}=r(e=eg(e)),n=Object.create(null);if(s.getMeta&&Object.assign(n,await ef(s.getMeta,i,t)),!t.nativeOnly){let e=await ef(s.getItem,i+"$",t).then(e=>T(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(n,e))}return n},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){let r=i(e=eb(e),!0),s=[],n=[],o=!0;for(let e of r){for(let r of(e.driver.flags?.maxDepth||(o=!1),await ef(e.driver.getKeys,e.relativeBase,t))){let t=e.mountpoint+eg(r);s.some(e=>t.startsWith(e))||n.push(t)}s=[e.mountpoint,...s.filter(t=>!t.startsWith(e.mountpoint))]}let a=void 0!==t.maxDepth&&!o;return n.filter(r=>{var i;return(!a||function(e,t){if(void 0===t)return!0;let r=0,i=e.indexOf(":");for(;i>-1;)r++,i=e.indexOf(":",i+1);return r<=t}(r,t.maxDepth))&&((i=e)?r.startsWith(i)&&"$"!==r[r.length-1]:"$"!==r[r.length-1])})},async clear(e,t={}){e=eb(e),await Promise.all(i(e,!1).map(async e=>e.driver.clear?ef(e.driver.clear,e.relativeBase,t):e.driver.removeItem?Promise.all((await e.driver.getKeys(e.relativeBase||"",t)).map(r=>e.driver.removeItem(r,t))):void 0))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>em(e)))},watch:async e=>(await n(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=eb(e))&&t.mounts[e])throw Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(ey(r,s,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),h},async unmount(e,r=!0){(e=eb(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await em(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){let t=r(e=eg(e)+":");return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>i(e=eg(e),t.parents).map(e=>({driver:e.driver,base:e.mountpoint})),keys:(e,t={})=>h.getKeys(e,t),get:(e,t={})=>h.getItem(e,t),set:(e,t,r={})=>h.setItem(e,t,r),has:(e,t={})=>h.hasItem(e,t),del:(e,t={})=>h.removeItem(e,t),remove:(e,t={})=>h.removeItem(e,t)};return h}({driver:((e={})=>{let t,r=e.base&&e.base.length>0?`${e.base}:`:"";return e.dbName&&e.storeName&&(t=ew(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await ex(r+e,t)>"u"),getItem:async e=>await ex(r+e,t)??null,setItem:(e,i)=>(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:eD();return r("readwrite",function(r){return r.put(t,e),ev(r.transaction)})})(r+e,i,t),removeItem:e=>(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:eD();return t("readwrite",function(t){return t.delete(e),ev(t.transaction)})})(r+e,t),getKeys:()=>(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eD();return e("readonly",function(e){if(e.getAllKeys)return ev(e.getAllKeys());var t,r=[];return(t=function(e){return r.push(e.key)},e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},ev(e.transaction)).then(function(){return r})})})(t),clear:()=>(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eD();return e("readwrite",function(e){return e.clear(),ev(e.transaction)})})(t)}})({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){let t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,e_(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var eI="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof t?t:"u">typeof self?self:{},eA={exports:{}};function eM(e){var t;return[e[0],eE(null!=(t=e[1])?t:"")]}function eO(){}eO.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},eO.prototype.setItem=function(e,t){this[e]=String(t)},eO.prototype.removeItem=function(e){delete this[e]},eO.prototype.clear=function(){let e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},eO.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},eO.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof eI&&eI.localStorage?eA.exports=eI.localStorage:"u">typeof window&&window.localStorage?eA.exports=window.localStorage:eA.exports=new eO;class eC{constructor(){this.localStorage=eA.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(eM)}async getItem(e){let t=this.localStorage.getItem(e);if(null!==t)return eE(t)}async setItem(e,t){this.localStorage.setItem(e,e_(t))}async removeItem(e){this.localStorage.removeItem(e)}}const eP=async(e,t,r)=>{let i="wc_storage_version",s=await t.getItem(i);if(s&&s>=1)return void r(t);let n=await e.getKeys();if(!n.length)return void r(t);let o=[];for(;n.length;){let r=n.shift();if(!r)continue;let i=r.toLowerCase();if(i.includes("wc@")||i.includes("walletconnect")||i.includes("wc_")||i.includes("wallet_connect")){let i=await e.getItem(r);await t.setItem(r,i),o.push(r)}}await t.setItem(i,1),r(t),eR(e,o)},eR=async(e,t)=>{t.length&&t.forEach(async t=>{await e.removeItem(t)})};class eT{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};let e=new eC;this.storage=e;try{let t=new eS;eP(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{let t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}var eN={},eB={};function eL(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}eB=function(e,t,r){var i=r&&r.stringify||eL;if("object"==typeof e&&null!==e){var s=t.length+1;if(1===s)return e;var n=Array(s);n[0]=i(e);for(var o=1;o<s;o++)n[o]=i(t[o]);return n.join(" ")}if("string"!=typeof e)return e;var a=t.length;if(0===a)return e;for(var h="",c=0,u=-1,l=e&&e.length||0,f=0;f<l;){if(37===e.charCodeAt(f)&&f+1<l){switch(u=u>-1?u:0,e.charCodeAt(f+1)){case 100:case 102:if(c>=a||null==t[c])break;u<f&&(h+=e.slice(u,f)),h+=Number(t[c]),u=f+2,f++;break;case 105:if(c>=a||null==t[c])break;u<f&&(h+=e.slice(u,f)),h+=Math.floor(Number(t[c])),u=f+2,f++;break;case 79:case 111:case 106:if(c>=a||void 0===t[c])break;u<f&&(h+=e.slice(u,f));var d=typeof t[c];if("string"===d){h+="'"+t[c]+"'",u=f+2,f++;break}if("function"===d){h+=t[c].name||"<anonymous>",u=f+2,f++;break}h+=i(t[c]),u=f+2,f++;break;case 115:if(c>=a)break;u<f&&(h+=e.slice(u,f)),h+=String(t[c]),u=f+2,f++;break;case 37:u<f&&(h+=e.slice(u,f)),h+="%",u=f+2,f++,c--}++c}++f}return -1===u?e:(u<l&&(h+=e.slice(u)),h)},eN=e$;const eU=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function ek(e,t){return"silent"===e?1/0:t.levels.values[e]}const eq=Symbol("pino.logFuncs"),ej=Symbol("pino.hierarchy"),ez={error:"log",fatal:"error",warn:"error",info:"log",debug:"log",trace:"log"};function eF(e,t){let r={logger:t,parent:e[ej]};t[ej]=r}function e$(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let s=e.browser.write||eU;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(n)),a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1);let h=Object.keys(e.customLevels||{}),c=["error","fatal","warn","info","debug","trace"].concat(h);"function"==typeof s&&c.forEach(function(e){s[e]=s}),(!1===e.enabled||e.browser.disabled)&&(e.level="silent");let u=e.level||"info",l=Object.create(s);l.log||(l.log=eJ);let f={};c.forEach(e=>{f[e]=s[e]?s[e]:eU[e]||eU[ez[e]||"log"]||eJ}),l[eq]=f,eF({},l),Object.defineProperty(l,"levelVal",{get:function(){return ek(this.level,this)}}),Object.defineProperty(l,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,eK(this,d,l,"error"),eK(this,d,l,"fatal"),eK(this,d,l,"warn"),eK(this,d,l,"info"),eK(this,d,l,"debug"),eK(this,d,l,"trace"),h.forEach(e=>{eK(this,d,l,e)})}});let d={transmit:i,serialize:o,asObject:e.browser.asObject,asObjectBindingsOnly:e.browser.asObjectBindingsOnly,formatters:e.browser.formatters,levels:c,timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?eZ:eX,messageKey:e.messageKey||"msg",onChild:e.onChild||eJ};function p(t,r,s){if(!r)throw Error("missing bindings for child Pino");s=s||{},o&&r.serializers&&(s.serializers=r.serializers);let a=s.serializers;if(o&&a){var h=Object.assign({},n,a),c=!0===e.browser.serialize?Object.keys(h):o;delete r.serializers,eV([r],c,h,this._stdErrSerialize)}function u(e){this._childLevel=(0|e._childLevel)+1,this.bindings=r,h&&(this.serializers=h,this._serialize=c),i&&(this._logEvent=eH([].concat(e._logEvent.bindings,r)))}u.prototype=this;let l=new u(this);return eF(this,l),l.child=function(...e){return p.call(this,t,...e)},l.level=s.level||this.level,t.onChild(l),l}return l.levels=function(e){let t=e.customLevels||{};return{values:Object.assign({},e$.levels.values,t),labels:Object.assign({},e$.levels.labels,function(e){let t={};return Object.keys(e).forEach(function(r){t[e[r]]=r}),t}(t))}}(e),l.level=u,l.isLevelEnabled=function(e){return!!this.levels.values[e]&&this.levels.values[e]>=this.levels.values[this.level]},l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=eJ,l.serializers=n,l._serialize=o,l._stdErrSerialize=a,l.child=function(...e){return p.call(this,d,...e)},i&&(l._logEvent=eH()),l}function eK(e,t,r,i){var s,n,o,a,h,c,u;if(Object.defineProperty(e,i,{value:ek(e.level,r)>ek(i,r)?eJ:r[eq][i],writable:!0,enumerable:!0,configurable:!0}),e[i]===eJ){if(!t.transmit)return;let s=ek(t.transmit.level||e.level,r);if(ek(i,r)<s)return}e[i]=(s=e,n=t,o=r,a=i,h=s[eq][a],function(){let e=n.timestamp(),t=Array(arguments.length),r=Object.getPrototypeOf&&Object.getPrototypeOf(this)===eU?eU:this;for(var i=0;i<t.length;i++)t[i]=arguments[i];var c=!1;if(n.serialize&&(eV(t,this._serialize,this.serializers,this._stdErrSerialize),c=!0),n.asObject||n.formatters?h.call(r,...function(e,t,r,i,s){let{level:n,log:o=e=>e}=s.formatters||{},a=r.slice(),h=a[0],c={},u=(0|e._childLevel)+1;if(u<1&&(u=1),i&&(c.time=i),n?Object.assign(c,n(t,e.levels.values[t])):c.level=e.levels.values[t],s.asObjectBindingsOnly){if(null!==h&&"object"==typeof h)for(;u--&&"object"==typeof a[0];)Object.assign(c,a.shift());return[o(c),...a]}if(null!==h&&"object"==typeof h){for(;u--&&"object"==typeof a[0];)Object.assign(c,a.shift());h=a.length?eB(a.shift(),a):void 0}else"string"==typeof h&&(h=eB(a.shift(),a));return void 0!==h&&(c[s.messageKey]=h),[o(c)]}(this,a,t,e,n)):h.apply(r,t),n.transmit){let r=n.transmit.level||s._level,i=ek(r,o),h=ek(a,o);if(h<i)return;!function(e,t,r,i=!1){let s=t.send,n=t.ts,o=t.methodLevel,a=t.methodValue,h=t.val,c=e._logEvent.bindings;i||eV(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=n,e._logEvent.messages=r.filter(function(e){return -1===c.indexOf(e)}),e._logEvent.level.label=o,e._logEvent.level.value=a,s(o,e._logEvent,h),e._logEvent=eH(c)}(this,{ts:e,methodLevel:a,methodValue:h,transmitLevel:r,transmitValue:o.levels.values[n.transmit.level||s._level],send:n.transmit.send,val:ek(s._level,o)},t,c)}});let l=function(e){let t=[];e.bindings&&t.push(e.bindings);let r=e[ej];for(;r.parent;)(r=r.parent).logger.bindings&&t.push(r.logger.bindings);return t.reverse()}(e);0!==l.length&&(e[i]=(c=l,u=e[i],function(){return u.apply(this,[...c,...arguments])}))}function eV(e,t,r,i){for(let s in e)if(i&&e[s]instanceof Error)e[s]=e$.stdSerializers.err(e[s]);else if("object"==typeof e[s]&&!Array.isArray(e[s])&&t)for(let i in e[s])t.indexOf(i)>-1&&i in r&&(e[s][i]=r[i](e[s][i]))}function eH(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function eG(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}function eW(){return{}}function eY(e){return e}function eJ(){}function eZ(){return!1}function eX(){return Date.now()}e$.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},e$.stdSerializers={mapHttpRequest:eW,mapHttpResponse:eW,wrapRequestSerializer:eY,wrapResponseSerializer:eY,wrapErrorSerializer:eY,req:eW,res:eW,err:eG,errWithCause:eG},e$.stdTimeFunctions=Object.assign({},{nullTime:eZ,epochTime:eX,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}}),eN.default=e$,eN.pino=e$;const eQ="custom_context";var e0=Object.defineProperty,e1=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?e0(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class e2{constructor(e){e1(this,"nodeValue"),e1(this,"sizeInBytes"),e1(this,"next"),this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class e3{constructor(e){e1(this,"lengthInNodes"),e1(this,"sizeInBytes"),e1(this,"head"),e1(this,"tail"),e1(this,"maxSizeInBytes"),this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new e2(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}var e8=Object.defineProperty,e6=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?e8(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class e5{constructor(e,t=1024e3){e6(this,"logs"),e6(this,"level"),e6(this,"levelValue"),e6(this,"MAX_LOG_SIZE_IN_BYTES"),this.level=e??"error",this.levelValue=eN.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new e3(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===eN.levels.values.error?console.error(e):t===eN.levels.values.warn?console.warn(e):t===eN.levels.values.debug?console.debug(e):t===eN.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(e_({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new e3(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push(e_({extraMetadata:e})),new Blob(t,{type:"application/json"})}}var e4=Object.defineProperty;class e9{constructor(e,t=1024e3){var r,i;let s;(s="symbol"!=typeof(r="baseChunkLogger")?r+"":r)in this?e4(this,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):this[s]=i,this.baseChunkLogger=new e5(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}var e7=Object.defineProperty;class te{constructor(e,t=1024e3){var r,i;let s;(s="symbol"!=typeof(r="baseChunkLogger")?r+"":r)in this?e7(this,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):this[s]=i,this.baseChunkLogger=new e5(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var tt=Object.defineProperty,tr=Object.defineProperties,ti=Object.getOwnPropertyDescriptors,ts=Object.getOwnPropertySymbols,tn=Object.prototype.hasOwnProperty,to=Object.prototype.propertyIsEnumerable,ta=(e,t,r)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,th=(e,t)=>{for(var r in t||(t={}))tn.call(t,r)&&ta(e,r,t[r]);if(ts)for(var r of ts(t))to.call(t,r)&&ta(e,r,t[r]);return e},tc=(e,t)=>tr(e,ti(t));function tu(e,t=eQ){return e[t]||""}function tl(e,t,r=eQ){let i=function(e,t,r=eQ){let i=tu(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=eQ){return e[r]=t,e}(e.child({context:i}),i,r)}function tf(e){return"u">typeof e.loggerOverride&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:"u">typeof window?function(e){var t,i;let s=new e9(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r(eN)(tc(th({},e.opts),{level:"trace",browser:tc(th({},null==(i=e.opts)?void 0:i.browser),{write:e=>s.write(e)})})),chunkLoggerController:s}}(e):function(e){var t;let i=new te(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r(eN)(tc(th({},e.opts),{level:"trace"}),i),chunkLoggerController:i}}(e)}var td=Object.defineProperty,tp=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?td(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class tg extends _{constructor(e){super(),this.opts=e,tp(this,"protocol","wc"),tp(this,"version",2)}}var tb=Object.defineProperty;class ty extends _{constructor(e,t){var r,i;let s;super(),this.core=e,this.logger=t,r="records",i=new Map,(s="symbol"!=typeof r?r+"":r)in this?tb(this,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):this[s]=i}}class tm{constructor(e,t){this.logger=e,this.core=t}}class tv extends _{constructor(e,t){super(),this.relayer=e,this.logger=t}}class tw extends _{constructor(e){super()}}class tD{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class tx extends _{constructor(e,t){super(),this.relayer=e,this.logger=t}}class tE extends _{constructor(e,t){super(),this.core=e,this.logger=t}}class t_{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class tS{constructor(e,t){this.projectId=e,this.logger=t}}class tI{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var tA=Object.defineProperty,tM=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?tA(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class tO{constructor(e){this.opts=e,tM(this,"protocol","wc"),tM(this,"version",2)}}a.EventEmitter;class tC{constructor(e){this.client=e}}function tP(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function tR(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}const tT="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,tN=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function tB(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),tP(e),e}class tL{clone(){return this._cloneInto()}}function tU(e=32){if(tT&&"function"==typeof tT.getRandomValues)return tT.getRandomValues(new Uint8Array(e));if(tT&&"function"==typeof tT.randomBytes)return tT.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}class tk extends tL{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=tN(this.buffer)}update(e){tR(this);let{view:t,buffer:r,blockLen:i}=this,s=(e=tB(e)).length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=tN(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){tR(this),function(e,t){tP(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(0xffffffff),o=Number(r>>s&n),a=Number(r&n),h=4*!!i,c=4*!i;e.setUint32(t+h,o,i),e.setUint32(t+c,a,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=tN(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=a/4,c=this.get();if(h>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<h;e++)o.setUint32(4*e,c[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}const tq=BigInt(0x100000000-1),tj=BigInt(32),tz=(e,t,r)=>e>>>r,tF=(e,t,r)=>e<<32-r|t>>>r,t$=(e,t,r)=>e>>>r|t<<32-r,tK=(e,t,r)=>e<<32-r|t>>>r,tV=(e,t,r)=>e<<64-r|t>>>r-32,tH=(e,t,r)=>e>>>r-32|t<<64-r,tG=function(e,t,r,i){let s=(t>>>0)+(i>>>0);return{h:e+r+(s/0x100000000|0)|0,l:0|s}},tW=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),tY=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0,tJ=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),tZ=(e,t,r,i,s)=>t+r+i+s+(e/0x100000000|0)|0,tX=(e,t,r,i,s,n)=>t+r+i+s+n+(e/0x100000000|0)|0,tQ=(e,t,r,i,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(s>>>0),[t0,t1]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&tq),l:Number(e>>tj&tq)}:{h:0|Number(e>>tj&tq),l:0|Number(e&tq)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),t2=new Uint32Array(80),t3=new Uint32Array(80);class t8 extends tk{constructor(){super(128,64,16,!1),this.Ah=0x6a09e667,this.Al=-0xc4336f8,this.Bh=-0x4498517b,this.Bl=-0x7b3558c5,this.Ch=0x3c6ef372,this.Cl=-0x16b07d5,this.Dh=-0x5ab00ac6,this.Dl=0x5f1d36f1,this.Eh=0x510e527f,this.El=-0x52197d2f,this.Fh=-0x64fa9774,this.Fl=0x2b3e6c1f,this.Gh=0x1f83d9ab,this.Gl=-0x4be4295,this.Hh=0x5be0cd19,this.Hl=0x137e2179}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:n,Dh:o,Dl:a,Eh:h,El:c,Fh:u,Fl:l,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g]}set(e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|n,this.Dh=0|o,this.Dl=0|a,this.Eh=0|h,this.El=0|c,this.Fh=0|u,this.Fl=0|l,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)t2[r]=e.getUint32(t),t3[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|t2[e-15],r=0|t3[e-15],i=t$(t,r,1)^t$(t,r,8)^tz(t,r,7),s=tK(t,r,1)^tK(t,r,8)^tF(t,r,7),n=0|t2[e-2],o=0|t3[e-2],a=t$(n,o,19)^tV(n,o,61)^tz(n,o,6),h=tJ(s,tK(n,o,19)^tH(n,o,61)^tF(n,o,6),t3[e-7],t3[e-16]),c=tZ(h,i,a,t2[e-7],t2[e-16]);t2[e]=0|c,t3[e]=0|h}let{Ah:r,Al:i,Bh:s,Bl:n,Ch:o,Cl:a,Dh:h,Dl:c,Eh:u,El:l,Fh:f,Fl:d,Gh:p,Gl:g,Hh:b,Hl:y}=this;for(let e=0;e<80;e++){let t=t$(u,l,14)^t$(u,l,18)^tV(u,l,41),m=tK(u,l,14)^tK(u,l,18)^tH(u,l,41),v=u&f^~u&p,w=tQ(y,m,l&d^~l&g,t1[e],t3[e]),D=tX(w,b,t,v,t0[e],t2[e]),x=0|w,E=t$(r,i,28)^tV(r,i,34)^tV(r,i,39),_=tK(r,i,28)^tH(r,i,34)^tH(r,i,39),S=r&s^r&o^s&o,I=i&n^i&a^n&a;b=0|p,y=0|g,p=0|f,g=0|d,f=0|u,d=0|l,({h:u,l:l}=tG(0|h,0|c,0|D,0|x)),h=0|o,c=0|a,o=0|s,a=0|n,s=0|r,n=0|i;let A=tW(x,_,I);r=tY(A,D,E,S),i=0|A}({h:r,l:i}=tG(0|this.Ah,0|this.Al,0|r,0|i)),({h:s,l:n}=tG(0|this.Bh,0|this.Bl,0|s,0|n)),({h:o,l:a}=tG(0|this.Ch,0|this.Cl,0|o,0|a)),({h:h,l:c}=tG(0|this.Dh,0|this.Dl,0|h,0|c)),({h:u,l:l}=tG(0|this.Eh,0|this.El,0|u,0|l)),({h:f,l:d}=tG(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:g}=tG(0|this.Gh,0|this.Gl,0|p,0|g)),({h:b,l:y}=tG(0|this.Hh,0|this.Hl,0|b,0|y)),this.set(r,i,s,n,o,a,h,c,u,l,f,d,p,g,b,y)}roundClean(){t2.fill(0),t3.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const t6=function(e){let t=t=>e().update(tB(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new t8),t5=BigInt(0),t4=BigInt(1),t9=BigInt(2);function t7(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function re(e){if(!t7(e))throw Error("Uint8Array expected")}function rt(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}const rr=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function ri(e){re(e);let t="";for(let r=0;r<e.length;r++)t+=rr[e[r]];return t}function rs(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?t5:BigInt("0x"+e)}function rn(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function ro(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=rn(e.charCodeAt(s)),n=rn(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function ra(e){return re(e),rs(ri(Uint8Array.from(e).reverse()))}function rh(e,t){return ro(e.toString(16).padStart(2*t,"0"))}function rc(e,t){return rh(e,t).reverse()}function ru(e,t,r){let i;if("string"==typeof t)try{i=ro(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(t7(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}function rl(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];re(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}const rf=e=>"bigint"==typeof e&&t5<=e;function rd(e,t,r,i){if(!(rf(t)&&rf(r)&&rf(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}const rp={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||t7(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function rg(e,t,r={}){let i=(t,r,i)=>{let s=rp[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function rb(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}}const ry=BigInt(0),rm=BigInt(1),rv=BigInt(2),rw=BigInt(3),rD=BigInt(4),rx=BigInt(5),rE=BigInt(8);function r_(e,t){let r=e%t;return r>=ry?r:t+r}function rS(e,t,r){let i=e;for(;t-- >ry;)i*=i,i%=r;return i}function rI(e,t){if(e===ry)throw Error("invert: expected non-zero number");if(t<=ry)throw Error("invert: expected positive modulus, got "+t);let r=r_(e,t),i=t,s=ry,n=rm;for(;r!==ry;){let e=i/r,t=i%r,o=s-n*e;i=r,r=t,s=n,n=o}if(i!==rm)throw Error("invert: does not exist");return r_(s,t)}const rA=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function rM(e,t){let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function rO(e,t,r=!1,i={}){let s;if(e<=ry)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:n,nByteLength:o}=rM(e,t);if(o>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:n,BYTES:o,MASK:(t9<<BigInt(n-1))-t4,ZERO:ry,ONE:rm,create:t=>r_(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return ry<=t&&t<e},is0:e=>e===ry,isOdd:e=>(e&rm)===rm,neg:t=>r_(-t,e),eql:(e,t)=>e===t,sqr:t=>r_(t*t,e),add:(t,r)=>r_(t+r,e),sub:(t,r)=>r_(t-r,e),mul:(t,r)=>r_(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<ry)throw Error("invalid exponent, negatives unsupported");if(r===ry)return e.ONE;if(r===rm)return t;let i=e.ONE,s=t;for(;r>ry;)r&rm&&(i=e.mul(i,s)),s=e.sqr(s),r>>=rm;return i})(a,e,t),div:(t,r)=>r_(t*rI(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>rI(t,e),sqrt:i.sqrt||(t=>(s||(s=function(e){if(e%rD===rw){let t=(e+rm)/rD;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(e%rE===rx){let t=(e-rx)/rE;return function(e,r){let i=e.mul(r,rv),s=e.pow(i,t),n=e.mul(r,s),o=e.mul(e.mul(n,rv),s),a=e.mul(n,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),r))throw Error("Cannot find square root");return a}}return function(e){let t,r,i,s=(e-rm)/rv;for(t=e-rm,r=0;t%rv===ry;t/=rv,r++);for(i=rv;i<e&&function(e,t,r){if(t<ry)throw Error("invalid exponent, negatives unsupported");if(r<=ry)throw Error("invalid modulus");if(r===rm)return ry;let i=rm;for(;t>ry;)t&rm&&(i=i*e%r),e=e*e%r,t>>=rm;return i}(i,s,e)!==e-rm;i++)if(i>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let t=(e+rm)/rD;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let n=(t+rm)/rv;return function(e,o){if(e.pow(o,s)===e.neg(e.ONE))throw Error("Cannot find square root");let a=r,h=e.pow(e.mul(e.ONE,i),t),c=e.pow(o,n),u=e.pow(o,t);for(;!e.eql(u,e.ONE);){if(e.eql(u,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(u);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(h,rm<<BigInt(a-t-1));h=e.sqr(r),c=e.mul(c,r),u=e.mul(u,h),a=t}return c}}(e)}(e)),s(a,t))),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,s)=>e.is0(i)?t:(r[s]=t,e.mul(t,i)),e.ONE),s=e.inv(i);return t.reduceRight((t,i,s)=>e.is0(i)?t:(r[s]=e.mul(t,r[s]),e.mul(t,i)),s),r})(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?rc(e,o):rh(e,o),fromBytes:e=>{if(e.length!==o)throw Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?ra(e):rs(ri(e))}});return Object.freeze(a)}const rC=BigInt(0),rP=BigInt(1);function rR(e,t){let r=t.negate();return e?r:t}function rT(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function rN(e,t){return rT(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}const rB=new WeakMap,rL=new WeakMap;function rU(e){return rL.get(e)||1}const rk=BigInt(0),rq=BigInt(1),rj=BigInt(2),rz=BigInt(8),rF={zip215:!0};BigInt(0),BigInt(1);const r$=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),rK=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const rV=BigInt(1),rH=BigInt(2);BigInt(3);const rG=BigInt(5),rW=BigInt(8),rY=rO(r$,void 0,!0),rJ=function(e){var t;let r=function(e){let t=(rg(e.Fp,rA.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),rg(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...rM(e.n,e.nBitLength),...e,p:e.Fp.ORDER}));return rg(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:i,n:s,prehash:n,hash:o,randomBytes:a,nByteLength:h,h:c}=r,u=rj<<BigInt(8*h)-rq,l=i.create,f=rO(r.n,r.nBitLength),d=r.uvRatio||((e,t)=>{try{return{isValid:!0,value:i.sqrt(e*i.inv(t))}}catch{return{isValid:!1,value:rk}}}),p=r.adjustScalarBytes||(e=>e),g=r.domain||((e,t,r)=>{if(rt("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function b(e,t){rd("coordinate "+e,t,rk,u)}function y(e){if(!(e instanceof w))throw Error("ExtendedPoint expected")}let m=rb((e,t)=>{let{ex:r,ey:s,ez:n}=e,o=e.is0();null==t&&(t=o?rz:i.inv(n));let a=l(r*t),h=l(s*t),c=l(n*t);if(o)return{x:rk,y:rq};if(c!==rq)throw Error("invZ was invalid");return{x:a,y:h}}),v=rb(e=>{let{a:t,d:i}=r;if(e.is0())throw Error("bad point: ZERO");let{ex:s,ey:n,ez:o,et:a}=e,h=l(s*s),c=l(n*n),u=l(o*o),f=l(u*u),d=l(h*t);if(l(u*l(d+c))!==l(f+l(i*l(h*c))))throw Error("bad point: equation left != right (1)");if(l(s*n)!==l(o*a))throw Error("bad point: equation left != right (2)");return!0});class w{constructor(e,t,r,i){this.ex=e,this.ey=t,this.ez=r,this.et=i,b("x",e),b("y",t),b("z",r),b("t",i),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof w)throw Error("extended point not allowed");let{x:t,y:r}=e||{};return b("x",t),b("y",r),new w(t,r,rq,l(t*r))}static normalizeZ(e){let t=i.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(w.fromAffine)}static msm(e,t){return function(e,t,r,i){if(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let s=e.ZERO,n=function(e){let t;for(t=0;e>t5;e>>=t4,t+=1);return t}(BigInt(r.length)),o=n>12?n-3:n>4?n-2:n?2:1,a=(1<<o)-1,h=Array(a+1).fill(s),c=Math.floor((t.BITS-1)/o)*o,u=s;for(let e=c;e>=0;e-=o){h.fill(s);for(let t=0;t<i.length;t++){let s=Number(i[t]>>BigInt(e)&BigInt(a));h[s]=h[s].add(r[t])}let t=s;for(let e=h.length-1,r=s;e>0;e--)r=r.add(h[e]),t=t.add(r);if(u=u.add(t),0!==e)for(let e=0;e<o;e++)u=u.double()}return u}(w,f,e,t)}_setWindowSize(e){E.setWindowSize(this,e)}assertValidity(){v(this)}equals(e){y(e);let{ex:t,ey:r,ez:i}=this,{ex:s,ey:n,ez:o}=e,a=l(t*o),h=l(s*i),c=l(r*o),u=l(n*i);return a===h&&c===u}is0(){return this.equals(w.ZERO)}negate(){return new w(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){let{a:e}=r,{ex:t,ey:i,ez:s}=this,n=l(t*t),o=l(i*i),a=l(rj*l(s*s)),h=l(e*n),c=t+i,u=l(l(c*c)-n-o),f=h+o,d=f-a,p=h-o,g=l(u*d),b=l(f*p),y=l(u*p);return new w(g,b,l(d*f),y)}add(e){y(e);let{a:t,d:i}=r,{ex:s,ey:n,ez:o,et:a}=this,{ex:h,ey:c,ez:u,et:f}=e;if(t===BigInt(-1)){let e=l((n-s)*(c+h)),t=l((n+s)*(c-h)),r=l(t-e);if(r===rk)return this.double();let i=l(o*rj*f),d=l(a*rj*u),p=d+i,g=t+e,b=d-i,y=l(p*r),m=l(g*b),v=l(p*b);return new w(y,m,l(r*g),v)}let d=l(s*h),p=l(n*c),g=l(a*i*f),b=l(o*u),m=l((s+n)*(h+c)-d-p),v=b-g,D=b+g,x=l(p-t*d),E=l(m*v),_=l(D*x),S=l(m*x);return new w(E,_,l(v*D),S)}subtract(e){return this.add(e.negate())}wNAF(e){return E.wNAFCached(this,e,w.normalizeZ)}multiply(e){rd("scalar",e,rq,s);let{p:t,f:r}=this.wNAF(e);return w.normalizeZ([t,r])[0]}multiplyUnsafe(e,t=w.ZERO){return rd("scalar",e,rk,s),e===rk?x:this.is0()||e===rq?this:E.wNAFCachedUnsafe(this,e,w.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return E.unsafeLadder(this,s).is0()}toAffine(e){return m(this,e)}clearCofactor(){let{h:e}=r;return e===rq?this:this.multiplyUnsafe(e)}static fromHex(e,t=!1){let{d:s,a:n}=r,o=i.BYTES;e=ru("pointHex",e,o),rt("zip215",t);let a=e.slice(),h=e[o-1];a[o-1]=-129&h;let c=ra(a);rd("pointHex.y",c,rk,t?u:i.ORDER);let f=l(c*c),{isValid:p,value:g}=d(l(f-rq),l(s*f-n));if(!p)throw Error("Point.fromHex: invalid y coordinate");let b=(g&rq)===rq,y=(128&h)!=0;if(!t&&g===rk&&y)throw Error("Point.fromHex: x=0 and x_0=1");return y!==b&&(g=l(-g)),w.fromAffine({x:g,y:c})}static fromPrivateKey(e){return _(e).point}toRawBytes(){let{x:e,y:t}=this.toAffine(),r=rc(t,i.BYTES);return r[r.length-1]|=e&rq?128:0,r}toHex(){return ri(this.toRawBytes())}}w.BASE=new w(r.Gx,r.Gy,rq,l(r.Gx*r.Gy)),w.ZERO=new w(rk,rq,rq,rk);let{BASE:D,ZERO:x}=w,E=(t=8*h,{constTimeNegate:rR,hasPrecomputes:e=>1!==rU(e),unsafeLadder(e,t,r=w.ZERO){let i=e;for(;t>rC;)t&rP&&(r=r.add(i)),i=i.double(),t>>=rP;return r},precomputeWindow(e,r){let{windows:i,windowSize:s}=rN(r,t),n=[],o=e,a=o;for(let e=0;e<i;e++){a=o,n.push(a);for(let e=1;e<s;e++)a=a.add(o),n.push(a);o=a.double()}return n},wNAF(e,r,i){let{windows:s,windowSize:n}=rN(e,t),o=w.ZERO,a=w.BASE,h=BigInt(2**e-1),c=2**e,u=BigInt(e);for(let e=0;e<s;e++){let t=e*n,s=Number(i&h);i>>=u,s>n&&(s-=c,i+=rP);let l=t+Math.abs(s)-1,f=e%2!=0,d=s<0;0===s?a=a.add(rR(f,r[t])):o=o.add(rR(d,r[l]))}return{p:o,f:a}},wNAFUnsafe(e,r,i,s=w.ZERO){let{windows:n,windowSize:o}=rN(e,t),a=BigInt(2**e-1),h=2**e,c=BigInt(e);for(let e=0;e<n;e++){let t=e*o;if(i===rC)break;let n=Number(i&a);if(i>>=c,n>o&&(n-=h,i+=rP),0===n)continue;let u=r[t+Math.abs(n)-1];n<0&&(u=u.negate()),s=s.add(u)}return s},getPrecomputes(e,t,r){let i=rB.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&rB.set(t,r(i))),i},wNAFCached(e,t,r){let i=rU(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let s=rU(e);return 1===s?this.unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)},setWindowSize(e,r){rT(r,t),rL.set(e,r),rB.delete(e)}});function _(e){let t=i.BYTES;e=ru("private key",e,t);let r=ru("hashed private key",o(e),2*t),n=p(r.slice(0,t)),a=r.slice(t,2*t),h=r_(ra(n),s),c=D.multiply(h),u=c.toRawBytes();return{head:n,prefix:a,scalar:h,point:c,pointBytes:u}}function S(e=new Uint8Array,...t){return r_(ra(o(g(rl(...t),ru("context",e),!!n))),s)}return D._setWindowSize(8),{CURVE:r,getPublicKey:function(e){return _(e).pointBytes},sign:function(e,t,r={}){e=ru("message",e),n&&(e=n(e));let{prefix:o,scalar:a,pointBytes:h}=_(t),c=S(r.context,o,e),u=D.multiply(c).toRawBytes(),l=r_(c+S(r.context,u,h,e)*a,s);return rd("signature.s",l,rk,s),ru("result",rl(u,rc(l,i.BYTES)),2*i.BYTES)},verify:function(e,t,r,s=rF){let o,a,h,{context:c,zip215:u}=s,l=i.BYTES;e=ru("signature",e,2*l),t=ru("message",t),r=ru("publicKey",r,l),void 0!==u&&rt("zip215",u),n&&(t=n(t));let f=ra(e.slice(l,2*l));try{o=w.fromHex(r,u),a=w.fromHex(e.slice(0,l),u),h=D.multiplyUnsafe(f)}catch{return!1}if(!u&&o.isSmallOrder())return!1;let d=S(c,a.toRawBytes(),o.toRawBytes(),t);return a.add(o.multiplyUnsafe(d)).subtract(h).clearCofactor().equals(w.ZERO)},ExtendedPoint:w,utils:{getExtendedPublicKey:_,randomPrivateKey:()=>a(i.BYTES),precompute:(e=8,t=w.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:rY,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:rW,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:t6,randomBytes:tU,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){let r=r_(t*t*t,r$),i=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%r$*e%r$,o=rS(n,rH,r$)*n%r$,a=rS(o,rV,r$)*e%r$,h=rS(a,rG,r$)*a%r$,c=rS(h,t,r$)*h%r$,u=rS(c,r,r$)*c%r$,l=rS(u,i,r$)*u%r$,f=rS(l,s,r$)*l%r$,d=rS(f,s,r$)*l%r$,p=rS(d,t,r$)*h%r$;return{pow_p_5_8:rS(p,rH,r$)*e%r$,b2:n}}(e*r_(r*r*t,r$)).pow_p_5_8,s=r_(e*r*i,r$),n=r_(t*s*s,r$),o=s,a=r_(s*rK,r$),h=n===e,c=n===r_(-e,r$),u=n===r_(-e*rK,r$);return h&&(s=o),(c||u)&&(s=a),(r_(s,r$)&rm)===rm&&(s=r_(-s,r$)),{isValid:h||c,value:s}}}),rZ="base64url",rX="utf8",rQ="utf8",r0="base58btc";function r1(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function r2(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?r1(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function r3(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=r2(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return r1(r)}var r8=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,h=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===h;)i++,t++;for(var n=(e.length-t)*c+1>>>0,o=new Uint8Array(n);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var l=0,f=n-1;(0!==u||l<s)&&-1!==f;f--,l++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=l,t++}if(" "!==e[t]){for(var d=n-s;d!==n&&0===o[d];)d++;for(var p=new Uint8Array(i+(n-d)),g=i;d!==n;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*u+1>>>0,c=new Uint8Array(o);s!==n;){for(var l=t[s],f=0,d=o-1;(0!==l||f<i)&&-1!==d;d--,f++)l+=256*c[d]>>>0,c[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw Error("Non-zero carry");i=f,s++}for(var p=o-i;p!==o&&0===c[p];)p++;for(var g=h.repeat(r);p<o;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw Error(`Non-${t} character`)}}};const r6=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class r5{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class r4{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return r7(this,e)}}class r9{constructor(e){this.decoders=e}or(e){return r7(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const r7=(e,t)=>new r9({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class ie{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new r5(e,t,r),this.decoder=new r4(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const it=({name:e,prefix:t,encode:r,decode:i})=>new ie(e,t,r,i),ir=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=r8(r,t);return it({prefix:e,name:t,encode:i,decode:e=>r6(s(e))})},ii=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>it({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n})(e,i,r),decode:t=>((e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,h=0,c=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);h=h<<r|n,(a+=r)>=8&&(a-=8,o[c++]=255&h>>a)}if(a>=r||255&h<<8-a)throw SyntaxError("Unexpected end of data");return o})(t,i,r,e)});var is=Object.freeze({__proto__:null,identity:it({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),io=Object.freeze({__proto__:null,base2:ii({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),ia=Object.freeze({__proto__:null,base8:ii({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),ih=Object.freeze({__proto__:null,base10:ir({prefix:"9",name:"base10",alphabet:"0123456789"})}),ic=Object.freeze({__proto__:null,base16:ii({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:ii({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});const iu=ii({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),il=ii({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),id=ii({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ip=ii({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ig=ii({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ib=ii({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),iy=ii({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var im=Object.freeze({__proto__:null,base32:iu,base32upper:il,base32pad:id,base32padupper:ip,base32hex:ig,base32hexupper:ib,base32hexpad:iy,base32hexpadupper:ii({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:ii({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),iv=Object.freeze({__proto__:null,base36:ir({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:ir({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),iw=Object.freeze({__proto__:null,base58btc:ir({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:ir({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});const iD=ii({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),ix=ii({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var iE=Object.freeze({__proto__:null,base64:iD,base64pad:ix,base64url:ii({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:ii({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});const i_=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),iS=i_.reduce((e,t,r)=>(e[r]=t,e),[]),iI=i_.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var iA=Object.freeze({__proto__:null,base256emoji:it({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=iS[t],"")},decode:function(e){let t=[];for(let r of e){let e=iI[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function iM(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,iM.bytes=r-i+1,t}const iO=(e,t,r=0)=>(iM(e,t,r),t),iC=e=>{var t;return(t=e)<128?1:t<16384?2:t<2097152?3:t<0x10000000?4:t<0x800000000?5:t<0x40000000000?6:t<0x2000000000000?7:t<0x100000000000000?8:t<0x8000000000000000?9:10},iP=(e,t)=>{let r=t.byteLength,i=iC(e),s=i+iC(r),n=new Uint8Array(s+r);return iO(e,n,0),iO(r,n,i),n.set(t,s),new iR(e,r,t,n)};class iR{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const iT=({name:e,code:t,encode:r})=>new iN(e,t,r);class iN{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?iP(this.code,t):t.then(e=>iP(this.code,e))}throw Error("Unknown type, must be binary type")}}const iB=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var iL=Object.freeze({__proto__:null,sha256:iT({name:"sha2-256",code:18,encode:iB("SHA-256")}),sha512:iT({name:"sha2-512",code:19,encode:iB("SHA-512")})}),iU=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:r6,digest:e=>iP(0,r6(e))}});new TextEncoder,new TextDecoder;const ik={...is,...io,...ia,...ih,...ic,...im,...iv,...iw,...iE,...iA};function iq(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...iL,...iU});const ij=iq("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),iz=iq("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=r2((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),iF={utf8:ij,"utf-8":ij,hex:ik.base16,latin1:iz,ascii:iz,binary:iz,...ik};function i$(e,t="utf8"){let r=iF[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function iK(e,t="utf8"){let r=iF[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?r1(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function iV(e){return eE(i$(iK(e,rZ),rX))}function iH(e){return i$(iK(e_(e),rX),rZ)}function iG(e){return["did:key","z"+i$(r3([iK("K36",r0),e]),r0)].join(":")}function iW(e){let t=e.split("."),r=iV(t[0]),i=iV(t[1]);return{header:r,payload:i,signature:iK(t[2],rZ),data:iK(t.slice(0,2).join("."),rQ)}}function iY(e=tU(32)){let t=rJ.getPublicKey(e);return{secretKey:r3([e,t]),publicKey:t}}async function iJ(e,t,r,i,s=(0,x.fromMiliseconds)(Date.now())){let n={alg:"EdDSA",typ:"JWT"},o={iss:iG(i.publicKey),sub:e,aud:t,iat:s,exp:s+r},a=iK([iH((h={header:n,payload:o}).header),iH(h.payload)].join("."),rQ);var h,c={header:n,payload:o,signature:rJ.sign(a,i.secretKey.slice(0,32))};return[iH(c.header),iH(c.payload),i$(c.signature,rZ)].join(".")}var iZ={};function iX(){throw Error("setTimeout has not been defined")}function iQ(){throw Error("clearTimeout has not been defined")}try{Mn="function"==typeof setTimeout?setTimeout:iX}catch(e){Mn=iX}try{Mo="function"==typeof clearTimeout?clearTimeout:iQ}catch(e){Mo=iQ}function i0(e){if(Mn===setTimeout)return setTimeout(e,0);if((Mn===iX||!Mn)&&setTimeout)return Mn=setTimeout,setTimeout(e,0);try{return Mn(e,0)}catch(t){try{return Mn.call(null,e,0)}catch(t){return Mn.call(this,e,0)}}}var i1=[],i2=!1,i3=-1;function i8(){i2&&Ma&&(i2=!1,Ma.length?i1=Ma.concat(i1):i3=-1,i1.length&&i6())}function i6(){if(!i2){var e=i0(i8);i2=!0;for(var t=i1.length;t;){for(Ma=i1,i1=[];++i3<t;)Ma&&Ma[i3].run();i3=-1,t=i1.length}Ma=null,i2=!1,function(e){if(Mo===clearTimeout)return clearTimeout(e);if((Mo===iQ||!Mo)&&clearTimeout)return Mo=clearTimeout,clearTimeout(e);try{Mo(e)}catch(t){try{return Mo.call(null,e)}catch(t){return Mo.call(this,e)}}}(e)}}function i5(e,t){this.fun=e,this.array=t}function i4(){}iZ.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];i1.push(new i5(e,t)),1!==i1.length||i2||i0(i6)},i5.prototype.run=function(){this.fun.apply(null,this.array)},iZ.title="browser",iZ.browser=!0,iZ.env={},iZ.argv=[],iZ.version="",iZ.versions={},iZ.on=i4,iZ.addListener=i4,iZ.once=i4,iZ.off=i4,iZ.removeListener=i4,iZ.removeAllListeners=i4,iZ.emit=i4,iZ.prependListener=i4,iZ.prependOnceListener=i4,iZ.listeners=function(e){return[]},iZ.binding=function(e){throw Error("process.binding is not supported")},iZ.cwd=function(){return"/"},iZ.chdir=function(e){throw Error("process.chdir is not supported")},iZ.umask=function(){return 0};var i9=function(e,t,r){if(r||2==arguments.length)for(var i,s=0,n=t.length;s<n;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},i7=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},se=function(e,t,r,i){this.name=e,this.version=t,this.os=r,this.bot=i,this.type="bot-device"},st=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},sr=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},si=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,ss=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],sn=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function so(e){return e?sa(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new sr:"undefined"!=typeof navigator?sa(navigator.userAgent):null}function sa(e){var t=""!==e&&ss.reduce(function(t,r){var i=r[0],s=r[1];if(t)return t;var n=s.exec(e);return!!n&&[i,n]},!1);if(!t)return null;var r=t[0],i=t[1];if("searchbot"===r)return new st;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<3&&(s=i9(i9([],s,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-s.length),!0)):s=[];var n=s.join("."),o=function(e){for(var t=0,r=sn.length;t<r;t++){var i=sn[t],s=i[0];if(i[1].exec(e))return s}return null}(e),a=si.exec(e);return a&&a[1]?new se(r,n,o,a[1]):new i7(r,n,o)}var sh={};function sc(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function su(e){let t=sc(e);if(!t)throw Error(`${e} is not defined in Window`);return t}Object.defineProperty(sh,"__esModule",{value:!0}),sh.getLocalStorage=sh.getLocalStorageOrThrow=sh.getCrypto=sh.getCryptoOrThrow=sh.getLocation=sh.getLocationOrThrow=sh.getNavigator=sh.getNavigatorOrThrow=sh.getDocument=sh.getDocumentOrThrow=sh.getFromWindowOrThrow=sh.getFromWindow=void 0,sh.getFromWindow=sc,sh.getFromWindowOrThrow=su,sh.getDocumentOrThrow=function(){return su("document")},sh.getDocument=function(){return sc("document")},sh.getNavigatorOrThrow=function(){return su("navigator")},sh.getNavigator=function(){return sc("navigator")},sh.getLocationOrThrow=function(){return su("location")},sh.getLocation=function(){return sc("location")},sh.getCryptoOrThrow=function(){return su("crypto")},sh.getCrypto=function(){return sc("crypto")},sh.getLocalStorageOrThrow=function(){return su("localStorage")},sh.getLocalStorage=function(){return sc("localStorage")};var sl={};Object.defineProperty(sl,"__esModule",{value:!0}),sl.getWindowMetadata=void 0,sl.getWindowMetadata=function(){let e,t,r;try{e=sh.getDocumentOrThrow(),t=sh.getLocationOrThrow()}catch(e){return null}function i(...t){let r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){let i=r[e],s=["itemprop","property","name"].map(e=>i.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(s.length&&s){let e=i.getAttribute("content");if(e)return e}}return""}let s=((r=i("name","og:site_name","og:title","twitter:title"))||(r=e.title),r),n=i("description","og:description","twitter:description","keywords"),o=t.origin;return{description:n,url:o,icons:function(){let r=e.getElementsByTagName("link"),i=[];for(let e=0;e<r.length;e++){let s=r[e],n=s.getAttribute("rel");if(n&&n.toLowerCase().indexOf("icon")>-1){let e=s.getAttribute("href");if(e)if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{let i=t.pathname.split("/");i.pop(),r+=i.join("/")+"/"+e}i.push(r)}else if(0===e.indexOf("//")){let r=t.protocol+e;i.push(r)}else i.push(e)}}return i}(),name:s}};var sf={};e(sf,"noble",()=>at),e(sf,"createKeyPair",()=>ar),e(sf,"randomPrivateKey",()=>an),e(sf,"getPublicKey",()=>ai),e(sf,"getSharedSecret",()=>as),e(sf,"recoverAddress",()=>ao),e(sf,"recoverPublicKey",()=>aa),e(sf,"sign",()=>ah),e(sf,"verify",()=>ac);var sd={};Object.defineProperty(sd,"__esModule",{value:!0}),sd.encodeToCurve=sd.hashToCurve=sd.secp256k1_hasher=sd.schnorr=sd.secp256k1=void 0;var sp={};Object.defineProperty(sp,"__esModule",{value:!0}),sp.sha512_224=sp.sha512_256=sp.sha384=sp.sha512=sp.sha224=sp.sha256=sp.SHA512_256=sp.SHA512_224=sp.SHA384=sp.SHA512=sp.SHA224=sp.SHA256=void 0;var sg={};Object.defineProperty(sg,"__esModule",{value:!0}),sg.SHA512_IV=sg.SHA384_IV=sg.SHA224_IV=sg.SHA256_IV=sg.HashMD=void 0,sg.setBigUint64=sy,sg.Chi=function(e,t,r){return e&t^~e&r},sg.Maj=function(e,t,r){return e&t^e&r^t&r};var sb=n("cLJKR");function sy(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(0xffffffff),o=Number(r>>s&n),a=Number(r&n),h=4*!!i,c=4*!i;e.setUint32(t+h,o,i),e.setUint32(t+c,a,i)}class sm extends sb.Hash{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=(0,sb.createView)(this.buffer)}update(e){(0,sb.aexists)(this),e=(0,sb.toBytes)(e),(0,sb.abytes)(e);let{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=(0,sb.createView)(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,sb.aexists)(this),(0,sb.aoutput)(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,(0,sb.clean)(this.buffer.subarray(n)),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;sy(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=(0,sb.createView)(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=a/4,c=this.get();if(h>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<h;e++)o.setUint32(4*e,c[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.destroyed=n,e.finished=s,e.length=i,e.pos=o,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}sg.HashMD=sm,sg.SHA256_IV=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),sg.SHA224_IV=Uint32Array.from([0xc1059ed8,0x367cd507,0x3070dd17,0xf70e5939,0xffc00b31,0x68581511,0x64f98fa7,0xbefa4fa4]),sg.SHA384_IV=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),sg.SHA512_IV=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]);var sv={};Object.defineProperty(sv,"__esModule",{value:!0}),sv.toBig=sv.shrSL=sv.shrSH=sv.rotrSL=sv.rotrSH=sv.rotrBL=sv.rotrBH=sv.rotr32L=sv.rotr32H=sv.rotlSL=sv.rotlSH=sv.rotlBL=sv.rotlBH=sv.add5L=sv.add5H=sv.add4L=sv.add4H=sv.add3L=sv.add3H=void 0,sv.add=sU,sv.fromBig=sx,sv.split=sE;const sw=BigInt(0x100000000-1),sD=BigInt(32);function sx(e,t=!1){return t?{h:Number(e&sw),l:Number(e>>sD&sw)}:{h:0|Number(e>>sD&sw),l:0|Number(e&sw)}}function sE(e,t=!1){let r=e.length,i=new Uint32Array(r),s=new Uint32Array(r);for(let n=0;n<r;n++){let{h:r,l:o}=sx(e[n],t);[i[n],s[n]]=[r,o]}return[i,s]}const s_=(e,t)=>BigInt(e>>>0)<<sD|BigInt(t>>>0);sv.toBig=s_;const sS=(e,t,r)=>e>>>r;sv.shrSH=sS;const sI=(e,t,r)=>e<<32-r|t>>>r;sv.shrSL=sI;const sA=(e,t,r)=>e>>>r|t<<32-r;sv.rotrSH=sA;const sM=(e,t,r)=>e<<32-r|t>>>r;sv.rotrSL=sM;const sO=(e,t,r)=>e<<64-r|t>>>r-32;sv.rotrBH=sO;const sC=(e,t,r)=>e>>>r-32|t<<64-r;sv.rotrBL=sC;const sP=(e,t)=>t;sv.rotr32H=sP;const sR=(e,t)=>e;sv.rotr32L=sR;const sT=(e,t,r)=>e<<r|t>>>32-r;sv.rotlSH=sT;const sN=(e,t,r)=>t<<r|e>>>32-r;sv.rotlSL=sN;const sB=(e,t,r)=>t<<r-32|e>>>64-r;sv.rotlBH=sB;const sL=(e,t,r)=>e<<r-32|t>>>64-r;function sU(e,t,r,i){let s=(t>>>0)+(i>>>0);return{h:e+r+(s/0x100000000|0)|0,l:0|s}}sv.rotlBL=sL;const sk=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0);sv.add3L=sk;const sq=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0;sv.add3H=sq;const sj=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0);sv.add4L=sj;const sz=(e,t,r,i,s)=>t+r+i+s+(e/0x100000000|0)|0;sv.add4H=sz;const sF=(e,t,r,i,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(s>>>0);sv.add5L=sF;const s$=(e,t,r,i,s,n)=>t+r+i+s+n+(e/0x100000000|0)|0;sv.add5H=s$,sv.default={fromBig:sx,split:sE,toBig:s_,shrSH:sS,shrSL:sI,rotrSH:sA,rotrSL:sM,rotrBH:sO,rotrBL:sC,rotr32H:sP,rotr32L:sR,rotlSH:sT,rotlSL:sN,rotlBH:sB,rotlBL:sL,add:sU,add3L:sk,add3H:sq,add4L:sj,add4H:sz,add5H:s$,add5L:sF};var sb=n("cLJKR");const sK=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),sV=new Uint32Array(64);class sH extends sg.HashMD{constructor(e=32){super(64,e,8,!1),this.A=0|sg.SHA256_IV[0],this.B=0|sg.SHA256_IV[1],this.C=0|sg.SHA256_IV[2],this.D=0|sg.SHA256_IV[3],this.E=0|sg.SHA256_IV[4],this.F=0|sg.SHA256_IV[5],this.G=0|sg.SHA256_IV[6],this.H=0|sg.SHA256_IV[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:o,H:a}=this;return[e,t,r,i,s,n,o,a]}set(e,t,r,i,s,n,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)sV[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=sV[e-15],r=sV[e-2],i=(0,sb.rotr)(t,7)^(0,sb.rotr)(t,18)^t>>>3,s=(0,sb.rotr)(r,17)^(0,sb.rotr)(r,19)^r>>>10;sV[e]=s+sV[e-7]+i+sV[e-16]|0}let{A:r,B:i,C:s,D:n,E:o,F:a,G:h,H:c}=this;for(let e=0;e<64;e++){let t=c+((0,sb.rotr)(o,6)^(0,sb.rotr)(o,11)^(0,sb.rotr)(o,25))+(0,sg.Chi)(o,a,h)+sK[e]+sV[e]|0,u=((0,sb.rotr)(r,2)^(0,sb.rotr)(r,13)^(0,sb.rotr)(r,22))+(0,sg.Maj)(r,i,s)|0;c=h,h=a,a=o,o=n+t|0,n=s,s=i,i=r,r=t+u|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,o=o+this.E|0,a=a+this.F|0,h=h+this.G|0,c=c+this.H|0,this.set(r,i,s,n,o,a,h,c)}roundClean(){(0,sb.clean)(sV)}destroy(){this.set(0,0,0,0,0,0,0,0),(0,sb.clean)(this.buffer)}}sp.SHA256=sH;class sG extends sH{constructor(){super(28),this.A=0|sg.SHA224_IV[0],this.B=0|sg.SHA224_IV[1],this.C=0|sg.SHA224_IV[2],this.D=0|sg.SHA224_IV[3],this.E=0|sg.SHA224_IV[4],this.F=0|sg.SHA224_IV[5],this.G=0|sg.SHA224_IV[6],this.H=0|sg.SHA224_IV[7]}}sp.SHA224=sG;const sW=sv.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),sY=sW[0],sJ=sW[1],sZ=new Uint32Array(80),sX=new Uint32Array(80);class sQ extends sg.HashMD{constructor(e=64){super(128,e,16,!1),this.Ah=0|sg.SHA512_IV[0],this.Al=0|sg.SHA512_IV[1],this.Bh=0|sg.SHA512_IV[2],this.Bl=0|sg.SHA512_IV[3],this.Ch=0|sg.SHA512_IV[4],this.Cl=0|sg.SHA512_IV[5],this.Dh=0|sg.SHA512_IV[6],this.Dl=0|sg.SHA512_IV[7],this.Eh=0|sg.SHA512_IV[8],this.El=0|sg.SHA512_IV[9],this.Fh=0|sg.SHA512_IV[10],this.Fl=0|sg.SHA512_IV[11],this.Gh=0|sg.SHA512_IV[12],this.Gl=0|sg.SHA512_IV[13],this.Hh=0|sg.SHA512_IV[14],this.Hl=0|sg.SHA512_IV[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:n,Dh:o,Dl:a,Eh:h,El:c,Fh:u,Fl:l,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g]}set(e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|n,this.Dh=0|o,this.Dl=0|a,this.Eh=0|h,this.El=0|c,this.Fh=0|u,this.Fl=0|l,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)sZ[r]=e.getUint32(t),sX[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|sZ[e-15],r=0|sX[e-15],i=sv.rotrSH(t,r,1)^sv.rotrSH(t,r,8)^sv.shrSH(t,r,7),s=sv.rotrSL(t,r,1)^sv.rotrSL(t,r,8)^sv.shrSL(t,r,7),n=0|sZ[e-2],o=0|sX[e-2],a=sv.rotrSH(n,o,19)^sv.rotrBH(n,o,61)^sv.shrSH(n,o,6),h=sv.rotrSL(n,o,19)^sv.rotrBL(n,o,61)^sv.shrSL(n,o,6),c=sv.add4L(s,h,sX[e-7],sX[e-16]),u=sv.add4H(c,i,a,sZ[e-7],sZ[e-16]);sZ[e]=0|u,sX[e]=0|c}let{Ah:r,Al:i,Bh:s,Bl:n,Ch:o,Cl:a,Dh:h,Dl:c,Eh:u,El:l,Fh:f,Fl:d,Gh:p,Gl:g,Hh:b,Hl:y}=this;for(let e=0;e<80;e++){let t=sv.rotrSH(u,l,14)^sv.rotrSH(u,l,18)^sv.rotrBH(u,l,41),m=sv.rotrSL(u,l,14)^sv.rotrSL(u,l,18)^sv.rotrBL(u,l,41),v=u&f^~u&p,w=l&d^~l&g,D=sv.add5L(y,m,w,sJ[e],sX[e]),x=sv.add5H(D,b,t,v,sY[e],sZ[e]),E=0|D,_=sv.rotrSH(r,i,28)^sv.rotrBH(r,i,34)^sv.rotrBH(r,i,39),S=sv.rotrSL(r,i,28)^sv.rotrBL(r,i,34)^sv.rotrBL(r,i,39),I=r&s^r&o^s&o,A=i&n^i&a^n&a;b=0|p,y=0|g,p=0|f,g=0|d,f=0|u,d=0|l,({h:u,l:l}=sv.add(0|h,0|c,0|x,0|E)),h=0|o,c=0|a,o=0|s,a=0|n,s=0|r,n=0|i;let M=sv.add3L(E,S,A);r=sv.add3H(M,x,_,I),i=0|M}({h:r,l:i}=sv.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:s,l:n}=sv.add(0|this.Bh,0|this.Bl,0|s,0|n)),({h:o,l:a}=sv.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:h,l:c}=sv.add(0|this.Dh,0|this.Dl,0|h,0|c)),({h:u,l:l}=sv.add(0|this.Eh,0|this.El,0|u,0|l)),({h:f,l:d}=sv.add(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:g}=sv.add(0|this.Gh,0|this.Gl,0|p,0|g)),({h:b,l:y}=sv.add(0|this.Hh,0|this.Hl,0|b,0|y)),this.set(r,i,s,n,o,a,h,c,u,l,f,d,p,g,b,y)}roundClean(){(0,sb.clean)(sZ,sX)}destroy(){(0,sb.clean)(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}sp.SHA512=sQ;class s0 extends sQ{constructor(){super(48),this.Ah=0|sg.SHA384_IV[0],this.Al=0|sg.SHA384_IV[1],this.Bh=0|sg.SHA384_IV[2],this.Bl=0|sg.SHA384_IV[3],this.Ch=0|sg.SHA384_IV[4],this.Cl=0|sg.SHA384_IV[5],this.Dh=0|sg.SHA384_IV[6],this.Dl=0|sg.SHA384_IV[7],this.Eh=0|sg.SHA384_IV[8],this.El=0|sg.SHA384_IV[9],this.Fh=0|sg.SHA384_IV[10],this.Fl=0|sg.SHA384_IV[11],this.Gh=0|sg.SHA384_IV[12],this.Gl=0|sg.SHA384_IV[13],this.Hh=0|sg.SHA384_IV[14],this.Hl=0|sg.SHA384_IV[15]}}sp.SHA384=s0;const s1=Uint32Array.from([0x8c3d37c8,0x19544da2,0x73e19966,0x89dcd4d6,0x1dfab7ae,0x32ff9c82,0x679dd514,0x582f9fcf,0xf6d2b69,0x7bd44da8,0x77e36f73,0x4c48942,0x3f9d85a8,0x6a1d36c8,0x1112e6ad,0x91d692a1]),s2=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class s3 extends sQ{constructor(){super(28),this.Ah=0|s1[0],this.Al=0|s1[1],this.Bh=0|s1[2],this.Bl=0|s1[3],this.Ch=0|s1[4],this.Cl=0|s1[5],this.Dh=0|s1[6],this.Dl=0|s1[7],this.Eh=0|s1[8],this.El=0|s1[9],this.Fh=0|s1[10],this.Fl=0|s1[11],this.Gh=0|s1[12],this.Gl=0|s1[13],this.Hh=0|s1[14],this.Hl=0|s1[15]}}sp.SHA512_224=s3;class s8 extends sQ{constructor(){super(32),this.Ah=0|s2[0],this.Al=0|s2[1],this.Bh=0|s2[2],this.Bl=0|s2[3],this.Ch=0|s2[4],this.Cl=0|s2[5],this.Dh=0|s2[6],this.Dl=0|s2[7],this.Eh=0|s2[8],this.El=0|s2[9],this.Fh=0|s2[10],this.Fl=0|s2[11],this.Gh=0|s2[12],this.Gl=0|s2[13],this.Hh=0|s2[14],this.Hl=0|s2[15]}}sp.SHA512_256=s8,sp.sha256=(0,sb.createHasher)(()=>new sH),sp.sha224=(0,sb.createHasher)(()=>new sG),sp.sha512=(0,sb.createHasher)(()=>new sQ),sp.sha384=(0,sb.createHasher)(()=>new s0),sp.sha512_256=(0,sb.createHasher)(()=>new s8),sp.sha512_224=(0,sb.createHasher)(()=>new s3);var sb=n("cLJKR"),s6={};Object.defineProperty(s6,"__esModule",{value:!0}),s6.getHash=nf,s6.createCurve=function(e,t){let r=t=>(0,s9.weierstrass)({...e,...nf(t)});return{...r(t),create:r}};var s5={};Object.defineProperty(s5,"__esModule",{value:!0}),s5.hmac=s5.HMAC=void 0;var sb=n("cLJKR");class s4 extends sb.Hash{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,(0,sb.ahash)(e);let r=(0,sb.toBytes)(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),(0,sb.clean)(s)}update(e){return(0,sb.aexists)(this),this.iHash.update(e),this}digestInto(e){(0,sb.aexists)(this),(0,sb.abytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}s5.HMAC=s4,s5.hmac=(e,t,r)=>new s4(e,t).update(r).digest(),s5.hmac.create=(e,t)=>new s4(e,t);var sb=n("cLJKR"),s9={};Object.defineProperty(s9,"__esModule",{value:!0}),s9.DER=s9.DERErr=void 0,s9.weierstrassPoints=nu,s9.weierstrass=function(e){let t=function(e){let t=(0,s7.validateBasic)(e);return(0,nt.validateObject)(t,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...t})}(e),{Fp:r,n:i,nByteLength:s,nBitLength:n}=t,o=r.BYTES+1,a=2*r.BYTES+1;function h(e){return(0,ne.mod)(e,i)}function c(e){return(0,ne.invert)(e,i)}let{ProjectivePoint:u,normPrivateKeyToScalar:l,weierstrassEquation:f,isWithinCurveOrder:d}=nu({...t,toBytes(e,t,i){let s=t.toAffine(),n=r.toBytes(s.x),o=nt.concatBytes;return((0,nt.abool)("isCompressed",i),i)?o(Uint8Array.from([t.hasEvenY()?2:3]),n):o(Uint8Array.from([4]),n,r.toBytes(s.y))},fromBytes(e){let t=e.length,i=e[0],s=e.subarray(1);if(t===o&&(2===i||3===i)){let e,t=(0,nt.bytesToNumberBE)(s);if(!(0,nt.inRange)(t,no,r.ORDER))throw Error("Point is not on curve");let n=f(t);try{e=r.sqrt(n)}catch(e){throw Error("Point is not on curve"+(e instanceof Error?": "+e.message:""))}return(1&i)==1!=((e&no)===no)&&(e=r.neg(e)),{x:t,y:e}}if(t===a&&4===i)return{x:r.fromBytes(s.subarray(0,r.BYTES)),y:r.fromBytes(s.subarray(r.BYTES,2*r.BYTES))};throw Error("invalid Point, expected length of "+o+", or uncompressed "+a+", got "+t)}}),p=(e,t,r)=>(0,nt.bytesToNumberBE)(e.slice(t,r));class g{constructor(e,t,r){(0,nt.aInRange)("r",e,no,i),(0,nt.aInRange)("s",t,no,i),this.r=e,this.s=t,null!=r&&(this.recovery=r),Object.freeze(this)}static fromCompact(e){return new g(p(e=(0,nt.ensureBytes)("compactSignature",e,2*s),0,s),p(e,s,2*s))}static fromDER(e){let{r:t,s:r}=s9.DER.toSig((0,nt.ensureBytes)("DER",e));return new g(t,r)}assertValidity(){}addRecoveryBit(e){return new g(this.r,this.s,e)}recoverPublicKey(e){let{r:i,s:s,recovery:n}=this,o=m((0,nt.ensureBytes)("msgHash",e));if(null==n||![0,1,2,3].includes(n))throw Error("recovery id invalid");let a=2===n||3===n?i+t.n:i;if(a>=r.ORDER)throw Error("recovery id 2 or 3 invalid");let l=(1&n)==0?"02":"03",f=u.fromHex(l+ns(a,r.BYTES)),d=c(a),p=h(-o*d),g=h(s*d),b=u.BASE.multiplyAndAddUnsafe(f,p,g);if(!b)throw Error("point at infinify");return b.assertValidity(),b}hasHighS(){return this.s>i>>no}normalizeS(){return this.hasHighS()?new g(this.r,h(-this.s),this.recovery):this}toDERRawBytes(){return(0,nt.hexToBytes)(this.toDERHex())}toDERHex(){return s9.DER.hexFromSig(this)}toCompactRawBytes(){return(0,nt.hexToBytes)(this.toCompactHex())}toCompactHex(){return ns(this.r,s)+ns(this.s,s)}}function b(e){if("bigint"==typeof e)return!1;if(e instanceof u)return!0;let i=(0,nt.ensureBytes)("key",e).length,n=r.BYTES,o=n+1;if(!t.allowedPrivateKeyLengths&&s!==o)return i===o||i===2*n+1}let y=t.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=(0,nt.bytesToNumberBE)(e),r=8*e.length-n;return r>0?t>>BigInt(r):t},m=t.bits2int_modN||function(e){return h(y(e))},v=(0,nt.bitMask)(n);function w(e){return(0,nt.aInRange)("num < 2^"+n,e,nn,v),(0,nt.numberToBytesBE)(e,s)}let D={lowS:t.lowS,prehash:!1},x={lowS:t.lowS,prehash:!1};return u.BASE._setWindowSize(8),{CURVE:t,getPublicKey:function(e,t=!0){return u.fromPrivateKey(e).toRawBytes(t)},getSharedSecret:function(e,t,r=!0){if(!0===b(e))throw Error("first arg must be private key");if(!1===b(t))throw Error("second arg must be public key");return u.fromHex(t).multiply(l(e)).toRawBytes(r)},sign:function(e,s,n=D){let{seed:o,k2sig:a}=function(e,s,n=D){if(["recovered","canonical"].some(e=>e in n))throw Error("sign() legacy options not supported");let{hash:o,randomBytes:a}=t,{lowS:f,prehash:p,extraEntropy:b}=n;null==f&&(f=!0),e=(0,nt.ensureBytes)("msgHash",e),nr(n),p&&(e=(0,nt.ensureBytes)("prehashed msgHash",o(e)));let v=m(e),x=l(s),E=[w(x),w(v)];if(null!=b&&!1!==b){let e=!0===b?a(r.BYTES):b;E.push((0,nt.ensureBytes)("extraEntropy",e))}return{seed:(0,nt.concatBytes)(...E),k2sig:function(e){var t;let r=y(e);if(!d(r))return;let s=c(r),n=u.BASE.multiply(r).toAffine(),o=h(n.x);if(o===nn)return;let a=h(s*h(v+o*x));if(a===nn)return;let l=2*(n.x!==o)|Number(n.y&no),p=a;return f&&a>i>>no&&(p=(t=a)>i>>no?h(-t):t,l^=1),new g(o,p,l)}}}(e,s,n);return(0,nt.createHmacDrbg)(t.hash.outputLen,t.nByteLength,t.hmac)(o,a)},verify:function(e,r,i,s=x){let n,o;r=(0,nt.ensureBytes)("msgHash",r),i=(0,nt.ensureBytes)("publicKey",i);let{lowS:a,prehash:l,format:f}=s;if(nr(s),"strict"in s)throw Error("options.strict was renamed to lowS");if(void 0!==f&&"compact"!==f&&"der"!==f)throw Error("format must be compact or der");let d="string"==typeof e||(0,nt.isBytes)(e),p=!d&&!f&&"object"==typeof e&&null!==e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!d&&!p)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");try{if(p&&(o=new g(e.r,e.s)),d){try{"compact"!==f&&(o=g.fromDER(e))}catch(e){if(!(e instanceof s9.DER.Err))throw e}o||"der"===f||(o=g.fromCompact(e))}n=u.fromHex(i)}catch(e){return!1}if(!o||a&&o.hasHighS())return!1;l&&(r=t.hash(r));let{r:b,s:y}=o,v=m(r),w=c(y),D=h(v*w),E=h(b*w),_=u.BASE.multiplyAndAddUnsafe(n,D,E)?.toAffine();return!!_&&h(_.x)===b},ProjectivePoint:u,Signature:g,utils:{isValidPrivateKey(e){try{return l(e),!0}catch(e){return!1}},normPrivateKeyToScalar:l,randomPrivateKey:()=>{let e=(0,ne.getMinHashLength)(t.n);return(0,ne.mapHashToField)(t.randomBytes(e),t.n)},precompute:(e=8,t=u.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}},s9.SWUFpSqrtRatio=nl,s9.mapToCurveSimpleSWU=function(e,t){if((0,ne.validateField)(e),!e.isValid(t.A)||!e.isValid(t.B)||!e.isValid(t.Z))throw Error("mapToCurveSimpleSWU: invalid opts");let r=nl(e,t.Z);if(!e.isOdd)throw Error("Fp.isOdd is not implemented!");return i=>{let s,n,o,a,h,c,u,l;s=e.sqr(i),s=e.mul(s,t.Z),n=e.sqr(s),n=e.add(n,s),o=e.add(n,e.ONE),o=e.mul(o,t.B),a=e.cmov(t.Z,e.neg(n),!e.eql(n,e.ZERO)),a=e.mul(a,t.A),n=e.sqr(o),c=e.sqr(a),h=e.mul(c,t.A),n=e.add(n,h),n=e.mul(n,o),c=e.mul(c,a),h=e.mul(c,t.B),n=e.add(n,h),u=e.mul(s,o);let{isValid:f,value:d}=r(n,c);l=e.mul(s,i),l=e.mul(l,d),u=e.cmov(u,o,f),l=e.cmov(l,d,f);let p=e.isOdd(i)===e.isOdd(l);l=e.cmov(e.neg(l),l,p);let g=(0,ne.FpInvertBatch)(e,[a],!0)[0];return{x:u=e.mul(u,g),y:l}}};var s7=n("lgCxf"),ne=n("es3xL"),nt=n("5l7pf");function nr(e){void 0!==e.lowS&&(0,nt.abool)("lowS",e.lowS),void 0!==e.prehash&&(0,nt.abool)("prehash",e.prehash)}class ni extends Error{constructor(e=""){super(e)}}function ns(e,t){return(0,nt.bytesToHex)((0,nt.numberToBytesBE)(e,t))}s9.DERErr=ni,s9.DER={Err:ni,_tlv:{encode:(e,t)=>{let{Err:r}=s9.DER;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,s=(0,nt.numberToHexUnpadded)(i);if(s.length/2&128)throw new r("tlv.encode: long form length too big");let n=i>127?(0,nt.numberToHexUnpadded)(s.length/2|128):"";return(0,nt.numberToHexUnpadded)(e)+n+s+t},decode(e,t){let{Err:r}=s9.DER,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let s=t[i++],n=0;if(128&s){let e=127&s;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let o=t.subarray(i,i+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of o)n=n<<8|e;if(i+=e,n<128)throw new r("tlv.decode(long): not minimal encoding")}else n=s;let o=t.subarray(i,i+n);if(o.length!==n)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(i+n)}}},_int:{encode(e){let{Err:t}=s9.DER;if(e<nn)throw new t("integer: negative integers are not allowed");let r=(0,nt.numberToHexUnpadded)(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=s9.DER;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return(0,nt.bytesToNumberBE)(e)}},toSig(e){let{Err:t,_int:r,_tlv:i}=s9.DER,s=(0,nt.ensureBytes)("signature",e),{v:n,l:o}=i.decode(48,s);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:h}=i.decode(2,n),{v:c,l:u}=i.decode(2,h);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(c)}},hexFromSig(e){let{_tlv:t,_int:r}=s9.DER,i=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s));return t.encode(48,i+s)}};const nn=BigInt(0),no=BigInt(1),na=BigInt(2),nh=BigInt(3),nc=BigInt(4);function nu(e){let t=function(e){let t=(0,s7.validateBasic)(e);(0,nt.validateObject)(t,{a:"field",b:"field"},{allowInfinityPoint:"boolean",allowedPrivateKeyLengths:"array",clearCofactor:"function",fromBytes:"function",isTorsionFree:"function",toBytes:"function",wrapPrivateKey:"boolean"});let{endo:r,Fp:i,a:s}=t;if(r){if(!i.eql(s,i.ZERO))throw Error("invalid endo: CURVE.a must be 0");if("object"!=typeof r||"bigint"!=typeof r.beta||"function"!=typeof r.splitScalar)throw Error('invalid endo: expected "beta": bigint and "splitScalar": function')}return Object.freeze({...t})}(e),{Fp:r}=t,i=(0,ne.Field)(t.n,t.nBitLength),s=t.toBytes||((e,t,i)=>{let s=t.toAffine();return(0,nt.concatBytes)(Uint8Array.from([4]),r.toBytes(s.x),r.toBytes(s.y))}),n=t.fromBytes||(e=>{let t=e.subarray(1);return{x:r.fromBytes(t.subarray(0,r.BYTES)),y:r.fromBytes(t.subarray(r.BYTES,2*r.BYTES))}});function o(e){let{a:i,b:s}=t,n=r.sqr(e),o=r.mul(n,e);return r.add(r.add(o,r.mul(e,i)),s)}function a(e,t){let i=r.sqr(t),s=o(e);return r.eql(i,s)}if(!a(t.Gx,t.Gy))throw Error("bad curve params: generator point");let h=r.mul(r.pow(t.a,nh),nc),c=r.mul(r.sqr(t.b),BigInt(27));if(r.is0(r.add(h,c)))throw Error("bad curve params: a or b");function u(e){let r,{allowedPrivateKeyLengths:i,nByteLength:s,wrapPrivateKey:n,n:o}=t;if(i&&"bigint"!=typeof e){if((0,nt.isBytes)(e)&&(e=(0,nt.bytesToHex)(e)),"string"!=typeof e||!i.includes(e.length))throw Error("invalid private key");e=e.padStart(2*s,"0")}try{r="bigint"==typeof e?e:(0,nt.bytesToNumberBE)((0,nt.ensureBytes)("private key",e,s))}catch(t){throw Error("invalid private key, expected hex or "+s+" bytes, got "+typeof e)}return n&&(r=(0,ne.mod)(r,o)),(0,nt.aInRange)("private key",r,no,o),r}function l(e){if(!(e instanceof p))throw Error("ProjectivePoint expected")}let f=(0,nt.memoized)((e,t)=>{let{px:i,py:s,pz:n}=e;if(r.eql(n,r.ONE))return{x:i,y:s};let o=e.is0();null==t&&(t=o?r.ONE:r.inv(n));let a=r.mul(i,t),h=r.mul(s,t),c=r.mul(n,t);if(o)return{x:r.ZERO,y:r.ZERO};if(!r.eql(c,r.ONE))throw Error("invZ was invalid");return{x:a,y:h}}),d=(0,nt.memoized)(e=>{if(e.is0()){if(t.allowInfinityPoint&&!r.is0(e.py))return;throw Error("bad point: ZERO")}let{x:i,y:s}=e.toAffine();if(!r.isValid(i)||!r.isValid(s))throw Error("bad point: x or y not FE");if(!a(i,s))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});class p{constructor(e,t,i){if(null==e||!r.isValid(e))throw Error("x required");if(null==t||!r.isValid(t)||r.is0(t))throw Error("y required");if(null==i||!r.isValid(i))throw Error("z required");this.px=e,this.py=t,this.pz=i,Object.freeze(this)}static fromAffine(e){let{x:t,y:i}=e||{};if(!e||!r.isValid(t)||!r.isValid(i))throw Error("invalid affine point");if(e instanceof p)throw Error("projective point not allowed");let s=e=>r.eql(e,r.ZERO);return s(t)&&s(i)?p.ZERO:new p(t,i,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(e){let t=(0,ne.FpInvertBatch)(r,e.map(e=>e.pz));return e.map((e,r)=>e.toAffine(t[r])).map(p.fromAffine)}static fromHex(e){let t=p.fromAffine(n((0,nt.ensureBytes)("pointHex",e)));return t.assertValidity(),t}static fromPrivateKey(e){return p.BASE.multiply(u(e))}static msm(e,t){return(0,s7.pippenger)(p,i,e,t)}_setWindowSize(e){y.setWindowSize(this,e)}assertValidity(){d(this)}hasEvenY(){let{y:e}=this.toAffine();if(r.isOdd)return!r.isOdd(e);throw Error("Field doesn't support isOdd")}equals(e){l(e);let{px:t,py:i,pz:s}=this,{px:n,py:o,pz:a}=e,h=r.eql(r.mul(t,a),r.mul(n,s)),c=r.eql(r.mul(i,a),r.mul(o,s));return h&&c}negate(){return new p(this.px,r.neg(this.py),this.pz)}double(){let{a:e,b:i}=t,s=r.mul(i,nh),{px:n,py:o,pz:a}=this,h=r.ZERO,c=r.ZERO,u=r.ZERO,l=r.mul(n,n),f=r.mul(o,o),d=r.mul(a,a),g=r.mul(n,o);return g=r.add(g,g),u=r.mul(n,a),u=r.add(u,u),h=r.mul(e,u),c=r.mul(s,d),c=r.add(h,c),h=r.sub(f,c),c=r.add(f,c),c=r.mul(h,c),h=r.mul(g,h),u=r.mul(s,u),d=r.mul(e,d),g=r.sub(l,d),g=r.mul(e,g),g=r.add(g,u),u=r.add(l,l),l=r.add(u,l),l=r.add(l,d),l=r.mul(l,g),c=r.add(c,l),d=r.mul(o,a),d=r.add(d,d),l=r.mul(d,g),h=r.sub(h,l),u=r.mul(d,f),u=r.add(u,u),new p(h,c,u=r.add(u,u))}add(e){l(e);let{px:i,py:s,pz:n}=this,{px:o,py:a,pz:h}=e,c=r.ZERO,u=r.ZERO,f=r.ZERO,d=t.a,g=r.mul(t.b,nh),b=r.mul(i,o),y=r.mul(s,a),m=r.mul(n,h),v=r.add(i,s),w=r.add(o,a);v=r.mul(v,w),w=r.add(b,y),v=r.sub(v,w),w=r.add(i,n);let D=r.add(o,h);return w=r.mul(w,D),D=r.add(b,m),w=r.sub(w,D),D=r.add(s,n),c=r.add(a,h),D=r.mul(D,c),c=r.add(y,m),D=r.sub(D,c),f=r.mul(d,w),c=r.mul(g,m),f=r.add(c,f),c=r.sub(y,f),f=r.add(y,f),u=r.mul(c,f),y=r.add(b,b),y=r.add(y,b),m=r.mul(d,m),w=r.mul(g,w),y=r.add(y,m),m=r.sub(b,m),m=r.mul(d,m),w=r.add(w,m),b=r.mul(y,w),u=r.add(u,b),b=r.mul(D,w),c=r.mul(v,c),c=r.sub(c,b),b=r.mul(v,y),f=r.mul(D,f),new p(c,u,f=r.add(f,b))}subtract(e){return this.add(e.negate())}is0(){return this.equals(p.ZERO)}wNAF(e){return y.wNAFCached(this,e,p.normalizeZ)}multiplyUnsafe(e){let{endo:i,n:s}=t;(0,nt.aInRange)("scalar",e,nn,s);let n=p.ZERO;if(e===nn)return n;if(this.is0()||e===no)return this;if(!i||y.hasPrecomputes(this))return y.wNAFCachedUnsafe(this,e,p.normalizeZ);let{k1neg:o,k1:a,k2neg:h,k2:c}=i.splitScalar(e),u=n,l=n,f=this;for(;a>nn||c>nn;)a&no&&(u=u.add(f)),c&no&&(l=l.add(f)),f=f.double(),a>>=no,c>>=no;return o&&(u=u.negate()),h&&(l=l.negate()),l=new p(r.mul(l.px,i.beta),l.py,l.pz),u.add(l)}multiply(e){let i,s,{endo:n,n:o}=t;if((0,nt.aInRange)("scalar",e,no,o),n){let{k1neg:t,k1:o,k2neg:a,k2:h}=n.splitScalar(e),{p:c,f:u}=this.wNAF(o),{p:l,f:f}=this.wNAF(h);c=y.constTimeNegate(t,c),l=y.constTimeNegate(a,l),l=new p(r.mul(l.px,n.beta),l.py,l.pz),i=c.add(l),s=u.add(f)}else{let{p:t,f:r}=this.wNAF(e);i=t,s=r}return p.normalizeZ([i,s])[0]}multiplyAndAddUnsafe(e,t,r){let i=p.BASE,s=(e,t)=>t!==nn&&t!==no&&e.equals(i)?e.multiply(t):e.multiplyUnsafe(t),n=s(this,t).add(s(e,r));return n.is0()?void 0:n}toAffine(e){return f(this,e)}isTorsionFree(){let{h:e,isTorsionFree:r}=t;if(e===no)return!0;if(r)return r(p,this);throw Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:e,clearCofactor:r}=t;return e===no?this:r?r(p,this):this.multiplyUnsafe(t.h)}toRawBytes(e=!0){return(0,nt.abool)("isCompressed",e),this.assertValidity(),s(p,this,e)}toHex(e=!0){return(0,nt.abool)("isCompressed",e),(0,nt.bytesToHex)(this.toRawBytes(e))}}p.BASE=new p(t.Gx,t.Gy,r.ONE),p.ZERO=new p(r.ZERO,r.ONE,r.ZERO);let{endo:g,nBitLength:b}=t,y=(0,s7.wNAF)(p,g?Math.ceil(b/2):b);return{CURVE:t,ProjectivePoint:p,normPrivateKeyToScalar:u,weierstrassEquation:o,isWithinCurveOrder:function(e){return(0,nt.inRange)(e,no,t.n)}}}function nl(e,t){let r=e.ORDER,i=nn;for(let e=r-no;e%na===nn;e/=na)i+=no;let s=i,n=na<<s-no-no,o=n*na,a=(r-no)/o,h=(a-no)/na,c=o-no,u=e.pow(t,a),l=e.pow(t,(a+no)/na),f=(t,r)=>{let i=u,o=e.pow(r,c),a=e.sqr(o);a=e.mul(a,r);let f=e.mul(t,a);f=e.pow(f,h),f=e.mul(f,o),o=e.mul(f,r),a=e.mul(f,t);let d=e.mul(a,o);f=e.pow(d,n);let p=e.eql(f,e.ONE);o=e.mul(a,l),f=e.mul(d,i),a=e.cmov(o,a,p),d=e.cmov(f,d,p);for(let t=s;t>no;t--){let r=t-na;r=na<<r-no;let s=e.pow(d,r),n=e.eql(s,e.ONE);o=e.mul(a,i),i=e.mul(i,i),s=e.mul(d,i),a=e.cmov(o,a,n),d=e.cmov(s,d,n)}return{isValid:p,value:a}};if(e.ORDER%nc===nh){let r=(e.ORDER-nh)/nc,i=e.sqrt(e.neg(t));f=(t,s)=>{let n=e.sqr(s),o=e.mul(t,s);n=e.mul(n,o);let a=e.pow(n,r);a=e.mul(a,o);let h=e.mul(a,i),c=e.mul(e.sqr(a),s),u=e.eql(c,t),l=e.cmov(h,a,u);return{isValid:u,value:l}}}return f}function nf(e){return{hash:e,hmac:(t,...r)=>(0,s5.hmac)(e,t,(0,sb.concatBytes)(...r)),randomBytes:sb.randomBytes}}var nd={};Object.defineProperty(nd,"__esModule",{value:!0}),nd.expand_message_xmd=ny,nd.expand_message_xof=nm,nd.hash_to_field=nv,nd.isogenyMap=function(e,t){let r=t.map(e=>Array.from(e).reverse());return(t,i)=>{let[s,n,o,a]=r.map(r=>r.reduce((r,i)=>e.add(e.mul(r,t),i))),[h,c]=(0,ne.FpInvertBatch)(e,[n,a],!0);return t=e.mul(s,h),i=e.mul(i,e.mul(o,c)),{x:t,y:i}}},nd.createHasher=function(e,t,r){if("function"!=typeof t)throw Error("mapToCurve() must be defined");function i(r){return e.fromAffine(t(r))}function s(t){let r=t.clearCofactor();return r.equals(e.ZERO)?e.ZERO:(r.assertValidity(),r)}return{defaults:r,hashToCurve(e,t){let n=nv(e,2,{...r,DST:r.DST,...t}),o=i(n[0]),a=i(n[1]);return s(o.add(a))},encodeToCurve:(e,t)=>s(i(nv(e,1,{...r,DST:r.encodeDST,...t})[0])),mapToCurve(e){if(!Array.isArray(e))throw Error("expected array of bigints");for(let t of e)if("bigint"!=typeof t)throw Error("expected array of bigints");return s(i(e))}}};var ne=n("es3xL"),nt=n("5l7pf");const np=nt.bytesToNumberBE;function ng(e,t){if(nb(e),nb(t),e<0||e>=1<<8*t)throw Error("invalid I2OSP input: "+e);let r=Array.from({length:t}).fill(0);for(let i=t-1;i>=0;i--)r[i]=255&e,e>>>=8;return new Uint8Array(r)}function nb(e){if(!Number.isSafeInteger(e))throw Error("number expected")}function ny(e,t,r,i){(0,nt.abytes)(e),(0,nt.abytes)(t),nb(r),t.length>255&&(t=i((0,nt.concatBytes)((0,nt.utf8ToBytes)("H2C-OVERSIZE-DST-"),t)));let{outputLen:s,blockLen:n}=i,o=Math.ceil(r/s);if(r>65535||o>255)throw Error("expand_message_xmd: invalid lenInBytes");let a=(0,nt.concatBytes)(t,ng(t.length,1)),h=ng(0,n),c=ng(r,2),u=Array(o),l=i((0,nt.concatBytes)(h,e,c,ng(0,1),a));u[0]=i((0,nt.concatBytes)(l,ng(1,1),a));for(let e=1;e<=o;e++){let t=[function(e,t){let r=new Uint8Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r}(l,u[e-1]),ng(e+1,1),a];u[e]=i((0,nt.concatBytes)(...t))}return(0,nt.concatBytes)(...u).slice(0,r)}function nm(e,t,r,i,s){if((0,nt.abytes)(e),(0,nt.abytes)(t),nb(r),t.length>255){let e=Math.ceil(2*i/8);t=s.create({dkLen:e}).update((0,nt.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(t).digest()}if(r>65535||t.length>255)throw Error("expand_message_xof: invalid lenInBytes");return s.create({dkLen:r}).update(e).update(ng(r,2)).update(t).update(ng(t.length,1)).digest()}function nv(e,t,r){let i;(0,nt.validateObject)(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:s,k:n,m:o,hash:a,expand:h,DST:c}=r;(0,nt.abytes)(e),nb(t);let u="string"==typeof c?(0,nt.utf8ToBytes)(c):c,l=Math.ceil((s.toString(2).length+n)/8),f=t*o*l;if("xmd"===h)i=ny(e,u,f,a);else if("xof"===h)i=nm(e,u,f,n,a);else if("_internal_pass"===h)i=e;else throw Error('expand must be "xmd" or "xof"');let d=Array(t);for(let e=0;e<t;e++){let t=Array(o);for(let r=0;r<o;r++){let n=l*(r+e*o),a=i.subarray(n,n+l);t[r]=(0,ne.mod)(np(a),s)}d[e]=t}return d}var ne=n("es3xL"),nt=n("5l7pf");const nw=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),nD=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),nx=BigInt(0),nE=BigInt(1),n_=BigInt(2),nS=(e,t)=>(e+t/n_)/t;function nI(e){let t=BigInt(3),r=BigInt(6),i=BigInt(11),s=BigInt(22),n=BigInt(23),o=BigInt(44),a=BigInt(88),h=e*e*e%nw,c=h*h*e%nw,u=(0,ne.pow2)(c,t,nw)*c%nw,l=(0,ne.pow2)(u,t,nw)*c%nw,f=(0,ne.pow2)(l,n_,nw)*h%nw,d=(0,ne.pow2)(f,i,nw)*f%nw,p=(0,ne.pow2)(d,s,nw)*d%nw,g=(0,ne.pow2)(p,o,nw)*p%nw,b=(0,ne.pow2)(g,a,nw)*g%nw,y=(0,ne.pow2)(b,o,nw)*p%nw,m=(0,ne.pow2)(y,t,nw)*c%nw,v=(0,ne.pow2)(m,n,nw)*d%nw,w=(0,ne.pow2)(v,r,nw)*h%nw,D=(0,ne.pow2)(w,n_,nw);if(!nA.eql(nA.sqr(D),e))throw Error("Cannot find square root");return D}const nA=(0,ne.Field)(nw,void 0,void 0,{sqrt:nI});sd.secp256k1=(0,s6.createCurve)({a:nx,b:BigInt(7),Fp:nA,n:nD,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:e=>{let t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),r=-nE*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=BigInt("0x100000000000000000000000000000000"),n=nS(t*e,nD),o=nS(-r*e,nD),a=(0,ne.mod)(e-n*t-o*i,nD),h=(0,ne.mod)(-n*r-o*t,nD),c=a>s,u=h>s;if(c&&(a=nD-a),u&&(h=nD-h),a>s||h>s)throw Error("splitScalar: Endomorphism failed, k="+e);return{k1neg:c,k1:a,k2neg:u,k2:h}}}},sp.sha256);const nM={};function nO(e,...t){let r=nM[e];if(void 0===r){let t=(0,sp.sha256)(Uint8Array.from(e,e=>e.charCodeAt(0)));r=(0,nt.concatBytes)(t,t),nM[e]=r}return(0,sp.sha256)((0,nt.concatBytes)(r,...t))}const nC=e=>e.toRawBytes(!0).slice(1),nP=e=>(0,nt.numberToBytesBE)(e,32),nR=e=>(0,ne.mod)(e,nw),nT=e=>(0,ne.mod)(e,nD),nN=sd.secp256k1.ProjectivePoint;function nB(e){let t=sd.secp256k1.utils.normPrivateKeyToScalar(e),r=nN.fromPrivateKey(t);return{scalar:r.hasEvenY()?t:nT(-t),bytes:nC(r)}}function nL(e){(0,nt.aInRange)("x",e,nE,nw);let t=nR(e*e),r=nI(nR(t*e+BigInt(7)));r%n_!==nx&&(r=nR(-r));let i=new nN(e,r,nE);return i.assertValidity(),i}const nU=nt.bytesToNumberBE;function nk(...e){return nT(nU(nO("BIP0340/challenge",...e)))}function nq(e,t,r){let i=(0,nt.ensureBytes)("signature",e,64),s=(0,nt.ensureBytes)("message",t),n=(0,nt.ensureBytes)("publicKey",r,32);try{let e,t=nL(nU(n)),r=nU(i.subarray(0,32));if(!(0,nt.inRange)(r,nE,nw))return!1;let o=nU(i.subarray(32,64));if(!(0,nt.inRange)(o,nE,nD))return!1;let a=nk(nP(r),nC(t),s),h=(e=nT(-a),nN.BASE.multiplyAndAddUnsafe(t,o,e));if(!h||!h.hasEvenY()||h.toAffine().x!==r)return!1;return!0}catch(e){return!1}}sd.schnorr={getPublicKey:function(e){return nB(e).bytes},sign:function(e,t,r=(0,sb.randomBytes)(32)){let i=(0,nt.ensureBytes)("message",e),{bytes:s,scalar:n}=nB(t),o=nP(n^nU(nO("BIP0340/aux",(0,nt.ensureBytes)("auxRand",r,32)))),a=nT(nU(nO("BIP0340/nonce",o,s,i)));if(a===nx)throw Error("sign failed: k is zero");let{bytes:h,scalar:c}=nB(a),u=nk(h,s,i),l=new Uint8Array(64);if(l.set(h,0),l.set(nP(nT(c+u*n)),32),!nq(l,i,s))throw Error("sign: Invalid signature produced");return l},verify:nq,utils:{randomPrivateKey:sd.secp256k1.utils.randomPrivateKey,lift_x:nL,pointToBytes:nC,numberToBytesBE:nt.numberToBytesBE,bytesToNumberBE:nt.bytesToNumberBE,taggedHash:nO,mod:ne.mod}};const nj=(0,nd.isogenyMap)(nA,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(e=>e.map(e=>BigInt(e)))),nz=(0,s9.mapToCurveSimpleSWU)(nA,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:nA.create(BigInt("-11"))});sd.secp256k1_hasher=(0,nd.createHasher)(sd.secp256k1.ProjectivePoint,e=>{let{x:t,y:r}=nz(nA.create(e[0]));return nj(t,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:nA.ORDER,m:1,k:128,expand:"xmd",hash:sp.sha256}),sd.hashToCurve=sd.secp256k1_hasher.hashToCurve,sd.encodeToCurve=sd.secp256k1_hasher.encodeToCurve;var nt=n("5l7pf");class nF extends Error{constructor(e,t={}){let r=(()=>{if(t.cause instanceof nF){if(t.cause.details)return t.cause.details;if(t.cause.shortMessage)return t.cause.shortMessage}return t.cause&&"details"in t.cause&&"string"==typeof t.cause.details?t.cause.details:t.cause?.message?t.cause.message:t.details})(),i=t.cause instanceof nF&&t.cause.docsPath||t.docsPath,s=`https://oxlib.sh${i??""}`;super([e||"An error occurred.",...t.metaMessages?["",...t.metaMessages]:[],...r||i?["",r?`Details: ${r}`:void 0,i?`See: ${s}`:void 0]:[]].filter(e=>"string"==typeof e).join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:"ox@0.1.1"}),this.cause=t.cause,this.details=r,this.docs=s,this.docsPath=i,this.shortMessage=e}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&t.cause?e(t.cause,r):r?null:t}(this,e)}}var nt=n("5l7pf");function n$(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function nK(e,t){if(n0(e)>t)throw new n6({givenSize:n0(e),maxSize:t})}function nV(e,t={}){let{dir:r,size:i=32}=t;if(0===i)return e;let s=e.replace("0x","");if(s.length>2*i)throw new n4({size:Math.ceil(s.length/2),targetSize:i,type:"Hex"});return`0x${s["right"===r?"padEnd":"padStart"](2*i,"0")}`}function nH(e,t,r){return JSON.stringify(e,(e,r)=>"function"==typeof t?t(e,r):"bigint"==typeof r?r.toString()+"#__bigint":r,r)}const nG=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function nW(...e){return`0x${e.reduce((e,t)=>e+t.replace("0x",""),"")}`}function nY(e){return e instanceof Uint8Array?nJ(e):Array.isArray(e)?nJ(new Uint8Array(e)):e}function nJ(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=nG[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(nK(i,t.size),nX(i,t.size)):i}function nZ(e,t={}){let r,{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<o){let t="bigint"==typeof e?"n":"";throw new n2({max:r?`${r}${t}`:void 0,min:`${o}${t}`,signed:i,size:s,value:`${e}${t}`})}let a=(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16),h=`0x${a}`;return s?nV(h,{dir:"left",size:s}):h}function nX(e,t){return nV(e,{dir:"right",size:t})}function nQ(e,t,r,i={}){let{strict:s}=i;if("number"==typeof t&&t>0&&t>n0(e)-1)throw new n5({offset:t,position:"start",size:n0(e)});let n=`0x${e.replace("0x","").slice((t??0)*2,(r??e.length)*2)}`;return s&&function(e,t,r){if("number"==typeof t&&"number"==typeof r&&n0(e)!==r-t)throw new n5({offset:r,position:"end",size:n0(e)})}(n,t,r),n}function n0(e){return Math.ceil((e.length-2)/2)}function n1(e){return function(e,t={}){let{dir:r="left"}=t,i=e.replace("0x",""),s=0;for(let e=0;e<i.length-1;e++)if("0"===i["left"===r?e:i.length-e-1].toString())s++;else break;return"0"===(i="left"===r?i.slice(s):i.slice(0,i.length-s))?"0x":"right"===r&&i.length%2==1?`0x${i}0`:`0x${i}`}(e,{dir:"left"})}class n2 extends nF{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number \`${s}\` is not in safe${i?` ${8*i}-bit`:""}${r?" signed":" unsigned"} integer range ${e?`(\`${t}\` to \`${e}\`)`:`(above \`${t}\`)`}`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.IntegerOutOfRangeError"})}}class n3 extends nF{constructor(e){super(`Value \`${"object"==typeof e?nH(e):e}\` of type \`${typeof e}\` is an invalid hex type.`,{metaMessages:['Hex types must be represented as `"0x${string}"`.']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexTypeError"})}}class n8 extends nF{constructor(e){super(`Value \`${e}\` is an invalid hex value.`,{metaMessages:['Hex values must start with `"0x"` and contain only hexadecimal characters (0-9, a-f, A-F).']}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.InvalidHexValueError"})}}class n6 extends nF{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeOverflowError"})}}class n5 extends nF{constructor({offset:e,position:t,size:r}){super(`Slice ${"start"===t?"starting":"ending"} at offset \`${e}\` is out-of-bounds (size: \`${r}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SliceOffsetOutOfBoundsError"})}}class n4 extends nF{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Hex.SizeExceedsPaddingSizeError"})}}const n9=new TextEncoder;function n7(e){var t;return e instanceof Uint8Array?e:"string"==typeof e?oe(e):(t=e)instanceof Uint8Array?t:new Uint8Array(t)}function oe(e,t={}){let{size:r}=t,i=e;r&&(nK(e,r),i=nX(e,r));let s=i.slice(2);s.length%2&&(s=`0${s}`);let n=s.length/2,o=new Uint8Array(n);for(let e=0,t=0;e<n;e++){let r=n$(s.charCodeAt(t++)),i=n$(s.charCodeAt(t++));if(void 0===r||void 0===i)throw new nF(`Invalid byte sequence ("${s[t-2]}${s[t-1]}" in "${s}").`);o[e]=16*r+i}return o}class ot extends nF{constructor(e){super(`Value \`${"object"==typeof e?nH(e):e}\` of type \`${typeof e}\` is an invalid Bytes value.`,{metaMessages:["Bytes values must be of type `Bytes`."]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.InvalidBytesTypeError"})}}class or extends nF{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed \`${t}\` bytes. Given size: \`${e}\` bytes.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeOverflowError"})}}class oi extends nF{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (\`${e}\`) exceeds padding size (\`${t}\`).`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Bytes.SizeExceedsPaddingSizeError"})}}class os extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}const on={checksum:new os(8192)}.checksum;var oo={};Object.defineProperty(oo,"__esModule",{value:!0}),oo.ripemd160=oo.RIPEMD160=void 0;var oa={};Object.defineProperty(oa,"__esModule",{value:!0}),oa.ripemd160=oa.RIPEMD160=oa.md5=oa.MD5=oa.sha1=oa.SHA1=void 0;var sb=n("cLJKR");const oh=Uint32Array.from([0x67452301,0xefcdab89,0x98badcfe,0x10325476,0xc3d2e1f0]),oc=new Uint32Array(80);class ou extends sg.HashMD{constructor(){super(64,20,8,!1),this.A=0|oh[0],this.B=0|oh[1],this.C=0|oh[2],this.D=0|oh[3],this.E=0|oh[4]}get(){let{A:e,B:t,C:r,D:i,E:s}=this;return[e,t,r,i,s]}set(e,t,r,i,s){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s}process(e,t){for(let r=0;r<16;r++,t+=4)oc[r]=e.getUint32(t,!1);for(let e=16;e<80;e++)oc[e]=(0,sb.rotl)(oc[e-3]^oc[e-8]^oc[e-14]^oc[e-16],1);let{A:r,B:i,C:s,D:n,E:o}=this;for(let e=0;e<80;e++){let t,a;e<20?(t=(0,sg.Chi)(i,s,n),a=0x5a827999):e<40?(t=i^s^n,a=0x6ed9eba1):e<60?(t=(0,sg.Maj)(i,s,n),a=0x8f1bbcdc):(t=i^s^n,a=0xca62c1d6);let h=(0,sb.rotl)(r,5)+t+o+a+oc[e]|0;o=n,n=s,s=(0,sb.rotl)(i,30),i=r,r=h}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,o=o+this.E|0,this.set(r,i,s,n,o)}roundClean(){(0,sb.clean)(oc)}destroy(){this.set(0,0,0,0,0),(0,sb.clean)(this.buffer)}}oa.SHA1=ou,oa.sha1=(0,sb.createHasher)(()=>new ou);const ol=Array.from({length:64},(e,t)=>Math.floor(0x100000000*Math.abs(Math.sin(t+1)))),of=oh.slice(0,4),od=new Uint32Array(16);class op extends sg.HashMD{constructor(){super(64,16,8,!0),this.A=0|of[0],this.B=0|of[1],this.C=0|of[2],this.D=0|of[3]}get(){let{A:e,B:t,C:r,D:i}=this;return[e,t,r,i]}set(e,t,r,i){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i}process(e,t){for(let r=0;r<16;r++,t+=4)od[r]=e.getUint32(t,!0);let{A:r,B:i,C:s,D:n}=this;for(let e=0;e<64;e++){let t,o,a;e<16?(t=(0,sg.Chi)(i,s,n),o=e,a=[7,12,17,22]):e<32?(t=(0,sg.Chi)(n,i,s),o=(5*e+1)%16,a=[5,9,14,20]):e<48?(t=i^s^n,o=(3*e+5)%16,a=[4,11,16,23]):(t=s^(i|~n),o=7*e%16,a=[6,10,15,21]),t=t+r+ol[e]+od[o],r=n,n=s,s=i,i+=(0,sb.rotl)(t,a[e%4])}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,this.set(r,i,s,n)}roundClean(){(0,sb.clean)(od)}destroy(){this.set(0,0,0,0),(0,sb.clean)(this.buffer)}}oa.MD5=op,oa.md5=(0,sb.createHasher)(()=>new op);const og=Uint8Array.from([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),ob=Uint8Array.from(Array(16).fill(0).map((e,t)=>t)),oy=ob.map(e=>(9*e+5)%16),om=(()=>{let e=[[ob],[oy]];for(let t=0;t<4;t++)for(let r of e)r.push(r[t].map(e=>og[e]));return e})(),ov=om[0],ow=om[1],oD=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(e=>Uint8Array.from(e)),ox=ov.map((e,t)=>e.map(e=>oD[t][e])),oE=ow.map((e,t)=>e.map(e=>oD[t][e])),o_=Uint32Array.from([0,0x5a827999,0x6ed9eba1,0x8f1bbcdc,0xa953fd4e]),oS=Uint32Array.from([0x50a28be6,0x5c4dd124,0x6d703ef3,0x7a6d76e9,0]);function oI(e,t,r,i){return 0===e?t^r^i:1===e?t&r|~t&i:2===e?(t|~r)^i:3===e?t&i|r&~i:t^(r|~i)}const oA=new Uint32Array(16);class oM extends sg.HashMD{constructor(){super(64,20,8,!0),this.h0=0x67452301,this.h1=-0x10325477,this.h2=-0x67452302,this.h3=0x10325476,this.h4=-0x3c2d1e10}get(){let{h0:e,h1:t,h2:r,h3:i,h4:s}=this;return[e,t,r,i,s]}set(e,t,r,i,s){this.h0=0|e,this.h1=0|t,this.h2=0|r,this.h3=0|i,this.h4=0|s}process(e,t){for(let r=0;r<16;r++,t+=4)oA[r]=e.getUint32(t,!0);let r=0|this.h0,i=r,s=0|this.h1,n=s,o=0|this.h2,a=o,h=0|this.h3,c=h,u=0|this.h4,l=u;for(let e=0;e<5;e++){let t=4-e,f=o_[e],d=oS[e],p=ov[e],g=ow[e],b=ox[e],y=oE[e];for(let t=0;t<16;t++){let i=(0,sb.rotl)(r+oI(e,s,o,h)+oA[p[t]]+f,b[t])+u|0;r=u,u=h,h=0|(0,sb.rotl)(o,10),o=s,s=i}for(let e=0;e<16;e++){let r=(0,sb.rotl)(i+oI(t,n,a,c)+oA[g[e]]+d,y[e])+l|0;i=l,l=c,c=0|(0,sb.rotl)(a,10),a=n,n=r}}this.set(this.h1+o+c|0,this.h2+h+l|0,this.h3+u+i|0,this.h4+r+n|0,this.h0+s+a|0)}roundClean(){(0,sb.clean)(oA)}destroy(){this.destroyed=!0,(0,sb.clean)(this.buffer),this.set(0,0,0,0,0)}}oa.RIPEMD160=oM,oa.ripemd160=(0,sb.createHasher)(()=>new oM),oo.RIPEMD160=oa.RIPEMD160,oo.ripemd160=oa.ripemd160;var oO={};Object.defineProperty(oO,"__esModule",{value:!0}),oO.shake256=oO.shake128=oO.keccak_512=oO.keccak_384=oO.keccak_256=oO.keccak_224=oO.sha3_512=oO.sha3_384=oO.sha3_256=oO.sha3_224=oO.Keccak=void 0,oO.keccakP=oK;var sb=n("cLJKR");const oC=BigInt(0),oP=BigInt(1),oR=BigInt(2),oT=BigInt(7),oN=BigInt(256),oB=BigInt(113),oL=[],oU=[],ok=[];for(let e=0,t=oP,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],oL.push(2*(5*i+r)),oU.push((e+1)*(e+2)/2%64);let s=oC;for(let e=0;e<7;e++)(t=(t<<oP^(t>>oT)*oB)%oN)&oR&&(s^=oP<<(oP<<BigInt(e))-oP);ok.push(s)}const oq=(0,sv.split)(ok,!0),oj=oq[0],oz=oq[1],oF=(e,t,r)=>r>32?(0,sv.rotlBH)(e,t,r):(0,sv.rotlSH)(e,t,r),o$=(e,t,r)=>r>32?(0,sv.rotlBL)(e,t,r):(0,sv.rotlSL)(e,t,r);function oK(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=oF(n,o,1)^r[i],h=o$(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=h}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=oU[r],n=oF(t,s,i),o=o$(t,s,i),a=oL[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=oj[i],e[1]^=oz[i]}(0,sb.clean)(r)}class oV extends sb.Hash{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,(0,sb.anumber)(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=(0,sb.u32)(this.state)}clone(){return this._cloneInto()}keccak(){(0,sb.swap32IfBE)(this.state32),oK(this.state32,this.rounds),(0,sb.swap32IfBE)(this.state32),this.posOut=0,this.pos=0}update(e){(0,sb.aexists)(this),e=(0,sb.toBytes)(e),(0,sb.abytes)(e);let{blockLen:t,state:r}=this,i=e.length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,sb.aexists)(this,!1),(0,sb.abytes)(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,sb.anumber)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,sb.aoutput)(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,(0,sb.clean)(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new oV(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}oO.Keccak=oV;const oH=(e,t,r)=>(0,sb.createHasher)(()=>new oV(t,e,r));oO.sha3_224=oH(6,144,28),oO.sha3_256=oH(6,136,32),oO.sha3_384=oH(6,104,48),oO.sha3_512=oH(6,72,64),oO.keccak_224=oH(1,144,28),oO.keccak_256=oH(1,136,32),oO.keccak_384=oH(1,104,48),oO.keccak_512=oH(1,72,64);const oG=(e,t,r)=>(0,sb.createXOFer)((i={})=>new oV(t,e,void 0===i.dkLen?r:i.dkLen,!0));oO.shake128=oG(31,168,16),oO.shake256=oG(31,136,32);var oW={};function oY(e,t={}){let{as:r="string"==typeof e?"Hex":"Bytes"}=t,i=(0,oO.keccak_256)(n7(e));return"Bytes"===r?i:nJ(i)}function oJ(e,t={}){let{compressed:r}=t,{prefix:i,x:s,y:n}=e;if(!1===r||"bigint"==typeof s&&"bigint"==typeof n){if(4!==i)throw new o1({prefix:i,cause:new o3});return}if(!0===r||"bigint"==typeof s&&void 0===n){if(3!==i&&2!==i)throw new o1({prefix:i,cause:new o2});return}throw new o0({publicKey:e})}function oZ(e){let t=(()=>{if(function(e,t={}){let{strict:r=!1}=t;try{return!function(e,t={}){let{strict:r=!1}=t;if(!e||"string"!=typeof e)throw new n3(e);if(r&&!/^0x[0-9a-fA-F]*$/.test(e)||!e.startsWith("0x"))throw new n8(e)}(e,{strict:r}),!0}catch{return!1}}(e))return oX(e);if(function(e){try{if(!(e instanceof Uint8Array)&&(!e||"object"!=typeof e||!("BYTES_PER_ELEMENT"in e)||1!==e.BYTES_PER_ELEMENT||"Uint8Array"!==e.constructor.name))throw new ot(e);return!0}catch{return!1}}(e))return oX(nJ(e));let{prefix:t,x:r,y:i}=e;return"bigint"==typeof r&&"bigint"==typeof i?{prefix:t??4,x:r,y:i}:{prefix:t,x:r}})();return oJ(t),t}function oX(e){if(132!==e.length&&130!==e.length&&68!==e.length)throw new o8({publicKey:e});if(130===e.length)return{prefix:4,x:BigInt(nQ(e,0,32)),y:BigInt(nQ(e,32,64))};if(132===e.length){let t=Number(nQ(e,0,1));return{prefix:t,x:BigInt(nQ(e,1,33)),y:BigInt(nQ(e,33,65))}}return{prefix:Number(nQ(e,0,1)),x:BigInt(nQ(e,1,33))}}function oQ(e,t={}){oJ(e);let{prefix:r,x:i,y:s}=e,{includePrefix:n=!0}=t;return nW(n?nZ(r,{size:1}):"0x",nZ(i,{size:32}),"bigint"==typeof s?nZ(s,{size:32}):"0x")}Object.defineProperty(oW,"__esModule",{value:!0}),oW.sha224=oW.SHA224=oW.sha256=oW.SHA256=void 0,oW.SHA256=sp.SHA256,oW.sha256=sp.sha256,oW.SHA224=sp.SHA224,oW.sha224=sp.sha224;class o0 extends nF{constructor({publicKey:e}){super(`Value \`${nH(e)}\` is not a valid public key.`,{metaMessages:["Public key must contain:","- an `x` and `prefix` value (compressed)","- an `x`, `y`, and `prefix` value (uncompressed)"]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidError"})}}class o1 extends nF{constructor({prefix:e,cause:t}){super(`Prefix "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidPrefixError"})}}class o2 extends nF{constructor(){super("Prefix must be 2 or 3 for compressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidCompressedPrefixError"})}}class o3 extends nF{constructor(){super("Prefix must be 4 for uncompressed public keys."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidUncompressedPrefixError"})}}class o8 extends nF{constructor({publicKey:e}){super(`Value \`${e}\` is an invalid public key size.`,{metaMessages:["Expected: 33 bytes (compressed + prefix), 64 bytes (uncompressed) or 65 bytes (uncompressed + prefix).",`Received ${n0(nY(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"PublicKey.InvalidSerializedSizeError"})}}const o6=/^0x[a-fA-F0-9]{40}$/;function o5(e,t={}){let{strict:r=!0}=t;if(!o6.test(e))throw new o9({address:e,cause:new o7});if(r){if(e.toLowerCase()===e)return;if(o4(e)!==e)throw new o9({address:e,cause:new ae})}}function o4(e){if(on.has(e))return on.get(e);o5(e,{strict:!1});let t=e.substring(2).toLowerCase(),r=oY(function(e,t={}){let{size:r}=t,i=n9.encode(e);if("number"==typeof r){if(i.length>r)throw new or({givenSize:i.length,maxSize:r});return function(e,t={}){let{dir:r,size:i=32}=t;if(0===i)return e;if(e.length>i)throw new oi({size:e.length,targetSize:i,type:"Bytes"});let s=new Uint8Array(i);for(let t=0;t<i;t++){let n="right"===r;s[n?t:i-t-1]=e[n?t:e.length-t-1]}return s}(i,{dir:"right",size:r})}return i}(t),{as:"Bytes"}),i=t.split("");for(let e=0;e<40;e+=2)r[e>>1]>>4>=8&&i[e]&&(i[e]=i[e].toUpperCase()),(15&r[e>>1])>=8&&i[e+1]&&(i[e+1]=i[e+1].toUpperCase());let s=`0x${i.join("")}`;return on.set(e,s),s}class o9 extends nF{constructor({address:e,cause:t}){super(`Address "${e}" is invalid.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidAddressError"})}}class o7 extends nF{constructor(){super("Address is not a 20 byte (40 hexadecimal character) value."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidInputError"})}}class ae extends nF{constructor(){super("Address does not match its checksum counterpart."),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Address.InvalidChecksumError"})}}const at=sd.secp256k1;function ar(e={}){let{as:t="Hex"}=e,r=an({as:t}),i=ai({privateKey:r});return{privateKey:r,publicKey:i}}function ai(e){let{privateKey:t}=e;return oZ(sd.secp256k1.ProjectivePoint.fromPrivateKey(nY(t).slice(2)))}function as(e){let{as:t="Hex",privateKey:r,publicKey:i}=e,s=sd.secp256k1.ProjectivePoint.fromHex(oQ(i).slice(2)).multiply(sd.secp256k1.utils.normPrivateKeyToScalar(nY(r).slice(2))).toRawBytes(!0);return"Hex"===t?nJ(s):s}function an(e={}){let{as:t="Hex"}=e,r=sd.secp256k1.utils.randomPrivateKey();return"Hex"===t?nJ(r):r}function ao(e){return function(e,t={}){let r=oY(`0x${oQ(e).slice(4)}`).substring(26);return function(e,t={}){let{checksum:r=!1}=t;return(o5(e),r)?o4(e):e}(`0x${r}`,t)}(aa(e))}function aa(e){let{payload:t,signature:r}=e,{r:i,s:s,yParity:n}=r;return oZ(new sd.secp256k1.Signature(BigInt(i),BigInt(s)).addRecoveryBit(n).recoverPublicKey(nY(t).substring(2)))}function ah(e){let{extraEntropy:t=!1,hash:r,payload:i,privateKey:s}=e,{r:n,s:o,recovery:a}=sd.secp256k1.sign(n7(i),n7(s),{extraEntropy:"boolean"==typeof t?t:nY(t).slice(2),lowS:!0,...r?{prehash:!0}:{}});return{r:n,s:o,yParity:a}}function ac(e){let{address:t,hash:r,payload:i,publicKey:s,signature:n}=e;if(t){var o;return o=ao({payload:i,signature:n}),o5(t,{strict:!1}),o5(o,{strict:!1}),t.toLowerCase()===o.toLowerCase()}return sd.secp256k1.verify(n,n7(i),function(e,t={}){return oe(oQ(e,t))}(s),...r?[{prehash:!0,lowS:!0}]:[])}var au={};e(au,"assert",()=>af),e(au,"MissingPropertiesError",()=>aT),e(au,"InvalidRError",()=>aN),e(au,"InvalidSError",()=>aB),e(au,"InvalidYParityError",()=>aL),e(au,"fromBytes",()=>ad),e(au,"fromHex",()=>ap),e(au,"InvalidSerializedSizeError",()=>aR),e(au,"vToYParity",()=>aC),e(au,"extract",()=>ag),e(au,"from",()=>ab),e(au,"fromRpc",()=>aw),e(au,"fromLegacy",()=>av),e(au,"fromDerBytes",()=>ay),e(au,"fromDerHex",()=>am),e(au,"fromTuple",()=>aD),e(au,"toBytes",()=>ax),e(au,"toHex",()=>aE),e(au,"yParityToV",()=>aP),e(au,"toDerBytes",()=>a_),e(au,"toDerHex",()=>aS),e(au,"toLegacy",()=>aI),e(au,"toRpc",()=>aA),e(au,"toTuple",()=>aM),e(au,"validate",()=>aO),e(au,"InvalidVError",()=>aU);const al=2n**256n-1n;function af(e,t={}){let{recovered:r}=t;if(void 0===e.r||void 0===e.s||r&&void 0===e.yParity)throw new aT({signature:e});if(e.r<0n||e.r>al)throw new aN({value:e.r});if(e.s<0n||e.s>al)throw new aB({value:e.s});if("number"==typeof e.yParity&&0!==e.yParity&&1!==e.yParity)throw new aL({value:e.yParity})}function ad(e){return ap(nJ(e))}function ap(e){if(130!==e.length&&132!==e.length)throw new aR({signature:e});let t=BigInt(nQ(e,0,32)),r=BigInt(nQ(e,32,64)),i=(()=>{let t=Number(`0x${e.slice(130)}`);if(!Number.isNaN(t))try{return aC(t)}catch{throw new aL({value:t})}})();return void 0===i?{r:t,s:r}:{r:t,s:r,yParity:i}}function ag(e){if(void 0!==e.r&&void 0!==e.s)return ab(e)}function ab(e){let t="string"==typeof e?ap(e):e instanceof Uint8Array?ad(e):"string"==typeof e.r?aw(e):e.v?av(e):{r:e.r,s:e.s,...void 0!==e.yParity?{yParity:e.yParity}:{}};return af(t),t}function ay(e){return am(nJ(e))}function am(e){let{r:t,s:r}=sd.secp256k1.Signature.fromDER(nY(e).slice(2));return{r:t,s:r}}function av(e){return{r:e.r,s:e.s,yParity:aC(e.v)}}function aw(e){let t=(()=>{let t=e.v?Number(e.v):void 0,r=e.yParity?Number(e.yParity):void 0;if("number"==typeof t&&"number"!=typeof r&&(r=aC(t)),"number"!=typeof r)throw new aL({value:e.yParity});return r})();return{r:BigInt(e.r),s:BigInt(e.s),yParity:t}}function aD(e){let[t,r,i]=e;return ab({r:"0x"===r?0n:BigInt(r),s:"0x"===i?0n:BigInt(i),yParity:"0x"===t?0:Number(t)})}function ax(e){return oe(aE(e))}function aE(e){af(e);let t=e.r,r=e.s;return nW(nZ(t,{size:32}),nZ(r,{size:32}),"number"==typeof e.yParity?nZ(aP(e.yParity),{size:1}):"0x")}function a_(e){return new sd.secp256k1.Signature(e.r,e.s).toDERRawBytes()}function aS(e){let t=new sd.secp256k1.Signature(e.r,e.s);return`0x${t.toDERHex()}`}function aI(e){return{r:e.r,s:e.s,v:aP(e.yParity)}}function aA(e){let{r:t,s:r,yParity:i}=e;return{r:nZ(t,{size:32}),s:nZ(r,{size:32}),yParity:0===i?"0x0":"0x1"}}function aM(e){let{r:t,s:r,yParity:i}=e;return[i?"0x01":"0x",0n===t?"0x":n1(nZ(t)),0n===r?"0x":n1(nZ(r))]}function aO(e,t={}){try{return af(e,t),!0}catch{return!1}}function aC(e){if(0===e||27===e)return 0;if(1===e||28===e)return 1;if(e>=35)return+(e%2==0);throw new aU({value:e})}function aP(e){if(0===e)return 27;if(1===e)return 28;throw new aL({value:e})}class aR extends nF{constructor({signature:e}){super(`Value \`${e}\` is an invalid signature size.`,{metaMessages:["Expected: 64 bytes or 65 bytes.",`Received ${n0(nY(e))} bytes.`]}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSerializedSizeError"})}}class aT extends nF{constructor({signature:e}){super(`Signature \`${nH(e)}\` is missing either an \`r\`, \`s\`, or \`yParity\` property.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.MissingPropertiesError"})}}class aN extends nF{constructor({value:e}){super(`Value \`${e}\` is an invalid r value. r must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidRError"})}}class aB extends nF{constructor({value:e}){super(`Value \`${e}\` is an invalid s value. s must be a positive integer less than 2^256.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidSError"})}}class aL extends nF{constructor({value:e}){super(`Value \`${e}\` is an invalid y-parity value. Y-parity must be 0 or 1.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidYParityError"})}}class aU extends nF{constructor({value:e}){super(`Value \`${e}\` is an invalid v value. v must be 27, 28 or >=35.`),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"Signature.InvalidVError"})}}var ak=function(e){if(e.length>=255)throw TypeError("Alphabet too long");let t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){let i=e.charAt(r),s=i.charCodeAt(0);if(255!==t[s])throw TypeError(i+" is ambiguous");t[s]=r}let r=e.length,i=e.charAt(0),s=Math.log(r)/Math.log(256),n=Math.log(256)/Math.log(r);function o(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;let n=0,o=0,a=0;for(;e[n]===i;)o++,n++;let h=(e.length-n)*s+1>>>0,c=new Uint8Array(h);for(;n<e.length;){let i=e.charCodeAt(n);if(i>255)return;let s=t[i];if(255===s)return;let o=0;for(let e=h-1;(0!==s||o<a)&&-1!==e;e--,o++)s+=r*c[e]>>>0,c[e]=s%256>>>0,s=s/256>>>0;if(0!==s)throw Error("Non-zero carry");a=o,n++}let u=h-a;for(;u!==h&&0===c[u];)u++;let l=new Uint8Array(o+(h-u)),f=o;for(;u!==h;)l[f++]=c[u++];return l}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";let s=0,o=0,a=0,h=t.length;for(;a!==h&&0===t[a];)a++,s++;let c=(h-a)*n+1>>>0,u=new Uint8Array(c);for(;a!==h;){let e=t[a],i=0;for(let t=c-1;(0!==e||i<o)&&-1!==t;t--,i++)e+=256*u[t]>>>0,u[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw Error("Non-zero carry");o=i,a++}let l=c-o;for(;l!==c&&0===u[l];)l++;let f=i.repeat(s);for(;l<c;++l)f+=e.charAt(u[l]);return f},decodeUnsafe:o,decode:function(e){let t=o(e);if(t)return t;throw Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");function aq(e){return`${e<0?"-":""}0x${Math.abs(e).toString(16).padStart(2,"0")}`}class aj{constructor(e,t){this.type=e,this.data=t}}class az extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Object.create(az.prototype)),Object.defineProperty(this,"name",{configurable:!0,enumerable:!1,value:az.name})}}function aF(e,t,r){let i=Math.floor(r/0x100000000);e.setUint32(t,i),e.setUint32(t+4,r)}function a$(e,t){return 0x100000000*e.getInt32(t)+e.getUint32(t+4)}const aK={type:-1,encode:function(e){return e instanceof Date?function({sec:e,nsec:t}){if(e>=0&&t>=0&&e<=0x3ffffffff)if(0===t&&e<=0xffffffff){let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e),t}else{let r=e/0x100000000,i=new Uint8Array(8),s=new DataView(i.buffer);return s.setUint32(0,t<<2|3&r),s.setUint32(4,0|e),i}{let r=new Uint8Array(12),i=new DataView(r.buffer);return i.setUint32(0,t),aF(i,4,e),r}}(function(e){let t=e.getTime(),r=Math.floor(t/1e3),i=(t-1e3*r)*1e6,s=Math.floor(i/1e9);return{sec:r+s,nsec:i-1e9*s}}(e)):null},decode:function(e){let t=function(e){let t=new DataView(e.buffer,e.byteOffset,e.byteLength);switch(e.byteLength){case 4:return{sec:t.getUint32(0),nsec:0};case 8:{let e=t.getUint32(0);return{sec:(3&e)*0x100000000+t.getUint32(4),nsec:e>>>2}}case 12:return{sec:a$(t,4),nsec:t.getUint32(0)};default:throw new az(`Unrecognized data size for timestamp (expected 4, 8, or 12): ${e.length}`)}}(e);return new Date(1e3*t.sec+t.nsec/1e6)}};class aV{constructor(){this.builtInEncoders=[],this.builtInDecoders=[],this.encoders=[],this.decoders=[],this.register(aK)}register({type:e,encode:t,decode:r}){if(e>=0)this.encoders[e]=t,this.decoders[e]=r;else{let i=-1-e;this.builtInEncoders[i]=t,this.builtInDecoders[i]=r}}tryToEncode(e,t){for(let r=0;r<this.builtInEncoders.length;r++){let i=this.builtInEncoders[r];if(null!=i){let s=i(e,t);if(null!=s)return new aj(-1-r,s)}}for(let r=0;r<this.encoders.length;r++){let i=this.encoders[r];if(null!=i){let s=i(e,t);if(null!=s)return new aj(r,s)}}return e instanceof aj?e:null}decode(e,t,r){let i=t<0?this.builtInDecoders[-1-t]:this.decoders[t];return i?i(e,t,r):new aj(t,e)}}aV.defaultCodec=new aV;const aH=new TextEncoder;function aG(e,t,r){let i=t,s=i+r,n=[],o="";for(;i<s;){let t=e[i++];if((128&t)==0)n.push(t);else if((224&t)==192){let r=63&e[i++];n.push((31&t)<<6|r)}else if((240&t)==224){let r=63&e[i++],s=63&e[i++];n.push((31&t)<<12|r<<6|s)}else if((248&t)==240){let r=63&e[i++],s=(7&t)<<18|r<<12|(63&e[i++])<<6|63&e[i++];s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s)}else n.push(t);n.length>=4096&&(o+=String.fromCharCode(...n),n.length=0)}return n.length>0&&(o+=String.fromCharCode(...n)),o}const aW=new TextDecoder;function aY(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer?new Uint8Array(e):Uint8Array.from(e)}const aJ="array",aZ="map_key",aX="map_value",aQ=e=>{if("string"==typeof e||"number"==typeof e)return e;throw new az("The type of key must be string or number but "+typeof e)};class a0{constructor(){this.stack=[],this.stackHeadPosition=-1}get length(){return this.stackHeadPosition+1}top(){return this.stack[this.stackHeadPosition]}pushArrayState(e){let t=this.getUninitializedStateFromPool();t.type=aJ,t.position=0,t.size=e,t.array=Array(e)}pushMapState(e){let t=this.getUninitializedStateFromPool();t.type=aZ,t.readCount=0,t.size=e,t.map={}}getUninitializedStateFromPool(){return this.stackHeadPosition++,this.stackHeadPosition===this.stack.length&&this.stack.push({type:void 0,size:0,array:void 0,position:0,readCount:0,map:void 0,key:null}),this.stack[this.stackHeadPosition]}release(e){if(this.stack[this.stackHeadPosition]!==e)throw Error("Invalid stack state. Released state is not on top of the stack.");e.type===aJ&&(e.size=0,e.array=void 0,e.position=0,e.type=void 0),(e.type===aZ||e.type===aX)&&(e.size=0,e.map=void 0,e.readCount=0,e.type=void 0),this.stackHeadPosition--}reset(){this.stack.length=0,this.stackHeadPosition=-1}}const a1=new DataView(new ArrayBuffer(0)),a2=new Uint8Array(a1.buffer);try{a1.getInt8(0)}catch(e){if(!(e instanceof RangeError))throw Error("This module is not supported in the current JavaScript engine because DataView does not throw RangeError on out-of-bounds access")}const a3=RangeError("Insufficient data"),a8=new class{constructor(e=16,t=16){this.hit=0,this.miss=0,this.maxKeyLength=e,this.maxLengthPerKey=t,this.caches=[];for(let e=0;e<this.maxKeyLength;e++)this.caches.push([])}canBeCached(e){return e>0&&e<=this.maxKeyLength}find(e,t,r){let i=this.caches[r-1];e:for(let s of i){let i=s.bytes;for(let s=0;s<r;s++)if(i[s]!==e[t+s])continue e;return s.str}return null}store(e,t){let r=this.caches[e.length-1],i={bytes:e,str:t};r.length>=this.maxLengthPerKey?r[Math.random()*r.length|0]=i:r.push(i)}decode(e,t,r){let i=this.find(e,t,r);if(null!=i)return this.hit++,i;this.miss++;let s=aG(e,t,r),n=Uint8Array.prototype.slice.call(e,t,t+r);return this.store(n,s),s}};class a6{constructor(e){this.totalPos=0,this.pos=0,this.view=a1,this.bytes=a2,this.headByte=-1,this.stack=new a0,this.entered=!1,this.extensionCodec=e?.extensionCodec??aV.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.rawStrings=e?.rawStrings??!1,this.maxStrLength=e?.maxStrLength??0xffffffff,this.maxBinLength=e?.maxBinLength??0xffffffff,this.maxArrayLength=e?.maxArrayLength??0xffffffff,this.maxMapLength=e?.maxMapLength??0xffffffff,this.maxExtLength=e?.maxExtLength??0xffffffff,this.keyDecoder=e?.keyDecoder!==void 0?e.keyDecoder:a8,this.mapKeyConverter=e?.mapKeyConverter??aQ}clone(){return new a6({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,rawStrings:this.rawStrings,maxStrLength:this.maxStrLength,maxBinLength:this.maxBinLength,maxArrayLength:this.maxArrayLength,maxMapLength:this.maxMapLength,maxExtLength:this.maxExtLength,keyDecoder:this.keyDecoder})}reinitializeState(){this.totalPos=0,this.headByte=-1,this.stack.reset()}setBuffer(e){let t=aY(e);this.bytes=t,this.view=new DataView(t.buffer,t.byteOffset,t.byteLength),this.pos=0}appendBuffer(e){if(-1!==this.headByte||this.hasRemaining(1)){let t=this.bytes.subarray(this.pos),r=aY(e),i=new Uint8Array(t.length+r.length);i.set(t),i.set(r,t.length),this.setBuffer(i)}else this.setBuffer(e)}hasRemaining(e){return this.view.byteLength-this.pos>=e}createExtraByteError(e){let{view:t,pos:r}=this;return RangeError(`Extra ${t.byteLength-r} of ${t.byteLength} byte(s) found at buffer[${e}]`)}decode(e){if(this.entered)return this.clone().decode(e);try{this.entered=!0,this.reinitializeState(),this.setBuffer(e);let t=this.doDecodeSync();if(this.hasRemaining(1))throw this.createExtraByteError(this.pos);return t}finally{this.entered=!1}}*decodeMulti(e){if(this.entered){let t=this.clone();yield*t.decodeMulti(e);return}try{for(this.entered=!0,this.reinitializeState(),this.setBuffer(e);this.hasRemaining(1);)yield this.doDecodeSync()}finally{this.entered=!1}}async decodeAsync(e){if(this.entered)return this.clone().decodeAsync(e);try{let t;this.entered=!0;let r=!1;for await(let i of e){if(r)throw this.entered=!1,this.createExtraByteError(this.totalPos);this.appendBuffer(i);try{t=this.doDecodeSync(),r=!0}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}if(r){if(this.hasRemaining(1))throw this.createExtraByteError(this.totalPos);return t}let{headByte:i,pos:s,totalPos:n}=this;throw RangeError(`Insufficient data in parsing ${aq(i)} at ${n} (${s} in the current buffer)`)}finally{this.entered=!1}}decodeArrayStream(e){return this.decodeMultiAsync(e,!0)}decodeStream(e){return this.decodeMultiAsync(e,!1)}async *decodeMultiAsync(e,t){if(this.entered){let r=this.clone();yield*r.decodeMultiAsync(e,t);return}try{this.entered=!0;let r=t,i=-1;for await(let s of e){if(t&&0===i)throw this.createExtraByteError(this.totalPos);this.appendBuffer(s),r&&(i=this.readArraySize(),r=!1,this.complete());try{for(;yield this.doDecodeSync(),0!=--i;);}catch(e){if(!(e instanceof RangeError))throw e}this.totalPos+=this.pos}}finally{this.entered=!1}}doDecodeSync(){t:for(;;){let e,t=this.readHeadByte();if(t>=224)e=t-256;else if(t<192)if(t<128)e=t;else if(t<144){let r=t-128;if(0!==r){this.pushMapState(r),this.complete();continue}e={}}else if(t<160){let r=t-144;if(0!==r){this.pushArrayState(r),this.complete();continue}e=[]}else{let r=t-160;e=this.decodeString(r,0)}else if(192===t)e=null;else if(194===t)e=!1;else if(195===t)e=!0;else if(202===t)e=this.readF32();else if(203===t)e=this.readF64();else if(204===t)e=this.readU8();else if(205===t)e=this.readU16();else if(206===t)e=this.readU32();else if(207===t)e=this.useBigInt64?this.readU64AsBigInt():this.readU64();else if(208===t)e=this.readI8();else if(209===t)e=this.readI16();else if(210===t)e=this.readI32();else if(211===t)e=this.useBigInt64?this.readI64AsBigInt():this.readI64();else if(217===t){let t=this.lookU8();e=this.decodeString(t,1)}else if(218===t){let t=this.lookU16();e=this.decodeString(t,2)}else if(219===t){let t=this.lookU32();e=this.decodeString(t,4)}else if(220===t){let t=this.readU16();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(221===t){let t=this.readU32();if(0!==t){this.pushArrayState(t),this.complete();continue}e=[]}else if(222===t){let t=this.readU16();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(223===t){let t=this.readU32();if(0!==t){this.pushMapState(t),this.complete();continue}e={}}else if(196===t){let t=this.lookU8();e=this.decodeBinary(t,1)}else if(197===t){let t=this.lookU16();e=this.decodeBinary(t,2)}else if(198===t){let t=this.lookU32();e=this.decodeBinary(t,4)}else if(212===t)e=this.decodeExtension(1,0);else if(213===t)e=this.decodeExtension(2,0);else if(214===t)e=this.decodeExtension(4,0);else if(215===t)e=this.decodeExtension(8,0);else if(216===t)e=this.decodeExtension(16,0);else if(199===t){let t=this.lookU8();e=this.decodeExtension(t,1)}else if(200===t){let t=this.lookU16();e=this.decodeExtension(t,2)}else if(201===t){let t=this.lookU32();e=this.decodeExtension(t,4)}else throw new az(`Unrecognized type byte: ${aq(t)}`);this.complete();let r=this.stack;for(;r.length>0;){let t=r.top();if(t.type===aJ)if(t.array[t.position]=e,t.position++,t.position===t.size)e=t.array,r.release(t);else continue t;else if(t.type===aZ){if("__proto__"===e)throw new az("The key __proto__ is not allowed");t.key=this.mapKeyConverter(e),t.type=aX;continue t}else if(t.map[t.key]=e,t.readCount++,t.readCount===t.size)e=t.map,r.release(t);else{t.key=null,t.type=aZ;continue t}}return e}}readHeadByte(){return -1===this.headByte&&(this.headByte=this.readU8()),this.headByte}complete(){this.headByte=-1}readArraySize(){let e=this.readHeadByte();switch(e){case 220:return this.readU16();case 221:return this.readU32();default:if(e<160)return e-144;throw new az(`Unrecognized array type byte: ${aq(e)}`)}}pushMapState(e){if(e>this.maxMapLength)throw new az(`Max length exceeded: map length (${e}) > maxMapLengthLength (${this.maxMapLength})`);this.stack.pushMapState(e)}pushArrayState(e){if(e>this.maxArrayLength)throw new az(`Max length exceeded: array length (${e}) > maxArrayLength (${this.maxArrayLength})`);this.stack.pushArrayState(e)}decodeString(e,t){return!this.rawStrings||this.stateIsMapKey()?this.decodeUtf8String(e,t):this.decodeBinary(e,t)}decodeUtf8String(e,t){let r;if(e>this.maxStrLength)throw new az(`Max length exceeded: UTF-8 byte length (${e}) > maxStrLength (${this.maxStrLength})`);if(this.bytes.byteLength<this.pos+t+e)throw a3;let i=this.pos+t;return r=this.stateIsMapKey()&&this.keyDecoder?.canBeCached(e)?this.keyDecoder.decode(this.bytes,i,e):function(e,t,r){if(!(r>200))return aG(e,t,r);let i=e.subarray(t,t+r);return aW.decode(i)}(this.bytes,i,e),this.pos+=t+e,r}stateIsMapKey(){return this.stack.length>0&&this.stack.top().type===aZ}decodeBinary(e,t){if(e>this.maxBinLength)throw new az(`Max length exceeded: bin length (${e}) > maxBinLength (${this.maxBinLength})`);if(!this.hasRemaining(e+t))throw a3;let r=this.pos+t,i=this.bytes.subarray(r,r+e);return this.pos+=t+e,i}decodeExtension(e,t){if(e>this.maxExtLength)throw new az(`Max length exceeded: ext length (${e}) > maxExtLength (${this.maxExtLength})`);let r=this.view.getInt8(this.pos+t),i=this.decodeBinary(e,t+1);return this.extensionCodec.decode(i,r,this.context)}lookU8(){return this.view.getUint8(this.pos)}lookU16(){return this.view.getUint16(this.pos)}lookU32(){return this.view.getUint32(this.pos)}readU8(){let e=this.view.getUint8(this.pos);return this.pos++,e}readI8(){let e=this.view.getInt8(this.pos);return this.pos++,e}readU16(){let e=this.view.getUint16(this.pos);return this.pos+=2,e}readI16(){let e=this.view.getInt16(this.pos);return this.pos+=2,e}readU32(){let e=this.view.getUint32(this.pos);return this.pos+=4,e}readI32(){let e=this.view.getInt32(this.pos);return this.pos+=4,e}readU64(){var e,t;let r=(e=this.view,t=this.pos,0x100000000*e.getUint32(t)+e.getUint32(t+4));return this.pos+=8,r}readI64(){let e=a$(this.view,this.pos);return this.pos+=8,e}readU64AsBigInt(){let e=this.view.getBigUint64(this.pos);return this.pos+=8,e}readI64AsBigInt(){let e=this.view.getBigInt64(this.pos);return this.pos+=8,e}readF32(){let e=this.view.getFloat32(this.pos);return this.pos+=4,e}readF64(){let e=this.view.getFloat64(this.pos);return this.pos+=8,e}}class a5{constructor(e){this.entered=!1,this.extensionCodec=e?.extensionCodec??aV.defaultCodec,this.context=e?.context,this.useBigInt64=e?.useBigInt64??!1,this.maxDepth=e?.maxDepth??100,this.initialBufferSize=e?.initialBufferSize??2048,this.sortKeys=e?.sortKeys??!1,this.forceFloat32=e?.forceFloat32??!1,this.ignoreUndefined=e?.ignoreUndefined??!1,this.forceIntegerToFloat=e?.forceIntegerToFloat??!1,this.pos=0,this.view=new DataView(new ArrayBuffer(this.initialBufferSize)),this.bytes=new Uint8Array(this.view.buffer)}clone(){return new a5({extensionCodec:this.extensionCodec,context:this.context,useBigInt64:this.useBigInt64,maxDepth:this.maxDepth,initialBufferSize:this.initialBufferSize,sortKeys:this.sortKeys,forceFloat32:this.forceFloat32,ignoreUndefined:this.ignoreUndefined,forceIntegerToFloat:this.forceIntegerToFloat})}reinitializeState(){this.pos=0}encodeSharedRef(e){if(this.entered)return this.clone().encodeSharedRef(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.subarray(0,this.pos)}finally{this.entered=!1}}encode(e){if(this.entered)return this.clone().encode(e);try{return this.entered=!0,this.reinitializeState(),this.doEncode(e,1),this.bytes.slice(0,this.pos)}finally{this.entered=!1}}doEncode(e,t){if(t>this.maxDepth)throw Error(`Too deep objects in depth ${t}`);null==e?this.encodeNil():"boolean"==typeof e?this.encodeBoolean(e):"number"==typeof e?this.forceIntegerToFloat?this.encodeNumberAsFloat(e):this.encodeNumber(e):"string"==typeof e?this.encodeString(e):this.useBigInt64&&"bigint"==typeof e?this.encodeBigInt64(e):this.encodeObject(e,t)}ensureBufferSizeToWrite(e){let t=this.pos+e;this.view.byteLength<t&&this.resizeBuffer(2*t)}resizeBuffer(e){let t=new ArrayBuffer(e),r=new Uint8Array(t),i=new DataView(t);r.set(this.bytes),this.view=i,this.bytes=r}encodeNil(){this.writeU8(192)}encodeBoolean(e){!1===e?this.writeU8(194):this.writeU8(195)}encodeNumber(e){!this.forceIntegerToFloat&&Number.isSafeInteger(e)?e>=0?e<128?this.writeU8(e):e<256?(this.writeU8(204),this.writeU8(e)):e<65536?(this.writeU8(205),this.writeU16(e)):e<0x100000000?(this.writeU8(206),this.writeU32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(207),this.writeU64(e)):e>=-32?this.writeU8(224|e+32):e>=-128?(this.writeU8(208),this.writeI8(e)):e>=-32768?(this.writeU8(209),this.writeI16(e)):e>=-0x80000000?(this.writeU8(210),this.writeI32(e)):this.useBigInt64?this.encodeNumberAsFloat(e):(this.writeU8(211),this.writeI64(e)):this.encodeNumberAsFloat(e)}encodeNumberAsFloat(e){this.forceFloat32?(this.writeU8(202),this.writeF32(e)):(this.writeU8(203),this.writeF64(e))}encodeBigInt64(e){e>=BigInt(0)?(this.writeU8(207),this.writeBigUint64(e)):(this.writeU8(211),this.writeBigInt64(e))}writeStringHeader(e){if(e<32)this.writeU8(160+e);else if(e<256)this.writeU8(217),this.writeU8(e);else if(e<65536)this.writeU8(218),this.writeU16(e);else if(e<0x100000000)this.writeU8(219),this.writeU32(e);else throw Error(`Too long string: ${e} bytes in UTF-8`)}encodeString(e){let t=function(e){let t=e.length,r=0,i=0;for(;i<t;){let s=e.charCodeAt(i++);if((0xffffff80&s)==0){r++;continue}if((0xfffff800&s)==0)r+=2;else{if(s>=55296&&s<=56319&&i<t){let t=e.charCodeAt(i);(64512&t)==56320&&(++i,s=((1023&s)<<10)+(1023&t)+65536)}(0xffff0000&s)==0?r+=3:r+=4}}return r}(e);this.ensureBufferSizeToWrite(5+t),this.writeStringHeader(t),function(e,t,r){if(e.length>50)aH.encodeInto(e,t.subarray(r));else!function(e,t,r){let i=e.length,s=r,n=0;for(;n<i;){let r=e.charCodeAt(n++);if((0xffffff80&r)==0){t[s++]=r;continue}if((0xfffff800&r)==0)t[s++]=r>>6&31|192;else{if(r>=55296&&r<=56319&&n<i){let t=e.charCodeAt(n);(64512&t)==56320&&(++n,r=((1023&r)<<10)+(1023&t)+65536)}(0xffff0000&r)==0?t[s++]=r>>12&15|224:(t[s++]=r>>18&7|240,t[s++]=r>>12&63|128),t[s++]=r>>6&63|128}t[s++]=63&r|128}}(e,t,r)}(e,this.bytes,this.pos),this.pos+=t}encodeObject(e,t){let r=this.extensionCodec.tryToEncode(e,this.context);if(null!=r)this.encodeExtension(r);else if(Array.isArray(e))this.encodeArray(e,t);else if(ArrayBuffer.isView(e))this.encodeBinary(e);else if("object"==typeof e)this.encodeMap(e,t);else throw Error(`Unrecognized object: ${Object.prototype.toString.apply(e)}`)}encodeBinary(e){let t=e.byteLength;if(t<256)this.writeU8(196),this.writeU8(t);else if(t<65536)this.writeU8(197),this.writeU16(t);else if(t<0x100000000)this.writeU8(198),this.writeU32(t);else throw Error(`Too large binary: ${t}`);let r=aY(e);this.writeU8a(r)}encodeArray(e,t){let r=e.length;if(r<16)this.writeU8(144+r);else if(r<65536)this.writeU8(220),this.writeU16(r);else if(r<0x100000000)this.writeU8(221),this.writeU32(r);else throw Error(`Too large array: ${r}`);for(let r of e)this.doEncode(r,t+1)}countWithoutUndefined(e,t){let r=0;for(let i of t)void 0!==e[i]&&r++;return r}encodeMap(e,t){let r=Object.keys(e);this.sortKeys&&r.sort();let i=this.ignoreUndefined?this.countWithoutUndefined(e,r):r.length;if(i<16)this.writeU8(128+i);else if(i<65536)this.writeU8(222),this.writeU16(i);else if(i<0x100000000)this.writeU8(223),this.writeU32(i);else throw Error(`Too large map object: ${i}`);for(let i of r){let r=e[i];this.ignoreUndefined&&void 0===r||(this.encodeString(i),this.doEncode(r,t+1))}}encodeExtension(e){if("function"==typeof e.data){let t=e.data(this.pos+6),r=t.length;if(r>=0x100000000)throw Error(`Too large extension object: ${r}`);this.writeU8(201),this.writeU32(r),this.writeI8(e.type),this.writeU8a(t);return}let t=e.data.length;if(1===t)this.writeU8(212);else if(2===t)this.writeU8(213);else if(4===t)this.writeU8(214);else if(8===t)this.writeU8(215);else if(16===t)this.writeU8(216);else if(t<256)this.writeU8(199),this.writeU8(t);else if(t<65536)this.writeU8(200),this.writeU16(t);else if(t<0x100000000)this.writeU8(201),this.writeU32(t);else throw Error(`Too large extension object: ${t}`);this.writeI8(e.type),this.writeU8a(e.data)}writeU8(e){this.ensureBufferSizeToWrite(1),this.view.setUint8(this.pos,e),this.pos++}writeU8a(e){let t=e.length;this.ensureBufferSizeToWrite(t),this.bytes.set(e,this.pos),this.pos+=t}writeI8(e){this.ensureBufferSizeToWrite(1),this.view.setInt8(this.pos,e),this.pos++}writeU16(e){this.ensureBufferSizeToWrite(2),this.view.setUint16(this.pos,e),this.pos+=2}writeI16(e){this.ensureBufferSizeToWrite(2),this.view.setInt16(this.pos,e),this.pos+=2}writeU32(e){this.ensureBufferSizeToWrite(4),this.view.setUint32(this.pos,e),this.pos+=4}writeI32(e){this.ensureBufferSizeToWrite(4),this.view.setInt32(this.pos,e),this.pos+=4}writeF32(e){this.ensureBufferSizeToWrite(4),this.view.setFloat32(this.pos,e),this.pos+=4}writeF64(e){this.ensureBufferSizeToWrite(8),this.view.setFloat64(this.pos,e),this.pos+=8}writeU64(e){var t,r;this.ensureBufferSizeToWrite(8),t=this.view,r=this.pos,t.setUint32(r,e/0x100000000),t.setUint32(r+4,e),this.pos+=8}writeI64(e){this.ensureBufferSizeToWrite(8),aF(this.view,this.pos,e),this.pos+=8}writeBigUint64(e){this.ensureBufferSizeToWrite(8),this.view.setBigUint64(this.pos,e),this.pos+=8}writeBigInt64(e){this.ensureBufferSizeToWrite(8),this.view.setBigInt64(this.pos,e),this.pos+=8}}function a4(e,t){return!!Array.isArray(t)&&(0===t.length||(e?t.every(e=>"string"==typeof e):t.every(e=>Number.isSafeInteger(e))))}function a9(e,t){if("string"!=typeof t)throw Error(`${e}: string expected`);return!0}function a7(e){if(!Number.isSafeInteger(e))throw Error(`invalid integer: ${e}`)}function he(e){if(!Array.isArray(e))throw Error("array expected")}function ht(e,t){if(!a4(!0,t))throw Error(`${e}: array of strings expected`)}function hr(...e){let t=e=>e,r=(e,t)=>r=>e(t(r));return{encode:e.map(e=>e.encode).reduceRight(r,t),decode:e.map(e=>e.decode).reduce(r,t)}}function hi(e){let t="string"==typeof e?e.split(""):e,r=t.length;ht("alphabet",t);let i=new Map(t.map((e,t)=>[e,t]));return{encode:i=>(he(i),i.map(i=>{if(!Number.isSafeInteger(i)||i<0||i>=r)throw Error(`alphabet.encode: digit index outside alphabet "${i}". Allowed: ${e}`);return t[i]})),decode:t=>(he(t),t.map(t=>{a9("alphabet.decode",t);let r=i.get(t);if(void 0===r)throw Error(`Unknown letter: "${t}". Allowed: ${e}`);return r}))}}function hs(e=""){return a9("join",e),{encode:t=>(ht("join.decode",t),t.join(e)),decode:t=>(a9("join.decode",t),t.split(e))}}const hn=(e,t)=>0===t?e:hn(t,e%t),ho=(e,t)=>e+(t-hn(e,t)),ha=(()=>{let e=[];for(let t=0;t<40;t++)e.push(2**t);return e})();function hh(e,t,r,i){if(he(e),t<=0||t>32)throw Error(`convertRadix2: wrong from=${t}`);if(r<=0||r>32)throw Error(`convertRadix2: wrong to=${r}`);if(ho(t,r)>32)throw Error(`convertRadix2: carry overflow from=${t} to=${r} carryBits=${ho(t,r)}`);let s=0,n=0,o=ha[t],a=ha[r]-1,h=[];for(let i of e){if(a7(i),i>=o)throw Error(`convertRadix2: invalid data word=${i} from=${t}`);if(s=s<<t|i,n+t>32)throw Error(`convertRadix2: carry overflow pos=${n} from=${t}`);for(n+=t;n>=r;n-=r)h.push((s>>n-r&a)>>>0);let e=ha[n];if(void 0===e)throw Error("invalid carry");s&=e-1}if(s=s<<r-n&a,!i&&n>=t)throw Error("Excess padding");if(!i&&s>0)throw Error(`Non-zero padding: ${s}`);return i&&n>0&&h.push(s>>>0),h}const hc=hr(function(e,t=!1){if(a7(5),e<=0||e>32)throw Error("radix2: bits should be in (0..32]");if(ho(8,e)>32||ho(e,8)>32)throw Error("radix2: carry overflow");return{encode:r=>{var i;if(!((i=r)instanceof Uint8Array||ArrayBuffer.isView(i)&&"Uint8Array"===i.constructor.name))throw Error("radix2.encode input should be Uint8Array");return hh(Array.from(r),8,e,!t)},decode:r=>((function(e,t){if(!a4(!1,t))throw Error(`${e}: array of numbers expected`)})("radix2.decode",r),Uint8Array.from(hh(r,e,8,t)))}}(5),hi("ABCDEFGHIJKLMNOPQRSTUVWXYZ234567"),function(e,t="="){return a7(5),a9("padding",t),{encode(e){for(ht("padding.encode",e);5*e.length%8;)e.push(t);return e},decode(r){ht("padding.decode",r);let i=r.length;if(i*e%8)throw Error("padding: invalid, string should have whole number of bytes");for(;i>0&&r[i-1]===t;i--)if((i-1)*e%8==0)throw Error("padding: invalid, string has too much padding");return r.slice(0,i)}}}(5),hs(""));"function"==typeof Uint8Array.from([]).toBase64&&Uint8Array.fromBase64;"function"==typeof Uint8Array.from([]).toHex&&Uint8Array.fromHex;var hu={};Object.defineProperty(hu,"__esModule",{value:!0});var hl={};Object.defineProperty(hl,"__esModule",{value:!0}),hl.compare=function(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return -1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0};var hf={};Object.defineProperty(hf,"__esModule",{value:!0});var hd={};Object.defineProperty(hd,"__esModule",{value:!0});var hp={};Object.defineProperty(hp,"__esModule",{value:!0}),hp.asUint8Array=function(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e},hd.alloc=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.alloc?hp.asUint8Array(globalThis.Buffer.alloc(e)):new Uint8Array(e)},hd.allocUnsafe=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?hp.asUint8Array(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)},hf.concat=function(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=hd.allocUnsafe(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return hp.asUint8Array(r)};var hg={};Object.defineProperty(hg,"__esModule",{value:!0}),hg.equals=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0};var hb={};Object.defineProperty(hb,"__esModule",{value:!0});var hy={},hm={};Object.defineProperty(hm,"__esModule",{value:!0});var hv={};Object.defineProperty(hv,"__esModule",{value:!0});var hw={};Object.defineProperty(hw,"__esModule",{value:!0});var hD={};hD=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,h=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===h;)i++,t++;for(var n=(e.length-t)*c+1>>>0,o=new Uint8Array(n);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var l=0,f=n-1;(0!==u||l<s)&&-1!==f;f--,l++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=l,t++}if(" "!==e[t]){for(var d=n-s;d!==n&&0===o[d];)d++;for(var p=new Uint8Array(i+(n-d)),g=i;d!==n;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*u+1>>>0,c=new Uint8Array(o);s!==n;){for(var l=t[s],f=0,d=o-1;(0!==l||f<i)&&-1!==d;d--,f++)l+=256*c[d]>>>0,c[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw Error("Non-zero carry");i=f,s++}for(var p=o-i;p!==o&&0===c[p];)p++;for(var g=h.repeat(r);p<o;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw Error(`Non-${t} character`)}}};var hx={};Object.defineProperty(hx,"__esModule",{value:!0});const hE=new Uint8Array(0);hx.coerce=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},hx.empty=hE,hx.equals=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},hx.fromHex=e=>{let t=e.match(/../g);return t?new Uint8Array(t.map(e=>parseInt(e,16))):hE},hx.fromString=e=>new TextEncoder().encode(e),hx.isBinary=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),hx.toHex=e=>e.reduce((e,t)=>e+t.toString(16).padStart(2,"0"),""),hx.toString=e=>new TextDecoder().decode(e);class h_{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class hS{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return hA(this,e)}}class hI{constructor(e){this.decoders=e}or(e){return hA(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const hA=(e,t)=>new hI({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class hM{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new h_(e,t,r),this.decoder=new hS(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const hO=({name:e,prefix:t,encode:r,decode:i})=>new hM(e,t,r,i);hw.Codec=hM,hw.baseX=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=hD(r,t);return hO({prefix:e,name:t,encode:i,decode:e=>hx.coerce(s(e))})},hw.from=hO,hw.or=hA,hw.rfc4648=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>hO({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n})(e,i,r),decode:t=>((e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,h=0,c=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);h=h<<r|n,(a+=r)>=8&&(a-=8,o[c++]=255&h>>a)}if(a>=r||255&h<<8-a)throw SyntaxError("Unexpected end of data");return o})(t,i,r,e)}),hv.identity=hw.from({prefix:"\0",name:"identity",encode:e=>hx.toString(e),decode:e=>hx.fromString(e)});var hC={};Object.defineProperty(hC,"__esModule",{value:!0}),hC.base2=hw.rfc4648({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var hP={};Object.defineProperty(hP,"__esModule",{value:!0}),hP.base8=hw.rfc4648({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var hR={};Object.defineProperty(hR,"__esModule",{value:!0}),hR.base10=hw.baseX({prefix:"9",name:"base10",alphabet:"0123456789"});var hT={};Object.defineProperty(hT,"__esModule",{value:!0});const hN=hw.rfc4648({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hB=hw.rfc4648({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});hT.base16=hN,hT.base16upper=hB;var hL={};Object.defineProperty(hL,"__esModule",{value:!0});const hU=hw.rfc4648({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),hk=hw.rfc4648({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hq=hw.rfc4648({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),hj=hw.rfc4648({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hz=hw.rfc4648({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),hF=hw.rfc4648({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),h$=hw.rfc4648({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),hK=hw.rfc4648({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),hV=hw.rfc4648({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});hL.base32=hU,hL.base32hex=hz,hL.base32hexpad=h$,hL.base32hexpadupper=hK,hL.base32hexupper=hF,hL.base32pad=hq,hL.base32padupper=hj,hL.base32upper=hk,hL.base32z=hV;var hH={};Object.defineProperty(hH,"__esModule",{value:!0});const hG=hw.baseX({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),hW=hw.baseX({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});hH.base36=hG,hH.base36upper=hW;var hY={};Object.defineProperty(hY,"__esModule",{value:!0});const hJ=hw.baseX({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),hZ=hw.baseX({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});hY.base58btc=hJ,hY.base58flickr=hZ;var hX={};Object.defineProperty(hX,"__esModule",{value:!0});const hQ=hw.rfc4648({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),h0=hw.rfc4648({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),h1=hw.rfc4648({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),h2=hw.rfc4648({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});hX.base64=hQ,hX.base64pad=h0,hX.base64url=h1,hX.base64urlpad=h2;var h3={};Object.defineProperty(h3,"__esModule",{value:!0});const h8=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),h6=h8.reduce((e,t,r)=>(e[r]=t,e),[]),h5=h8.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);h3.base256emoji=hw.from({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=h6[t],"")},decode:function(e){let t=[];for(let r of e){let e=h5[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var h4={};Object.defineProperty(h4,"__esModule",{value:!0});var h9={};Object.defineProperty(h9,"__esModule",{value:!0});var h7={};Object.defineProperty(h7,"__esModule",{value:!0});var ce={};Object.defineProperty(ce,"__esModule",{value:!0});var ct={};function cr(e,t,r){t=t||[];for(var i=r=r||0;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,cr.bytes=r-i+1,t}function ci(e,t){var r,i=0,t=t||0,s=0,n=t,o=e.length;do{if(n>=o)throw ci.bytes=0,RangeError("Could not decode varint");r=e[n++],i+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128)return ci.bytes=n-t,i}ct={encode:cr,decode:ci,encodingLength:function(e){return e<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:e<0x800000000?5:e<0x40000000000?6:e<0x2000000000000?7:e<0x100000000000000?8:e<0x8000000000000000?9:10}},ce.decode=(e,t=0)=>[ct.decode(e,t),ct.decode.bytes],ce.encodeTo=(e,t,r=0)=>(ct.encode(e,t,r),t),ce.encodingLength=e=>ct.encodingLength(e);class cs{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}h7.Digest=cs,h7.create=(e,t)=>{let r=t.byteLength,i=ce.encodingLength(e),s=i+ce.encodingLength(r),n=new Uint8Array(s+r);return ce.encodeTo(e,n,0),ce.encodeTo(r,n,i),n.set(t,s),new cs(e,r,t,n)},h7.decode=e=>{let t=hx.coerce(e),[r,i]=ce.decode(t),[s,n]=ce.decode(t.subarray(i)),o=t.subarray(i+n);if(o.byteLength!==s)throw Error("Incorrect length");return new cs(r,s,o,t)},h7.equals=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&hx.equals(e.bytes,t.bytes);class cn{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?h7.create(this.code,t):t.then(e=>h7.create(this.code,e))}throw Error("Unknown type, must be binary type")}}h9.Hasher=cn,h9.from=({name:e,code:t,encode:r})=>new cn(e,t,r);const co=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ca=h9.from({name:"sha2-256",code:18,encode:co("SHA-256")}),ch=h9.from({name:"sha2-512",code:19,encode:co("SHA-512")});h4.sha256=ca,h4.sha512=ch;var cc={};Object.defineProperty(cc,"__esModule",{value:!0});const cu=hx.coerce;cc.identity={code:0,name:"identity",encode:cu,digest:e=>h7.create(0,cu(e))};var cl={};Object.defineProperty(cl,"__esModule",{value:!0}),cl.code=85,cl.decode=e=>hx.coerce(e),cl.encode=e=>hx.coerce(e),cl.name="raw";var cf={};Object.defineProperty(cf,"__esModule",{value:!0});const cd=new TextEncoder,cp=new TextDecoder;cf.code=512,cf.decode=e=>JSON.parse(cp.decode(e)),cf.encode=e=>cd.encode(JSON.stringify(e)),cf.name="json";var cg={};Object.defineProperty(cg,"__esModule",{value:!0});var cb={};Object.defineProperty(cb,"__esModule",{value:!0});class cy{constructor(e,t,r,i){this.code=t,this.version=e,this.multihash=r,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:cI,byteLength:cI,code:cS,version:cS,multihash:cS,bytes:cS,_baseCache:cI,asCID:cI})}toV0(){if(0===this.version)return this;{let{code:e,multihash:t}=this;if(e!==cD)throw Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==cx)throw Error("Cannot convert non sha2-256 multihash CID to CIDv0");return cy.createV0(t)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=h7.create(e,t);return cy.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&h7.equals(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:i}=this;return 0===r?cv(t,i,e||hY.base58btc.encoder):cw(t,i,e||hL.base32.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return cA(/^0\.0/,cM),!!(e&&(e[c_]||e.asCID===e))}get toBaseEncodedString(){throw Error("Deprecated, use .toString()")}get codec(){throw Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw Error('"multibaseName" property is deprecated')}get prefix(){throw Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof cy)return e;if(null!=e&&e.asCID===e){let{version:t,code:r,multihash:i,bytes:s}=e;return new cy(t,r,i,s||cE(t,r,i.bytes))}if(null==e||!0!==e[c_])return null;{let{version:t,multihash:r,code:i}=e,s=h7.decode(r);return cy.create(t,i,s)}}static create(e,t,r){if("number"!=typeof t)throw Error("String codecs are no longer supported");switch(e){case 0:if(t===cD)return new cy(e,t,r,r.bytes);throw Error(`Version 0 CID must use dag-pb (code: ${cD}) block encoding`);case 1:{let i=cE(e,t,r.bytes);return new cy(e,t,r,i)}default:throw Error("Invalid version")}}static createV0(e){return cy.create(0,cD,e)}static createV1(e,t){return cy.create(1,e,t)}static decode(e){let[t,r]=cy.decodeFirst(e);if(r.length)throw Error("Incorrect length");return t}static decodeFirst(e){let t=cy.inspectBytes(e),r=t.size-t.multihashSize,i=hx.coerce(e.subarray(r,r+t.multihashSize));if(i.byteLength!==t.multihashSize)throw Error("Incorrect length");let s=i.subarray(t.multihashSize-t.digestSize),n=new h7.Digest(t.multihashCode,t.digestSize,s,i);return[0===t.version?cy.createV0(n):cy.createV1(t.codec,n),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[r,i]=ce.decode(e.subarray(t));return t+=i,r},i=r(),s=cD;if(18===i?(i=0,t=0):1===i&&(s=r()),0!==i&&1!==i)throw RangeError(`Invalid CID version ${i}`);let n=t,o=r(),a=r(),h=t+a;return{version:i,codec:s,multihashCode:o,digestSize:a,multihashSize:h-n,size:h}}static parse(e,t){let[r,i]=cm(e,t),s=cy.decode(i);return s._baseCache.set(r,e),s}}const cm=(e,t)=>{switch(e[0]){case"Q":{let r=t||hY.base58btc;return[hY.base58btc.prefix,r.decode(`${hY.base58btc.prefix}${e}`)]}case hY.base58btc.prefix:{let r=t||hY.base58btc;return[hY.base58btc.prefix,r.decode(e)]}case hL.base32.prefix:{let r=t||hL.base32;return[hL.base32.prefix,r.decode(e)]}default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},cv=(e,t,r)=>{let{prefix:i}=r;if(i!==hY.base58btc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=t.get(i);if(null!=s)return s;{let s=r.encode(e).slice(1);return t.set(i,s),s}},cw=(e,t,r)=>{let{prefix:i}=r,s=t.get(i);if(null!=s)return s;{let s=r.encode(e);return t.set(i,s),s}},cD=112,cx=18,cE=(e,t,r)=>{let i=ce.encodingLength(e),s=i+ce.encodingLength(t),n=new Uint8Array(s+r.byteLength);return ce.encodeTo(e,n,0),ce.encodeTo(t,n,i),n.set(r,s),n},c_=Symbol.for("@ipld/js-cid/CID"),cS={writable:!1,configurable:!1,enumerable:!0},cI={writable:!1,enumerable:!1,configurable:!1},cA=(e,t)=>{if(e.test("0.0.0-dev"))console.warn(t);else throw Error(t)},cM=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;cb.CID=cy,cg.CID=cb.CID,cg.varint=ce,cg.bytes=hx,cg.hasher=h9,cg.digest=h7;const cO={...hv,...hC,...hP,...hR,...hT,...hL,...hH,...hY,...hX,...h3},cC={...h4,...cc};function cP(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}hm.CID=cb.CID,hm.hasher=h9,hm.digest=h7,hm.varint=ce,hm.bytes=hx,hm.bases=cO,hm.codecs={raw:cl,json:cf},hm.hashes=cC;const cR=cP("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),cT=cP("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=hd.allocUnsafe(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t});hy={utf8:cR,"utf-8":cR,hex:hm.bases.base16,latin1:cT,ascii:cT,binary:cT,...hm.bases},hb.fromString=function(e,t="utf8"){let r=hy[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?hp.asUint8Array(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)};var cN={};Object.defineProperty(cN,"__esModule",{value:!0}),cN.toString=function(e,t="utf8"){let r=hy[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)};var cB={};Object.defineProperty(cB,"__esModule",{value:!0}),cB.xor=function(e,t){if(e.length!==t.length)throw Error("Inputs should have the same length");let r=hd.allocUnsafe(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return hp.asUint8Array(r)},hu.compare=hl.compare,hu.concat=hf.concat,hu.equals=hg.equals,hu.fromString=hb.fromString,hu.toString=cN.toString,hu.xor=cB.xor;const cL={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var cU={},ck={},cq={};function cj(e){return(0x100000000+e).toString(16).substring(1)}function cz(e,t,r){let i=e[t]+e[r],s=e[t+1]+e[r+1];i>=0x100000000&&s++,e[t]=i,e[t+1]=s}function cF(e,t,r,i){let s=e[t]+r;r<0&&(s+=0x100000000);let n=e[t+1]+i;s>=0x100000000&&n++,e[t]=s,e[t+1]=n}function c$(e,t){return e[t]^e[t+1]<<8^e[t+2]<<16^e[t+3]<<24}function cK(e,t,r,i,s,n){let o=cW[s],a=cW[s+1],h=cW[n],c=cW[n+1];cz(cG,e,t),cF(cG,e,o,a);let u=cG[i]^cG[e],l=cG[i+1]^cG[e+1];cG[i]=l,cG[i+1]=u,cz(cG,r,i),u=cG[t]^cG[r],l=cG[t+1]^cG[r+1],cG[t]=u>>>24^l<<8,cG[t+1]=l>>>24^u<<8,cz(cG,e,t),cF(cG,e,h,c),u=cG[i]^cG[e],l=cG[i+1]^cG[e+1],cG[i]=u>>>16^l<<16,cG[i+1]=l>>>16^u<<16,cz(cG,r,i),u=cG[t]^cG[r],l=cG[t+1]^cG[r+1],cG[t]=l>>>31^u<<1,cG[t+1]=u>>>31^l<<1}cq={normalizeInput:function(e){let t;if(e instanceof Uint8Array)t=e;else if("string"==typeof e)t=new TextEncoder().encode(e);else throw Error("Input must be an string, Buffer or Uint8Array");return t},toHex:function(e){return Array.prototype.map.call(e,function(e){return(e<16?"0":"")+e.toString(16)}).join("")},debugPrint:function(e,t,r){let i="\n"+e+" = ";for(let s=0;s<t.length;s+=2){if(32===r)i+=cj(t[s]).toUpperCase(),i+=" ",i+=cj(t[s+1]).toUpperCase();else if(64===r)i+=cj(t[s+1]).toUpperCase(),i+=cj(t[s]).toUpperCase();else throw Error("Invalid size "+r);s%6==4?i+="\n"+Array(e.length+4).join(" "):s<t.length-2&&(i+=" ")}console.log(i)},testSpeed:function(e,t,r){let i=new Date().getTime(),s=new Uint8Array(t);for(let e=0;e<t;e++)s[e]=e%256;let n=new Date().getTime();console.log("Generated random input in "+(n-i)+"ms"),i=n;for(let n=0;n<r;n++){let r=e(s),n=new Date().getTime(),o=n-i;i=n,console.log("Hashed in "+o+"ms: "+r.substring(0,20)+"..."),console.log(Math.round(t/1048576/(o/1e3)*100)/100+" MB PER SECOND")}}};const cV=new Uint32Array([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),cH=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map(function(e){return 2*e})),cG=new Uint32Array(32),cW=new Uint32Array(32);function cY(e,t){let r=0;for(r=0;r<16;r++)cG[r]=e.h[r],cG[r+16]=cV[r];for(cG[24]=cG[24]^e.t,cG[25]=cG[25]^e.t/0x100000000,t&&(cG[28]=~cG[28],cG[29]=~cG[29]),r=0;r<32;r++)cW[r]=c$(e.b,4*r);for(r=0;r<12;r++)cK(0,8,16,24,cH[16*r+0],cH[16*r+1]),cK(2,10,18,26,cH[16*r+2],cH[16*r+3]),cK(4,12,20,28,cH[16*r+4],cH[16*r+5]),cK(6,14,22,30,cH[16*r+6],cH[16*r+7]),cK(0,10,20,30,cH[16*r+8],cH[16*r+9]),cK(2,12,22,24,cH[16*r+10],cH[16*r+11]),cK(4,14,16,26,cH[16*r+12],cH[16*r+13]),cK(6,8,18,28,cH[16*r+14],cH[16*r+15]);for(r=0;r<16;r++)e.h[r]=e.h[r]^cG[r]^cG[r+16]}const cJ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function cZ(e,t,r,i){if(0===e||e>64)throw Error("Illegal output length, expected 0 < length <= 64");if(t&&t.length>64)throw Error("Illegal key, expected Uint8Array with 0 < length <= 64");if(r&&16!==r.length)throw Error("Illegal salt, expected Uint8Array with length is 16");if(i&&16!==i.length)throw Error("Illegal personal, expected Uint8Array with length is 16");let s={b:new Uint8Array(128),h:new Uint32Array(16),t:0,c:0,outlen:e};cJ.fill(0),cJ[0]=e,t&&(cJ[1]=t.length),cJ[2]=1,cJ[3]=1,r&&cJ.set(r,32),i&&cJ.set(i,48);for(let e=0;e<16;e++)s.h[e]=cV[e]^c$(cJ,4*e);return t&&(cX(s,t),s.c=128),s}function cX(e,t){for(let r=0;r<t.length;r++)128===e.c&&(e.t+=e.c,cY(e,!1),e.c=0),e.b[e.c++]=t[r]}function cQ(e){for(e.t+=e.c;e.c<128;)e.b[e.c++]=0;cY(e,!0);let t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r);return t}function c0(e,t,r,i,s){r=r||64,e=cq.normalizeInput(e),i&&(i=cq.normalizeInput(i)),s&&(s=cq.normalizeInput(s));let n=cZ(r,t,i,s);return cX(n,e),cQ(n)}ck={blake2b:c0,blake2bHex:function(e,t,r,i,s){let n=c0(e,t,r,i,s);return cq.toHex(n)},blake2bInit:cZ,blake2bUpdate:cX,blake2bFinal:cQ};var c1={};function c2(e,t,r,i,s,n){c5[e]=c5[e]+c5[t]+s,c5[i]=c3(c5[i]^c5[e],16),c5[r]=c5[r]+c5[i],c5[t]=c3(c5[t]^c5[r],12),c5[e]=c5[e]+c5[t]+n,c5[i]=c3(c5[i]^c5[e],8),c5[r]=c5[r]+c5[i],c5[t]=c3(c5[t]^c5[r],7)}function c3(e,t){return e>>>t^e<<32-t}const c8=new Uint32Array([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),c6=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0]),c5=new Uint32Array(16),c4=new Uint32Array(16);function c9(e,t){let r=0;for(r=0;r<8;r++)c5[r]=e.h[r],c5[r+8]=c8[r];for(c5[12]^=e.t,c5[13]^=e.t/0x100000000,t&&(c5[14]=~c5[14]),r=0;r<16;r++){var i,s;c4[r]=(i=e.b)[s=4*r]^i[s+1]<<8^i[s+2]<<16^i[s+3]<<24}for(r=0;r<10;r++)c2(0,4,8,12,c4[c6[16*r+0]],c4[c6[16*r+1]]),c2(1,5,9,13,c4[c6[16*r+2]],c4[c6[16*r+3]]),c2(2,6,10,14,c4[c6[16*r+4]],c4[c6[16*r+5]]),c2(3,7,11,15,c4[c6[16*r+6]],c4[c6[16*r+7]]),c2(0,5,10,15,c4[c6[16*r+8]],c4[c6[16*r+9]]),c2(1,6,11,12,c4[c6[16*r+10]],c4[c6[16*r+11]]),c2(2,7,8,13,c4[c6[16*r+12]],c4[c6[16*r+13]]),c2(3,4,9,14,c4[c6[16*r+14]],c4[c6[16*r+15]]);for(r=0;r<8;r++)e.h[r]^=c5[r]^c5[r+8]}function c7(e,t){if(!(e>0&&e<=32))throw Error("Incorrect output length, should be in [1, 32]");let r=t?t.length:0;if(t&&!(r>0&&r<=32))throw Error("Incorrect key length, should be in [1, 32]");let i={h:new Uint32Array(c8),b:new Uint8Array(64),c:0,t:0,outlen:e};return i.h[0]^=0x1010000^r<<8^e,r>0&&(ue(i,t),i.c=64),i}function ue(e,t){for(let r=0;r<t.length;r++)64===e.c&&(e.t+=e.c,c9(e,!1),e.c=0),e.b[e.c++]=t[r]}function ut(e){for(e.t+=e.c;e.c<64;)e.b[e.c++]=0;c9(e,!0);let t=new Uint8Array(e.outlen);for(let r=0;r<e.outlen;r++)t[r]=e.h[r>>2]>>8*(3&r)&255;return t}function ur(e,t,r){r=r||32,e=cq.normalizeInput(e);let i=c7(r,t);return ue(i,e),ut(i)}function ui(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function us(e,t){return e.includes(":")?[e]:t.chains||[]}c1={blake2s:ur,blake2sHex:function(e,t,r){let i=ur(e,t,r);return cq.toHex(i)},blake2sInit:c7,blake2sUpdate:ue,blake2sFinal:ut},cU={blake2b:ck.blake2b,blake2bHex:ck.blake2bHex,blake2bInit:ck.blake2bInit,blake2bUpdate:ck.blake2bUpdate,blake2bFinal:ck.blake2bFinal,blake2s:c1.blake2s,blake2sHex:c1.blake2sHex,blake2sInit:c1.blake2sInit,blake2sUpdate:c1.blake2sUpdate,blake2sFinal:c1.blake2sFinal};var un=Object.defineProperty,uo=Object.defineProperties,ua=Object.getOwnPropertyDescriptors,uh=Object.getOwnPropertySymbols,uc=Object.prototype.hasOwnProperty,uu=Object.prototype.propertyIsEnumerable,ul=(e,t,r)=>t in e?un(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uf=(e,t)=>{for(var r in t||(t={}))uc.call(t,r)&&ul(e,r,t[r]);if(uh)for(var r of uh(t))uu.call(t,r)&&ul(e,r,t[r]);return e},ud=(e,t,r)=>ul(e,"symbol"!=typeof t?t+"":t,r);const up="react-native",ug="browser";function ub(){return!(0,sh.getDocument)()&&!!(0,sh.getNavigator)()&&"ReactNative"===navigator.product}function uy(){return!!(0,sh.getNavigator)()&&!!(0,sh.getDocument)()}function um(){return ub()?up:uy()?ug:"unknown"}function uv(){var e;try{return ub()&&"u">typeof t&&"u">typeof(null==t?void 0:t.Application)?null==(e=t.Application)?void 0:e.applicationId:void 0}catch{return}}function uw(){return(0,sl.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function uD(e,r,i){let s=function(){if(um()===up&&"u">typeof t&&"u">typeof(null==t?void 0:t.Platform)){let{OS:e,Version:r}=t.Platform;return[e,r].join("-")}let e=so();if(null===e)return"unknown";let r=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[r,e.name,e.version].join("-"):[r,e.version].join("-")}(),n=function(){var e;let t=um();return t===ug?[t,(null==(e=(0,sh.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,r].join("-"),["js",i].join("-"),s,n].join("/")}function ux(e,t){return e.filter(e=>t.includes(e)).length===e.length}function uE(e){return Object.fromEntries(e.entries())}function u_(e){return new Map(Object.entries(e))}function uS(e=x.FIVE_MINUTES,t){let r,i,s,n,o=(0,x.toMiliseconds)(e||x.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e),n=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,a)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),a(e)},o),r=e,i=a})}}function uI(e,t,r){return new Promise(async(i,s)=>{let n=setTimeout(()=>s(Error(r)),t);try{let t=await e;i(t)}catch(e){s(e)}clearTimeout(n)})}function uA(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function uM(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function uO(e,t){return(0,x.fromMiliseconds)((t||Date.now())+(0,x.toMiliseconds)(e))}function uC(e){return Date.now()>=(0,x.toMiliseconds)(e)}function uP(e,t){return`${e}${t?`:${t}`:""}`}function uR(e=[],t=[]){return[...new Set([...e,...t])]}async function uT({id:e,topic:r,wcDeepLink:i}){var s,n;try{if(!i)return;let o="string"==typeof i?JSON.parse(i):i,a=o?.href;if("string"!=typeof a)return;let h=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let r=F.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else s=`${s}/wc?${i}`;return s}(a,e,r),c=um();if(c===ug){let e;if(!(null!=(s=(0,sh.getDocument)())&&s.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");n=h,e="_self",!function(){try{return window.self!==window.top}catch{return!1}}()?("u">typeof window&&(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto)||n.startsWith("https://")||n.startsWith("http://"))&&(e="_blank"):e="_top",window.open(n,e,"noreferrer noopener")}else c===up&&"u">typeof(null==t?void 0:t.Linking)&&await t.Linking.openURL(h)}catch(e){console.error(e)}}async function uN(e,t){let r="";try{if(uy()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function uB(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function uL(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function uU(e){return F.from(e,"base64").toString("utf-8")}class uk{constructor({limit:e}){ud(this,"limit"),ud(this,"set"),this.limit=e,this.set=new Set}add(e){if(!this.set.has(e)){if(this.set.size>=this.limit){let e=this.set.values().next().value;e&&this.set.delete(e)}this.set.add(e)}}has(e){return this.set.has(e)}}const uq=BigInt(0x100000000-1),uj=BigInt(32);function uz(e,t=!1){return t?{h:Number(e&uq),l:Number(e>>uj&uq)}:{h:0|Number(e>>uj&uq),l:0|Number(e&uq)}}function uF(e,t=!1){let r=e.length,i=new Uint32Array(r),s=new Uint32Array(r);for(let n=0;n<r;n++){let{h:r,l:o}=uz(e[n],t);[i[n],s[n]]=[r,o]}return[i,s]}const u$=(e,t,r)=>e>>>r,uK=(e,t,r)=>e<<32-r|t>>>r,uV=(e,t,r)=>e>>>r|t<<32-r,uH=(e,t,r)=>e<<32-r|t>>>r,uG=(e,t,r)=>e<<64-r|t>>>r-32,uW=(e,t,r)=>e>>>r-32|t<<64-r;function uY(e,t,r,i){let s=(t>>>0)+(i>>>0);return{h:e+r+(s/0x100000000|0)|0,l:0|s}}const uJ=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),uZ=(e,t,r,i)=>t+r+i+(e/0x100000000|0)|0,uX=(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),uQ=(e,t,r,i,s)=>t+r+i+s+(e/0x100000000|0)|0,u0=(e,t,r,i,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(s>>>0),u1=(e,t,r,i,s,n)=>t+r+i+s+n+(e/0x100000000|0)|0,u2="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function u3(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function u8(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function u6(e,...t){if(!u3(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function u5(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.createHasher");u8(e.outputLen),u8(e.blockLen)}function u4(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function u9(e,t){u6(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}function u7(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function le(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function lt(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function lr(e,t){return e<<32-t|e>>>t}const li=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function ls(e){return e<<24&0xff000000|e<<8&0xff0000|e>>>8&65280|e>>>24&255}const ln=li?e=>e:e=>ls(e),lo=li?e=>e:function(e){for(let t=0;t<e.length;t++)e[t]=ls(e[t]);return e},la="function"==typeof Uint8Array.from([]).toHex&&"function"==typeof Uint8Array.fromHex,lh=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function lc(e){if(u6(e),la)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=lh[e[r]];return t}function lu(e){return e>=48&&e<=57?e-48:e>=65&&e<=70?e-55:e>=97&&e<=102?e-87:void 0}function ll(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);if(la)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=lu(e.charCodeAt(s)),n=lu(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function lf(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function ld(e){return"string"==typeof e&&(e=lf(e)),u6(e),e}function lp(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];u6(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}class lg{}function lb(e){let t=t=>e().update(ld(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function ly(e=32){if(u2&&"function"==typeof u2.getRandomValues)return u2.getRandomValues(new Uint8Array(e));if(u2&&"function"==typeof u2.randomBytes)return Uint8Array.from(u2.randomBytes(e));throw Error("crypto.getRandomValues must be defined")}const lm=BigInt(0),lv=BigInt(1),lw=BigInt(2),lD=BigInt(7),lx=BigInt(256),lE=BigInt(113),l_=[],lS=[],lI=[];for(let e=0,t=lv,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],l_.push(2*(5*i+r)),lS.push((e+1)*(e+2)/2%64);let s=lm;for(let e=0;e<7;e++)(t=(t<<lv^(t>>lD)*lE)%lx)&lw&&(s^=lv<<(lv<<BigInt(e))-lv);lI.push(s)}const lA=uF(lI,!0),lM=lA[0],lO=lA[1],lC=(e,t,r)=>r>32?t<<r-32|e>>>64-r:e<<r|t>>>32-r,lP=(e,t,r)=>r>32?e<<r-32|t>>>64-r:t<<r|e>>>32-r;class lR extends lg{constructor(e,t,r,i=!1,s=24){if(super(),this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,this.enableXOF=!1,this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,u8(r),!(0<e&&e<200))throw Error("only keccak-f1600 function is supported");this.state=new Uint8Array(200),this.state32=u7(this.state)}clone(){return this._cloneInto()}keccak(){lo(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=lC(n,o,1)^r[i],h=lP(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=h}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=lS[r],n=lC(t,s,i),o=lP(t,s,i),a=l_[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=lM[i],e[1]^=lO[i]}le(r)}(this.state32,this.rounds),lo(this.state32),this.posOut=0,this.pos=0}update(e){u4(this),u6(e=ld(e));let{blockLen:t,state:r}=this,i=e.length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){u4(this,!1),u6(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return u8(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(u9(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,le(this.state)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new lR(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}const lT=lb(()=>new lR(136,1,32));class lN extends lg{constructor(e,t,r,i){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.buffer=new Uint8Array(e),this.view=lt(this.buffer)}update(e){u4(this),u6(e=ld(e));let{view:t,buffer:r,blockLen:i}=this,s=e.length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=lt(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){u4(this),u9(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,le(this.buffer.subarray(n)),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(0xffffffff),o=Number(r>>s&n),a=Number(r&n),h=4*!!i,c=4*!i;e.setUint32(t+h,o,i),e.setUint32(t+c,a,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=lt(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let h=a/4,c=this.get();if(h>c.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<h;e++)o.setUint32(4*e,c[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.destroyed=n,e.finished=s,e.length=i,e.pos=o,i%t&&e.buffer.set(r),e}clone(){return this._cloneInto()}}const lB=Uint32Array.from([0x6a09e667,0xbb67ae85,0x3c6ef372,0xa54ff53a,0x510e527f,0x9b05688c,0x1f83d9ab,0x5be0cd19]),lL=Uint32Array.from([0xcbbb9d5d,0xc1059ed8,0x629a292a,0x367cd507,0x9159015a,0x3070dd17,0x152fecd8,0xf70e5939,0x67332667,0xffc00b31,0x8eb44a87,0x68581511,0xdb0c2e0d,0x64f98fa7,0x47b5481d,0xbefa4fa4]),lU=Uint32Array.from([0x6a09e667,0xf3bcc908,0xbb67ae85,0x84caa73b,0x3c6ef372,0xfe94f82b,0xa54ff53a,0x5f1d36f1,0x510e527f,0xade682d1,0x9b05688c,0x2b3e6c1f,0x1f83d9ab,0xfb41bd6b,0x5be0cd19,0x137e2179]),lk=Uint32Array.from([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]),lq=new Uint32Array(64);class lj extends lN{constructor(e=32){super(64,e,8,!1),this.A=0|lB[0],this.B=0|lB[1],this.C=0|lB[2],this.D=0|lB[3],this.E=0|lB[4],this.F=0|lB[5],this.G=0|lB[6],this.H=0|lB[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:o,H:a}=this;return[e,t,r,i,s,n,o,a]}set(e,t,r,i,s,n,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)lq[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=lq[e-15],r=lq[e-2],i=lr(t,7)^lr(t,18)^t>>>3,s=lr(r,17)^lr(r,19)^r>>>10;lq[e]=s+lq[e-7]+i+lq[e-16]|0}let{A:r,B:i,C:s,D:n,E:o,F:a,G:h,H:c}=this;for(let e=0;e<64;e++){var u,l,f,d;let t=c+(lr(o,6)^lr(o,11)^lr(o,25))+((u=o)&a^~u&h)+lk[e]+lq[e]|0,p=(lr(r,2)^lr(r,13)^lr(r,22))+((l=r)&(f=i)^l&(d=s)^f&d)|0;c=h,h=a,a=o,o=n+t|0,n=s,s=i,i=r,r=t+p|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,o=o+this.E|0,a=a+this.F|0,h=h+this.G|0,c=c+this.H|0,this.set(r,i,s,n,o,a,h,c)}roundClean(){le(lq)}destroy(){this.set(0,0,0,0,0,0,0,0),le(this.buffer)}}const lz=uF(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),lF=lz[0],l$=lz[1],lK=new Uint32Array(80),lV=new Uint32Array(80);class lH extends lN{constructor(e=64){super(128,e,16,!1),this.Ah=0|lU[0],this.Al=0|lU[1],this.Bh=0|lU[2],this.Bl=0|lU[3],this.Ch=0|lU[4],this.Cl=0|lU[5],this.Dh=0|lU[6],this.Dl=0|lU[7],this.Eh=0|lU[8],this.El=0|lU[9],this.Fh=0|lU[10],this.Fl=0|lU[11],this.Gh=0|lU[12],this.Gl=0|lU[13],this.Hh=0|lU[14],this.Hl=0|lU[15]}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:n,Dh:o,Dl:a,Eh:h,El:c,Fh:u,Fl:l,Gh:f,Gl:d,Hh:p,Hl:g}=this;return[e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g]}set(e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|n,this.Dh=0|o,this.Dl=0|a,this.Eh=0|h,this.El=0|c,this.Fh=0|u,this.Fl=0|l,this.Gh=0|f,this.Gl=0|d,this.Hh=0|p,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)lK[r]=e.getUint32(t),lV[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|lK[e-15],r=0|lV[e-15],i=uV(t,r,1)^uV(t,r,8)^u$(t,r,7),s=uH(t,r,1)^uH(t,r,8)^uK(t,r,7),n=0|lK[e-2],o=0|lV[e-2],a=uV(n,o,19)^uG(n,o,61)^u$(n,o,6),h=uX(s,uH(n,o,19)^uW(n,o,61)^uK(n,o,6),lV[e-7],lV[e-16]),c=uQ(h,i,a,lK[e-7],lK[e-16]);lK[e]=0|c,lV[e]=0|h}let{Ah:r,Al:i,Bh:s,Bl:n,Ch:o,Cl:a,Dh:h,Dl:c,Eh:u,El:l,Fh:f,Fl:d,Gh:p,Gl:g,Hh:b,Hl:y}=this;for(let e=0;e<80;e++){let t=uV(u,l,14)^uV(u,l,18)^uG(u,l,41),m=uH(u,l,14)^uH(u,l,18)^uW(u,l,41),v=u&f^~u&p,w=u0(y,m,l&d^~l&g,l$[e],lV[e]),D=u1(w,b,t,v,lF[e],lK[e]),x=0|w,E=uV(r,i,28)^uG(r,i,34)^uG(r,i,39),_=uH(r,i,28)^uW(r,i,34)^uW(r,i,39),S=r&s^r&o^s&o,I=i&n^i&a^n&a;b=0|p,y=0|g,p=0|f,g=0|d,f=0|u,d=0|l,({h:u,l:l}=uY(0|h,0|c,0|D,0|x)),h=0|o,c=0|a,o=0|s,a=0|n,s=0|r,n=0|i;let A=uJ(x,_,I);r=uZ(A,D,E,S),i=0|A}({h:r,l:i}=uY(0|this.Ah,0|this.Al,0|r,0|i)),({h:s,l:n}=uY(0|this.Bh,0|this.Bl,0|s,0|n)),({h:o,l:a}=uY(0|this.Ch,0|this.Cl,0|o,0|a)),({h:h,l:c}=uY(0|this.Dh,0|this.Dl,0|h,0|c)),({h:u,l:l}=uY(0|this.Eh,0|this.El,0|u,0|l)),({h:f,l:d}=uY(0|this.Fh,0|this.Fl,0|f,0|d)),({h:p,l:g}=uY(0|this.Gh,0|this.Gl,0|p,0|g)),({h:b,l:y}=uY(0|this.Hh,0|this.Hl,0|b,0|y)),this.set(r,i,s,n,o,a,h,c,u,l,f,d,p,g,b,y)}roundClean(){le(lK,lV)}destroy(){le(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}class lG extends lH{constructor(){super(48),this.Ah=0|lL[0],this.Al=0|lL[1],this.Bh=0|lL[2],this.Bl=0|lL[3],this.Ch=0|lL[4],this.Cl=0|lL[5],this.Dh=0|lL[6],this.Dl=0|lL[7],this.Eh=0|lL[8],this.El=0|lL[9],this.Fh=0|lL[10],this.Fl=0|lL[11],this.Gh=0|lL[12],this.Gl=0|lL[13],this.Hh=0|lL[14],this.Hl=0|lL[15]}}const lW=Uint32Array.from([0x22312194,0xfc2bf72c,0x9f555fa3,0xc84c64c2,0x2393b86b,0x6f53b151,0x96387719,0x5940eabd,0x96283ee2,0xa88effe3,0xbe5e1e25,0x53863992,0x2b0199fc,0x2c85b8aa,0xeb72ddc,0x81c52ca2]);class lY extends lH{constructor(){super(32),this.Ah=0|lW[0],this.Al=0|lW[1],this.Bh=0|lW[2],this.Bl=0|lW[3],this.Ch=0|lW[4],this.Cl=0|lW[5],this.Dh=0|lW[6],this.Dl=0|lW[7],this.Eh=0|lW[8],this.El=0|lW[9],this.Fh=0|lW[10],this.Fl=0|lW[11],this.Gh=0|lW[12],this.Gl=0|lW[13],this.Hh=0|lW[14],this.Hl=0|lW[15]}}const lJ=lb(()=>new lj),lZ=lb(()=>new lH),lX=lb(()=>new lG),lQ=lb(()=>new lY),l0=Uint8Array.from([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9]),l1=Uint32Array.from([0xf3bcc908,0x6a09e667,0x84caa73b,0xbb67ae85,0xfe94f82b,0x3c6ef372,0x5f1d36f1,0xa54ff53a,0xade682d1,0x510e527f,0x2b3e6c1f,0x9b05688c,0xfb41bd6b,0x1f83d9ab,0x137e2179,0x5be0cd19]),l2=new Uint32Array(32);function l3(e,t,r,i,s,n){let o=s[n],a=s[n+1],h=l2[2*e],c=l2[2*e+1],u=l2[2*t],l=l2[2*t+1],f=l2[2*r],d=l2[2*r+1],p=l2[2*i],g=l2[2*i+1],b=uJ(h,u,o);c=uZ(b,c,l,a),h=0|b,({Dh:g,Dl:p}={Dh:g^c,Dl:p^h}),({Dh:g,Dl:p}={Dh:p,Dl:g}),({h:d,l:f}=uY(d,f,g,p)),({Bh:l,Bl:u}={Bh:l^d,Bl:u^f}),({Bh:l,Bl:u}={Bh:uV(l,u,24),Bl:uH(l,u,24)}),l2[2*e]=h,l2[2*e+1]=c,l2[2*t]=u,l2[2*t+1]=l,l2[2*r]=f,l2[2*r+1]=d,l2[2*i]=p,l2[2*i+1]=g}function l8(e,t,r,i,s,n){let o=s[n],a=s[n+1],h=l2[2*e],c=l2[2*e+1],u=l2[2*t],l=l2[2*t+1],f=l2[2*r],d=l2[2*r+1],p=l2[2*i],g=l2[2*i+1],b=uJ(h,u,o);c=uZ(b,c,l,a),h=0|b,({Dh:g,Dl:p}={Dh:g^c,Dl:p^h}),({Dh:g,Dl:p}={Dh:uV(g,p,16),Dl:uH(g,p,16)}),({h:d,l:f}=uY(d,f,g,p)),({Bh:l,Bl:u}={Bh:l^d,Bl:u^f}),({Bh:l,Bl:u}={Bh:uG(l,u,63),Bl:uW(l,u,63)}),l2[2*e]=h,l2[2*e+1]=c,l2[2*t]=u,l2[2*t+1]=l,l2[2*r]=f,l2[2*r+1]=d,l2[2*i]=p,l2[2*i+1]=g}class l6 extends lg{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,this.length=0,this.pos=0,u8(e),u8(t),this.blockLen=e,this.outputLen=t,this.buffer=new Uint8Array(e),this.buffer32=u7(this.buffer)}update(e){u4(this),u6(e=ld(e));let{blockLen:t,buffer:r,buffer32:i}=this,s=e.length,n=e.byteOffset,o=e.buffer;for(let a=0;a<s;){this.pos===t&&(lo(i),this.compress(i,0,!1),lo(i),this.pos=0);let h=Math.min(t-this.pos,s-a),c=n+a;if(h===t&&!(c%4)&&a+h<s){let e=new Uint32Array(o,c,Math.floor((s-a)/4));lo(e);for(let r=0;a+t<s;r+=i.length,a+=t)this.length+=t,this.compress(e,r,!1);lo(e);continue}r.set(e.subarray(a,a+h),this.pos),this.pos+=h,this.length+=h,a+=h}return this}digestInto(e){u4(this),u9(e,this);let{pos:t,buffer32:r}=this;this.finished=!0,le(this.buffer.subarray(t)),lo(r),this.compress(r,0,!0),lo(r);let i=u7(e);this.get().forEach((e,t)=>i[t]=ln(e))}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){let{buffer:t,length:r,finished:i,destroyed:s,outputLen:n,pos:o}=this;return e||(e=new this.constructor({dkLen:n})),e.set(...this.get()),e.buffer.set(t),e.destroyed=s,e.finished=i,e.length=r,e.pos=o,e.outputLen=n,e}clone(){return this._cloneInto()}}class l5 extends l6{constructor(e={}){let t=void 0===e.dkLen?64:e.dkLen;super(128,t),this.v0l=0|l1[0],this.v0h=0|l1[1],this.v1l=0|l1[2],this.v1h=0|l1[3],this.v2l=0|l1[4],this.v2h=0|l1[5],this.v3l=0|l1[6],this.v3h=0|l1[7],this.v4l=0|l1[8],this.v4h=0|l1[9],this.v5l=0|l1[10],this.v5h=0|l1[11],this.v6l=0|l1[12],this.v6h=0|l1[13],this.v7l=0|l1[14],this.v7h=0|l1[15],function(e,t={},r,i,s){if(u8(64),e<0||e>64)throw Error("outputLen bigger than keyLen");let{key:n,salt:o,personalization:a}=t;if(void 0!==n&&(n.length<1||n.length>r))throw Error("key length must be undefined or 1.."+r);if(void 0!==o&&16!==o.length)throw Error("salt must be undefined or 16");if(void 0!==a&&16!==a.length)throw Error("personalization must be undefined or 16")}(t,e,64,16,16);let{key:r,personalization:i,salt:s}=e,n=0;if(void 0!==r&&(n=(r=ld(r)).length),this.v0l^=this.outputLen|n<<8|0x1010000,void 0!==s){let e=u7(s=ld(s));this.v4l^=ln(e[0]),this.v4h^=ln(e[1]),this.v5l^=ln(e[2]),this.v5h^=ln(e[3])}if(void 0!==i){let e=u7(i=ld(i));this.v6l^=ln(e[0]),this.v6h^=ln(e[1]),this.v7l^=ln(e[2]),this.v7h^=ln(e[3])}if(void 0!==r){let e=new Uint8Array(this.blockLen);e.set(r),this.update(e)}}get(){let{v0l:e,v0h:t,v1l:r,v1h:i,v2l:s,v2h:n,v3l:o,v3h:a,v4l:h,v4h:c,v5l:u,v5h:l,v6l:f,v6h:d,v7l:p,v7h:g}=this;return[e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g]}set(e,t,r,i,s,n,o,a,h,c,u,l,f,d,p,g){this.v0l=0|e,this.v0h=0|t,this.v1l=0|r,this.v1h=0|i,this.v2l=0|s,this.v2h=0|n,this.v3l=0|o,this.v3h=0|a,this.v4l=0|h,this.v4h=0|c,this.v5l=0|u,this.v5h=0|l,this.v6l=0|f,this.v6h=0|d,this.v7l=0|p,this.v7h=0|g}compress(e,t,r){this.get().forEach((e,t)=>l2[t]=e),l2.set(l1,16);let{h:i,l:s}=uz(BigInt(this.length));l2[24]=l1[8]^s,l2[25]=l1[9]^i,r&&(l2[28]=~l2[28],l2[29]=~l2[29]);let n=0;for(let r=0;r<12;r++)l3(0,4,8,12,e,t+2*l0[n++]),l8(0,4,8,12,e,t+2*l0[n++]),l3(1,5,9,13,e,t+2*l0[n++]),l8(1,5,9,13,e,t+2*l0[n++]),l3(2,6,10,14,e,t+2*l0[n++]),l8(2,6,10,14,e,t+2*l0[n++]),l3(3,7,11,15,e,t+2*l0[n++]),l8(3,7,11,15,e,t+2*l0[n++]),l3(0,5,10,15,e,t+2*l0[n++]),l8(0,5,10,15,e,t+2*l0[n++]),l3(1,6,11,12,e,t+2*l0[n++]),l8(1,6,11,12,e,t+2*l0[n++]),l3(2,7,8,13,e,t+2*l0[n++]),l8(2,7,8,13,e,t+2*l0[n++]),l3(3,4,9,14,e,t+2*l0[n++]),l8(3,4,9,14,e,t+2*l0[n++]);this.v0l^=l2[0]^l2[16],this.v0h^=l2[1]^l2[17],this.v1l^=l2[2]^l2[18],this.v1h^=l2[3]^l2[19],this.v2l^=l2[4]^l2[20],this.v2h^=l2[5]^l2[21],this.v3l^=l2[6]^l2[22],this.v3h^=l2[7]^l2[23],this.v4l^=l2[8]^l2[24],this.v4h^=l2[9]^l2[25],this.v5l^=l2[10]^l2[26],this.v5h^=l2[11]^l2[27],this.v6l^=l2[12]^l2[28],this.v6h^=l2[13]^l2[29],this.v7l^=l2[14]^l2[30],this.v7h^=l2[15]^l2[31],le(l2)}destroy(){this.destroyed=!0,le(this.buffer32),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const l4=function(e){let t=(t,r)=>e(r).update(ld(t)).digest(),r=e({});return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new l5(e));function l9(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+F.from(lT(r)).toString("hex")}async function l7(e,t,r,i,s,n){switch(r.t){case"eip191":return await function(e,t,r){let i=au.fromHex(r);return sf.recoverAddress({payload:l9(t),signature:i}).toLowerCase()===e.toLowerCase()}(e,t,r.s);case"eip1271":return await fe(e,t,r.s,i,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function fe(e,t,r,i,s,n){let o=ui(i);if(!o.namespace||!o.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let o="0x1626ba7e",a=r.substring(2),h=(a.length/2).toString(16).padStart(64,"0"),c=(t.startsWith("0x")?t:l9(t)).substring(2),u=o+c+"0000000000000000000000000000000000000000000000000000000000000040"+h+a,l=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${s}`,{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:u},"latest"]})}),{result:f}=await l.json();return!!f&&f.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}function ft(e){let t=new Uint8Array(lJ(function(e){if(e instanceof Uint8Array)return e;if(Array.isArray(e))return new Uint8Array(e);if("object"==typeof e&&null!=e&&e.data)return new Uint8Array(Object.values(e.data));if("object"==typeof e&&e)return new Uint8Array(Object.values(e));throw Error("getNearUint8ArrayFromBytes: Unexpected result type from bytes array")}(e)));return ak.encode(t)}function fr(e){var t;let r=(t=F.from(e,"base64"),new a6(void 0).decode(t)).txn;if(!r)throw Error("Invalid signed transaction: missing 'txn' field");let i=new a5(void 0).encodeSharedRef(r),s=F.from("TX"),n=lQ(F.concat([s,F.from(i)]));return hc.encode(n).replace(/=+$/,"")}function fi(e){let t=[],r=BigInt(e);for(;r>=BigInt(128);)t.push(Number(r&BigInt(127)|BigInt(128))),r>>=BigInt(7);return t.push(Number(r)),F.from(t)}var fs=Object.defineProperty,fn=Object.defineProperties,fo=Object.getOwnPropertyDescriptors,fa=Object.getOwnPropertySymbols,fh=Object.prototype.hasOwnProperty,fc=Object.prototype.propertyIsEnumerable,fu=(e,t,r)=>t in e?fs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const fl=e=>e?.split(":"),ff=e=>{let t=e&&fl(e);if(t)return t[2]+":"+t[3]},fd=e=>{let t=e&&fl(e);if(t)return t.pop()};async function fp(e){let{cacao:t,projectId:r}=e,{s:i,p:s}=t,n=fg(s,s.iss),o=fd(s.iss);return await l7(o,n,i,ff(s.iss),r)}const fg=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=fd(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${(e=>{let t=e&&fl(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,h=`Nonce: ${e.nonce}`,c=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,l=e.nbf?`Not Before: ${e.nbf}`:void 0,f=e.requestId?`Request ID: ${e.requestId}`:void 0,d=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,p=fD(e.resources);return p&&(s=function(e="",t){fb(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],s=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let n={};r.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let o=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));i.push(o.join(", ").replace(".,","."))});let n=i.join(" "),o=`${r}${n}`;return`${e?e+" ":""}${o}`}(s,fm(p))),[r,i,"",s,"",n,o,a,h,c,u,l,f,d].filter(e=>null!=e).join(`
`)};function fb(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function fy(e){return fb(e),`urn:recap:${F.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function fm(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(F.from(t,"base64").toString("utf-8")));return fb(r),r}function fv(e){var t;let r=fm(e);fb(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function fw(e){let t=fm(e);fb(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function fD(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function fx(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function fE(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}function f_(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function fS(e,...t){if(!fx(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function fI(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function fA(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function fM(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}const fO=68===new Uint8Array(new Uint32Array([0x11223344]).buffer)[0];function fC(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(fx(e))e=fT(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function fP(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function fR(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(0xffffffff),o=Number(r>>s&n),a=Number(r&n),h=4*!!i,c=4*!i;e.setUint32(t+h,o,i),e.setUint32(t+c,a,i)}function fT(e){return Uint8Array.from(e)}const fN=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),fB=fN("expand 16-byte k"),fL=fN("expand 32-byte k"),fU=fA(fB),fk=fA(fL);function fq(e,t){return e<<t|e>>>32-t}function fj(e){return e.byteOffset%4==0}const fz=0x100000000-1,fF=new Uint32Array,f$=(e,t)=>255&e[t++]|(255&e[t++])<<8;class fK{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,fS(e=fC(e),32);let t=f$(e,0),r=f$(e,2),i=f$(e,4),s=f$(e,6),n=f$(e,8),o=f$(e,10),a=f$(e,12),h=f$(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|o<<2)&8191,this.r[7]=(o>>>11|a<<5)&8065,this.r[8]=(a>>>8|h<<8)&8191,this.r[9]=h>>>5&127;for(let t=0;t<8;t++)this.pad[t]=f$(e,16+2*t)}process(e,t,r=!1){let{h:i,r:s}=this,n=s[0],o=s[1],a=s[2],h=s[3],c=s[4],u=s[5],l=s[6],f=s[7],d=s[8],p=s[9],g=f$(e,t+0),b=f$(e,t+2),y=f$(e,t+4),m=f$(e,t+6),v=f$(e,t+8),w=f$(e,t+10),D=f$(e,t+12),x=f$(e,t+14),E=i[0]+(8191&g),_=i[1]+((g>>>13|b<<3)&8191),S=i[2]+((b>>>10|y<<6)&8191),I=i[3]+((y>>>7|m<<9)&8191),A=i[4]+((m>>>4|v<<12)&8191),M=i[5]+(v>>>1&8191),O=i[6]+((v>>>14|w<<2)&8191),C=i[7]+((w>>>11|D<<5)&8191),P=i[8]+((D>>>8|x<<8)&8191),R=i[9]+(x>>>5|2048*!r),T=0,N=0+E*n+5*p*_+5*d*S+5*f*I+5*l*A;T=N>>>13,N&=8191,N+=5*u*M+5*c*O+5*h*C+5*a*P+5*o*R,T+=N>>>13,N&=8191;let B=T+E*o+_*n+5*p*S+5*d*I+5*f*A;T=B>>>13,B&=8191,B+=5*l*M+5*u*O+5*c*C+5*h*P+5*a*R,T+=B>>>13,B&=8191;let L=T+E*a+_*o+S*n+5*p*I+5*d*A;T=L>>>13,L&=8191,L+=5*f*M+5*l*O+5*u*C+5*c*P+5*h*R,T+=L>>>13,L&=8191;let U=T+E*h+_*a+S*o+I*n+5*p*A;T=U>>>13,U&=8191,U+=5*d*M+5*f*O+5*l*C+5*u*P+5*c*R,T+=U>>>13,U&=8191;let k=T+E*c+_*h+S*a+I*o+A*n;T=k>>>13,k&=8191,k+=5*p*M+5*d*O+5*f*C+5*l*P+5*u*R,T+=k>>>13,k&=8191;let q=T+E*u+_*c+S*h+I*a+A*o;T=q>>>13,q&=8191,q+=M*n+5*p*O+5*d*C+5*f*P+5*l*R,T+=q>>>13,q&=8191;let j=T+E*l+_*u+S*c+I*h+A*a;T=j>>>13,j&=8191,j+=M*o+O*n+5*p*C+5*d*P+5*f*R,T+=j>>>13,j&=8191;let z=T+E*f+_*l+S*u+I*c+A*h;T=z>>>13,z&=8191,z+=M*a+O*o+C*n+5*p*P+5*d*R,T+=z>>>13,z&=8191;let F=T+E*d+_*f+S*l+I*u+A*c;T=F>>>13,F&=8191,F+=M*h+O*a+C*o+P*n+5*p*R,T+=F>>>13,F&=8191;let $=T+E*p+_*d+S*f+I*l+A*u;T=$>>>13,$&=8191,$+=M*c+O*h+C*a+P*o+R*n,T+=$>>>13,$&=8191,N=8191&(T=(T=(T<<2)+T|0)+N|0),T>>>=13,B+=T,i[0]=N,i[1]=B,i[2]=L,i[3]=U,i[4]=k,i[5]=q,i[6]=j,i[7]=z,i[8]=F,i[9]=$}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let s=(1^i)-1;for(let e=0;e<10;e++)r[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let r=1;r<8;r++)n=(e[r]+t[r]|0)+(n>>>16)|0,e[r]=65535&n;fM(r)}update(e){fI(this),fS(e=fC(e));let{buffer:t,blockLen:r}=this,i=e.length;for(let s=0;s<i;){let n=Math.min(r-this.pos,i-s);if(n===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){fM(this.h,this.r,this.buffer,this.pad)}digestInto(e){fI(this),function(e,t){fS(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=r[t]>>>0,e[s++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}const fV=function(e){let t=(t,r)=>e(r).update(fC(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new fK(e)),fH=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return f_(s),f_(o),fE(n),fE(r),(t,a,h,c,u=0)=>{fS(t),fS(a),fS(h);let l=h.length;if(void 0===c&&(c=new Uint8Array(l)),fS(c),f_(u),u<0||u>=fz)throw Error("arx: counter overflow");if(c.length<l)throw Error(`arx: output (${c.length}) is shorter than data (${l})`);let f=[],d=t.length,p,g;if(32===d)f.push(p=fT(t)),g=fk;else if(16===d&&r)(p=new Uint8Array(32)).set(t),p.set(t,16),g=fU,f.push(p);else throw Error(`arx: invalid 32-byte key, got length=${d}`);fj(a)||f.push(a=fT(a));let b=fA(p);if(i){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");i(g,b,fA(a.subarray(0,16)),b),a=a.subarray(16)}let y=16-s;if(y!==a.length)throw Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){let e=new Uint8Array(12);e.set(a,n?0:12-a.length),a=e,f.push(a)}return function(e,t,r,i,s,n,o,a){let h=s.length,c=new Uint8Array(64),u=fA(c),l=fj(s)&&fj(n),f=l?fA(s):fF,d=l?fA(n):fF;for(let p=0;p<h;o++){if(e(t,r,i,u,o,a),o>=fz)throw Error("arx: counter overflow");let g=Math.min(64,h-p);if(l&&64===g){let e=p/4;if(p%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)d[r=e+t]=f[r]^u[t];p+=64;continue}for(let e=0,t;e<g;e++)n[t=p+e]=s[t]^c[e];p+=g}}(e,g,b,fA(a),h,c,u,o),fM(...f),c}}(function(e,t,r,i,s,n=20){let o=e[0],a=e[1],h=e[2],c=e[3],u=t[0],l=t[1],f=t[2],d=t[3],p=t[4],g=t[5],b=t[6],y=t[7],m=r[0],v=r[1],w=r[2],D=o,x=a,E=h,_=c,S=u,I=l,A=f,M=d,O=p,C=g,P=b,R=y,T=s,N=m,B=v,L=w;for(let e=0;e<n;e+=2)O=O+(T=fq(T^(D=D+S|0),16))|0,D=D+(S=fq(S^O,12))|0,O=O+(T=fq(T^D,8))|0,S=fq(S^O,7),C=C+(N=fq(N^(x=x+I|0),16))|0,x=x+(I=fq(I^C,12))|0,C=C+(N=fq(N^x,8))|0,I=fq(I^C,7),P=P+(B=fq(B^(E=E+A|0),16))|0,E=E+(A=fq(A^P,12))|0,P=P+(B=fq(B^E,8))|0,A=fq(A^P,7),R=R+(L=fq(L^(_=_+M|0),16))|0,_=_+(M=fq(M^R,12))|0,R=R+(L=fq(L^_,8))|0,M=fq(M^R,7),P=P+(L=fq(L^(D=D+I|0),16))|0,D=D+(I=fq(I^P,12))|0,P=P+(L=fq(L^D,8))|0,I=fq(I^P,7),R=R+(T=fq(T^(x=x+A|0),16))|0,x=x+(A=fq(A^R,12))|0,R=R+(T=fq(T^x,8))|0,A=fq(A^R,7),O=O+(N=fq(N^(E=E+M|0),16))|0,E=E+(M=fq(M^O,12))|0,O=O+(N=fq(N^E,8))|0,M=fq(M^O,7),C=C+(B=fq(B^(_=_+S|0),16))|0,_=_+(S=fq(S^C,12))|0,C=C+(B=fq(B^_,8))|0,S=fq(S^C,7);let U=0;i[U++]=o+D|0,i[U++]=a+x|0,i[U++]=h+E|0,i[U++]=c+_|0,i[U++]=u+S|0,i[U++]=l+I|0,i[U++]=f+A|0,i[U++]=d+M|0,i[U++]=p+O|0,i[U++]=g+C|0,i[U++]=b+P|0,i[U++]=y+R|0,i[U++]=s+T|0,i[U++]=m+N|0,i[U++]=v+B|0,i[U++]=w+L|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),fG=new Uint8Array(16),fW=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(fG.subarray(r))},fY=new Uint8Array(32);function fJ(e,t,r,i,s){let n=e(t,r,fY),o=fV.create(n);s&&fW(o,s),fW(o,i);let a=function(e,t,r){fE(r);let i=new Uint8Array(16),s=new DataView(i.buffer,i.byteOffset,i.byteLength);return fR(s,0,BigInt(t),r),fR(s,8,BigInt(e),r),i}(i.length,s?s.length:0,!0);o.update(a);let h=o.digest();return fM(n,a),h}const fZ=((e,t)=>{function r(i,...s){if(fS(i),!fO)throw Error("Non little-endian hardware is not yet supported");if(void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?fS(t):fS(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&fS(s[1]);let o=t(i,...s),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");fS(t)}},h=!1;return{encrypt(e,t){if(h)throw Error("cannot encrypt() twice with same key + nonce");return h=!0,fS(e),a(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(fS(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return a(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,s){let n=i.length;(s=fP(n+16,s,!1)).set(i);let o=s.subarray(0,-16);fH(e,t,o,o,1);let a=fJ(fH,e,t,o,r);return s.set(a,n),fM(a),s},decrypt(i,s){s=fP(i.length-16,s,!1);let n=i.subarray(0,-16),o=i.subarray(-16),a=fJ(fH,e,t,n,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(o,a))throw Error("invalid tag");return s.set(i.subarray(0,-16)),fH(e,t,s,s,1),fM(a),s}}));class fX extends lg{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,u5(e);let r=ld(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),le(s)}update(e){return u4(this),this.iHash.update(e),this}digestInto(e){u4(this),u6(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const fQ=(e,t,r)=>new fX(e,t).update(r).digest();fQ.create=(e,t)=>new fX(e,t);const f0=Uint8Array.from([0]),f1=Uint8Array.of(),f2=BigInt(0),f3=BigInt(1);function f8(e,t=""){if("boolean"!=typeof e)throw Error((t&&`"${t}"`)+"expected boolean, got type="+typeof e);return e}function f6(e,t,r=""){let i=u3(e),s=e?.length,n=void 0!==t;if(!i||n&&s!==t)throw Error((r&&`"${r}" `)+"expected Uint8Array"+(n?` of length ${t}`:"")+", got "+(i?`length=${s}`:`type=${typeof e}`));return e}function f5(e){let t=e.toString(16);return 1&t.length?"0"+t:t}function f4(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?f2:BigInt("0x"+e)}function f9(e){return u6(e),f4(lc(Uint8Array.from(e).reverse()))}function f7(e,t){return ll(e.toString(16).padStart(2*t,"0"))}function de(e,t){return f7(e,t).reverse()}function dt(e,t,r){let i;if("string"==typeof t)try{i=ll(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(u3(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}const dr=e=>"bigint"==typeof e&&f2<=e;function di(e,t,r,i){if(!(dr(t)&&dr(r)&&dr(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}function ds(e){let t;for(t=0;e>f2;e>>=f3,t+=1);return t}const dn=e=>(f3<<BigInt(e))-f3;function da(e,t,r={}){if(!e||"object"!=typeof e)throw Error("expected valid options object");function i(t,r,i){let s=e[t];if(i&&void 0===s)return;let n=typeof s;if(n!==r||null===s)throw Error(`param "${t}" is invalid: expected ${r}, got ${n}`)}Object.entries(t).forEach(([e,t])=>i(e,t,!1)),Object.entries(r).forEach(([e,t])=>i(e,t,!0))}function dh(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}}const dc=BigInt(0),du=BigInt(1),dl=BigInt(2),df=BigInt(3),dd=BigInt(4),dp=BigInt(5),dg=BigInt(7),db=BigInt(8),dy=BigInt(9),dm=BigInt(16);function dv(e,t){let r=e%t;return r>=dc?r:t+r}function dw(e,t,r){let i=e;for(;t-- >dc;)i*=i,i%=r;return i}function dD(e,t){if(e===dc)throw Error("invert: expected non-zero number");if(t<=dc)throw Error("invert: expected positive modulus, got "+t);let r=dv(e,t),i=t,s=dc,n=du;for(;r!==dc;){let e=i/r,t=i%r,o=s-n*e;i=r,r=t,s=n,n=o}if(i!==du)throw Error("invert: does not exist");return dv(s,t)}function dx(e,t,r){if(!e.eql(e.sqr(t),r))throw Error("Cannot find square root")}function dE(e,t){let r=(e.ORDER+du)/dd,i=e.pow(t,r);return dx(e,i,t),i}function d_(e,t){let r=(e.ORDER-dp)/db,i=e.mul(t,dl),s=e.pow(i,r),n=e.mul(t,s),o=e.mul(e.mul(n,dl),s),a=e.mul(n,e.sub(o,e.ONE));return dx(e,a,t),a}function dS(e){if(e<df)throw Error("sqrt is not defined for small field");let t=e-du,r=0;for(;t%dl===dc;)t/=dl,r++;let i=dl,s=dC(e);for(;1===dM(s,i);)if(i++>1e3)throw Error("Cannot find square root: probably non-prime P");if(1===r)return dE;let n=s.pow(i,t),o=(t+du)/dl;return function(e,i){if(e.is0(i))return i;if(1!==dM(e,i))throw Error("Cannot find square root");let s=r,a=e.mul(e.ONE,n),h=e.pow(i,t),c=e.pow(i,o);for(;!e.eql(h,e.ONE);){if(e.is0(h))return e.ZERO;let t=1,r=e.sqr(h);for(;!e.eql(r,e.ONE);)if(t++,r=e.sqr(r),t===s)throw Error("Cannot find square root");let i=du<<BigInt(s-t-1),n=e.pow(a,i);s=t,a=e.sqr(n),h=e.mul(h,a),c=e.mul(c,n)}return c}}const dI=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function dA(e,t,r=!1){let i=Array(t.length).fill(r?e.ZERO:void 0),s=t.reduce((t,r,s)=>e.is0(r)?t:(i[s]=t,e.mul(t,r)),e.ONE),n=e.inv(s);return t.reduceRight((t,r,s)=>e.is0(r)?t:(i[s]=e.mul(t,i[s]),e.mul(t,r)),n),i}function dM(e,t){let r=(e.ORDER-du)/dl,i=e.pow(t,r),s=e.eql(i,e.ONE),n=e.eql(i,e.ZERO),o=e.eql(i,e.neg(e.ONE));if(!s&&!n&&!o)throw Error("invalid Legendre symbol result");return s?1:n?0:-1}function dO(e,t){void 0!==t&&u8(t);let r=void 0!==t?t:e.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function dC(e,t,r=!1,i={}){let s;if(e<=dc)throw Error("invalid field: expected ORDER > 0, got "+e);let n,o,a=!1,h;if("object"==typeof t&&null!=t){if(i.sqrt||r)throw Error("cannot specify opts in two arguments");t.BITS&&(n=t.BITS),t.sqrt&&(o=t.sqrt),"boolean"==typeof t.isLE&&(r=t.isLE),"boolean"==typeof t.modFromBytes&&(a=t.modFromBytes),h=t.allowedLengths}else"number"==typeof t&&(n=t),i.sqrt&&(o=i.sqrt);let{nBitLength:c,nByteLength:u}=dO(e,n);if(u>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let l=Object.freeze({ORDER:e,isLE:r,BITS:c,BYTES:u,MASK:dn(c),ZERO:dc,ONE:du,allowedLengths:h,create:t=>dv(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return dc<=t&&t<e},is0:e=>e===dc,isValidNot0:e=>!l.is0(e)&&l.isValid(e),isOdd:e=>(e&du)===du,neg:t=>dv(-t,e),eql:(e,t)=>e===t,sqr:t=>dv(t*t,e),add:(t,r)=>dv(t+r,e),sub:(t,r)=>dv(t-r,e),mul:(t,r)=>dv(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<dc)throw Error("invalid exponent, negatives unsupported");if(r===dc)return e.ONE;if(r===du)return t;let i=e.ONE,s=t;for(;r>dc;)r&du&&(i=e.mul(i,s)),s=e.sqr(s),r>>=du;return i})(l,e,t),div:(t,r)=>dv(t*dD(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>dD(t,e),sqrt:o||(t=>(s||(s=e%dd===df?dE:e%db===dp?d_:e%dm===dy?function(e){let t=dC(e),r=dS(e),i=r(t,t.neg(t.ONE)),s=r(t,i),n=r(t,t.neg(i)),o=(e+dg)/dm;return(e,t)=>{let r=e.pow(t,o),a=e.mul(r,i),h=e.mul(r,s),c=e.mul(r,n),u=e.eql(e.sqr(a),t),l=e.eql(e.sqr(h),t);r=e.cmov(r,a,u),a=e.cmov(c,h,l);let f=e.eql(e.sqr(a),t),d=e.cmov(r,a,f);return dx(e,d,t),d}}(e):dS(e)),s(l,t))),toBytes:e=>r?de(e,u):f7(e,u),fromBytes:(t,i=!0)=>{if(h){if(!h.includes(t.length)||t.length>u)throw Error("Field.fromBytes: expected "+h+" bytes, got "+t.length);let e=new Uint8Array(u);e.set(t,r?0:e.length-t.length),t=e}if(t.length!==u)throw Error("Field.fromBytes: expected "+u+" bytes, got "+t.length);let s=r?f9(t):f4(lc(t));if(a&&(s=dv(s,e)),!i&&!l.isValid(s))throw Error("invalid field element: outside of range 0..ORDER");return s},invertBatch:e=>dA(l,e),cmov:(e,t,r)=>r?t:e});return Object.freeze(l)}function dP(e){if("bigint"!=typeof e)throw Error("field order must be bigint");return Math.ceil(e.toString(2).length/8)}function dR(e){let t=dP(e);return t+Math.ceil(t/2)}const dT=BigInt(0),dN=BigInt(1);function dB(e,t){let r=t.negate();return e?r:t}function dL(e,t){let r=dA(e.Fp,t.map(e=>e.Z));return t.map((t,i)=>e.fromAffine(t.toAffine(r[i])))}function dU(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function dk(e,t){dU(e,t);let r=Math.ceil(t/e)+1,i=2**(e-1),s=2**e;return{windows:r,windowSize:i,mask:dn(e),maxNumber:s,shiftBy:BigInt(e)}}function dq(e,t,r){let{windowSize:i,mask:s,maxNumber:n,shiftBy:o}=r,a=Number(e&s),h=e>>o;a>i&&(a-=n,h+=dN);let c=t*i;return{nextN:h,offset:c+Math.abs(a)-1,isZero:0===a,isNeg:a<0,isNegF:t%2!=0,offsetF:c}}const dj=new WeakMap,dz=new WeakMap;function dF(e){return dz.get(e)||1}function d$(e){if(e!==dT)throw Error("invalid wNAF")}class dK{constructor(e,t){this.BASE=e.BASE,this.ZERO=e.ZERO,this.Fn=e.Fn,this.bits=t}_unsafeLadder(e,t,r=this.ZERO){let i=e;for(;t>dT;)t&dN&&(r=r.add(i)),i=i.double(),t>>=dN;return r}precomputeWindow(e,t){let{windows:r,windowSize:i}=dk(t,this.bits),s=[],n=e,o=n;for(let e=0;e<r;e++){o=n,s.push(o);for(let e=1;e<i;e++)o=o.add(n),s.push(o);n=o.double()}return s}wNAF(e,t,r){if(!this.Fn.isValid(r))throw Error("invalid scalar");let i=this.ZERO,s=this.BASE,n=dk(e,this.bits);for(let e=0;e<n.windows;e++){let{nextN:o,offset:a,isZero:h,isNeg:c,isNegF:u,offsetF:l}=dq(r,e,n);r=o,h?s=s.add(dB(u,t[l])):i=i.add(dB(c,t[a]))}return d$(r),{p:i,f:s}}wNAFUnsafe(e,t,r,i=this.ZERO){let s=dk(e,this.bits);for(let e=0;e<s.windows&&r!==dT;e++){let{nextN:n,offset:o,isZero:a,isNeg:h}=dq(r,e,s);if(r=n,!a){let e=t[o];i=i.add(h?e.negate():e)}}return d$(r),i}getPrecomputes(e,t,r){let i=dj.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&("function"==typeof r&&(i=r(i)),dj.set(t,i))),i}cached(e,t,r){let i=dF(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)}unsafe(e,t,r,i){let s=dF(e);return 1===s?this._unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)}createCache(e,t){dU(t,this.bits),dz.set(e,t),dj.delete(e)}hasCache(e){return 1!==dF(e)}}function dV(e,t,r){if(!t)return dC(e,{isLE:r});if(t.ORDER!==e)throw Error("Field.ORDER must match order: Fp == p, Fn == n");return da(t,dI.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"number",BITS:"number"})),t}BigInt(0),BigInt(1),BigInt(2),BigInt(8),lf("HashToScalar-");const dH=BigInt(0),dG=BigInt(1),dW=BigInt(2),dY=BigInt(1),dJ=BigInt(2),dZ=BigInt(3),dX=BigInt(5),dQ=BigInt(8),d0=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed");function d1(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}const d2=dC({p:d0,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:dQ,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")}.p,{isLE:!0}),d3=(()=>{let e=d2.ORDER;return function(e){let{P:t,type:r,adjustScalarBytes:i,powPminus2:s,randomBytes:n}=(da(e,{adjustScalarBytes:"function",powPminus2:"function"}),Object.freeze({...e})),o="x25519"===r;if(!o&&"x448"!==r)throw Error("invalid type");let a=n||ly,h=o?255:448,c=o?32:56,u=BigInt(o?9:5),l=BigInt(o?121665:39081),f=o?dW**BigInt(254):dW**BigInt(447),d=f+(o?BigInt(8)*dW**BigInt(251)-dG:BigInt(4)*dW**BigInt(445)-dG)+dG,p=e=>dv(e,t),g=de(p(u),c);function b(e,r){let n=function(e,r){di("u",e,dH,t),di("scalar",r,f,d);let i=dG,n=dH,o=e,a=dG,c=dH;for(let t=BigInt(h-1);t>=dH;t--){let s=r>>t&dG;c^=s,({x_2:i,x_3:o}=m(c,i,o)),({x_2:n,x_3:a}=m(c,n,a)),c=s;let h=i+n,u=p(h*h),f=i-n,d=p(f*f),g=u-d,b=o+a,y=p((o-a)*h),v=p(b*f),w=y+v,D=y-v;o=p(w*w),a=p(e*p(D*D)),i=p(u*d),n=p(g*(u+p(l*g)))}return{x_2:i,x_3:o}=m(c,i,o),{x_2:n,x_3:a}=m(c,n,a),p(i*s(n))}(function(e){let t=dt("u coordinate",e,c);return o&&(t[31]&=127),p(f9(t))}(r),f9(i(dt("scalar",e,c))));if(n===dH)throw Error("invalid private or public key received");return de(p(n),c)}function y(e){return b(e,g)}function m(e,t,r){let i=p(e*(t-r));return{x_2:t=p(t-i),x_3:r=p(r+i)}}let v={secretKey:c,publicKey:c,seed:c},w=(e=a(c))=>(u6(e,v.seed),e);return{keygen:function(e){let t=w(e);return{secretKey:t,publicKey:y(t)}},getSharedSecret:(e,t)=>b(e,t),getPublicKey:e=>y(e),scalarMult:b,scalarMultBase:y,utils:{randomSecretKey:w,randomPrivateKey:w},GuBytes:g.slice(),lengths:v}}({P:e,type:"x25519",powPminus2:t=>{let{pow_p_5_8:r,b2:i}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%d0*e%d0,o=dw(n,dJ,d0)*n%d0,a=dw(o,dY,d0)*e%d0,h=dw(a,dX,d0)*a%d0,c=dw(h,t,d0)*h%d0,u=dw(c,r,d0)*c%d0,l=dw(u,i,d0)*u%d0,f=dw(l,s,d0)*l%d0,d=dw(f,s,d0)*l%d0,p=dw(d,t,d0)*h%d0;return{pow_p_5_8:dw(p,dJ,d0)*e%d0,b2:n}}(t);return dv(dw(r,dZ,e)*i,e)},adjustScalarBytes:d1})})(),d8=(e,t)=>(e+(e>=0?t:-t)/pe)/t;function d6(e){if(!["compact","recovered","der"].includes(e))throw Error('Signature format must be "compact", "recovered", or "der"');return e}function d5(e,t){let r={};for(let i of Object.keys(t))r[i]=void 0===e[i]?t[i]:e[i];return f8(r.lowS,"lowS"),f8(r.prehash,"prehash"),void 0!==r.format&&d6(r.format),r}const d4={Err:class extends Error{constructor(e=""){super(e)}},_tlv:{encode:(e,t)=>{let{Err:r}=d4;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(1&t.length)throw new r("tlv.encode: unpadded data");let i=t.length/2,s=f5(i);if(s.length/2&128)throw new r("tlv.encode: long form length too big");let n=i>127?f5(s.length/2|128):"";return f5(e)+n+s+t},decode(e,t){let{Err:r}=d4,i=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[i++]!==e)throw new r("tlv.decode: wrong tlv");let s=t[i++],n=0;if(128&s){let e=127&s;if(!e)throw new r("tlv.decode(long): indefinite length not supported");if(e>4)throw new r("tlv.decode(long): byte length is too big");let o=t.subarray(i,i+e);if(o.length!==e)throw new r("tlv.decode: length bytes not complete");if(0===o[0])throw new r("tlv.decode(long): zero leftmost byte");for(let e of o)n=n<<8|e;if(i+=e,n<128)throw new r("tlv.decode(long): not minimal encoding")}else n=s;let o=t.subarray(i,i+n);if(o.length!==n)throw new r("tlv.decode: wrong value length");return{v:o,l:t.subarray(i+n)}}},_int:{encode(e){let{Err:t}=d4;if(e<d9)throw new t("integer: negative integers are not allowed");let r=f5(e);if(8&Number.parseInt(r[0],16)&&(r="00"+r),1&r.length)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=d4;if(128&e[0])throw new t("invalid signature integer: negative");if(0===e[0]&&!(128&e[1]))throw new t("invalid signature integer: unnecessary leading zero");return f4(lc(e))}},toSig(e){let{Err:t,_int:r,_tlv:i}=d4,s=dt("signature",e),{v:n,l:o}=i.decode(48,s);if(o.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:h}=i.decode(2,n),{v:c,l:u}=i.decode(2,h);if(u.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(c)}},hexFromSig(e){let{_tlv:t,_int:r}=d4,i=t.encode(2,r.encode(e.r)),s=t.encode(2,r.encode(e.s));return t.encode(48,i+s)}},d9=BigInt(0),d7=BigInt(1),pe=BigInt(2),pt=BigInt(3),pr=BigInt(4);function pi(e,t){let r,{BYTES:i}=e;if("bigint"==typeof t)r=t;else{let s=dt("private key",t);try{r=e.fromBytes(s)}catch{throw Error(`invalid private key: expected ui8a of size ${i}, got ${typeof t}`)}}if(!e.isValidNot0(r))throw Error("invalid private key: out of range [1..N-1]");return r}function ps(e){return Uint8Array.of(e?2:3)}function pn(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function po(e,t){let r=t=>(function(e){let{CURVE:t,curveOpts:r,hash:i,ecdsaOpts:s}=function(e){let{CURVE:t,curveOpts:r}=function(e){let t={a:e.a,b:e.b,p:e.Fp.ORDER,n:e.n,h:e.h,Gx:e.Gx,Gy:e.Gy},r=e.Fp,i=e.allowedPrivateKeyLengths?Array.from(new Set(e.allowedPrivateKeyLengths.map(e=>Math.ceil(e/2)))):void 0,s={Fp:r,Fn:dC(t.n,{BITS:e.nBitLength,allowedLengths:i,modFromBytes:e.wrapPrivateKey}),allowInfinityPoint:e.allowInfinityPoint,endo:e.endo,isTorsionFree:e.isTorsionFree,clearCofactor:e.clearCofactor,fromBytes:e.fromBytes,toBytes:e.toBytes};return{CURVE:t,curveOpts:s}}(e),i={hmac:e.hmac,randomBytes:e.randomBytes,lowS:e.lowS,bits2int:e.bits2int,bits2int_modN:e.bits2int_modN};return{CURVE:t,curveOpts:r,hash:e.hash,ecdsaOpts:i}}(e),n=function(e,t,r={}){u5(t),da(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"});let i=r.randomBytes||ly,s=r.hmac||((e,...r)=>fQ(t,e,lp(...r))),{Fp:n,Fn:o}=e,{ORDER:a,BITS:h}=o,{keygen:c,getPublicKey:u,getSharedSecret:l,utils:f,lengths:d}=function(e,t={}){let{Fn:r}=e,i=t.randomBytes||ly,s=Object.assign(pn(e.Fp,r),{seed:dR(r.ORDER)});function n(e){try{return!!pi(r,e)}catch{return!1}}function o(e=i(s.seed)){return function(e,t,r=!1){let i=e.length,s=dP(t),n=dR(t);if(i<16||i<n||i>1024)throw Error("expected "+n+"-1024 bytes of input, got "+i);let o=dv(r?f9(e):f4(lc(e)),t-du)+du;return r?de(o,s):f7(o,s)}(f6(e,s.seed,"seed"),r.ORDER)}function a(t,i=!0){return e.BASE.multiply(pi(r,t)).toBytes(i)}function h(t){if("bigint"==typeof t)return!1;if(t instanceof e)return!0;let{secretKey:i,publicKey:n,publicKeyUncompressed:o}=s;if(r.allowedLengths||i===n)return;let a=dt("key",t).length;return a===n||a===o}return Object.freeze({getPublicKey:a,getSharedSecret:function(t,i,s=!0){if(!0===h(t))throw Error("first arg must be private key");if(!1===h(i))throw Error("second arg must be public key");let n=pi(r,t);return e.fromHex(i).multiply(n).toBytes(s)},keygen:function(e){let t=o(e);return{secretKey:t,publicKey:a(t)}},Point:e,utils:{isValidSecretKey:n,isValidPublicKey:function(t,r){let{publicKey:i,publicKeyUncompressed:n}=s;try{let s=t.length;return(!0!==r||s===i)&&(!1!==r||s===n)&&!!e.fromBytes(t)}catch{return!1}},randomSecretKey:o,isValidPrivateKey:n,randomPrivateKey:o,normPrivateKeyToScalar:e=>pi(r,e),precompute:(t=8,r=e.BASE)=>r.precompute(t,!1)},lengths:s})}(e,r),p={prehash:!1,lowS:"boolean"==typeof r.lowS&&r.lowS,format:void 0,extraEntropy:!1},g="compact";function b(e,t){if(!o.isValidNot0(t))throw Error(`invalid signature ${e}: out of range 1..Point.Fn.ORDER`);return t}class y{constructor(e,t,r){this.r=b("r",e),this.s=b("s",t),null!=r&&(this.recovery=r),Object.freeze(this)}static fromBytes(e,t=g){let r;if(!function(e,t){d6(t);let r=d.signature;f6(e,"compact"===t?r:"recovered"===t?r+1:void 0,`${t} signature`)}(e,t),"der"===t){let{r:t,s:r}=d4.toSig(f6(e));return new y(t,r)}"recovered"===t&&(r=e[0],t="compact",e=e.subarray(1));let i=o.BYTES,s=e.subarray(0,i),n=e.subarray(i,2*i);return new y(o.fromBytes(s),o.fromBytes(n),r)}static fromHex(e,t){return this.fromBytes(ll(e),t)}addRecoveryBit(e){return new y(this.r,this.s,e)}recoverPublicKey(t){let r=n.ORDER,{r:i,s:s,recovery:h}=this;if(null==h||![0,1,2,3].includes(h))throw Error("recovery id invalid");if(a*pe<r&&h>1)throw Error("recovery id is ambiguous for h>1 curve");let c=2===h||3===h?i+a:i;if(!n.isValid(c))throw Error("recovery id 2 or 3 invalid");let u=n.toBytes(c),l=e.fromBytes(lp(ps((1&h)==0),u)),f=o.inv(c),d=v(dt("msgHash",t)),p=o.create(-d*f),g=o.create(s*f),b=e.BASE.multiplyUnsafe(p).add(l.multiplyUnsafe(g));if(b.is0())throw Error("point at infinify");return b.assertValidity(),b}hasHighS(){return this.s>a>>d7}toBytes(e=g){if(d6(e),"der"===e)return ll(d4.hexFromSig(this));let t=o.toBytes(this.r),r=o.toBytes(this.s);if("recovered"===e){if(null==this.recovery)throw Error("recovery bit must be present");return lp(Uint8Array.of(this.recovery),t,r)}return lp(t,r)}toHex(e){return lc(this.toBytes(e))}assertValidity(){}static fromCompact(e){return y.fromBytes(dt("sig",e),"compact")}static fromDER(e){return y.fromBytes(dt("sig",e),"der")}normalizeS(){return this.hasHighS()?new y(this.r,o.neg(this.s),this.recovery):this}toDERRawBytes(){return this.toBytes("der")}toDERHex(){return lc(this.toBytes("der"))}toCompactRawBytes(){return this.toBytes("compact")}toCompactHex(){return lc(this.toBytes("compact"))}}let m=r.bits2int||function(e){if(e.length>8192)throw Error("input is too large");let t=f4(lc(e)),r=8*e.length-h;return r>0?t>>BigInt(r):t},v=r.bits2int_modN||function(e){return o.create(m(e))},w=dn(h);function D(e){return di("num < 2^"+h,e,d9,w),o.toBytes(e)}function x(e,r){return f6(e,void 0,"message"),r?f6(t(e),void 0,"prehashed message"):e}return Object.freeze({keygen:c,getPublicKey:u,getSharedSecret:l,utils:f,lengths:d,Point:e,sign:function(r,n,h={}){let{seed:c,k2sig:u}=function(t,r,s){if(["recovered","canonical"].some(e=>e in s))throw Error("sign() legacy options not supported");let{lowS:n,prehash:h,extraEntropy:c}=d5(s,p),u=v(t=x(t,h)),l=pi(o,r),f=[D(l),D(u)];if(null!=c&&!1!==c){let e=!0===c?i(d.secretKey):c;f.push(dt("extraEntropy",e))}return{seed:lp(...f),k2sig:function(t){let r=m(t);if(!o.isValidNot0(r))return;let i=o.inv(r),s=e.BASE.multiply(r).toAffine(),h=o.create(s.x);if(h===d9)return;let c=o.create(i*o.create(u+h*l));if(c===d9)return;let f=2*(s.x!==h)|Number(s.y&d7),d=c;return n&&c>a>>d7&&(d=o.neg(c),f^=1),new y(h,d,f)}}}(r=dt("message",r),n,h);return(function(e,t,r){if("number"!=typeof e||e<2)throw Error("hashLen must be a number");if("number"!=typeof t||t<2)throw Error("qByteLen must be a number");if("function"!=typeof r)throw Error("hmacFn must be a function");let i=e=>new Uint8Array(e),s=e=>Uint8Array.of(e),n=i(e),o=i(e),a=0,h=()=>{n.fill(1),o.fill(0),a=0},c=(...e)=>r(o,n,...e),u=(e=i(0))=>{o=c(s(0),e),n=c(),0!==e.length&&(o=c(s(1),e),n=c())},l=()=>{if(a++>=1e3)throw Error("drbg: tried 1000 values");let e=0,r=[];for(;e<t;){let t=(n=c()).slice();r.push(t),e+=n.length}return lp(...r)};return(e,t)=>{let r;for(h(),u(e);!(r=t(l()));)u();return h(),r}})(t.outputLen,o.BYTES,s)(c,u)},verify:function(t,r,i,s={}){let{lowS:n,prehash:a,format:h}=d5(s,p);if(i=dt("publicKey",i),r=x(dt("message",r),a),"strict"in s)throw Error("options.strict was renamed to lowS");let c=void 0===h?function(e){let t,r="string"==typeof e||u3(e),i=!r&&null!==e&&"object"==typeof e&&"bigint"==typeof e.r&&"bigint"==typeof e.s;if(!r&&!i)throw Error("invalid signature, expected Uint8Array, hex string or Signature instance");if(i)t=new y(e.r,e.s);else if(r){try{t=y.fromBytes(dt("sig",e),"der")}catch(e){if(!(e instanceof d4.Err))throw e}if(!t)try{t=y.fromBytes(dt("sig",e),"compact")}catch{return!1}}return t||!1}(t):y.fromBytes(dt("sig",t),h);if(!1===c)return!1;try{let t=e.fromBytes(i);if(n&&c.hasHighS())return!1;let{r:s,s:a}=c,h=v(r),u=o.inv(a),l=o.create(h*u),f=o.create(s*u),d=e.BASE.multiplyUnsafe(l).add(t.multiplyUnsafe(f));return!d.is0()&&o.create(d.x)===s}catch{return!1}},recoverPublicKey:function(e,t,r={}){let{prehash:i}=d5(r,p);return t=x(t,i),y.fromBytes(e,"recovered").recoverPublicKey(t).toBytes()},Signature:y,hash:t})}(function(e,t={}){let r=function(e,t,r={},i){if(void 0===i&&(i="edwards"===e),!t||"object"!=typeof t)throw Error(`expected valid ${e} CURVE object`);for(let e of["p","n","h"]){let r=t[e];if(!("bigint"==typeof r&&r>dT))throw Error(`CURVE.${e} must be positive bigint`)}let s=dV(t.p,r.Fp,i),n=dV(t.n,r.Fn,i);for(let r of["Gx","Gy","a","weierstrass"===e?"b":"d"])if(!s.isValid(t[r]))throw Error(`CURVE.${r} must be valid field element of CURVE.Fp`);return{CURVE:t=Object.freeze(Object.assign({},t)),Fp:s,Fn:n}}("weierstrass",e,t),{Fp:i,Fn:s}=r,n=r.CURVE,{h:o,n:a}=n;da(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object",wrapPrivateKey:"boolean"});let{endo:h}=t;if(h&&(!i.is0(n.a)||"bigint"!=typeof h.beta||!Array.isArray(h.basises)))throw Error('invalid endo: expected "beta": bigint and "basises": array');let c=pn(i,s);function u(){if(!i.isOdd)throw Error("compression is not supported: Field does not have .isOdd()")}let l=t.toBytes||function(e,t,r){let{x:s,y:n}=t.toAffine(),o=i.toBytes(s);return(f8(r,"isCompressed"),r)?(u(),lp(ps(!i.isOdd(n)),o)):lp(Uint8Array.of(4),o,i.toBytes(n))},f=t.fromBytes||function(e){f6(e,void 0,"Point");let{publicKey:t,publicKeyUncompressed:r}=c,s=e.length,n=e[0],o=e.subarray(1);if(s===t&&(2===n||3===n)){let e,t=i.fromBytes(o);if(!i.isValid(t))throw Error("bad point: is not on curve, wrong x");let r=d(t);try{e=i.sqrt(r)}catch(e){throw Error("bad point: is not on curve, sqrt error"+(e instanceof Error?": "+e.message:""))}return u(),(1&n)==1!==i.isOdd(e)&&(e=i.neg(e)),{x:t,y:e}}if(s===r&&4===n){let e=i.BYTES,t=i.fromBytes(o.subarray(0,e)),r=i.fromBytes(o.subarray(e,2*e));if(!p(t,r))throw Error("bad point: is not on curve");return{x:t,y:r}}throw Error(`bad point: got length ${s}, expected compressed=${t} or uncompressed=${r}`)};function d(e){let t=i.sqr(e),r=i.mul(t,e);return i.add(i.add(r,i.mul(e,n.a)),n.b)}function p(e,t){let r=i.sqr(t),s=d(e);return i.eql(r,s)}if(!p(n.Gx,n.Gy))throw Error("bad curve params: generator point");let g=i.mul(i.pow(n.a,pt),pr),b=i.mul(i.sqr(n.b),BigInt(27));if(i.is0(i.add(g,b)))throw Error("bad curve params: a or b");function y(e,t,r=!1){if(!i.isValid(t)||r&&i.is0(t))throw Error(`bad point coordinate ${e}`);return t}function m(e){if(!(e instanceof E))throw Error("ProjectivePoint expected")}function v(e){if(!h||!h.basises)throw Error("no endo");return function(e,t,r){let[[i,s],[n,o]]=t,a=d8(o*e,r),h=d8(-s*e,r),c=e-a*i-h*n,u=-a*s-h*o,l=c<d9,f=u<d9;l&&(c=-c),f&&(u=-u);let d=dn(Math.ceil(ds(r)/2))+d7;if(c<d9||c>=d||u<d9||u>=d)throw Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:l,k1:c,k2neg:f,k2:u}}(e,h.basises,s.ORDER)}let w=dh((e,t)=>{let{X:r,Y:s,Z:n}=e;if(i.eql(n,i.ONE))return{x:r,y:s};let o=e.is0();null==t&&(t=o?i.ONE:i.inv(n));let a=i.mul(r,t),h=i.mul(s,t),c=i.mul(n,t);if(o)return{x:i.ZERO,y:i.ZERO};if(!i.eql(c,i.ONE))throw Error("invZ was invalid");return{x:a,y:h}}),D=dh(e=>{if(e.is0()){if(t.allowInfinityPoint&&!i.is0(e.Y))return;throw Error("bad point: ZERO")}let{x:r,y:s}=e.toAffine();if(!i.isValid(r)||!i.isValid(s))throw Error("bad point: x or y not field elements");if(!p(r,s))throw Error("bad point: equation left != right");if(!e.isTorsionFree())throw Error("bad point: not in prime-order subgroup");return!0});function x(e,t,r,s,n){return r=new E(i.mul(r.X,e),r.Y,r.Z),t=dB(s,t),r=dB(n,r),t.add(r)}class E{constructor(e,t,r){this.X=y("x",e),this.Y=y("y",t,!0),this.Z=y("z",r),Object.freeze(this)}static CURVE(){return n}static fromAffine(e){let{x:t,y:r}=e||{};if(!e||!i.isValid(t)||!i.isValid(r))throw Error("invalid affine point");if(e instanceof E)throw Error("projective point not allowed");return i.is0(t)&&i.is0(r)?E.ZERO:new E(t,r,i.ONE)}static fromBytes(e){let t=E.fromAffine(f(f6(e,void 0,"point")));return t.assertValidity(),t}static fromHex(e){return E.fromBytes(dt("pointHex",e))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(e=8,t=!0){return S.createCache(this,e),t||this.multiply(pt),this}assertValidity(){D(this)}hasEvenY(){let{y:e}=this.toAffine();if(!i.isOdd)throw Error("Field doesn't support isOdd");return!i.isOdd(e)}equals(e){m(e);let{X:t,Y:r,Z:s}=this,{X:n,Y:o,Z:a}=e,h=i.eql(i.mul(t,a),i.mul(n,s)),c=i.eql(i.mul(r,a),i.mul(o,s));return h&&c}negate(){return new E(this.X,i.neg(this.Y),this.Z)}double(){let{a:e,b:t}=n,r=i.mul(t,pt),{X:s,Y:o,Z:a}=this,h=i.ZERO,c=i.ZERO,u=i.ZERO,l=i.mul(s,s),f=i.mul(o,o),d=i.mul(a,a),p=i.mul(s,o);return p=i.add(p,p),u=i.mul(s,a),u=i.add(u,u),h=i.mul(e,u),c=i.mul(r,d),c=i.add(h,c),h=i.sub(f,c),c=i.add(f,c),c=i.mul(h,c),h=i.mul(p,h),u=i.mul(r,u),d=i.mul(e,d),p=i.sub(l,d),p=i.mul(e,p),p=i.add(p,u),u=i.add(l,l),l=i.add(u,l),l=i.add(l,d),l=i.mul(l,p),c=i.add(c,l),d=i.mul(o,a),d=i.add(d,d),l=i.mul(d,p),h=i.sub(h,l),u=i.mul(d,f),u=i.add(u,u),new E(h,c,u=i.add(u,u))}add(e){m(e);let{X:t,Y:r,Z:s}=this,{X:o,Y:a,Z:h}=e,c=i.ZERO,u=i.ZERO,l=i.ZERO,f=n.a,d=i.mul(n.b,pt),p=i.mul(t,o),g=i.mul(r,a),b=i.mul(s,h),y=i.add(t,r),v=i.add(o,a);y=i.mul(y,v),v=i.add(p,g),y=i.sub(y,v),v=i.add(t,s);let w=i.add(o,h);return v=i.mul(v,w),w=i.add(p,b),v=i.sub(v,w),w=i.add(r,s),c=i.add(a,h),w=i.mul(w,c),c=i.add(g,b),w=i.sub(w,c),l=i.mul(f,v),c=i.mul(d,b),l=i.add(c,l),c=i.sub(g,l),l=i.add(g,l),u=i.mul(c,l),g=i.add(p,p),g=i.add(g,p),b=i.mul(f,b),v=i.mul(d,v),g=i.add(g,b),b=i.sub(p,b),b=i.mul(f,b),v=i.add(v,b),p=i.mul(g,v),u=i.add(u,p),p=i.mul(w,v),c=i.mul(y,c),c=i.sub(c,p),p=i.mul(y,g),l=i.mul(w,l),new E(c,u,l=i.add(l,p))}subtract(e){return this.add(e.negate())}is0(){return this.equals(E.ZERO)}multiply(e){let r,i,{endo:n}=t;if(!s.isValidNot0(e))throw Error("invalid scalar: out of range");let o=e=>S.cached(this,e,e=>dL(E,e));if(n){let{k1neg:t,k1:s,k2neg:a,k2:h}=v(e),{p:c,f:u}=o(s),{p:l,f:f}=o(h);i=u.add(f),r=x(n.beta,c,l,t,a)}else{let{p:t,f:s}=o(e);r=t,i=s}return dL(E,[r,i])[0]}multiplyUnsafe(e){let{endo:r}=t;if(!s.isValid(e))throw Error("invalid scalar: out of range");if(e===d9||this.is0())return E.ZERO;if(e===d7)return this;if(S.hasCache(this))return this.multiply(e);if(!r)return S.unsafe(this,e);{let{k1neg:t,k1:i,k2neg:s,k2:n}=v(e),{p1:o,p2:a}=function(e,t,r,i){let s=t,n=e.ZERO,o=e.ZERO;for(;r>dT||i>dT;)r&dN&&(n=n.add(s)),i&dN&&(o=o.add(s)),s=s.double(),r>>=dN,i>>=dN;return{p1:n,p2:o}}(E,this,i,n);return x(r.beta,o,a,t,s)}}multiplyAndAddUnsafe(e,t,r){let i=this.multiplyUnsafe(t).add(e.multiplyUnsafe(r));return i.is0()?void 0:i}toAffine(e){return w(this,e)}isTorsionFree(){let{isTorsionFree:e}=t;return o===d7||(e?e(E,this):S.unsafe(this,a).is0())}clearCofactor(){let{clearCofactor:e}=t;return o===d7?this:e?e(E,this):this.multiplyUnsafe(o)}isSmallOrder(){return this.multiplyUnsafe(o).is0()}toBytes(e=!0){return f8(e,"isCompressed"),this.assertValidity(),l(E,this,e)}toHex(e=!0){return lc(this.toBytes(e))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}get px(){return this.X}get py(){return this.X}get pz(){return this.Z}toRawBytes(e=!0){return this.toBytes(e)}_setWindowSize(e){this.precompute(e)}static normalizeZ(e){return dL(E,e)}static msm(e,t){return function(e,t,r,i){(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})})(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t);let s=r.length,n=i.length;if(s!==n)throw Error("arrays of points and scalars must have equal length");let o=e.ZERO,a=ds(BigInt(s)),h=1;a>12?h=a-3:a>4?h=a-2:a>0&&(h=2);let c=dn(h),u=Array(Number(c)+1).fill(o),l=Math.floor((t.BITS-1)/h)*h,f=o;for(let e=l;e>=0;e-=h){u.fill(o);for(let t=0;t<n;t++){let s=Number(i[t]>>BigInt(e)&c);u[s]=u[s].add(r[t])}let t=o;for(let e=u.length-1,r=o;e>0;e--)r=r.add(u[e]),t=t.add(r);if(f=f.add(t),0!==e)for(let e=0;e<h;e++)f=f.double()}return f}(E,s,e,t)}static fromPrivateKey(e){return E.BASE.multiply(pi(s,e))}}E.BASE=new E(n.Gx,n.Gy,i.ONE),E.ZERO=new E(i.ZERO,i.ONE,i.ZERO),E.Fp=i,E.Fn=s;let _=s.BITS,S=new dK(E,t.endo?Math.ceil(_/2):_);return E.BASE.precompute(8),E}(t,r),i,s),o=n.Point;return Object.assign({},n,{ProjectivePoint:o,CURVE:Object.assign({},e,dO(o.Fn.ORDER,o.Fn.BITS))})})({...e,hash:t});return{...r(t),create:r}}const pa={p:BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff"),n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),h:BigInt(1),a:BigInt("0xffffffff00000001000000000000000000000000fffffffffffffffffffffffc"),b:BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5")},ph={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000ffffffff"),n:BigInt("0xffffffffffffffffffffffffffffffffffffffffffffffffc7634d81f4372ddf581a0db248b0a77aecec196accc52973"),h:BigInt(1),a:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffeffffffff0000000000000000fffffffc"),b:BigInt("0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef"),Gx:BigInt("0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7"),Gy:BigInt("0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f")},pc={p:BigInt("0x1ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),n:BigInt("0x01fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffa51868783bf2f966b7fcc0148f709a5d03bb5c9b8899c47aebb6fb71e91386409"),h:BigInt(1),a:BigInt("0x1fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffc"),b:BigInt("0x0051953eb9618e1c9a1f929a21a0b68540eea2da725b99b315f3b8b489918ef109e156193951ec7e937b1652c0bd3bb1bf073573df883d2c34f1ef451fd46b503f00"),Gx:BigInt("0x00c6858e06b70404e9cd9e3ecb662395b4429c648139053fb521f828af606b4d3dbaa14b5e77efe75928fe1dc127a2ffa8de3348b3c1856a429bf97e7e31c2e5bd66"),Gy:BigInt("0x011839296a789a3bc0045c8a5fb42c7d1bd998f54449579b446817afbd17273e662c97ee72995ef42640c550b9013fad0761353c7086a272c24088be94769fd16650")},pu=dC(pa.p),pl=dC(ph.p),pf=dC(pc.p),pd=po({...pa,Fp:pu,lowS:!1},lJ);po({...ph,Fp:pl,lowS:!1},lX),po({...pc,Fp:pf,lowS:!1,allowedPrivateKeyLengths:[130,131,132]},lZ);const pp="base10",pg="base16",pb="base64pad",py="base64url",pm="utf8";function pv(){let e=ly(32);return(0,hu.toString)(e,pg)}function pw(e){let t=lJ((0,hu.fromString)(e,pg));return(0,hu.toString)(t,pg)}function pD(e){let t=lJ((0,hu.fromString)(e,pm));return(0,hu.toString)(t,pg)}function px(e){return(0,hu.fromString)(`${e}`,pp)}function pE(e){return Number((0,hu.toString)(e,pp))}function p_(e){return e.replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function pS(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=(4-t.length%4)%4;return t+"=".repeat(r)}function pI(e){if(2===pE(e.type))return(0,hu.toString)((0,hu.concat)([e.type,e.sealed]),pb);if(1===pE(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,hu.toString)((0,hu.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),pb)}return(0,hu.toString)((0,hu.concat)([e.type,e.iv,e.sealed]),pb)}function pA(e){let t=(e.encoding||pb)===py?pS(e.encoded):e.encoded,r=(0,hu.fromString)(t,pb),i=r.slice(0,1);if(1===pE(i)){let e=r.slice(1,33),t=r.slice(33,45);return{type:i,sealed:r.slice(45),iv:t,senderPublicKey:e}}if(2===pE(i))return{type:i,sealed:r.slice(1),iv:ly(12)};let s=r.slice(1,13);return{type:i,sealed:r.slice(13),iv:s}}function pM(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function pO(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function pC(e){return e?.relay||{protocol:"irn"}}function pP(e){let t=cL[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}var pR=Object.defineProperty,pT=Object.defineProperties,pN=Object.getOwnPropertyDescriptors,pB=Object.getOwnPropertySymbols,pL=Object.prototype.hasOwnProperty,pU=Object.prototype.propertyIsEnumerable,pk=(e,t,r)=>t in e?pR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pq=(e,t)=>{for(var r in t||(t={}))pL.call(t,r)&&pk(e,r,t[r]);if(pB)for(var r of pB(t))pU.call(t,r)&&pk(e,r,t[r]);return e};function pj(e){var t;if(!e.includes("wc:")){let t=uU(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,r),n=e.substring(r+1,i).split("@"),o=Object.fromEntries(new URLSearchParams("u">typeof i?e.substring(i):"").entries()),a="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:o.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let s=t.replace(i,""),n=e[t];r[s]=n}}),r}(o),methods:a,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function pz(e){let t=new URLSearchParams;return Object.entries(pq(pq(pT(pq({},function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay)),pN({symKey:e.symKey})),e.expiryTimestamp&&{expiryTimestamp:e.expiryTimestamp.toString()}),e.methods&&{methods:e.methods.join(",")})).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,r])=>{void 0!==r&&t.append(e,String(r))}),`${e.protocol}:${e.topic}@${e.version}?${t}`}function pF(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}var p$=Object.defineProperty,pK=Object.defineProperties,pV=Object.getOwnPropertyDescriptors,pH=Object.getOwnPropertySymbols,pG=Object.prototype.hasOwnProperty,pW=Object.prototype.propertyIsEnumerable,pY=(e,t,r)=>t in e?p$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pJ=(e,t)=>{for(var r in t||(t={}))pG.call(t,r)&&pY(e,r,t[r]);if(pH)for(var r of pH(t))pW.call(t,r)&&pY(e,r,t[r]);return e},pZ=(e,t)=>pK(e,pV(t));function pX(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function pQ(e){return e.includes(":")}function p0(e){var t,r,i;let s={};if(!p4(e))return s;for(let[n,o]of Object.entries(e)){let e=pQ(n)?[n]:o.chains,a=o.methods||[],h=o.events||[],c=pQ(n)?n.split(":")[0]:n;s[c]=pZ(pJ({},s[c]),{chains:uR(e,null==(t=s[c])?void 0:t.chains),methods:uR(a,null==(r=s[c])?void 0:r.methods),events:uR(h,null==(i=s[c])?void 0:i.events)})}return s}function p1(e,t){let r=function(e){let t={};return e?.forEach(e=>{var r;let[i,s]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(r=t[i].chains)||r.push(`${i}:${s}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,i]of Object.entries(r))i.methods?i.methods=uR(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}const p2={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},p3={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function p8(e,t){let{message:r,code:i}=p3[e];return{message:t?`${r} ${t}`:r,code:i}}function p6(e,t){let{message:r,code:i}=p2[e];return{message:t?`${r} ${t}`:r,code:i}}function p5(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function p4(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function p9(e){return typeof e>"u"}function p7(e,t){return!!(t&&p9(e))||"string"==typeof e&&!!e.trim().length}function ge(e,t){return!!(t&&p9(e))||"number"==typeof e&&!isNaN(e)}function gt(e){return!!(p7(e,!1)&&e.includes(":"))&&2===e.split(":").length}function gr(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(p7(e,!1)){if(t(e))return!0;let r=uU(e);return t(r)}}catch{}return!1}function gi(e){let t=!0;return p5(e)?e.length&&(t=e.every(e=>p7(e,!1))):t=!1,t}function gs(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let s;if(r)return;let n=(i=`${t}, namespace`,s=null,gi(e?.methods)?gi(e?.events)||(s=p6("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):s=p6("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),s);n&&(r=n)}),r}function gn(e,t){let r=null;if(e&&p4(e)){let i,s=gs(e,t);s&&(r=s);let n=(i=null,Object.values(e).forEach(e=>{var r,s;let n;if(i)return;let o=(r=e?.accounts,s=`${t} namespace`,n=null,p5(r)?r.forEach(e=>{n||function(e){if(p7(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&gt(e)}}return!1}(e)||(n=p6("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=p6("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);o&&(i=o)}),i);n&&(r=n)}else r=p8("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function go(e){return p7(e.protocol,!0)}function ga(e){return"u">typeof e}function gh(e,t){return!(!gt(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...pX(e.accounts))}),t})(e).includes(t))}function gc(e,t,r){let i=null,s=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=pX(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(s),a=Object.keys(n),h=gu(Object.keys(e)),c=gu(Object.keys(t)),u=h.filter(e=>!c.includes(e));return u.length&&(i=p8("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),ux(o,a)||(i=p8("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let s=pX(t[e].accounts);s.includes(e)||(i=p8("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),o.forEach(e=>{i||(ux(s[e].methods,n[e].methods)?ux(s[e].events,n[e].events)||(i=p8("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=p8("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function gu(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function gl(e,t){return ge(e,!1)&&e<=t.max&&e>=t.min}function gf(){let e=um();return new Promise(t=>{switch(e){case ug:t(uy()&&navigator?.onLine);break;case up:t(gd());break;default:t(!0)}})}async function gd(){if(ub()&&"u">typeof t&&null!=t&&t.NetInfo){let e=await (null==t?void 0:t.NetInfo.fetch());return e?.isConnected}return!0}const gp={};class gg{static get(e){return gp[e]}static set(e,t){gp[e]=t}static delete(e){delete gp[e]}}function gb(e){return new Uint8Array(e.replace(/^0x/,"").match(/.{1,2}/g).map(e=>parseInt(e,16)))}function gy({logger:e,name:t}){let r="string"==typeof e?tf({opts:{level:e,name:t}}).logger:e;return r.level="string"==typeof e?e:e.level,r}var gm={};e(gm,"parseConnectionError",()=>g_),e(gm,"formatJsonRpcError",()=>gS.formatJsonRpcError),e(gm,"formatJsonRpcRequest",()=>gS.formatJsonRpcRequest),e(gm,"formatJsonRpcResult",()=>gS.formatJsonRpcResult),e(gm,"getBigIntRpcId",()=>gS.getBigIntRpcId),e(gm,"IJsonRpcProvider",()=>gS.IJsonRpcProvider),e(gm,"isJsonRpcError",()=>gS.isJsonRpcError),e(gm,"isJsonRpcRequest",()=>gS.isJsonRpcRequest),e(gm,"isJsonRpcResponse",()=>gS.isJsonRpcResponse),e(gm,"isJsonRpcResult",()=>gS.isJsonRpcResult),e(gm,"isLocalhostUrl",()=>gS.isLocalhostUrl),e(gm,"isReactNative",()=>gS.isReactNative),e(gm,"isWsUrl",()=>gS.isWsUrl),e(gm,"parseConnectionError",()=>gS.parseConnectionError),e(gm,"payloadId",()=>gS.payloadId),e(gm,"formatJsonRpcError",()=>gP),e(gm,"formatJsonRpcRequest",()=>gO),e(gm,"formatJsonRpcResult",()=>gC),e(gm,"getBigIntRpcId",()=>gM),e(gm,"payloadId",()=>gA),e(gm,"IJsonRpcProvider",()=>gN),e(gm,"isLocalhostUrl",()=>gL),e(gm,"isWsUrl",()=>gB),e(gm,"isJsonRpcError",()=>gz),e(gm,"isJsonRpcRequest",()=>gk),e(gm,"isJsonRpcResponse",()=>gq),e(gm,"isJsonRpcResult",()=>gj);const gv="INTERNAL_ERROR",gw="SERVER_ERROR",gD=[-32700,-32600,-32601,-32602,-32603],gx={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[gv]:{code:-32603,message:"Internal error"},[gw]:{code:-32e3,message:"Server error"}};function gE(e){return Object.keys(gx).includes(e)?gx[e]:gx[gw]}function g_(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?Error(`Unavailable ${r} RPC url at ${t}`):e}var gS={};function gI(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function gA(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function gM(e=6){return BigInt(gA(e))}function gO(e,t,r){return{id:r||gA(),jsonrpc:"2.0",method:e,params:t}}function gC(e,t){return{id:e,jsonrpc:"2.0",result:t}}function gP(e,t,r){var i,s,n;return{id:e,jsonrpc:"2.0",error:(i=t,s=r,void 0===i?gE(gv):("string"==typeof i&&(i=Object.assign(Object.assign({},gE(gw)),{message:i})),void 0!==s&&(i.data=s),n=i.code,gD.includes(n)&&(i=function(e){let t=Object.values(gx).find(t=>t.code===e);return t||gx[gw]}(i.code)),i))}}Object.defineProperty(gS,"__esModule",{value:!0}),gI(n("ljFVp"),gS),gI(n("5vmD7"),gS),gS.isNode;class gR{}class gT extends gR{constructor(){super()}}class gN extends gT{constructor(e){super()}}function gB(e){let t=function(e){let t=e.match(RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==t&&RegExp("^wss?:").test(t)}function gL(e){return RegExp("wss?://localhost(:d{2,5})?").test(e)}function gU(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function gk(e){return gU(e)&&"method"in e}function gq(e){return gU(e)&&(gj(e)||gz(e))}function gj(e){return"result"in e}function gz(e){return"error"in e}class gF extends gN{constructor(e){super(e),this.events=new(0,a.EventEmitter),this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(gO(e.method,e.params||[],e.id||gM().toString()),t)}async requestStrict(e,t){return new Promise(async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(e){i(e)}this.events.on(`${e.id}`,e=>{gz(e)?i(e.error):r(e.result)});try{await this.connection.send(e,t)}catch(e){i(e)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),gq(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const g$=e=>e.split("?")[0],gK="u">typeof WebSocket?WebSocket:"u">typeof t&&"u">typeof t.WebSocket?t.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:n("fvaAM");class gV{constructor(e){if(this.url=e,this.events=new(0,a.EventEmitter),this.registering=!1,!gB(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u")return void t(Error("Connection already closed"));this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(e_(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!gB(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{let s=(0,gS.isReactNative)()?void 0:{rejectUnauthorized:!gL(e)},n=new gK(e,[],s);"u">typeof WebSocket||"u">typeof t&&"u">typeof t.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket?n.onerror=e=>{i(this.emitError(e.error))}:n.on("error",e=>{i(this.emitError(e))}),n.onopen=()=>{this.onOpen(n),r(n)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?eE(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=gP(e,r.message||r.toString());this.events.emit("payload",i)}parseError(e,t=this.url){return g_(e,g$(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){let t=this.parseError(Error(e?.message||`WebSocket connection failed for host: ${g$(this.url)}`));return this.events.emit("register_error",t),t}}const gH="core",gG=`wc@2:${gH}:`,gW={database:":memory:"},gY="client_ed25519_seed",gJ=x.ONE_DAY,gZ=x.SIX_HOURS,gX="wss://relay.walletconnect.org",gQ="relayer_message",g0="relayer_message_ack",g1="relayer_connection_stalled",g2="relayer_publish",g3="payload",g8="connect",g6="disconnect",g5="error",g4="2.22.4",g9="link_mode",g7="relay",be="inbound",bt="WALLETCONNECT_LINK_MODE_APPS",br="subscription_created",bi="subscription_deleted",bs=(x.THIRTY_DAYS,x.FIVE_SECONDS,x.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:x.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:x.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:x.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:x.ONE_DAY,prompt:!1,tag:0},res:{ttl:x.ONE_DAY,prompt:!1,tag:0}}}),bn="pairing_create",bo="pairing_delete",ba="history_created",bh="history_updated",bc="history_deleted",bu="expirer_created",bl="expirer_deleted",bf="expirer_expired",bd=(x.ONE_DAY,"https://verify.walletconnect.org"),bp=`${bd}/v3`,bg=["https://verify.walletconnect.com",bd],bb="malformed_pairing_uri",by="session_approve_started";var bm=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,h=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===h;)i++,t++;for(var n=(e.length-t)*c+1>>>0,o=new Uint8Array(n);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var l=0,f=n-1;(0!==u||l<s)&&-1!==f;f--,l++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=l,t++}if(" "!==e[t]){for(var d=n-s;d!==n&&0===o[d];)d++;for(var p=new Uint8Array(i+(n-d)),g=i;d!==n;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*u+1>>>0,c=new Uint8Array(o);s!==n;){for(var l=t[s],f=0,d=o-1;(0!==l||f<i)&&-1!==d;d--,f++)l+=256*c[d]>>>0,c[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw Error("Non-zero carry");i=f,s++}for(var p=o-i;p!==o&&0===c[p];)p++;for(var g=h.repeat(r);p<o;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw Error(`Non-${t} character`)}}};const bv=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class bw{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class bD{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return bE(this,e)}}class bx{constructor(e){this.decoders=e}or(e){return bE(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const bE=(e,t)=>new bx({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class b_{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new bw(e,t,r),this.decoder=new bD(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const bS=({name:e,prefix:t,encode:r,decode:i})=>new b_(e,t,r,i),bI=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=bm(r,t);return bS({prefix:e,name:t,encode:i,decode:e=>bv(s(e))})},bA=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>bS({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n})(e,i,r),decode:t=>((e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,h=0,c=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);h=h<<r|n,(a+=r)>=8&&(a-=8,o[c++]=255&h>>a)}if(a>=r||255&h<<8-a)throw SyntaxError("Unexpected end of data");return o})(t,i,r,e)});var bM=Object.freeze({__proto__:null,identity:bS({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),bO=Object.freeze({__proto__:null,base2:bA({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),bC=Object.freeze({__proto__:null,base8:bA({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),bP=Object.freeze({__proto__:null,base10:bI({prefix:"9",name:"base10",alphabet:"0123456789"})}),bR=Object.freeze({__proto__:null,base16:bA({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:bA({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});const bT=bA({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),bN=bA({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),bB=bA({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),bL=bA({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),bU=bA({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),bk=bA({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bq=bA({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var bj=Object.freeze({__proto__:null,base32:bT,base32upper:bN,base32pad:bB,base32padupper:bL,base32hex:bU,base32hexupper:bk,base32hexpad:bq,base32hexpadupper:bA({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:bA({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),bz=Object.freeze({__proto__:null,base36:bI({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:bI({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),bF=Object.freeze({__proto__:null,base58btc:bI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:bI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});const b$=bA({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),bK=bA({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var bV=Object.freeze({__proto__:null,base64:b$,base64pad:bK,base64url:bA({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:bA({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});const bH=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),bG=bH.reduce((e,t,r)=>(e[r]=t,e),[]),bW=bH.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var bY=Object.freeze({__proto__:null,base256emoji:bS({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=bG[t],"")},decode:function(e){let t=[];for(let r of e){let e=bW[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function bJ(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,bJ.bytes=r-i+1,t}const bZ=(e,t,r=0)=>(bJ(e,t,r),t),bX=e=>{var t;return(t=e)<128?1:t<16384?2:t<2097152?3:t<0x10000000?4:t<0x800000000?5:t<0x40000000000?6:t<0x2000000000000?7:t<0x100000000000000?8:t<0x8000000000000000?9:10},bQ=(e,t)=>{let r=t.byteLength,i=bX(e),s=i+bX(r),n=new Uint8Array(s+r);return bZ(e,n,0),bZ(r,n,i),n.set(t,s),new b0(e,r,t,n)};class b0{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const b1=({name:e,code:t,encode:r})=>new b2(e,t,r);class b2{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?bQ(this.code,t):t.then(e=>bQ(this.code,e))}throw Error("Unknown type, must be binary type")}}const b3=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var b8=Object.freeze({__proto__:null,sha256:b1({name:"sha2-256",code:18,encode:b3("SHA-256")}),sha512:b1({name:"sha2-512",code:19,encode:b3("SHA-512")})}),b6=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:bv,digest:e=>bQ(0,bv(e))}});new TextEncoder,new TextDecoder;const b5={...bM,...bO,...bC,...bP,...bR,...bj,...bz,...bF,...bV,...bY};function b4(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function b9(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...b8,...b6});const b7=b9("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ye=b9("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?b4(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),yt={utf8:b7,"utf-8":b7,hex:b5.base16,latin1:ye,ascii:ye,binary:ye,...b5};var yr=Object.defineProperty,yi=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?yr(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class ys{constructor(e,t){this.core=e,this.logger=t,yi(this,"keychain",new Map),yi(this,"name","keychain"),yi(this,"version","0.3"),yi(this,"initialized",!1),yi(this,"storagePrefix",gG),yi(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),yi(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),yi(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),yi(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=p8("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),yi(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=tl(t,this.name)}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,uE(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?u_(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var yn=Object.defineProperty,yo=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?yn(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class ya{constructor(e,t,r){this.core=e,this.logger=t,yo(this,"name","crypto"),yo(this,"keychain"),yo(this,"randomSessionIdentifier",pv()),yo(this,"initialized",!1),yo(this,"clientId"),yo(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),yo(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),yo(this,"getClientId",async()=>{if(this.isInitialized(),this.clientId)return this.clientId;let e=iG(iY(await this.getClientSeed()).publicKey);return this.clientId=e,e}),yo(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=d3.utils.randomPrivateKey(),t=d3.getPublicKey(e);return{privateKey:(0,hu.toString)(e,pg),publicKey:(0,hu.toString)(t,pg)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),yo(this,"signJWT",async e=>{this.isInitialized();let t=iY(await this.getClientSeed()),r=this.randomSessionIdentifier;return await iJ(r,e,gJ,t)}),yo(this,"generateSharedKey",(e,t,r)=>{this.isInitialized();let i=function(e,t){var r,i;let s=d3.getSharedSecret((0,hu.fromString)(e,pg),(0,hu.fromString)(t,pg)),n=(r=void 0,function(e,t,r,i=32){u5(e),u8(i);let s=e.outputLen;if(i>255*s)throw Error("Length should be <= 255*HashLen");let n=Math.ceil(i/s);void 0===r&&(r=f1);let o=new Uint8Array(n*s),a=fQ.create(e,t),h=a._cloneInto(),c=new Uint8Array(a.outputLen);for(let e=0;e<n;e++)f0[0]=e+1,h.update(0===e?f1:c).update(r).update(f0).digestInto(c),o.set(c,s*e),a._cloneInto(h);return a.destroy(),h.destroy(),le(c,f0),o.slice(0,i)}(lJ,(i=void 0,u5(lJ),void 0===i&&(i=new Uint8Array(lJ.outputLen)),fQ(lJ,ld(i),ld(s))),r,32));return(0,hu.toString)(n,pg)}(this.getPrivateKey(e),t);return this.setSymKey(i,r)}),yo(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||pw(e);return await this.keychain.set(r,e),r}),yo(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),yo(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),yo(this,"encode",async(e,t,r)=>{this.isInitialized();let i=pM(r),s=e_(t);if(2===i.type)return function(e,t){let r=px(2),i=ly(12),s=pI({type:r,sealed:(0,hu.fromString)(e,pm),iv:i});return t===py?p_(s):s}(s,r?.encoding);if(pO(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let n=this.getSymKey(e),{type:o,senderPublicKey:a}=i;return function(e){let t=px("u">typeof e.type?e.type:0);if(1===pE(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let r="u">typeof e.senderPublicKey?(0,hu.fromString)(e.senderPublicKey,pg):void 0,i="u">typeof e.iv?(0,hu.fromString)(e.iv,pg):ly(12),s=pI({type:t,sealed:fZ((0,hu.fromString)(e.symKey,pg),i).encrypt((0,hu.fromString)(e.message,pm)),iv:i,senderPublicKey:r});return e.encoding===py?p_(s):s}({type:o,symKey:n,message:s,senderPublicKey:a,encoding:r?.encoding})}),yo(this,"decode",async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=pA({encoded:e,encoding:t?.encoding});return pM({type:pE(r.type),senderPublicKey:"u">typeof r.senderPublicKey?(0,hu.toString)(r.senderPublicKey,pg):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type)return eE(function(e,t){let{sealed:r}=pA({encoded:e,encoding:t});return(0,hu.toString)(r,pm)}(t,r?.encoding));if(pO(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),s=function(e){let t=(0,hu.fromString)(e.symKey,pg),{sealed:r,iv:i}=pA({encoded:e.encoded,encoding:e.encoding}),s=fZ(t,i).decrypt(r);if(null===s)throw Error("Failed to decrypt");return(0,hu.toString)(s,pm)}({symKey:i,encoded:t,encoding:r?.encoding});return eE(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),yo(this,"getPayloadType",(e,t=pb)=>pE(pA({encoded:e,encoding:t}).type)),yo(this,"getPayloadSenderPublicKey",(e,t=pb)=>{let r=pA({encoded:e,encoding:t});return r.senderPublicKey?(0,hu.toString)(r.senderPublicKey,pg):void 0}),this.core=e,this.logger=tl(t,this.name),this.keychain=r||new ys(this.core,this.logger)}get context(){return tu(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(gY)}catch{e=pv(),await this.keychain.set(gY,e)}return function(e,t="utf8"){let r=yt[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?b4(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var yh=Object.defineProperty,yc=Object.defineProperties,yu=Object.getOwnPropertyDescriptors,yl=Object.getOwnPropertySymbols,yf=Object.prototype.hasOwnProperty,yd=Object.prototype.propertyIsEnumerable,yp=(e,t,r)=>t in e?yh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yg=(e,t,r)=>yp(e,"symbol"!=typeof t?t+"":t,r);class yb extends tm{constructor(e,t){super(e,t),this.logger=e,this.core=t,yg(this,"messages",new Map),yg(this,"messagesWithoutClientAck",new Map),yg(this,"name","messages"),yg(this,"version","0.3"),yg(this,"initialized",!1),yg(this,"storagePrefix",gG),yg(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),yg(this,"set",async(e,t,r)=>{this.isInitialized();let i=pD(t),s=this.messages.get(e);if(typeof s>"u"&&(s={}),"u">typeof s[i])return i;if(s[i]=t,this.messages.set(e,s),r===be){let r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,yc(((e,t)=>{for(var r in t||(t={}))yf.call(t,r)&&yp(e,r,t[r]);if(yl)for(var r of yl(t))yd.call(t,r)&&yp(e,r,t[r]);return e})({},r),yu({[i]:t})))}return await this.persist(),i}),yg(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),yg(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let r of e){let e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),yg(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[pD(t)])),yg(this,"ack",async(e,t)=>{this.isInitialized();let r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;let i=pD(t);delete r[i],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),yg(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=tl(e,this.name),this.core=t}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,uE(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,uE(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?u_(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?u_(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var yy=Object.defineProperty,ym=Object.defineProperties,yv=Object.getOwnPropertyDescriptors,yw=Object.getOwnPropertySymbols,yD=Object.prototype.hasOwnProperty,yx=Object.prototype.propertyIsEnumerable,yE=(e,t,r)=>t in e?yy(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y_=(e,t)=>{for(var r in t||(t={}))yD.call(t,r)&&yE(e,r,t[r]);if(yw)for(var r of yw(t))yx.call(t,r)&&yE(e,r,t[r]);return e},yS=(e,t)=>ym(e,yv(t)),yI=(e,t,r)=>yE(e,"symbol"!=typeof t?t+"":t,r);class yA extends tv{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,yI(this,"events",new(0,a.EventEmitter)),yI(this,"name","publisher"),yI(this,"queue",new Map),yI(this,"publishTimeout",(0,x.toMiliseconds)(x.ONE_MINUTE)),yI(this,"initialPublishTimeout",(0,x.toMiliseconds)(15*x.ONE_SECOND)),yI(this,"needsTransportRestart",!1),yI(this,"publish",async(e,t,r)=>{var i,s,n,o,a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let h=r?.ttl||gZ,c=r?.prompt||!1,u=r?.tag||0,l=r?.id||gM().toString(),f=pP(pC().protocol),d={id:l,method:r?.publishMethod||f.publish,params:y_({topic:e,message:t,ttl:h,prompt:c,tag:u,attestation:r?.attestation},r?.tvf)},p=`Failed to publish payload, please try again. id:${l} tag:${u}`;try{p9(null==(i=d.params)?void 0:i.prompt)&&(null==(s=d.params)||delete s.prompt),p9(null==(n=d.params)?void 0:n.tag)&&(null==(o=d.params)||delete o.tag);let a=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=d.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(g2,t),e())};this.relayer.events.on(g2,t);let i=uI(new Promise((e,t)=>{this.rpcPublish(d,r).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${l} tag:${u}`);try{await i,this.events.removeListener(g2,t)}catch(e){this.queue.set(l,{request:d,opts:r,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:l,topic:e,message:t,opts:r}}),await uI(a,this.publishTimeout,p)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(a=r?.internal)&&a.throwOnFailedPublish)throw e}finally{this.queue.delete(l)}}),yI(this,"publishCustom",async e=>{var t,r,i,s,n;this.logger.debug("Publishing custom payload"),this.logger.trace({type:"method",method:"publishCustom",params:e});let{payload:o,opts:a={}}=e,{attestation:h,tvf:c,publishMethod:u,prompt:l,tag:f,ttl:d=x.FIVE_MINUTES}=a,p=a.id||gM().toString(),g=pP(pC().protocol),b=u||g.publish,y={id:p,method:b,params:y_(yS(y_({},o),{ttl:d,prompt:l,tag:f,attestation:h}),c)},m=`Failed to publish custom payload, please try again. id:${p} tag:${f}`;try{p9(null==(t=y.params)?void 0:t.prompt)&&(null==(r=y.params)||delete r.prompt),p9(null==(i=y.params)?void 0:i.tag)&&(null==(s=y.params)||delete s.tag);let e=new Promise(async e=>{let t=({id:r})=>{var i;(null==(i=y.id)?void 0:i.toString())===r.toString()&&(this.removeRequestFromQueue(r),this.relayer.events.removeListener(g2,t),e())};this.relayer.events.on(g2,t);let r=uI(new Promise((e,t)=>{this.rpcPublish(y,a).then(e).catch(e=>{this.logger.warn(e,e?.message),t(e)})}),this.initialPublishTimeout,`Failed initial custom payload publish, retrying.... method:${b} id:${p} tag:${f}`);try{await r,this.events.removeListener(g2,t)}catch(e){this.queue.set(p,{request:y,opts:a,attempt:1}),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:p,payload:o,opts:a}}),await uI(e,this.publishTimeout,m)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(n=a?.internal)&&n.throwOnFailedPublish)throw e}finally{this.queue.delete(p)}}),yI(this,"on",(e,t)=>{this.events.on(e,t)}),yI(this,"once",(e,t)=>{this.events.once(e,t)}),yI(this,"off",(e,t)=>{this.events.off(e,t)}),yI(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=tl(t,this.name),this.registerEventListeners()}get context(){return tu(this.logger)}async rpcPublish(e,t){this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:e});let r=await this.relayer.request(e);return this.relayer.events.emit(g2,y_(y_({},e),t)),this.logger.debug("Successfully Published Payload"),r}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{var r;let i=e.attempt+1;this.queue.set(t,yS(y_({},e),{attempt:i})),this.logger.warn({},`Publisher: queue->publishing: ${e.request.id}, tag: ${null==(r=e.request.params)?void 0:r.tag}, attempt: ${i}`),await this.rpcPublish(e.request,e.opts),this.logger.warn({},`Publisher: queue->published: ${e.request.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(A,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(g1);return}this.checkQueue()}),this.relayer.on(g0,e=>{this.removeRequestFromQueue(e.id.toString())})}}var yM=Object.defineProperty,yO=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?yM(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class yC{constructor(){yO(this,"map",new Map),yO(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),yO(this,"get",e=>this.map.get(e)||[]),yO(this,"exists",(e,t)=>this.get(e).includes(t)),yO(this,"delete",(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length)return void this.map.delete(e);this.map.set(e,i)}),yO(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var yP=Object.defineProperty,yR=Object.defineProperties,yT=Object.getOwnPropertyDescriptors,yN=Object.getOwnPropertySymbols,yB=Object.prototype.hasOwnProperty,yL=Object.prototype.propertyIsEnumerable,yU=(e,t,r)=>t in e?yP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yk=(e,t)=>{for(var r in t||(t={}))yB.call(t,r)&&yU(e,r,t[r]);if(yN)for(var r of yN(t))yL.call(t,r)&&yU(e,r,t[r]);return e},yq=(e,t)=>yR(e,yT(t)),yj=(e,t,r)=>yU(e,"symbol"!=typeof t?t+"":t,r);class yz extends tx{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,yj(this,"subscriptions",new Map),yj(this,"topicMap",new yC),yj(this,"events",new(0,a.EventEmitter)),yj(this,"name","subscription"),yj(this,"version","0.3"),yj(this,"pending",new Map),yj(this,"cached",[]),yj(this,"initialized",!1),yj(this,"storagePrefix",gG),yj(this,"subscribeTimeout",(0,x.toMiliseconds)(x.ONE_MINUTE)),yj(this,"initialSubscribeTimeout",(0,x.toMiliseconds)(15*x.ONE_SECOND)),yj(this,"clientId"),yj(this,"batchSubscribeTopicsLimit",500),yj(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),yj(this,"subscribe",async(e,t)=>{var r;this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let i=pC(t),s={topic:e,relay:i,transportType:t?.transportType};null!=(r=t?.internal)&&r.skipSubscribe||this.pending.set(e,s);let n=await this.rpcSubscribe(e,i,t);return"string"==typeof n&&(this.onSubscribe(n,s),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),n}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),yj(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),yj(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),yj(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),yj(this,"on",(e,t)=>{this.events.on(e,t)}),yj(this,"once",(e,t)=>{this.events.once(e,t)}),yj(this,"off",(e,t)=>{this.events.off(e,t)}),yj(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),yj(this,"start",async()=>{await this.onConnect()}),yj(this,"stop",async()=>{await this.onDisconnect()}),yj(this,"restart",async()=>{await this.restore(),await this.onRestart()}),yj(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),yj(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(A,async()=>{await this.checkPending()}),this.events.on(br,async e=>{this.logger.info(`Emitting ${br}`),this.logger.debug({type:"event",event:br,data:e}),await this.persist()}),this.events.on(bi,async e=>{this.logger.info(`Emitting ${bi}`),this.logger.debug({type:"event",event:bi,data:e}),await this.persist()})}),this.relayer=e,this.logger=tl(t,this.name),this.clientId=""}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.values.length>0&&(this.cached=this.values),this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=pC(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=p6("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i,s;let n=await this.getSubscriptionId(e);if(null!=(i=r?.internal)&&i.skipSubscribe)return n;r&&r?.transportType!==g7||await this.restartToComplete({topic:e,id:e,relay:t});let o={method:pP(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o});let a=null==(s=r?.internal)?void 0:s.throwOnFailedPublish;try{if(r?.transportType===g9)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(o).catch(e=>this.logger.warn(e))},(0,x.toMiliseconds)(x.ONE_SECOND)),n;let t=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(br,r),t(i.id))};this.events.on(br,r);try{let i=await uI(new Promise((e,t)=>{this.relayer.request(o).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(br,r),t(i)}catch{}}),i=await uI(t,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!i&&a)throw Error(`Subscribing to ${e} failed, please try again`);return i?n:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(g1),a)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:pP(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await uI(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(g1)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:pP(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await uI(new Promise((e,t)=>{this.relayer.request(r).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(g1)}return t}rpcUnsubscribe(e,t,r){let i={method:pP(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,yq(yk({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,yk({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,yk({},t)),this.topicMap.set(t.topic,e),this.events.emit(br,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=p8("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(bi,yq(yk({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit("subscription_resubscribed")}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size&&!e.every(e=>{var t;return e.topic===(null==(t=this.subscriptions.get(e.id))?void 0:t.topic)})){let{message:e}=p8("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>yq(yk({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,x.toMiliseconds)(x.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return pD(e+await this.getClientId())}}var yF=Object.defineProperty,y$=Object.getOwnPropertySymbols,yK=Object.prototype.hasOwnProperty,yV=Object.prototype.propertyIsEnumerable,yH=(e,t,r)=>t in e?yF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yG=(e,t)=>{for(var r in t||(t={}))yK.call(t,r)&&yH(e,r,t[r]);if(y$)for(var r of y$(t))yV.call(t,r)&&yH(e,r,t[r]);return e},yW=(e,t,r)=>yH(e,"symbol"!=typeof t?t+"":t,r);class yY extends tw{constructor(e){var r;super(e),yW(this,"protocol","wc"),yW(this,"version",2),yW(this,"core"),yW(this,"logger"),yW(this,"events",new(0,a.EventEmitter)),yW(this,"provider"),yW(this,"messages"),yW(this,"subscriber"),yW(this,"publisher"),yW(this,"name","relayer"),yW(this,"transportExplicitlyClosed",!1),yW(this,"initialized",!1),yW(this,"connectionAttemptInProgress",!1),yW(this,"relayUrl"),yW(this,"projectId"),yW(this,"packageName"),yW(this,"bundleId"),yW(this,"hasExperiencedNetworkDisruption",!1),yW(this,"pingTimeout"),yW(this,"heartBeatTimeout",(0,x.toMiliseconds)(x.THIRTY_SECONDS+x.FIVE_SECONDS)),yW(this,"reconnectTimeout"),yW(this,"connectPromise"),yW(this,"reconnectInProgress",!1),yW(this,"requestsInFlight",[]),yW(this,"connectTimeout",(0,x.toMiliseconds)(15*x.ONE_SECOND)),yW(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||gM().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),yW(this,"resetPingTimeout",()=>{}),yW(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),yW(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit("relayer_connect")}),yW(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),yW(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit("relayer_error",e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),yW(this,"registerProviderListeners",()=>{this.provider.on(g3,this.onPayloadHandler),this.provider.on(g8,this.onConnectHandler),this.provider.on(g6,this.onDisconnectHandler),this.provider.on(g5,this.onProviderErrorHandler)}),this.core=e.core,this.logger=gy({logger:null!=(r=e.logger)?r:"error",name:this.name}),this.messages=new yb(this.logger,e.core),this.subscriber=new yz(this,this.logger),this.publisher=new yA(this,this.logger),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||gX,ub()&&"u">typeof t&&"u">typeof(null==t?void 0:t.Platform)&&(null==t?void 0:t.Platform.OS)==="android"?this.packageName=uv():ub()&&"u">typeof t&&"u">typeof(null==t?void 0:t.Platform)&&(null==t?void 0:t.Platform.OS)==="ios"&&(this.bundleId=uv()),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.transportOpen().catch(e=>this.logger.warn(e,e?.message))}get context(){return tu(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:g7},"outbound")}async publishCustom(e){this.isInitialized(),await this.publisher.publishCustom(e)}async subscribe(e,t){var r,i,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),o=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",a,h=t=>{t.topic===e&&(this.subscriber.off(br,h),a())};return await Promise.all([new Promise(e=>{a=e,this.subscriber.on(br,h)}),new Promise(async(r,i)=>{o=await this.subscriber.subscribe(e,yG({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&i(e)})||o,r()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await uI(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics)return void this.logger.info("Starting WS connection skipped because the client has no topics to work with.");if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await gf())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=uO(x.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(gQ,e),await this.recordMessageEvent(e,be)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to connect"))};this.provider.once(g6,r),await uI(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(g6,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,r)=>{let i=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(g6,i),await this.subscriber.start().then(e).catch(r).finally(()=>{this.provider.off(g6,i)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,x.toMiliseconds)(+t))),t++}}startPingTimeout(){}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new gF(new gV(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:o,bundleId:a,packageName:h}){let c=r.split("?"),u=uD(e,t,i),l=function(e,t){let r=new URLSearchParams(e);return Object.entries(t).sort(([e],[t])=>e.localeCompare(t)).forEach(([e,t])=>{null!=t&&r.set(e,String(t))}),r.toString()}(c[1]||"",{auth:s,ua:u,projectId:n,useOnCloseEvent:o||void 0,packageName:h||void 0,bundleId:a||void 0});return c[0]+"?"+l}({sdkVersion:g4,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),gk(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:n}=t.data,o={topic:r,message:i,publishedAt:s,transportType:g7,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(yG({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else gq(e)&&this.events.emit(g0,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,be),this.events.emit(gQ,e))}async acknowledgePayload(e){let t=gC(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(g3,this.onPayloadHandler),this.provider.off(g8,this.onConnectHandler),this.provider.off(g6,this.onDisconnectHandler),this.provider.off(g5,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await gf();(function(e){var r,i;switch(um()){case ug:r=e,!ub()&&uy()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)));break;case up:i=e,ub()&&"u">typeof t&&null!=t&&t.NetInfo&&t?.NetInfo.addEventListener(e=>i(e?.isConnected))}})(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))}),this.core.heartbeat.on(A,async()=>{var e;if(!this.transportExplicitlyClosed&&!this.connected&&(!(uy()&&(0,sh.getDocument)())||(null==(e=(0,sh.getDocument)())?void 0:e.visibilityState)==="visible"))try{await this.confirmOnlineStateOrThrow(),await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,x.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectPromise)return void await this.connectPromise;await this.connect()}}}function yJ(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function yZ(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}const yX="[object Arguments]",yQ="[object Object]";function y0(){}function y1(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}var y2=Object.defineProperty,y3=Object.getOwnPropertySymbols,y8=Object.prototype.hasOwnProperty,y6=Object.prototype.propertyIsEnumerable,y5=(e,t,r)=>t in e?y2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,y4=(e,t)=>{for(var r in t||(t={}))y8.call(t,r)&&y5(e,r,t[r]);if(y3)for(var r of y3(t))y6.call(t,r)&&y5(e,r,t[r]);return e},y9=(e,t,r)=>y5(e,"symbol"!=typeof t?t+"":t,r);class y7 extends tD{constructor(e,t,r,i=gG,s){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,y9(this,"map",new Map),y9(this,"version","0.3"),y9(this,"cached",[]),y9(this,"initialized",!1),y9(this,"getKey"),y9(this,"storagePrefix",gG),y9(this,"recentlyDeleted",[]),y9(this,"recentlyDeletedLimit",200),y9(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!p9(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),y9(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),y9(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),y9(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>{var i;return i=t[r],function e(t,r,i,s,n,o,a){let h=a(t,r,i,s,n,o);if(void 0!==h)return h;if(typeof t==typeof r)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===r;case"number":return t===r||Object.is(t,r)}return function t(r,i,s,n){if(Object.is(r,i))return!0;let o=yZ(r),a=yZ(i);if(o===yX&&(o=yQ),a===yX&&(a=yQ),o!==a)return!1;switch(o){case"[object String]":return r.toString()===i.toString();case"[object Number]":{let e=r.valueOf(),t=i.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(r.valueOf(),i.valueOf());case"[object RegExp]":return r.source===i.source&&r.flags===i.flags;case"[object Function]":return r===i}let h=(s=s??new Map).get(r),c=s.get(i);if(null!=h&&null!=c)return h===i;s.set(r,i),s.set(i,r);try{switch(o){case"[object Map]":if(r.size!==i.size)return!1;for(let[t,o]of r.entries())if(!i.has(t)||!e(o,i.get(t),t,r,i,s,n))return!1;return!0;case"[object Set]":{if(r.size!==i.size)return!1;let t=Array.from(r.values()),o=Array.from(i.values());for(let a=0;a<t.length;a++){let h=t[a],c=o.findIndex(t=>e(h,t,void 0,r,i,s,n));if(-1===c)return!1;o.splice(c,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if(F.isBuffer(r)!==F.isBuffer(i)||r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(!e(r[t],i[t],t,r,i,s,n))return!1;return!0;case"[object ArrayBuffer]":return r.byteLength===i.byteLength&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object DataView]":return r.byteLength===i.byteLength&&r.byteOffset===i.byteOffset&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object Error]":return r.name===i.name&&r.message===i.message;case yQ:{if(!(t(r.constructor,i.constructor,s,n)||y1(r)&&y1(i)))return!1;let o=[...Object.keys(r),...yJ(r)],a=[...Object.keys(i),...yJ(i)];if(o.length!==a.length)return!1;for(let t=0;t<o.length;t++){let a=o[t],h=r[a];if(!Object.hasOwn(i,a))return!1;let c=i[a];if(!e(h,c,a,r,i,s,n))return!1}return!0}default:return!1}}finally{s.delete(r),s.delete(i)}}(t,r,o,a)}(i,e[r],void 0,void 0,void 0,void 0,y0)})):this.values)),y9(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=y4(y4({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),y9(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=tl(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=p8("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=p8("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=p8("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var me=Object.defineProperty,mt=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?me(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class mr{constructor(e,t){this.core=e,this.logger=t,mt(this,"name","pairing"),mt(this,"version","0.3"),mt(this,"events",new(r(a))),mt(this,"pairings"),mt(this,"initialized",!1),mt(this,"storagePrefix",gG),mt(this,"ignoredPayloadTypes",[1]),mt(this,"registeredMethods",[]),mt(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),mt(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),mt(this,"create",async e=>{this.isInitialized();let t=pv(),r=await this.core.crypto.setSymKey(t),i=uO(x.FIVE_MINUTES),s={protocol:"irn"},n={topic:r,expiry:i,relay:s,active:!1,methods:e?.methods},o=pz({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return this.events.emit(bn,n),this.core.expirer.set(r,i),await this.pairings.set(r,n),await this.core.relayer.subscribe(r,{transportType:e?.transportType,internal:e?.internal}),{topic:r,uri:o}}),mt(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});this.isValidPair(e,r);let{topic:i,symKey:s,relay:n,expiryTimestamp:o,methods:a}=pj(e.uri);if(r.props.properties.topic=i,r.addTrace("pairing_uri_validation_success"),r.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace("existing_pairing"),t.active)throw r.setError("active_pairing_already_exists"),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace("pairing_not_expired")}let h=o||uO(x.FIVE_MINUTES),c={topic:i,relay:n,expiry:h,active:!1,methods:a};this.core.expirer.set(i,h),await this.pairings.set(i,c),r.addTrace("store_new_pairing"),e.activatePairing&&await this.activate({topic:i}),this.events.emit(bn,c),r.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(s,i),r.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError("no_internet_connection")}try{await this.core.relayer.subscribe(i,{relay:n})}catch(e){throw r.setError("subscribe_pairing_topic_failure"),e}return r.addTrace("subscribe_pairing_topic_success"),c}),mt(this,"activate",async({topic:e})=>{this.isInitialized();let t=uO(x.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),mt(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:s}=uS();this.events.once(uP("pairing_ping",e),({error:e})=>{e?s(e):i()}),await r()}}),mt(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),mt(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),mt(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),mt(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",p6("USER_DISCONNECTED")),await this.deletePairing(t))}),mt(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:s}=e,n=this.core.crypto.keychain.get(t);return pz({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:r,expiryTimestamp:i,methods:s})}),mt(this,"sendRequest",async(e,t,r)=>{let i=gO(t,r),s=await this.core.crypto.encode(e,i),n=bs[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,s,n),i.id}),mt(this,"sendResult",async(e,t,r)=>{let i=gC(e,r),s=await this.core.crypto.encode(t,i),n=bs[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(i)}),mt(this,"sendError",async(e,t,r)=>{let i=gP(e,r),s=await this.core.crypto.encode(t,i),n=(await this.core.history.get(t,e)).request.method,o=bs[n]?bs[n].res:bs.unregistered_method.res;await this.core.relayer.publish(t,s,o),await this.core.history.resolve(i)}),mt(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,p6("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),mt(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>uC(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),mt(this,"onRelayEventRequest",async e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),mt(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),mt(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),mt(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{gj(t)?this.events.emit(uP("pairing_ping",r),{}):gz(t)&&this.events.emit(uP("pairing_ping",r),{error:t.error})},500)}),mt(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(bo,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),mt(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=p6("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),mt(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(p6("WC_METHOD_UNSUPPORTED",e))}),mt(this,"isValidPair",(e,t)=>{var r;if(!ga(e)){let{message:r}=p8("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(bb),Error(r)}if(!gr(e.uri)){let{message:r}=p8("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(bb),Error(r)}let i=pj(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=p8("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(bb),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=p8("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(bb),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,x.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");let{message:e}=p8("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),mt(this,"isValidPing",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),mt(this,"isValidDisconnect",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),mt(this,"isValidPairingTopic",async e=>{if(!p7(e,!1)){let{message:t}=p8("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=p8("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(uC(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=p8("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=tl(t,this.name),this.pairings=new y7(this.core,this.logger,this.name,this.storagePrefix)}get context(){return tu(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(gQ,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==g9&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let e=await this.core.crypto.decode(t,r);gk(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):gq(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(bf,async e=>{let{topic:t}=uM(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}var mi=Object.defineProperty,ms=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?mi(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class mn extends ty{constructor(e,t){super(e,t),this.core=e,this.logger=t,ms(this,"records",new Map),ms(this,"events",new(0,a.EventEmitter)),ms(this,"name","history"),ms(this,"version","0.3"),ms(this,"cached",[]),ms(this,"initialized",!1),ms(this,"storagePrefix",gG),ms(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),ms(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:uO(x.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(ba,i)}),ms(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=gz(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(bh,t))}),ms(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),ms(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic===e&&("u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(bc,r)))}),this.persist()}),ms(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),ms(this,"on",(e,t)=>{this.events.on(e,t)}),ms(this,"once",(e,t)=>{this.events.once(e,t)}),ms(this,"off",(e,t)=>{this.events.off(e,t)}),ms(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=tl(t,this.name)}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:gO(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=p8("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=p8("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ba,e=>{this.logger.info(`Emitting ${ba}`),this.logger.debug({type:"event",event:ba,record:e})}),this.events.on(bh,e=>{this.logger.info(`Emitting ${bh}`),this.logger.debug({type:"event",event:bh,record:e})}),this.events.on(bc,e=>{this.logger.info(`Emitting ${bc}`),this.logger.debug({type:"event",event:bc,record:e})}),this.core.heartbeat.on(A,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,x.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(bc,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var mo=Object.defineProperty,ma=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?mo(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class mh extends tE{constructor(e,t){super(e,t),this.core=e,this.logger=t,ma(this,"expirations",new Map),ma(this,"events",new(0,a.EventEmitter)),ma(this,"name","expirer"),ma(this,"version","0.3"),ma(this,"cached",[]),ma(this,"initialized",!1),ma(this,"storagePrefix",gG),ma(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),ma(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),ma(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(bu,{target:r,expiration:i})}),ma(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),ma(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(bl,{target:t,expiration:r})}}),ma(this,"on",(e,t)=>{this.events.on(e,t)}),ma(this,"once",(e,t)=>{this.events.once(e,t)}),ma(this,"off",(e,t)=>{this.events.off(e,t)}),ma(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=tl(t,this.name)}get context(){return tu(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return uA("topic",e);if("number"==typeof e)return uA("id",e);let{message:t}=p8("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=p8("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=p8("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,x.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(bf,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(A,()=>this.checkExpirations()),this.events.on(bu,e=>{this.logger.info(`Emitting ${bu}`),this.logger.debug({type:"event",event:bu,data:e}),this.persist()}),this.events.on(bf,e=>{this.logger.info(`Emitting ${bf}`),this.logger.debug({type:"event",event:bf,data:e}),this.persist()}),this.events.on(bl,e=>{this.logger.info(`Emitting ${bl}`),this.logger.debug({type:"event",event:bl,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}}var mc=Object.defineProperty,mu=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?mc(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class ml extends t_{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,mu(this,"name","verify-api"),mu(this,"abortController"),mu(this,"isDevEnv"),mu(this,"verifyUrlV3",bp),mu(this,"storagePrefix",gG),mu(this,"version",2),mu(this,"publicKey"),mu(this,"fetchPromise"),mu(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,x.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),mu(this,"register",async e=>{if(!uy()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,sh.getDocument)(),t=this.startAbortTimer(5*x.ONE_SECOND),i=await new Promise((i,n)=>{let o=()=>{window.removeEventListener("message",h),e.body.removeChild(a),n("attestation aborted")};this.abortController.signal.addEventListener("abort",o);let a=e.createElement("iframe");a.src=s,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});let h=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if(iW(n.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",h),i(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",h,{signal:this.abortController.signal})});return this.logger.debug(i,"jwt attestation"),i}catch(e){this.logger.warn(e)}return""}),mu(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if(iW(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,s)}),mu(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*x.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),mu(this,"getVerifyUrl",e=>{let t=e||bd;return bg.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${bd}`),t=bd),t}),mu(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(x.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),mu(this,"persistPublicKey",async e=>{this.logger.debug(e,"persisting public key to local storage"),await this.store.setItem(this.storeKey,e),this.publicKey=e}),mu(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),mu(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),mu(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),mu(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),mu(this,"validateAttestation",(e,t)=>{let r=function(e,t){let[r,i,s]=e.split("."),n=F.from(pS(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let o=n.slice(0,32),a=n.slice(32,64),h=lJ(`${r}.${i}`),c=function(e){let t=F.from(e.x,"base64"),r=F.from(e.y,"base64");return(0,hu.concat)([new Uint8Array([4]),t,r])}(t);if(!pd.verify((0,hu.concat)([o,a]),h,c))throw Error("Invalid signature");return iW(e).payload}(e,t.publicKey),i={hasExpired:(0,x.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=tl(t,this.name),this.abortController=new AbortController,this.isDevEnv=!1,this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return tu(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,x.toMiliseconds)(e))}}var mf=Object.defineProperty,md=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?mf(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class mp extends tS{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,md(this,"context","echo"),md(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:s})})}),this.logger=tl(t,this.context)}}var mg=Object.defineProperty,mb=Object.getOwnPropertySymbols,my=Object.prototype.hasOwnProperty,mm=Object.prototype.propertyIsEnumerable,mv=(e,t,r)=>t in e?mg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mw=(e,t)=>{for(var r in t||(t={}))my.call(t,r)&&mv(e,r,t[r]);if(mb)for(var r of mb(t))mm.call(t,r)&&mv(e,r,t[r]);return e},mD=(e,t,r)=>mv(e,"symbol"!=typeof t?t+"":t,r);class mx extends tI{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,mD(this,"context","event-client"),mD(this,"storagePrefix",gG),mD(this,"storageVersion",.1),mD(this,"events",new Map),mD(this,"shouldPersist",!1),mD(this,"init",async()=>{try{let e={eventId:uL(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:uD(this.core.relayer.protocol,this.core.relayer.version,g4)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),mD(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:s}}=e,n=uL(),o=this.core.projectId||"",a=mw({eventId:n,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:s}},bundleId:o,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,a),this.shouldPersist=!0),a}),mD(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return mw(mw({},i),this.setMethods(i.eventId))}),mD(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),mD(this,"setEventListeners",()=>{this.core.heartbeat.on(A,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,x.fromMiliseconds)(Date.now())-(0,x.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),mD(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),mD(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),mD(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),mD(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),mD(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,mw(mw({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),mD(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),mD(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${g4}${t}`,{method:"POST",body:JSON.stringify(e)})}),mD(this,"getAppDomain",()=>uw().url),this.logger=tl(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var mE=Object.defineProperty,m_=Object.getOwnPropertySymbols,mS=Object.prototype.hasOwnProperty,mI=Object.prototype.propertyIsEnumerable,mA=(e,t,r)=>t in e?mE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,mM=(e,t)=>{for(var r in t||(t={}))mS.call(t,r)&&mA(e,r,t[r]);if(m_)for(var r of m_(t))mI.call(t,r)&&mA(e,r,t[r]);return e},mO=(e,t,r)=>mA(e,"symbol"!=typeof t?t+"":t,r);class mC extends tg{constructor(e){var t,r;super(e),mO(this,"protocol","wc"),mO(this,"version",2),mO(this,"name",gH),mO(this,"relayUrl"),mO(this,"projectId"),mO(this,"customStoragePrefix"),mO(this,"events",new(0,a.EventEmitter)),mO(this,"logger"),mO(this,"heartbeat"),mO(this,"relayer"),mO(this,"crypto"),mO(this,"storage"),mO(this,"history"),mO(this,"expirer"),mO(this,"pairing"),mO(this,"verify"),mO(this,"echoClient"),mO(this,"linkModeSupportedApps"),mO(this,"eventClient"),mO(this,"initialized",!1),mO(this,"logChunkController"),mO(this,"on",(e,t)=>this.events.on(e,t)),mO(this,"once",(e,t)=>this.events.once(e,t)),mO(this,"off",(e,t)=>this.events.off(e,t)),mO(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),mO(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:g9};this.relayer.onLinkMessageEvent(i,{sessionExists:r})});let i=this.getGlobalCore(e?.customStoragePrefix);if(i)try{return this.customStoragePrefix=i.customStoragePrefix,this.logger=i.logger,this.heartbeat=i.heartbeat,this.crypto=i.crypto,this.history=i.history,this.expirer=i.expirer,this.storage=i.storage,this.relayer=i.relayer,this.pairing=i.pairing,this.verify=i.verify,this.echoClient=i.echoClient,this.linkModeSupportedApps=i.linkModeSupportedApps,this.eventClient=i.eventClient,this.initialized=i.initialized,this.logChunkController=i.logChunkController,i}catch(e){console.warn("Failed to copy global core",e)}this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||gX,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let{logger:s,chunkLoggerController:n}=tf({opts:tc(th({},r={level:"string"==typeof e?.logger&&e.logger?e.logger:"error",name:gH}),{level:r?.level||"info"}),maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=n,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=tl(s,this.name),this.heartbeat=new M,this.crypto=new ya(this,this.logger,e?.keychain),this.history=new mn(this,this.logger),this.expirer=new mh(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new eT(mM(mM({},gW),e?.storageOptions)),this.relayer=new yY({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new mr(this,this.logger),this.verify=new ml(this,this.logger,this.storage),this.echoClient=new mp(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new mx(this,this.logger,e?.telemetryEnabled),this.setGlobalCore(this)}static async init(e){let t=new mC(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return tu(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(bt,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(bt)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(e,`Core Initialization Failure at epoch ${Date.now()}`),this.logger.error(e.message),e}}getGlobalCore(e=""){try{if(this.isGlobalCoreDisabled())return;let t=`_walletConnectCore_${e}`,r=`${t}_count`;return globalThis[r]=(globalThis[r]||0)+1,globalThis[r]>1&&console.warn(`WalletConnect Core is already initialized. This is probably a mistake and can lead to unexpected behavior. Init() was called ${globalThis[r]} times.`),globalThis[t]}catch(e){console.warn("Failed to get global WalletConnect core",e);return}}setGlobalCore(e){var t;try{if(this.isGlobalCoreDisabled())return;let r=`_walletConnectCore_${(null==(t=e.opts)?void 0:t.customStoragePrefix)||""}`;globalThis[r]=e}catch(e){console.warn("Failed to set global WalletConnect core",e)}}isGlobalCoreDisabled(){try{return!1}catch{return!0}}}var mP={};mP=mT;const mR=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function mT(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let s=e.browser.write||mR;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(n)),a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1),"function"==typeof s&&(s.error=s.fatal=s.warn=s.info=s.debug=s.trace=s),!1===e.enabled&&(e.level="silent");let h=e.level||"info",c=Object.create(s);c.log||(c.log=mj),Object.defineProperty(c,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(c,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,mN(u,c,"error","log"),mN(u,c,"fatal","error"),mN(u,c,"warn","error"),mN(u,c,"info","log"),mN(u,c,"debug","log"),mN(u,c,"trace","log")}});let u={transmit:i,serialize:o,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?mz:mF};return c.levels=mT.levels,c.level=h,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=mj,c.serializers=n,c._serialize=o,c._stdErrSerialize=a,c.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},o&&t.serializers&&(r.serializers=t.serializers);let s=r.serializers;if(o&&s){var a=Object.assign({},n,s),h=!0===e.browser.serialize?Object.keys(a):o;delete t.serializers,mB([t],h,a,this._stdErrSerialize)}function c(e){this._childLevel=(0|e._childLevel)+1,this.error=mL(e,t,"error"),this.fatal=mL(e,t,"fatal"),this.warn=mL(e,t,"warn"),this.info=mL(e,t,"info"),this.debug=mL(e,t,"debug"),this.trace=mL(e,t,"trace"),a&&(this.serializers=a,this._serialize=h),i&&(this._logEvent=mU([].concat(e._logEvent.bindings,t)))}return c.prototype=this,new c(this)},i&&(c._logEvent=mU()),c}function mN(e,t,r,i){let s=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?mj:s[r]?s[r]:mR[r]||mR[i]||mj,function(e,t,r){if(e.transmit||t[r]!==mj){var i;t[r]=(i=t[r],function(){let s=e.timestamp(),n=Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===mR?mR:this;for(var a=0;a<n.length;a++)n[a]=arguments[a];if(e.serialize&&!e.asObject&&mB(n,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?i.call(o,function(e,t,r,i){e._serialize&&mB(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),n=s[0],o={};i&&(o.time=i),o.level=mT.levels.values[t];let a=(0|e._childLevel)+1;if(a<1&&(a=1),null!==n&&"object"==typeof n){for(;a--&&"object"==typeof s[0];)Object.assign(o,s.shift());n=s.length?eB(s.shift(),s):void 0}else"string"==typeof n&&(n=eB(s.shift(),s));return void 0!==n&&(o.msg=n),o}(this,r,n,s)):i.apply(o,n),e.transmit){let i=e.transmit.level||t.level,o=mT.levels.values[i],a=mT.levels.values[r];if(a<o)return;!function(e,t,r){let i=t.send,s=t.ts,n=t.methodLevel,o=t.methodValue,a=t.val,h=e._logEvent.bindings;mB(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return -1===h.indexOf(e)}),e._logEvent.level.label=n,e._logEvent.level.value=o,i(n,e._logEvent,a),e._logEvent=mU(h)}(this,{ts:s,methodLevel:r,methodValue:a,transmitLevel:i,transmitValue:mT.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},n)}})}}(e,t,r)}function mB(e,t,r,i){for(let s in e)if(i&&e[s]instanceof Error)e[s]=mT.stdSerializers.err(e[s]);else if("object"==typeof e[s]&&!Array.isArray(e[s]))for(let i in e[s])t&&t.indexOf(i)>-1&&i in r&&(e[s][i]=r[i](e[s][i]))}function mL(e,t,r){return function(){let i=Array(1+arguments.length);i[0]=t;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return e[r].apply(this,i)}}function mU(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function mk(){return{}}function mq(e){return e}function mj(){}function mz(){return!1}function mF(){return Date.now()}mT.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},mT.stdSerializers={mapHttpRequest:mk,mapHttpResponse:mk,wrapRequestSerializer:mq,wrapResponseSerializer:mq,wrapErrorSerializer:mq,req:mk,res:mk,err:function(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}},mT.stdTimeFunctions=Object.assign({},{nullTime:mz,epochTime:mF,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const m$="custom_context";var mK=Object.defineProperty,mV=Object.defineProperties,mH=Object.getOwnPropertyDescriptors,mG=Object.getOwnPropertySymbols,mW=Object.prototype.hasOwnProperty,mY=Object.prototype.propertyIsEnumerable,mJ=(e,t,r)=>t in e?mK(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;function mZ(e,t=m$){return typeof e.bindings>"u"?function(e,t=m$){return e[t]||""}(e,t):e.bindings().context||""}const mX=null!=(Mh=mP.default)?Mh:mP;let mQ=!1,m0=!1;const m1={debug:1,default:2,info:2,warning:3,error:4,off:5};let m2=m1.default,m3=null;const m8=function(){try{let e=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test"!=="test".normalize(t))throw Error("bad normalize")}catch(r){e.push(t)}}),e.length)throw Error("missing "+e.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw Error("broken implementation")}catch(e){return e.message}return null}();(A3=Mc||(Mc={})).DEBUG="DEBUG",A3.INFO="INFO",A3.WARNING="WARNING",A3.ERROR="ERROR",A3.OFF="OFF",(A8=Mu||(Mu={})).UNKNOWN_ERROR="UNKNOWN_ERROR",A8.NOT_IMPLEMENTED="NOT_IMPLEMENTED",A8.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",A8.NETWORK_ERROR="NETWORK_ERROR",A8.SERVER_ERROR="SERVER_ERROR",A8.TIMEOUT="TIMEOUT",A8.BUFFER_OVERRUN="BUFFER_OVERRUN",A8.NUMERIC_FAULT="NUMERIC_FAULT",A8.MISSING_NEW="MISSING_NEW",A8.INVALID_ARGUMENT="INVALID_ARGUMENT",A8.MISSING_ARGUMENT="MISSING_ARGUMENT",A8.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",A8.CALL_EXCEPTION="CALL_EXCEPTION",A8.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",A8.NONCE_EXPIRED="NONCE_EXPIRED",A8.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",A8.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",A8.TRANSACTION_REPLACED="TRANSACTION_REPLACED",A8.ACTION_REJECTED="ACTION_REJECTED";const m6="0123456789abcdef";class m5{constructor(e){Object.defineProperty(this,"version",{enumerable:!0,value:e,writable:!1})}_log(e,t){let r=e.toLowerCase();null==m1[r]&&this.throwArgumentError("invalid log level name","logLevel",e),m2>m1[r]||console.log.apply(console,t)}debug(...e){this._log(m5.levels.DEBUG,e)}info(...e){this._log(m5.levels.INFO,e)}warn(...e){this._log(m5.levels.WARNING,e)}makeError(e,t,r){if(m0)return this.makeError("censored error",t,{});t||(t=m5.errors.UNKNOWN_ERROR),r||(r={});let i=[];Object.keys(r).forEach(e=>{let t=r[e];try{if(t instanceof Uint8Array){let r="";for(let e=0;e<t.length;e++)r+=m6[t[e]>>4],r+=m6[15&t[e]];i.push(e+"=Uint8Array(0x"+r+")")}else i.push(e+"="+JSON.stringify(t))}catch(t){i.push(e+"="+JSON.stringify(r[e].toString()))}}),i.push(`code=${t}`),i.push(`version=${this.version}`);let s=e,n="";switch(t){case Mu.NUMERIC_FAULT:{n="NUMERIC_FAULT";let t=e;switch(t){case"overflow":case"underflow":case"division-by-zero":n+="-"+t;break;case"negative-power":case"negative-width":n+="-unsupported";break;case"unbound-bitwise-result":n+="-unbound-result"}break}case Mu.CALL_EXCEPTION:case Mu.INSUFFICIENT_FUNDS:case Mu.MISSING_NEW:case Mu.NONCE_EXPIRED:case Mu.REPLACEMENT_UNDERPRICED:case Mu.TRANSACTION_REPLACED:case Mu.UNPREDICTABLE_GAS_LIMIT:n=t}n&&(e+=" [ See: https://links.ethers.org/v5-errors-"+n+" ]"),i.length&&(e+=" ("+i.join(", ")+")");let o=Error(e);return o.reason=s,o.code=t,Object.keys(r).forEach(function(e){o[e]=r[e]}),o}throwError(e,t,r){throw this.makeError(e,t,r)}throwArgumentError(e,t,r){return this.throwError(e,m5.errors.INVALID_ARGUMENT,{argument:t,value:r})}assert(e,t,r,i){e||this.throwError(t,r,i)}assertArgument(e,t,r,i){e||this.throwArgumentError(t,r,i)}checkNormalize(e){null==e&&(e="platform missing String.prototype.normalize"),m8&&this.throwError("platform missing String.prototype.normalize",m5.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:m8})}checkSafeUint53(e,t){"number"==typeof e&&(null==t&&(t="value not safe"),(e<0||e>=0x1fffffffffffff)&&this.throwError(t,m5.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:e}),e%1&&this.throwError(t,m5.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:e}))}checkArgumentCount(e,t,r){r=r?": "+r:"",e<t&&this.throwError("missing argument"+r,m5.errors.MISSING_ARGUMENT,{count:e,expectedCount:t}),e>t&&this.throwError("too many arguments"+r,m5.errors.UNEXPECTED_ARGUMENT,{count:e,expectedCount:t})}checkNew(e,t){(e===Object||null==e)&&this.throwError("missing new",m5.errors.MISSING_NEW,{name:t.name})}checkAbstract(e,t){e===t?this.throwError("cannot instantiate abstract class "+JSON.stringify(t.name)+" directly; use a sub-class",m5.errors.UNSUPPORTED_OPERATION,{name:e.name,operation:"new"}):(e===Object||null==e)&&this.throwError("missing new",m5.errors.MISSING_NEW,{name:t.name})}static globalLogger(){return m3||(m3=new m5("logger/5.8.0")),m3}static setCensorship(e,t){if(!e&&t&&this.globalLogger().throwError("cannot permanently disable censorship",m5.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),mQ){if(!e)return;this.globalLogger().throwError("error censorship permanent",m5.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}m0=!!e,mQ=!!t}static setLogLevel(e){let t=m1[e.toLowerCase()];if(null==t)return void m5.globalLogger().warn("invalid log level - "+e);m2=t}static from(e){return new m5(e)}}m5.errors=Mu,m5.levels=Mc;const m4=new m5("bytes/5.8.0");function m9(e){return!!e.toHexString}function m7(e){return e.slice||(e.slice=function(){let t=Array.prototype.slice.call(arguments);return m7(new Uint8Array(Array.prototype.slice.apply(e,t)))}),e}function ve(e){return"number"==typeof e&&e==e&&e%1==0}function vt(e){if(null==e)return!1;if(e.constructor===Uint8Array)return!0;if("string"==typeof e||!ve(e.length)||e.length<0)return!1;for(let t=0;t<e.length;t++){let r=e[t];if(!ve(r)||r<0||r>=256)return!1}return!0}function vr(e,t){if(t||(t={}),"number"==typeof e){m4.checkSafeUint53(e,"invalid arrayify value");let t=[];for(;e;)t.unshift(255&e),e=parseInt(String(e/256));return 0===t.length&&t.push(0),m7(new Uint8Array(t))}if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),m9(e)&&(e=e.toHexString()),vs(e)){let r=e.substring(2);r.length%2&&("left"===t.hexPad?r="0"+r:"right"===t.hexPad?r+="0":m4.throwArgumentError("hex data is odd-length","value",e));let i=[];for(let e=0;e<r.length;e+=2)i.push(parseInt(r.substring(e,e+2),16));return m7(new Uint8Array(i))}return vt(e)?m7(new Uint8Array(e)):m4.throwArgumentError("invalid arrayify value","value",e)}function vi(e){let t=e.map(e=>vr(e)),r=new Uint8Array(t.reduce((e,t)=>e+t.length,0));return t.reduce((e,t)=>(r.set(t,e),e+t.length),0),m7(r)}function vs(e,t){return"string"==typeof e&&!!e.match(/^0x[0-9A-Fa-f]*$/)&&(!t||e.length===2+2*t)}const vn="0123456789abcdef";function vo(e,t){if(t||(t={}),"number"==typeof e){m4.checkSafeUint53(e,"invalid hexlify value");let t="";for(;e;)t=vn[15&e]+t,e=Math.floor(e/16);return t.length?(t.length%2&&(t="0"+t),"0x"+t):"0x00"}if("bigint"==typeof e)return(e=e.toString(16)).length%2?"0x0"+e:"0x"+e;if(t.allowMissingPrefix&&"string"==typeof e&&"0x"!==e.substring(0,2)&&(e="0x"+e),m9(e))return e.toHexString();if(vs(e))return e.length%2&&("left"===t.hexPad?e="0x0"+e.substring(2):"right"===t.hexPad?e+="0":m4.throwArgumentError("hex data is odd-length","value",e)),e.toLowerCase();if(vt(e)){let t="0x";for(let r=0;r<e.length;r++){let i=e[r];t+=vn[(240&i)>>4]+vn[15&i]}return t}return m4.throwArgumentError("invalid hexlify value","value",e)}function va(e,t,r){return("string"!=typeof e?e=vo(e):(!vs(e)||e.length%2)&&m4.throwArgumentError("invalid hexData","value",e),t=2+2*t,null!=r)?"0x"+e.substring(t,2+2*r):"0x"+e.substring(t)}function vh(e,t){for("string"!=typeof e?e=vo(e):vs(e)||m4.throwArgumentError("invalid hex string","value",e),e.length>2*t+2&&m4.throwArgumentError("value out of range","value",arguments[1]);e.length<2*t+2;)e="0x0"+e.substring(2);return e}function vc(e){let t={r:"0x",s:"0x",_vs:"0x",recoveryParam:0,v:0,yParityAndS:"0x",compact:"0x"};if(vs(e)&&!(e.length%2)||vt(e)){let r=vr(e);64===r.length?(t.v=27+(r[32]>>7),r[32]&=127,t.r=vo(r.slice(0,32)),t.s=vo(r.slice(32,64))):65===r.length?(t.r=vo(r.slice(0,32)),t.s=vo(r.slice(32,64)),t.v=r[64]):m4.throwArgumentError("invalid signature string","signature",e),t.v<27&&(0===t.v||1===t.v?t.v+=27:m4.throwArgumentError("signature invalid v byte","signature",e)),t.recoveryParam=1-t.v%2,t.recoveryParam&&(r[32]|=128),t._vs=vo(r.slice(32,64))}else{if(t.r=e.r,t.s=e.s,t.v=e.v,t.recoveryParam=e.recoveryParam,t._vs=e._vs,null!=t._vs){let r=function(e,t){(e=vr(e)).length>t&&m4.throwArgumentError("value out of range","value",arguments[0]);let r=new Uint8Array(t);return r.set(e,t-e.length),m7(r)}(vr(t._vs),32);t._vs=vo(r);let i=+(r[0]>=128);null==t.recoveryParam?t.recoveryParam=i:t.recoveryParam!==i&&m4.throwArgumentError("signature recoveryParam mismatch _vs","signature",e),r[0]&=127;let s=vo(r);null==t.s?t.s=s:t.s!==s&&m4.throwArgumentError("signature v mismatch _vs","signature",e)}if(null==t.recoveryParam)null==t.v?m4.throwArgumentError("signature missing v and recoveryParam","signature",e):0===t.v||1===t.v?t.recoveryParam=t.v:t.recoveryParam=1-t.v%2;else if(null==t.v)t.v=27+t.recoveryParam;else{let r=0===t.v||1===t.v?t.v:1-t.v%2;t.recoveryParam!==r&&m4.throwArgumentError("signature recoveryParam mismatch v","signature",e)}null!=t.r&&vs(t.r)?t.r=vh(t.r,32):m4.throwArgumentError("signature missing or invalid r","signature",e),null!=t.s&&vs(t.s)?t.s=vh(t.s,32):m4.throwArgumentError("signature missing or invalid s","signature",e);let r=vr(t.s);r[0]>=128&&m4.throwArgumentError("signature s out of range","signature",e),t.recoveryParam&&(r[0]|=128);let i=vo(r);t._vs&&(vs(t._vs)||m4.throwArgumentError("signature invalid _vs","signature",e),t._vs=vh(t._vs,32)),null==t._vs?t._vs=i:t._vs!==i&&m4.throwArgumentError("signature _vs mismatch v and s","signature",e)}return t.yParityAndS=t._vs,t.compact=t.r+t.yParityAndS.substring(2),t}var vu={};function vl(e){return"0x"+r(vu).keccak_256(vr(e))}!function(){var e="input is invalid type",t="object"==typeof window,r=t?window:{};r.JS_SHA3_NO_WINDOW&&(t=!1);var i=!t&&"object"==typeof self;r.JS_SHA3_NO_NODE_JS,i&&(r=self);var s=!r.JS_SHA3_NO_COMMON_JS&&vu,n="function"==typeof define&&define.amd,o=!r.JS_SHA3_NO_ARRAY_BUFFER&&"undefined"!=typeof ArrayBuffer,a="0123456789abcdef".split(""),h=[4,1024,262144,0x4000000],c=[0,8,16,24],u=[1,0,32898,0,32906,0x80000000,0x80008000,0x80000000,32907,0,0x80000001,0,0x80008081,0x80000000,32777,0x80000000,138,0,136,0,0x80008009,0,0x8000000a,0,0x8000808b,0,139,0x80000000,32905,0x80000000,32771,0x80000000,32770,0x80000000,128,0x80000000,32778,0,0x8000000a,0x80000000,0x80008081,0x80000000,32896,0x80000000,0x80000001,0,0x80008008,0x80000000],l=[224,256,384,512],f=[128,256],d=["hex","buffer","arrayBuffer","array","digest"],p={128:168,256:136};(r.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}),o&&(r.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(e){return"object"==typeof e&&e.buffer&&e.buffer.constructor===ArrayBuffer});for(var g=function(e,t,r){return function(i){return new C(e,t,e).update(i)[r]()}},b=function(e,t,r){return function(i,s){return new C(e,t,s).update(i)[r]()}},y=function(e,t,r){return function(t,i,s,n){return x["cshake"+e].update(t,i,s,n)[r]()}},m=function(e,t,r){return function(t,i,s,n){return x["kmac"+e].update(t,i,s,n)[r]()}},v=function(e,t,r,i){for(var s=0;s<d.length;++s){var n=d[s];e[n]=t(r,i,n)}return e},w=function(e,t){var r=g(e,t,"hex");return r.create=function(){return new C(e,t,e)},r.update=function(e){return r.create().update(e)},v(r,g,e,t)},D=[{name:"keccak",padding:[1,256,65536,0x1000000],bits:l,createMethod:w},{name:"sha3",padding:[6,1536,393216,0x6000000],bits:l,createMethod:w},{name:"shake",padding:[31,7936,2031616,0x1f000000],bits:f,createMethod:function(e,t){var r=b(e,t,"hex");return r.create=function(r){return new C(e,t,r)},r.update=function(e,t){return r.create(t).update(e)},v(r,b,e,t)}},{name:"cshake",padding:h,bits:f,createMethod:function(e,t){var r=p[e],i=y(e,t,"hex");return i.create=function(i,s,n){return s||n?new C(e,t,i).bytepad([s,n],r):x["shake"+e].create(i)},i.update=function(e,t,r,s){return i.create(t,r,s).update(e)},v(i,y,e,t)}},{name:"kmac",padding:h,bits:f,createMethod:function(e,t){var r=p[e],i=m(e,t,"hex");return i.create=function(i,s,n){return new P(e,t,s).bytepad(["KMAC",n],r).bytepad([i],r)},i.update=function(e,t,r,s){return i.create(e,r,s).update(t)},v(i,m,e,t)}}],x={},E=[],_=0;_<D.length;++_)for(var S=D[_],I=S.bits,A=0;A<I.length;++A){var M=S.name+"_"+I[A];if(E.push(M),x[M]=S.createMethod(I[A],S.padding),"sha3"!==S.name){var O=S.name+I[A];E.push(O),x[O]=x[M]}}function C(e,t,r){this.blocks=[],this.s=[],this.padding=t,this.outputBits=r,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(e<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=r>>5,this.extraBytes=(31&r)>>3;for(var i=0;i<50;++i)this.s[i]=0}function P(e,t,r){C.call(this,e,t,r)}C.prototype.update=function(t){if(this.finalized)throw Error("finalize already called");var r,i=typeof t;if("string"!==i){if("object"===i){if(null===t)throw Error(e);else if(o&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!o||!ArrayBuffer.isView(t)))throw Error(e)}else throw Error(e);r=!0}for(var s,n,a=this.blocks,h=this.byteCount,u=t.length,l=this.blockCount,f=0,d=this.s;f<u;){if(this.reset)for(s=1,this.reset=!1,a[0]=this.block;s<l+1;++s)a[s]=0;if(r)for(s=this.start;f<u&&s<h;++f)a[s>>2]|=t[f]<<c[3&s++];else for(s=this.start;f<u&&s<h;++f)(n=t.charCodeAt(f))<128?a[s>>2]|=n<<c[3&s++]:(n<2048?a[s>>2]|=(192|n>>6)<<c[3&s++]:(n<55296||n>=57344?a[s>>2]|=(224|n>>12)<<c[3&s++]:(n=65536+((1023&n)<<10|1023&t.charCodeAt(++f)),a[s>>2]|=(240|n>>18)<<c[3&s++],a[s>>2]|=(128|n>>12&63)<<c[3&s++]),a[s>>2]|=(128|n>>6&63)<<c[3&s++]),a[s>>2]|=(128|63&n)<<c[3&s++]);if(this.lastByteIndex=s,s>=h){for(this.start=s-h,this.block=a[l],s=0;s<l;++s)d[s]^=a[s];R(d),this.reset=!0}else this.start=s}return this},C.prototype.encode=function(e,t){var r=255&e,i=1,s=[r];for(e>>=8,r=255&e;r>0;)s.unshift(r),e>>=8,r=255&e,++i;return t?s.push(i):s.unshift(i),this.update(s),s.length},C.prototype.encodeString=function(t){var r,i=typeof t;if("string"!==i){if("object"===i){if(null===t)throw Error(e);else if(o&&t.constructor===ArrayBuffer)t=new Uint8Array(t);else if(!Array.isArray(t)&&(!o||!ArrayBuffer.isView(t)))throw Error(e)}else throw Error(e);r=!0}var s=0,n=t.length;if(r)s=n;else for(var a=0;a<t.length;++a){var h=t.charCodeAt(a);h<128?s+=1:h<2048?s+=2:h<55296||h>=57344?s+=3:(h=65536+((1023&h)<<10|1023&t.charCodeAt(++a)),s+=4)}return s+=this.encode(8*s),this.update(t),s},C.prototype.bytepad=function(e,t){for(var r=this.encode(t),i=0;i<e.length;++i)r+=this.encodeString(e[i]);var s=[];return s.length=t-r%t,this.update(s),this},C.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var e=this.blocks,t=this.lastByteIndex,r=this.blockCount,i=this.s;if(e[t>>2]|=this.padding[3&t],this.lastByteIndex===this.byteCount)for(t=1,e[0]=e[r];t<r+1;++t)e[t]=0;for(e[r-1]|=0x80000000,t=0;t<r;++t)i[t]^=e[t];R(i)}},C.prototype.toString=C.prototype.hex=function(){this.finalize();for(var e,t=this.blockCount,r=this.s,i=this.outputBlocks,s=this.extraBytes,n=0,o=0,h="";o<i;){for(n=0;n<t&&o<i;++n,++o)h+=a[(e=r[n])>>4&15]+a[15&e]+a[e>>12&15]+a[e>>8&15]+a[e>>20&15]+a[e>>16&15]+a[e>>28&15]+a[e>>24&15];o%t==0&&(R(r),n=0)}return s&&(h+=a[(e=r[n])>>4&15]+a[15&e],s>1&&(h+=a[e>>12&15]+a[e>>8&15]),s>2&&(h+=a[e>>20&15]+a[e>>16&15])),h},C.prototype.arrayBuffer=function(){this.finalize();for(var e,t=this.blockCount,r=this.s,i=this.outputBlocks,s=this.extraBytes,n=0,o=0,a=this.outputBits>>3,h=new Uint32Array(e=new ArrayBuffer(s?i+1<<2:a));o<i;){for(n=0;n<t&&o<i;++n,++o)h[o]=r[n];o%t==0&&R(r)}return s&&(h[n]=r[n],e=e.slice(0,a)),e},C.prototype.buffer=C.prototype.arrayBuffer,C.prototype.digest=C.prototype.array=function(){this.finalize();for(var e,t,r=this.blockCount,i=this.s,s=this.outputBlocks,n=this.extraBytes,o=0,a=0,h=[];a<s;){for(o=0;o<r&&a<s;++o,++a)e=a<<2,t=i[o],h[e]=255&t,h[e+1]=t>>8&255,h[e+2]=t>>16&255,h[e+3]=t>>24&255;a%r==0&&R(i)}return n&&(e=a<<2,t=i[o],h[e]=255&t,n>1&&(h[e+1]=t>>8&255),n>2&&(h[e+2]=t>>16&255)),h},P.prototype=new C,P.prototype.finalize=function(){return this.encode(this.outputBits,!0),C.prototype.finalize.call(this)};var R=function(e){var t,r,i,s,n,o,a,h,c,l,f,d,p,g,b,y,m,v,w,D,x,E,_,S,I,A,M,O,C,P,R,T,N,B,L,U,k,q,j,z,F,$,K,V,H,G,W,Y,J,Z,X,Q,ee,et,er,ei,es,en,eo,ea,eh,ec,eu;for(i=0;i<48;i+=2)s=e[0]^e[10]^e[20]^e[30]^e[40],n=e[1]^e[11]^e[21]^e[31]^e[41],o=e[2]^e[12]^e[22]^e[32]^e[42],a=e[3]^e[13]^e[23]^e[33]^e[43],h=e[4]^e[14]^e[24]^e[34]^e[44],c=e[5]^e[15]^e[25]^e[35]^e[45],l=e[6]^e[16]^e[26]^e[36]^e[46],f=e[7]^e[17]^e[27]^e[37]^e[47],d=e[8]^e[18]^e[28]^e[38]^e[48],p=e[9]^e[19]^e[29]^e[39]^e[49],t=d^(o<<1|a>>>31),r=p^(a<<1|o>>>31),e[0]^=t,e[1]^=r,e[10]^=t,e[11]^=r,e[20]^=t,e[21]^=r,e[30]^=t,e[31]^=r,e[40]^=t,e[41]^=r,t=s^(h<<1|c>>>31),r=n^(c<<1|h>>>31),e[2]^=t,e[3]^=r,e[12]^=t,e[13]^=r,e[22]^=t,e[23]^=r,e[32]^=t,e[33]^=r,e[42]^=t,e[43]^=r,t=o^(l<<1|f>>>31),r=a^(f<<1|l>>>31),e[4]^=t,e[5]^=r,e[14]^=t,e[15]^=r,e[24]^=t,e[25]^=r,e[34]^=t,e[35]^=r,e[44]^=t,e[45]^=r,t=h^(d<<1|p>>>31),r=c^(p<<1|d>>>31),e[6]^=t,e[7]^=r,e[16]^=t,e[17]^=r,e[26]^=t,e[27]^=r,e[36]^=t,e[37]^=r,e[46]^=t,e[47]^=r,t=l^(s<<1|n>>>31),r=f^(n<<1|s>>>31),e[8]^=t,e[9]^=r,e[18]^=t,e[19]^=r,e[28]^=t,e[29]^=r,e[38]^=t,e[39]^=r,e[48]^=t,e[49]^=r,g=e[0],b=e[1],G=e[11]<<4|e[10]>>>28,W=e[10]<<4|e[11]>>>28,O=e[20]<<3|e[21]>>>29,C=e[21]<<3|e[20]>>>29,ea=e[31]<<9|e[30]>>>23,eh=e[30]<<9|e[31]>>>23,$=e[40]<<18|e[41]>>>14,K=e[41]<<18|e[40]>>>14,B=e[2]<<1|e[3]>>>31,L=e[3]<<1|e[2]>>>31,y=e[13]<<12|e[12]>>>20,m=e[12]<<12|e[13]>>>20,Y=e[22]<<10|e[23]>>>22,J=e[23]<<10|e[22]>>>22,P=e[33]<<13|e[32]>>>19,R=e[32]<<13|e[33]>>>19,ec=e[42]<<2|e[43]>>>30,eu=e[43]<<2|e[42]>>>30,et=e[5]<<30|e[4]>>>2,er=e[4]<<30|e[5]>>>2,U=e[14]<<6|e[15]>>>26,k=e[15]<<6|e[14]>>>26,v=e[25]<<11|e[24]>>>21,w=e[24]<<11|e[25]>>>21,Z=e[34]<<15|e[35]>>>17,X=e[35]<<15|e[34]>>>17,T=e[45]<<29|e[44]>>>3,N=e[44]<<29|e[45]>>>3,S=e[6]<<28|e[7]>>>4,I=e[7]<<28|e[6]>>>4,ei=e[17]<<23|e[16]>>>9,es=e[16]<<23|e[17]>>>9,q=e[26]<<25|e[27]>>>7,j=e[27]<<25|e[26]>>>7,D=e[36]<<21|e[37]>>>11,x=e[37]<<21|e[36]>>>11,Q=e[47]<<24|e[46]>>>8,ee=e[46]<<24|e[47]>>>8,V=e[8]<<27|e[9]>>>5,H=e[9]<<27|e[8]>>>5,A=e[18]<<20|e[19]>>>12,M=e[19]<<20|e[18]>>>12,en=e[29]<<7|e[28]>>>25,eo=e[28]<<7|e[29]>>>25,z=e[38]<<8|e[39]>>>24,F=e[39]<<8|e[38]>>>24,E=e[48]<<14|e[49]>>>18,_=e[49]<<14|e[48]>>>18,e[0]=g^~y&v,e[1]=b^~m&w,e[10]=S^~A&O,e[11]=I^~M&C,e[20]=B^~U&q,e[21]=L^~k&j,e[30]=V^~G&Y,e[31]=H^~W&J,e[40]=et^~ei&en,e[41]=er^~es&eo,e[2]=y^~v&D,e[3]=m^~w&x,e[12]=A^~O&P,e[13]=M^~C&R,e[22]=U^~q&z,e[23]=k^~j&F,e[32]=G^~Y&Z,e[33]=W^~J&X,e[42]=ei^~en&ea,e[43]=es^~eo&eh,e[4]=v^~D&E,e[5]=w^~x&_,e[14]=O^~P&T,e[15]=C^~R&N,e[24]=q^~z&$,e[25]=j^~F&K,e[34]=Y^~Z&Q,e[35]=J^~X&ee,e[44]=en^~ea&ec,e[45]=eo^~eh&eu,e[6]=D^~E&g,e[7]=x^~_&b,e[16]=P^~T&S,e[17]=R^~N&I,e[26]=z^~$&B,e[27]=F^~K&L,e[36]=Z^~Q&V,e[37]=X^~ee&H,e[46]=ea^~ec&et,e[47]=eh^~eu&er,e[8]=E^~g&y,e[9]=_^~b&m,e[18]=T^~S&A,e[19]=N^~I&M,e[28]=$^~B&U,e[29]=K^~L&k,e[38]=Q^~V&G,e[39]=ee^~H&W,e[48]=ec^~et&ei,e[49]=eu^~er&es,e[0]^=u[i],e[1]^=u[i+1]};if(s)vu=x;else{for(_=0;_<E.length;++_)r[E[_]]=x[E[_]];n&&define(function(){return x})}}();const vf=new m5("strings/5.8.0");function vd(e,t,r,i,s){if(e===Mf.BAD_PREFIX||e===Mf.UNEXPECTED_CONTINUE){let e=0;for(let i=t+1;i<r.length&&r[i]>>6==2;i++)e++;return e}return e===Mf.OVERRUN?r.length-t-1:0}function vp(e,t=Ml.current){t!=Ml.current&&(vf.checkNormalize(),e=e.normalize(t));let r=[];for(let t=0;t<e.length;t++){let i=e.charCodeAt(t);if(i<128)r.push(i);else if(i<2048)r.push(i>>6|192),r.push(63&i|128);else if((64512&i)==55296){t++;let s=e.charCodeAt(t);if(t>=e.length||(64512&s)!=56320)throw Error("invalid utf-8 string");let n=65536+((1023&i)<<10)+(1023&s);r.push(n>>18|240),r.push(n>>12&63|128),r.push(n>>6&63|128),r.push(63&n|128)}else r.push(i>>12|224),r.push(i>>6&63|128),r.push(63&i|128)}return vr(r)}function vg(e){return"string"==typeof e&&(e=vp(e)),vl(vi([vp("\x19Ethereum Signed Message:\n"),vp(String(e.length)),e]))}(A6=Ml||(Ml={})).current="",A6.NFC="NFC",A6.NFD="NFD",A6.NFKC="NFKC",A6.NFKD="NFKD",(A5=Mf||(Mf={})).UNEXPECTED_CONTINUE="unexpected continuation byte",A5.BAD_PREFIX="bad codepoint prefix",A5.OVERRUN="string overrun",A5.MISSING_CONTINUE="missing continuation byte",A5.OUT_OF_RANGE="out of UTF-8 range",A5.UTF16_SURROGATE="UTF-16 surrogate",A5.OVERLONG="overlong representation",Object.freeze({error:function(e,t,r,i,s){return vf.throwArgumentError(`invalid codepoint at offset ${t}; ${e}`,"bytes",r)},ignore:vd,replace:function(e,t,r,i,s){return e===Mf.OVERLONG?(i.push(s),0):(i.push(65533),vd(e,t,r,i,s))}});var vb=n("dEXSZ"),vy=r(vb).BN;const vm=new m5("bignumber/5.8.0"),vv={};let vw=!1;class vD{constructor(e,t){e!==vv&&vm.throwError("cannot call constructor directly; use BigNumber.from",m5.errors.UNSUPPORTED_OPERATION,{operation:"new (BigNumber)"}),this._hex=t,this._isBigNumber=!0,Object.freeze(this)}fromTwos(e){return vE(v_(this).fromTwos(e))}toTwos(e){return vE(v_(this).toTwos(e))}abs(){return"-"===this._hex[0]?vD.from(this._hex.substring(1)):this}add(e){return vE(v_(this).add(v_(e)))}sub(e){return vE(v_(this).sub(v_(e)))}div(e){return vD.from(e).isZero()&&vS("division-by-zero","div"),vE(v_(this).div(v_(e)))}mul(e){return vE(v_(this).mul(v_(e)))}mod(e){let t=v_(e);return t.isNeg()&&vS("division-by-zero","mod"),vE(v_(this).umod(t))}pow(e){let t=v_(e);return t.isNeg()&&vS("negative-power","pow"),vE(v_(this).pow(t))}and(e){let t=v_(e);return(this.isNegative()||t.isNeg())&&vS("unbound-bitwise-result","and"),vE(v_(this).and(t))}or(e){let t=v_(e);return(this.isNegative()||t.isNeg())&&vS("unbound-bitwise-result","or"),vE(v_(this).or(t))}xor(e){let t=v_(e);return(this.isNegative()||t.isNeg())&&vS("unbound-bitwise-result","xor"),vE(v_(this).xor(t))}mask(e){return(this.isNegative()||e<0)&&vS("negative-width","mask"),vE(v_(this).maskn(e))}shl(e){return(this.isNegative()||e<0)&&vS("negative-width","shl"),vE(v_(this).shln(e))}shr(e){return(this.isNegative()||e<0)&&vS("negative-width","shr"),vE(v_(this).shrn(e))}eq(e){return v_(this).eq(v_(e))}lt(e){return v_(this).lt(v_(e))}lte(e){return v_(this).lte(v_(e))}gt(e){return v_(this).gt(v_(e))}gte(e){return v_(this).gte(v_(e))}isNegative(){return"-"===this._hex[0]}isZero(){return v_(this).isZero()}toNumber(){try{return v_(this).toNumber()}catch(e){vS("overflow","toNumber",this.toString())}return null}toBigInt(){try{return BigInt(this.toString())}catch(e){}return vm.throwError("this platform does not support BigInt",m5.errors.UNSUPPORTED_OPERATION,{value:this.toString()})}toString(){return arguments.length>0&&(10===arguments[0]?vw||(vw=!0,vm.warn("BigNumber.toString does not accept any parameters; base-10 is assumed")):16===arguments[0]?vm.throwError("BigNumber.toString does not accept any parameters; use bigNumber.toHexString()",m5.errors.UNEXPECTED_ARGUMENT,{}):vm.throwError("BigNumber.toString does not accept parameters",m5.errors.UNEXPECTED_ARGUMENT,{})),v_(this).toString(10)}toHexString(){return this._hex}toJSON(e){return{type:"BigNumber",hex:this.toHexString()}}static from(e){if(e instanceof vD)return e;if("string"==typeof e)return e.match(/^-?0x[0-9a-f]+$/i)?new vD(vv,vx(e)):e.match(/^-?[0-9]+$/)?new vD(vv,vx(new vy(e))):vm.throwArgumentError("invalid BigNumber string","value",e);if("number"==typeof e)return e%1&&vS("underflow","BigNumber.from",e),(e>=0x1fffffffffffff||e<=-0x1fffffffffffff)&&vS("overflow","BigNumber.from",e),vD.from(String(e));if("bigint"==typeof e)return vD.from(e.toString());if(vt(e))return vD.from(vo(e));if(e)if(e.toHexString){let t=e.toHexString();if("string"==typeof t)return vD.from(t)}else{let t=e._hex;if(null==t&&"BigNumber"===e.type&&(t=e.hex),"string"==typeof t&&(vs(t)||"-"===t[0]&&vs(t.substring(1))))return vD.from(t)}return vm.throwArgumentError("invalid BigNumber value","value",e)}static isBigNumber(e){return!!(e&&e._isBigNumber)}}function vx(e){if("string"!=typeof e)return vx(e.toString(16));if("-"===e[0])return("-"===(e=e.substring(1))[0]&&vm.throwArgumentError("invalid hex","value",e),"0x00"===(e=vx(e)))?e:"-"+e;if("0x"!==e.substring(0,2)&&(e="0x"+e),"0x"===e)return"0x00";for(e.length%2&&(e="0x0"+e.substring(2));e.length>4&&"0x00"===e.substring(0,4);)e="0x"+e.substring(4);return e}function vE(e){return vD.from(vx(e))}function v_(e){let t=vD.from(e).toHexString();return"-"===t[0]?new vy("-"+t.substring(3),16):new vy(t.substring(2),16)}function vS(e,t,r){let i={fault:e,operation:t};return null!=r&&(i.value=r),vm.throwError(e,m5.errors.NUMERIC_FAULT,i)}new m5("rlp/5.8.0");const vI=new m5("address/5.8.0");function vA(e){vs(e,20)||vI.throwArgumentError("invalid address","address",e);let t=(e=e.toLowerCase()).substring(2).split(""),r=new Uint8Array(40);for(let e=0;e<40;e++)r[e]=t[e].charCodeAt(0);let i=vr(vl(r));for(let e=0;e<40;e+=2)i[e>>1]>>4>=8&&(t[e]=t[e].toUpperCase()),(15&i[e>>1])>=8&&(t[e+1]=t[e+1].toUpperCase());return"0x"+t.join("")}const vM={};for(let e=0;e<10;e++)vM[String(e)]=String(e);for(let e=0;e<26;e++)vM[String.fromCharCode(65+e)]=String(10+e);const vO=Math.floor(Math.log10?Math.log10(0x1fffffffffffff):Math.log(0x1fffffffffffff)/Math.LN10);function vC(e){let t=null;if("string"!=typeof e&&vI.throwArgumentError("invalid address","address",e),e.match(/^(0x)?[0-9a-fA-F]{40}$/))"0x"!==e.substring(0,2)&&(e="0x"+e),t=vA(e),e.match(/([A-F].*[a-f])|([a-f].*[A-F])/)&&t!==e&&vI.throwArgumentError("bad address checksum","address",e);else if(e.match(/^XE[0-9]{2}[0-9A-Za-z]{30,31}$/)){for(e.substring(2,4)!==function(e){let t=(e=(e=e.toUpperCase()).substring(4)+e.substring(0,2)+"00").split("").map(e=>vM[e]).join("");for(;t.length>=vO;){let e=t.substring(0,vO);t=parseInt(e,10)%97+t.substring(e.length)}let r=String(98-parseInt(t,10)%97);for(;r.length<2;)r="0"+r;return r}(e)&&vI.throwArgumentError("bad icap checksum","address",e),t=new vy(e.substring(4),36).toString(16);t.length<40;)t="0"+t;t=vA("0x"+t)}else vI.throwArgumentError("invalid address","address",e);return t}function vP(e,t,r){Object.defineProperty(e,t,{enumerable:!0,value:r,writable:!1})}vD.from(-1),vD.from(0),vD.from(1),vD.from(2),vD.from("1000000000000000000"),vD.from("0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),vD.from("-0x8000000000000000000000000000000000000000000000000000000000000000"),vD.from("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),new m5("properties/5.8.0");var vb=n("dEXSZ"),vR=n("kiSKt");function vT(e,t,r){return e(r={path:t,exports:{},require:function(e,t){throw null==t&&r.path,Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}},r.exports),r.exports}"undefined"!=typeof globalThis||("undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self);var vN=vB;function vB(e,t){if(!e)throw Error(t||"Assertion failed")}vB.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)};var vL=vT(function(e,t){function r(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",i=0;i<e.length;i++)t+=r(e[i].toString(16));return t}t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)r[i]=0|e[i];return r}if("hex"===t){(e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e);for(var i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var i=0;i<e.length;i++){var s=e.charCodeAt(i),n=s>>8,o=255&s;n?r.push(n,o):r.push(o)}return r},t.zero2=r,t.toHex=i,t.encode=function(e,t){return"hex"===t?i(e):e}}),vU=vT(function(e,t){t.assert=vN,t.toArray=vL.toArray,t.zero2=vL.zero2,t.toHex=vL.toHex,t.encode=vL.encode,t.getNAF=function(e,t,r){var i=Array(Math.max(e.bitLength(),r)+1);for(o=0;o<i.length;o+=1)i[o]=0;var s=1<<t+1,n=e.clone();for(o=0;o<i.length;o++){var o,a,h=n.andln(s-1);n.isOdd()?(a=h>(s>>1)-1?(s>>1)-h:h,n.isubn(a)):a=0,i[o]=a,n.iushrn(1)}return i},t.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var n,o,a,h=e.andln(3)+i&3,c=t.andln(3)+s&3;3===h&&(h=-1),3===c&&(c=-1),o=(1&h)==0?0:(3==(n=e.andln(7)+i&7)||5===n)&&2===c?-h:h,r[0].push(o),a=(1&c)==0?0:(3==(n=t.andln(7)+s&7)||5===n)&&2===h?-c:c,r[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},t.cachedProperty=function(e,t,r){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},t.parseBytes=function(e){return"string"==typeof e?t.toArray(e,"hex"):e},t.intFromLE=function(e){return new(r(vb))(e,"hex","le")}}),vk=vU.getNAF,vq=vU.getJSF,vj=vU.assert;function vz(e,t){this.type=e,this.p=new(r(vb))(t.p,16),this.red=t.prime?r(vb).red(t.prime):r(vb).mont(this.p),this.zero=new(r(vb))(0).toRed(this.red),this.one=new(r(vb))(1).toRed(this.red),this.two=new(r(vb))(2).toRed(this.red),this.n=t.n&&new(r(vb))(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,],this._bitLength=this.n?this.n.bitLength():0;var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function vF(e,t){this.curve=e,this.type=t,this.precomputed=null}vz.prototype.point=function(){throw Error("Not implemented")},vz.prototype.validate=function(){throw Error("Not implemented")},vz.prototype._fixedNafMul=function(e,t){vj(e.precomputed);var r,i,s=e._getDoubles(),n=vk(t,1,this._bitLength),o=(1<<s.step+1)-(s.step%2==0?2:1);o/=3;var a=[];for(r=0;r<n.length;r+=s.step){i=0;for(var h=r+s.step-1;h>=r;h--)i=(i<<1)+n[h];a.push(i)}for(var c=this.jpoint(null,null,null),u=this.jpoint(null,null,null),l=o;l>0;l--){for(r=0;r<a.length;r++)(i=a[r])===l?u=u.mixedAdd(s.points[r]):i===-l&&(u=u.mixedAdd(s.points[r].neg()));c=c.add(u)}return c.toP()},vz.prototype._wnafMul=function(e,t){var r=4,i=e._getNAFPoints(r);r=i.wnd;for(var s=i.points,n=vk(t,r,this._bitLength),o=this.jpoint(null,null,null),a=n.length-1;a>=0;a--){for(var h=0;a>=0&&0===n[a];a--)h++;if(a>=0&&h++,o=o.dblp(h),a<0)break;var c=n[a];vj(0!==c),o="affine"===e.type?c>0?o.mixedAdd(s[c-1>>1]):o.mixedAdd(s[-c-1>>1].neg()):c>0?o.add(s[c-1>>1]):o.add(s[-c-1>>1].neg())}return"affine"===e.type?o.toP():o},vz.prototype._wnafMulAdd=function(e,t,r,i,s){var n,o,a,h=this._wnafT1,c=this._wnafT2,u=this._wnafT3,l=0;for(n=0;n<i;n++){var f=(a=t[n])._getNAFPoints(e);h[n]=f.wnd,c[n]=f.points}for(n=i-1;n>=1;n-=2){var d=n-1,p=n;if(1!==h[d]||1!==h[p]){u[d]=vk(r[d],h[d],this._bitLength),u[p]=vk(r[p],h[p],this._bitLength),l=Math.max(u[d].length,l),l=Math.max(u[p].length,l);continue}var g=[t[d],null,null,t[p]];0===t[d].y.cmp(t[p].y)?(g[1]=t[d].add(t[p]),g[2]=t[d].toJ().mixedAdd(t[p].neg())):0===t[d].y.cmp(t[p].y.redNeg())?(g[1]=t[d].toJ().mixedAdd(t[p]),g[2]=t[d].add(t[p].neg())):(g[1]=t[d].toJ().mixedAdd(t[p]),g[2]=t[d].toJ().mixedAdd(t[p].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],y=vq(r[d],r[p]);for(o=0,l=Math.max(y[0].length,l),u[d]=Array(l),u[p]=Array(l);o<l;o++){var m=0|y[0][o],v=0|y[1][o];u[d][o]=b[(m+1)*3+(v+1)],u[p][o]=0,c[d]=g}}var w=this.jpoint(null,null,null),D=this._wnafT4;for(n=l;n>=0;n--){for(var x=0;n>=0;){var E=!0;for(o=0;o<i;o++)D[o]=0|u[o][n],0!==D[o]&&(E=!1);if(!E)break;x++,n--}if(n>=0&&x++,w=w.dblp(x),n<0)break;for(o=0;o<i;o++){var _=D[o];0!==_&&(_>0?a=c[o][_-1>>1]:_<0&&(a=c[o][-_-1>>1].neg()),w="affine"===a.type?w.mixedAdd(a):w.add(a))}}for(n=0;n<i;n++)c[n]=null;return s?w:w.toP()},vz.BasePoint=vF,vF.prototype.eq=function(){throw Error("Not implemented")},vF.prototype.validate=function(){return this.curve.validate(this)},vz.prototype.decodePoint=function(e,t){e=vU.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?vj(e[e.length-1]%2==0):7===e[0]&&vj(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw Error("Unknown point format")},vF.prototype.encodeCompressed=function(e){return this.encode(e,!0)},vF.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},vF.prototype.encode=function(e,t){return vU.encode(this._encode(t),e)},vF.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},vF.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},vF.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,s=0;s<t;s+=e){for(var n=0;n<e;n++)i=i.dbl();r.push(i)}return{step:e,points:r}},vF.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,i=1===r?null:this.dbl(),s=1;s<r;s++)t[s]=t[s-1].add(i);return{wnd:e,points:t}},vF.prototype._getBeta=function(){return null},vF.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t};var v$=vT(function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}}),vK=vU.assert;function vV(e){vz.call(this,"short",e),this.a=new(r(vb))(e.a,16).toRed(this.red),this.b=new(r(vb))(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}function vH(e,t,i,s){vz.BasePoint.call(this,e,"affine"),null===t&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new(r(vb))(t,16),this.y=new(r(vb))(i,16),s&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function vG(e,t,i,s){vz.BasePoint.call(this,e,"jacobian"),null===t&&null===i&&null===s?(this.x=this.curve.one,this.y=this.curve.one,this.z=new(r(vb))(0)):(this.x=new(r(vb))(t,16),this.y=new(r(vb))(i,16),this.z=new(r(vb))(s,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}v$(vV,vz),vV.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){if(e.beta)t=new(r(vb))(e.beta,16).toRed(this.red);else{var t,i,s,n=this._getEndoRoots(this.p);t=(t=0>n[0].cmp(n[1])?n[0]:n[1]).toRed(this.red)}if(e.lambda)i=new(r(vb))(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?i=o[0]:(i=o[1],vK(0===this.g.mul(i).x.cmp(this.g.x.redMul(t))))}return s=e.basis?e.basis.map(function(e){return{a:new(r(vb))(e.a,16),b:new(r(vb))(e.b,16)}}):this._getEndoBasis(i),{beta:t,lambda:i,basis:s}}},vV.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:r(vb).mont(e),i=new(r(vb))(2).toRed(t).redInvm(),s=i.redNeg(),n=new(r(vb))(3).toRed(t).redNeg().redSqrt().redMul(i);return[s.redAdd(n).fromRed(),s.redSub(n).fromRed()]},vV.prototype._getEndoBasis=function(e){for(var t,i,s,n,o,a,h,c,u,l=this.n.ushrn(Math.floor(this.n.bitLength()/2)),f=e,d=this.n.clone(),p=new(r(vb))(1),g=new(r(vb))(0),b=new(r(vb))(0),y=new(r(vb))(1),m=0;0!==f.cmpn(0);){var v=d.div(f);c=d.sub(v.mul(f)),u=b.sub(v.mul(p));var w=y.sub(v.mul(g));if(!s&&0>c.cmp(l))t=h.neg(),i=p,s=c.neg(),n=u;else if(s&&2==++m)break;h=c,d=f,f=c,b=p,p=u,y=g,g=w}o=c.neg(),a=u;var D=s.sqr().add(n.sqr());return o.sqr().add(a.sqr()).cmp(D)>=0&&(o=t,a=i),s.negative&&(s=s.neg(),n=n.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:s,b:n},{a:o,b:a}]},vV.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],i=t[1],s=i.b.mul(e).divRound(this.n),n=r.b.neg().mul(e).divRound(this.n),o=s.mul(r.a),a=n.mul(i.a),h=s.mul(r.b),c=n.mul(i.b);return{k1:e.sub(o).sub(a),k2:h.add(c).neg()}},vV.prototype.pointFromX=function(e,t){(e=new(r(vb))(e,16)).red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),s=i.redSqrt();if(0!==s.redSqr().redSub(i).cmp(this.zero))throw Error("invalid point");var n=s.fromRed().isOdd();return(t&&!n||!t&&n)&&(s=s.redNeg()),this.point(e,s)},vV.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(s).cmpn(0)},vV.prototype._endoWnafMulAdd=function(e,t,r){for(var i=this._endoWnafT1,s=this._endoWnafT2,n=0;n<e.length;n++){var o=this._endoSplit(t[n]),a=e[n],h=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),h=h.neg(!0)),i[2*n]=a,i[2*n+1]=h,s[2*n]=o.k1,s[2*n+1]=o.k2}for(var c=this._wnafMulAdd(1,i,s,2*n,r),u=0;u<2*n;u++)i[u]=null,s[u]=null;return c},v$(vH,vz.BasePoint),vV.prototype.point=function(e,t,r){return new vH(this,e,t,r)},vV.prototype.pointFromJSON=function(e,t){return vH.fromJSON(this,e,t)},vH.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,i=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},vH.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},vH.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],r);if(!t[2])return i;function s(t){return e.point(t[0],t[1],r)}var n=t[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(s))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(s))}},i},vH.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},vH.prototype.isInfinity=function(){return this.inf},vH.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e)||0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},vH.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),i=e.redInvm(),s=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(i),n=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)},vH.prototype.getX=function(){return this.x.fromRed()},vH.prototype.getY=function(){return this.y.fromRed()},vH.prototype.mul=function(e){return(e=new(r(vb))(e,16),this.isInfinity())?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},vH.prototype.mulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},vH.prototype.jmulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},vH.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},vH.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t},vH.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},v$(vG,vz.BasePoint),vV.prototype.jpoint=function(e,t,r){return new vG(this,e,t,r)},vG.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(r,i)},vG.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},vG.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t),s=e.x.redMul(r),n=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=i.redSub(s),h=n.redSub(o);if(0===a.cmpn(0))if(0!==h.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var c=a.redSqr(),u=c.redMul(a),l=i.redMul(c),f=h.redSqr().redIAdd(u).redISub(l).redISub(l),d=h.redMul(l.redISub(f)).redISub(n.redMul(u)),p=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(f,d,p)},vG.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,i=e.x.redMul(t),s=this.y,n=e.y.redMul(t).redMul(this.z),o=r.redSub(i),a=s.redSub(n);if(0===o.cmpn(0))if(0!==a.cmpn(0))return this.curve.jpoint(null,null,null);else return this.dbl();var h=o.redSqr(),c=h.redMul(o),u=r.redMul(h),l=a.redSqr().redIAdd(c).redISub(u).redISub(u),f=a.redMul(u.redISub(l)).redISub(s.redMul(c)),d=this.z.redMul(o);return this.curve.jpoint(l,f,d)},vG.prototype.dblp=function(e){if(0===e||this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t,r=this;for(t=0;t<e;t++)r=r.dbl();return r}var i=this.curve.a,s=this.curve.tinv,n=this.x,o=this.y,a=this.z,h=a.redSqr().redSqr(),c=o.redAdd(o);for(t=0;t<e;t++){var u=n.redSqr(),l=c.redSqr(),f=l.redSqr(),d=u.redAdd(u).redIAdd(u).redIAdd(i.redMul(h)),p=n.redMul(l),g=d.redSqr().redISub(p.redAdd(p)),b=p.redISub(g),y=d.redMul(b);y=y.redIAdd(y).redISub(f);var m=c.redMul(a);t+1<e&&(h=h.redMul(f)),n=g,a=m,c=y}return this.curve.jpoint(n,c.redMul(s),a)},vG.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},vG.prototype._zeroDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i),h=a.redSqr().redISub(o).redISub(o),c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),e=h,t=a.redMul(o.redISub(h)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),l=this.y.redSqr(),f=l.redSqr(),d=this.x.redAdd(l).redSqr().redISub(u).redISub(f);d=d.redIAdd(d);var p=u.redAdd(u).redIAdd(u),g=p.redSqr(),b=f.redIAdd(f);b=(b=b.redIAdd(b)).redIAdd(b),e=g.redISub(d).redISub(d),t=p.redMul(d.redISub(e)).redISub(b),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},vG.prototype._threeDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),h=a.redSqr().redISub(o).redISub(o);e=h;var c=n.redIAdd(n);c=(c=c.redIAdd(c)).redIAdd(c),t=a.redMul(o.redISub(h)).redISub(c),r=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),l=this.y.redSqr(),f=this.x.redMul(l),d=this.x.redSub(u).redMul(this.x.redAdd(u));d=d.redAdd(d).redIAdd(d);var p=f.redIAdd(f),g=(p=p.redIAdd(p)).redAdd(p);e=d.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(l).redISub(u);var b=l.redSqr();b=(b=(b=b.redIAdd(b)).redIAdd(b)).redIAdd(b),t=d.redMul(p.redISub(e)).redISub(b)}return this.curve.jpoint(e,t,r)},vG.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,i=this.z,s=i.redSqr().redSqr(),n=t.redSqr(),o=r.redSqr(),a=n.redAdd(n).redIAdd(n).redIAdd(e.redMul(s)),h=t.redAdd(t),c=(h=h.redIAdd(h)).redMul(o),u=a.redSqr().redISub(c.redAdd(c)),l=c.redISub(u),f=o.redSqr();f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=a.redMul(l).redISub(f),p=r.redAdd(r).redMul(i);return this.curve.jpoint(u,d,p)},vG.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=t.redSqr(),s=e.redAdd(e).redIAdd(e),n=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(i),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(n)).redSqr(),h=i.redIAdd(i);h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var c=s.redIAdd(o).redSqr().redISub(n).redISub(a).redISub(h),u=t.redMul(c);u=(u=u.redIAdd(u)).redIAdd(u);var l=this.x.redMul(a).redISub(u);l=(l=l.redIAdd(l)).redIAdd(l);var f=this.y.redMul(c.redMul(h.redISub(c)).redISub(o.redMul(a)));f=(f=(f=f.redIAdd(f)).redIAdd(f)).redIAdd(f);var d=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(l,f,d)},vG.prototype.mul=function(e,t){return e=new(r(vb))(e,t),this.curve._wnafMul(this,e)},vG.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),s=r.redMul(e.z);return 0===this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)},vG.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var i=e.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(s),0===this.x.cmp(r))return!0}},vG.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},vG.prototype.isInfinity=function(){return 0===this.z.cmpn(0)};var vW=vT(function(e,t){t.base=vz,t.short=vV,t.mont=null,t.edwards=null}),vY=vT(function(e,t){var i,s=vU.assert;function n(e){"short"===e.type?this.curve=new vW.short(e):"edwards"===e.type?this.curve=new vW.edwards(e):this.curve=new vW.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function o(e,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){var i=new n(r);return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:i}),i}})}t.PresetCurve=n,o("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r(vR).sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),o("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r(vR).sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),o("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r(vR).sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),o("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r(vR).sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),o("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r(vR).sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),o("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r(vR).sha256,gRed:!1,g:["9"]}),o("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r(vR).sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=null.crash()}catch(e){i=void 0}o("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r(vR).sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})});function vJ(e){if(!(this instanceof vJ))return new vJ(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=vL.toArray(e.entropy,e.entropyEnc||"hex"),r=vL.toArray(e.nonce,e.nonceEnc||"hex"),i=vL.toArray(e.pers,e.persEnc||"hex");vN(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,i)}vJ.prototype._init=function(e,t,r){var i=e.concat(t).concat(r);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=0x1000000000000},vJ.prototype._hmac=function(){return new(r(vR)).hmac(this.hash,this.K)},vJ.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},vJ.prototype.reseed=function(e,t,r,i){"string"!=typeof t&&(i=r,r=t,t=null),e=vL.toArray(e,t),r=vL.toArray(r,i),vN(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},vJ.prototype.generate=function(e,t,r,i){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");"string"!=typeof t&&(i=r,r=t,t=null),r&&(r=vL.toArray(r,i||"hex"),this._update(r));for(var s=[];s.length<e;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var n=s.slice(0,e);return this._update(r),this._reseed++,vL.encode(n,t)};var vZ=vU.assert;function vX(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}vX.fromPublic=function(e,t,r){return t instanceof vX?t:new vX(e,{pub:t,pubEnc:r})},vX.fromPrivate=function(e,t,r){return t instanceof vX?t:new vX(e,{priv:t,privEnc:r})},vX.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},vX.prototype.getPublic=function(e,t){return("string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t)?this.pub.encode(t,e):this.pub},vX.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},vX.prototype._importPrivate=function(e,t){this.priv=new(r(vb))(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},vX.prototype._importPublic=function(e,t){if(e.x||e.y){"mont"===this.ec.curve.type?vZ(e.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&vZ(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)},vX.prototype.derive=function(e){return e.validate()||vZ(e.validate(),"public point not validated"),e.mul(this.priv).getX()},vX.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},vX.prototype.verify=function(e,t,r){return this.ec.verify(e,t,this,void 0,r)},vX.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var vQ=vU.assert;function v0(e,t){if(e instanceof v0)return e;this._importDER(e,t)||(vQ(e.r&&e.s,"Signature without r or s"),this.r=new(r(vb))(e.r,16),this.s=new(r(vb))(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function v1(){this.place=0}function v2(e,t){var r=e[t.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4||0===e[t.place])return!1;for(var s=0,n=0,o=t.place;n<i;n++,o++)s<<=8,s|=e[o],s>>>=0;return!(s<=127)&&(t.place=o,s)}function v3(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function v8(e,t){if(t<128)return void e.push(t);var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}v0.prototype._importDER=function(e,t){e=vU.toArray(e,t);var i=new v1;if(48!==e[i.place++])return!1;var s=v2(e,i);if(!1===s||s+i.place!==e.length||2!==e[i.place++])return!1;var n=v2(e,i);if(!1===n||(128&e[i.place])!=0)return!1;var o=e.slice(i.place,n+i.place);if(i.place+=n,2!==e[i.place++])return!1;var a=v2(e,i);if(!1===a||e.length!==a+i.place||(128&e[i.place])!=0)return!1;var h=e.slice(i.place,a+i.place);if(0===o[0])if(!(128&o[1]))return!1;else o=o.slice(1);if(0===h[0])if(!(128&h[1]))return!1;else h=h.slice(1);return this.r=new(r(vb))(o),this.s=new(r(vb))(h),this.recoveryParam=null,!0},v0.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=v3(t),r=v3(r);!r[0]&&!(128&r[1]);)r=r.slice(1);var i=[2];v8(i,t.length),(i=i.concat(t)).push(2),v8(i,r.length);var s=i.concat(r),n=[48];return v8(n,s.length),n=n.concat(s),vU.encode(n,e)};var v6=function(){throw Error("unsupported")},v5=vU.assert;function v4(e){if(!(this instanceof v4))return new v4(e);"string"==typeof e&&(v5(Object.prototype.hasOwnProperty.call(vY,e),"Unknown curve "+e),e=vY[e]),e instanceof vY.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}v4.prototype.keyPair=function(e){return new vX(this,e)},v4.prototype.keyFromPrivate=function(e,t){return vX.fromPrivate(this,e,t)},v4.prototype.keyFromPublic=function(e,t){return vX.fromPublic(this,e,t)},v4.prototype.genKeyPair=function(e){e||(e={});for(var t=new vJ({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||v6(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),s=this.n.sub(new(r(vb))(2));;){var n=new(r(vb))(t.generate(i));if(!(n.cmp(s)>0))return n.iaddn(1),this.keyFromPrivate(n)}},v4.prototype._truncateToN=function(e,t,i){if(r(vb).isBN(e)||"number"==typeof e)s=(e=new(r(vb))(e,16)).byteLength();else if("object"==typeof e)s=e.length,e=new(r(vb))(e,16);else{var s,n=e.toString();s=n.length+1>>>1,e=new(r(vb))(n,16)}"number"!=typeof i&&(i=8*s);var o=i-this.n.bitLength();return(o>0&&(e=e.ushrn(o)),!t&&e.cmp(this.n)>=0)?e.sub(this.n):e},v4.prototype.sign=function(e,t,i,s){if("object"==typeof i&&(s=i,i=null),s||(s={}),"string"!=typeof e&&"number"!=typeof e&&!r(vb).isBN(e)){v5("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),v5(e.length>>>0===e.length);for(var n=0;n<e.length;n++)v5((255&e[n])===e[n])}t=this.keyFromPrivate(t,i),v5(!(e=this._truncateToN(e,!1,s.msgBitLength)).isNeg(),"Can not sign a negative message");var o=this.n.byteLength(),a=t.getPrivate().toArray("be",o),h=e.toArray("be",o);v5(new(r(vb))(h).eq(e),"Can not sign message");for(var c=new vJ({hash:this.hash,entropy:a,nonce:h,pers:s.pers,persEnc:s.persEnc||"utf8"}),u=this.n.sub(new(r(vb))(1)),l=0;;l++){var f=s.k?s.k(l):new(r(vb))(c.generate(this.n.byteLength()));if(0>=(f=this._truncateToN(f,!0)).cmpn(1)||f.cmp(u)>=0)continue;var d=this.g.mul(f);if(!d.isInfinity()){var p=d.getX(),g=p.umod(this.n);if(0!==g.cmpn(0)){var b=f.invm(this.n).mul(g.mul(t.getPrivate()).iadd(e));if(0!==(b=b.umod(this.n)).cmpn(0)){var y=!!d.getY().isOdd()|2*(0!==p.cmp(g));return s.canonical&&b.cmp(this.nh)>0&&(b=this.n.sub(b),y^=1),new v0({r:g,s:b,recoveryParam:y})}}}}},v4.prototype.verify=function(e,t,r,i,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),r=this.keyFromPublic(r,i);var n,o=(t=new v0(t,"hex")).r,a=t.s;if(0>o.cmpn(1)||o.cmp(this.n)>=0||0>a.cmpn(1)||a.cmp(this.n)>=0)return!1;var h=a.invm(this.n),c=h.mul(e).umod(this.n),u=h.mul(o).umod(this.n);return this.curve._maxwellTrick?!(n=this.g.jmulAdd(c,r.getPublic(),u)).isInfinity()&&n.eqXToP(o):!(n=this.g.mulAdd(c,r.getPublic(),u)).isInfinity()&&0===n.getX().umod(this.n).cmp(o)},v4.prototype.recoverPubKey=function(e,t,i,s){v5((3&i)===i,"The recovery param is more than two bits"),t=new v0(t,s);var n=this.n,o=new(r(vb))(e),a=t.r,h=t.s,c=1&i,u=i>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw Error("Unable to find sencond key candinate");a=u?this.curve.pointFromX(a.add(this.curve.n),c):this.curve.pointFromX(a,c);var l=t.r.invm(n),f=n.sub(o).mul(l).umod(n),d=h.mul(l).umod(n);return this.g.mulAdd(f,a,d)},v4.prototype.getKeyRecoveryParam=function(e,t,r,i){if(null!==(t=new v0(t,i)).recoveryParam)return t.recoveryParam;for(var s,n=0;n<4;n++){try{s=this.recoverPubKey(e,t,n)}catch(e){continue}if(s.eq(r))return n}throw Error("Unable to find valid recovery factor")};var v9=vT(function(e,t){t.version="6.6.1",t.utils=vU,t.rand=function(){throw Error("unsupported")},t.curve=vW,t.curves=vY,t.ec=v4,t.eddsa=null}).ec;const v7=new m5("signing-key/5.8.0");let we=null;function wt(){return we||(we=new v9("secp256k1")),we}class wr{constructor(e){vP(this,"curve","secp256k1"),vP(this,"privateKey",vo(e)),32!==function(e){if("string"!=typeof e)e=vo(e);else if(!vs(e)||e.length%2)return null;return(e.length-2)/2}(this.privateKey)&&v7.throwArgumentError("invalid private key","privateKey","[[ REDACTED ]]");let t=wt().keyFromPrivate(vr(this.privateKey));vP(this,"publicKey","0x"+t.getPublic(!1,"hex")),vP(this,"compressedPublicKey","0x"+t.getPublic(!0,"hex")),vP(this,"_isSigningKey",!0)}_addPoint(e){let t=wt().keyFromPublic(vr(this.publicKey)),r=wt().keyFromPublic(vr(e));return"0x"+t.pub.add(r.pub).encodeCompressed("hex")}signDigest(e){let t=wt().keyFromPrivate(vr(this.privateKey)),r=vr(e);32!==r.length&&v7.throwArgumentError("bad digest length","digest",e);let i=t.sign(r,{canonical:!0});return vc({recoveryParam:i.recoveryParam,r:vh("0x"+i.r.toString(16),32),s:vh("0x"+i.s.toString(16),32)})}computeSharedSecret(e){let t=wt().keyFromPrivate(vr(this.privateKey)),r=wt().keyFromPublic(vr(ws(e)));return vh("0x"+t.derive(r.getPublic()).toString(16),32)}static isSigningKey(e){return!!(e&&e._isSigningKey)}}function wi(e,t){let r=vc(t),i={r:vr(r.r),s:vr(r.s)};return"0x"+wt().recoverPubKey(vr(e),i,r.recoveryParam).encode("hex",!1)}function ws(e,t){let r=vr(e);if(32===r.length){let e=new wr(r);return t?"0x"+wt().keyFromPrivate(r).getPublic(!0,"hex"):e.publicKey}return 33===r.length?t?vo(r):"0x"+wt().keyFromPublic(r).getPublic(!1,"hex"):65===r.length?t?"0x"+wt().keyFromPublic(r).getPublic(!0,"hex"):vo(r):v7.throwArgumentError("invalid public or private key","key","[REDACTED]")}new m5("transactions/5.8.0"),(A4=Md||(Md={}))[A4.legacy=0]="legacy",A4[A4.eip2930=1]="eip2930",A4[A4.eip1559=2]="eip1559";var wn={};wn=self.fetch||(self.fetch=n("laOt8").default||n("laOt8"));var wo={};Object.defineProperty(wo,"__esModule",{value:!0}),wo.randomStringForEntropy=wo.randomString=wo.randomUint32=wo.randomBytes=wo.defaultRandomSource=void 0;var wa={};Object.defineProperty(wa,"__esModule",{value:!0}),wa.SystemRandomSource=void 0;var wh={};Object.defineProperty(wh,"__esModule",{value:!0}),wh.BrowserRandomSource=void 0,wh.BrowserRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let e="undefined"!=typeof self?self.crypto||self.msCrypto:null;e&&void 0!==e.getRandomValues&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw Error("Browser random byte generator is not available.");let t=new Uint8Array(e);for(let e=0;e<t.length;e+=65536)this._crypto.getRandomValues(t.subarray(e,e+Math.min(t.length-e,65536)));return t}};var wc={};Object.defineProperty(wc,"__esModule",{value:!0}),wc.NodeRandomSource=void 0;var wu={};Object.defineProperty(wu,"__esModule",{value:!0}),wu.wipe=function(e){for(var t=0;t<e.length;t++)e[t]=0;return e},wc.NodeRandomSource=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{let e=n("kjyEk");e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw Error("NodeRandomSource: got fewer bytes than requested");let r=new Uint8Array(e);for(let e=0;e<r.length;e++)r[e]=t[e];return(0,wu.wipe)(t),r}},wa.SystemRandomSource=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new wh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new wc.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw Error("System random byte generator is not available.");return this._source.randomBytes(e)}};var wl={};Object.defineProperty(wl,"__esModule",{value:!0});var wf={};function wd(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}function wp(e,t,r){return void 0===t&&(t=new Uint8Array(2)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}function wg(e,t){return void 0===t&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function wb(e,t){return void 0===t&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}function wy(e,t){return void 0===t&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}function wm(e,t){return void 0===t&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}function wv(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}function ww(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}function wD(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),wv(e/0x100000000>>>0,t,r),wv(e>>>0,t,r+4),t}function wx(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),ww(e>>>0,t,r),ww(e/0x100000000>>>0,t,r+4),t}function wE(e,t=wo.defaultRandomSource){return t.randomBytes(e)}Object.defineProperty(wf,"__esModule",{value:!0}),wf.mul=Math.imul||function(e,t){var r=65535&e,i=65535&t;return r*i+((e>>>16&65535)*i+r*(t>>>16&65535)<<16>>>0)|0},wf.add=function(e,t){return e+t|0},wf.sub=function(e,t){return e-t|0},wf.rotl=function(e,t){return e<<t|e>>>32-t},wf.rotr=function(e,t){return e<<32-t|e>>>t},wf.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},wf.MAX_SAFE_INTEGER=0x1fffffffffffff,wf.isSafeInteger=function(e){return wf.isInteger(e)&&e>=-wf.MAX_SAFE_INTEGER&&e<=wf.MAX_SAFE_INTEGER},wl.readInt16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16},wl.readUint16BE=function(e,t){return void 0===t&&(t=0),(e[t+0]<<8|e[t+1])>>>0},wl.readInt16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])<<16>>16},wl.readUint16LE=function(e,t){return void 0===t&&(t=0),(e[t+1]<<8|e[t])>>>0},wl.writeUint16BE=wd,wl.writeInt16BE=wd,wl.writeUint16LE=wp,wl.writeInt16LE=wp,wl.readInt32BE=wg,wl.readUint32BE=wb,wl.readInt32LE=wy,wl.readUint32LE=wm,wl.writeUint32BE=wv,wl.writeInt32BE=wv,wl.writeUint32LE=ww,wl.writeInt32LE=ww,wl.readInt64BE=function(e,t){void 0===t&&(t=0);var r=wg(e,t),i=wg(e,t+4);return 0x100000000*r+i-(i>>31)*0x100000000},wl.readUint64BE=function(e,t){return void 0===t&&(t=0),0x100000000*wb(e,t)+wb(e,t+4)},wl.readInt64LE=function(e,t){void 0===t&&(t=0);var r=wy(e,t);return 0x100000000*wy(e,t+4)+r-(r>>31)*0x100000000},wl.readUint64LE=function(e,t){void 0===t&&(t=0);var r=wm(e,t);return 0x100000000*wm(e,t+4)+r},wl.writeUint64BE=wD,wl.writeInt64BE=wD,wl.writeUint64LE=wx,wl.writeInt64LE=wx,wl.readUintBE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw Error("readUintBE: array is too short for the given bitLength");for(var i=0,s=1,n=e/8+r-1;n>=r;n--)i+=t[n]*s,s*=256;return i},wl.readUintLE=function(e,t,r){if(void 0===r&&(r=0),e%8!=0)throw Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw Error("readUintLE: array is too short for the given bitLength");for(var i=0,s=1,n=r;n<r+e/8;n++)i+=t[n]*s,s*=256;return i},wl.writeUintBE=function(e,t,r,i){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw Error("writeUintBE supports only bitLengths divisible by 8");if(!wf.isSafeInteger(t))throw Error("writeUintBE value must be an integer");for(var s=1,n=e/8+i-1;n>=i;n--)r[n]=t/s&255,s*=256;return r},wl.writeUintLE=function(e,t,r,i){if(void 0===r&&(r=new Uint8Array(e/8)),void 0===i&&(i=0),e%8!=0)throw Error("writeUintLE supports only bitLengths divisible by 8");if(!wf.isSafeInteger(t))throw Error("writeUintLE value must be an integer");for(var s=1,n=i;n<i+e/8;n++)r[n]=t/s&255,s*=256;return r},wl.readFloat32BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t)},wl.readFloat32LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat32(t,!0)},wl.readFloat64BE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t)},wl.readFloat64LE=function(e,t){return void 0===t&&(t=0),new DataView(e.buffer,e.byteOffset,e.byteLength).getFloat64(t,!0)},wl.writeFloat32BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e),t},wl.writeFloat32LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(4)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat32(r,e,!0),t},wl.writeFloat64BE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e),t},wl.writeFloat64LE=function(e,t,r){return void 0===t&&(t=new Uint8Array(8)),void 0===r&&(r=0),new DataView(t.buffer,t.byteOffset,t.byteLength).setFloat64(r,e,!0),t},wo.defaultRandomSource=new wa.SystemRandomSource,wo.randomBytes=wE,wo.randomUint32=function(e=wo.defaultRandomSource){let t=wE(4,e),r=(0,wl.readUint32LE)(t);return(0,wu.wipe)(t),r};const w_="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function wS(e,t=w_,r=wo.defaultRandomSource){if(t.length<2)throw Error("randomString charset is too short");if(t.length>256)throw Error("randomString charset is too long");let i="",s=t.length,n=256-256%s;for(;e>0;){let o=wE(Math.ceil(256*e/n),r);for(let r=0;r<o.length&&e>0;r++){let a=o[r];a<n&&(i+=t.charAt(a%s),e--)}(0,wu.wipe)(o)}return i}wo.randomString=wS,wo.randomStringForEntropy=function(e,t=w_,r=wo.defaultRandomSource){return wS(Math.ceil(e/(Math.log(t.length)/Math.LN2)),t,r)};var wI={};Object.defineProperty(wI,"__esModule",{value:!0}),wI.DIGEST_LENGTH=32,wI.BLOCK_SIZE=64;var wA=function(){function e(){this.digestLength=wI.DIGEST_LENGTH,this.blockSize=wI.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=0x6a09e667,this._state[1]=0xbb67ae85,this._state[2]=0x3c6ef372,this._state[3]=0xa54ff53a,this._state[4]=0x510e527f,this._state[5]=0x9b05688c,this._state[6]=0x1f83d9ab,this._state[7]=0x5be0cd19},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){wu.wipe(this._buffer),wu.wipe(this._temp),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw Error("SHA256: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&t>0;)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(wO(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(r=wO(this._temp,this._state,e,r,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[r++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,i=t%64<56?64:128;this._buffer[r]=128;for(var s=r+1;s<i-8;s++)this._buffer[s]=0;wl.writeUint32BE(t/0x20000000|0,this._buffer,i-8),wl.writeUint32BE(t<<3,this._buffer,i-4),wO(this._temp,this._state,this._buffer,0,i),this._finished=!0}for(var s=0;s<this.digestLength/4;s++)wl.writeUint32BE(this._state[s],e,4*s);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._state.set(e.state),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){wu.wipe(e.state),e.buffer&&wu.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();wI.SHA256=wA;var wM=new Int32Array([0x428a2f98,0x71374491,0xb5c0fbcf,0xe9b5dba5,0x3956c25b,0x59f111f1,0x923f82a4,0xab1c5ed5,0xd807aa98,0x12835b01,0x243185be,0x550c7dc3,0x72be5d74,0x80deb1fe,0x9bdc06a7,0xc19bf174,0xe49b69c1,0xefbe4786,0xfc19dc6,0x240ca1cc,0x2de92c6f,0x4a7484aa,0x5cb0a9dc,0x76f988da,0x983e5152,0xa831c66d,0xb00327c8,0xbf597fc7,0xc6e00bf3,0xd5a79147,0x6ca6351,0x14292967,0x27b70a85,0x2e1b2138,0x4d2c6dfc,0x53380d13,0x650a7354,0x766a0abb,0x81c2c92e,0x92722c85,0xa2bfe8a1,0xa81a664b,0xc24b8b70,0xc76c51a3,0xd192e819,0xd6990624,0xf40e3585,0x106aa070,0x19a4c116,0x1e376c08,0x2748774c,0x34b0bcb5,0x391c0cb3,0x4ed8aa4a,0x5b9cca4f,0x682e6ff3,0x748f82ee,0x78a5636f,0x84c87814,0x8cc70208,0x90befffa,0xa4506ceb,0xbef9a3f7,0xc67178f2]);function wO(e,t,r,i,s){for(;s>=64;){for(var n=t[0],o=t[1],a=t[2],h=t[3],c=t[4],u=t[5],l=t[6],f=t[7],d=0;d<16;d++){var p=i+4*d;e[d]=wl.readUint32BE(r,p)}for(var d=16;d<64;d++){var g=e[d-2],b=(g>>>17|g<<15)^(g>>>19|g<<13)^g>>>10,y=((g=e[d-15])>>>7|g<<25)^(g>>>18|g<<14)^g>>>3;e[d]=(b+e[d-7]|0)+(y+e[d-16]|0)}for(var d=0;d<64;d++){var b=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&l)|0)+(f+(wM[d]+e[d]|0)|0)|0,y=((n>>>2|n<<30)^(n>>>13|n<<19)^(n>>>22|n<<10))+(n&o^n&a^o&a)|0;f=l,l=u,u=c,c=h+b|0,h=a,a=o,o=n,n=b+y|0}t[0]+=n,t[1]+=o,t[2]+=a,t[3]+=h,t[4]+=c,t[5]+=u,t[6]+=l,t[7]+=f,i+=64,s-=64}return i}wI.hash=function(e){var t=new wA;t.update(e);var r=t.digest();return t.clean(),r};class wC{constructor(e){this.client=e}}class wP{constructor(e){this.opts=e}}const wR={wc_authRequest:{req:{ttl:x.ONE_DAY,prompt:!0,tag:3e3},res:{ttl:x.ONE_DAY,prompt:!1,tag:3001}}},wT={min:x.FIVE_MINUTES,max:x.SEVEN_DAYS},wN="authClient",wB="wc@1:auth:",wL=`${wB}:PUB_KEY`;function wU(e){return e?.split(":")}function wk(e){let t=e&&wU(e);if(t)return t.pop()}async function wq(e,t,r,i,s){switch(r.t){case"eip191":var n,o,a,h,c;return n=e,o=t,a=r.s,(h=vg(o),c=a,vC(va(vl(va(ws(wi(vr(h),c)),1)),12))).toLowerCase()===n.toLowerCase();case"eip1271":return await wj(e,t,r.s,i,s);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function wj(e,t,i,s,n){try{let o="0x1626ba7e",a=i.substring(2),h=vg(t).substring(2),c=o+h+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+a,u=await r(wn)(`https://rpc.walletconnect.com/v1/?chainId=${s}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:c},"latest"]})}),{result:l}=await u.json();return!!l&&l.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}function wz(e){return e.getAll().filter(e=>"requester"in e)}function wF(e,t){return wz(e).find(e=>e.id===t)}x.ONE_DAY;var w$=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,h=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===h;)i++,t++;for(var n=(e.length-t)*c+1>>>0,o=new Uint8Array(n);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var l=0,f=n-1;(0!==u||l<s)&&-1!==f;f--,l++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=l,t++}if(" "!==e[t]){for(var d=n-s;d!==n&&0===o[d];)d++;for(var p=new Uint8Array(i+(n-d)),g=i;d!==n;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*u+1>>>0,c=new Uint8Array(o);s!==n;){for(var l=t[s],f=0,d=o-1;(0!==l||f<i)&&-1!==d;d--,f++)l+=256*c[d]>>>0,c[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw Error("Non-zero carry");i=f,s++}for(var p=o-i;p!==o&&0===c[p];)p++;for(var g=h.repeat(r);p<o;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw Error(`Non-${t} character`)}}};const wK=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class wV{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class wH{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return wW(this,e)}}class wG{constructor(e){this.decoders=e}or(e){return wW(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const wW=(e,t)=>new wG({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class wY{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new wV(e,t,r),this.decoder=new wH(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const wJ=({name:e,prefix:t,encode:r,decode:i})=>new wY(e,t,r,i),wZ=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=w$(r,t);return wJ({prefix:e,name:t,encode:i,decode:e=>wK(s(e))})},wX=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>wJ({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n})(e,i,r),decode:t=>((e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,h=0,c=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);h=h<<r|n,(a+=r)>=8&&(a-=8,o[c++]=255&h>>a)}if(a>=r||255&h<<8-a)throw SyntaxError("Unexpected end of data");return o})(t,i,r,e)});var wQ=Object.freeze({__proto__:null,identity:wJ({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),w0=Object.freeze({__proto__:null,base2:wX({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),w1=Object.freeze({__proto__:null,base8:wX({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),w2=Object.freeze({__proto__:null,base10:wZ({prefix:"9",name:"base10",alphabet:"0123456789"})}),w3=Object.freeze({__proto__:null,base16:wX({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:wX({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});const w8=wX({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),w6=wX({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),w5=wX({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),w4=wX({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),w9=wX({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),w7=wX({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),De=wX({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var Dt=Object.freeze({__proto__:null,base32:w8,base32upper:w6,base32pad:w5,base32padupper:w4,base32hex:w9,base32hexupper:w7,base32hexpad:De,base32hexpadupper:wX({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:wX({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),Dr=Object.freeze({__proto__:null,base36:wZ({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:wZ({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),Di=Object.freeze({__proto__:null,base58btc:wZ({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:wZ({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});const Ds=wX({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dn=wX({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var Do=Object.freeze({__proto__:null,base64:Ds,base64pad:Dn,base64url:wX({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:wX({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});const Da=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),Dh=Da.reduce((e,t,r)=>(e[r]=t,e),[]),Dc=Da.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var Du=Object.freeze({__proto__:null,base256emoji:wJ({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=Dh[t],"")},decode:function(e){let t=[];for(let r of e){let e=Dc[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function Dl(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,Dl.bytes=r-i+1,t}const Df=(e,t,r=0)=>(Dl(e,t,r),t),Dd=e=>{var t;return(t=e)<128?1:t<16384?2:t<2097152?3:t<0x10000000?4:t<0x800000000?5:t<0x40000000000?6:t<0x2000000000000?7:t<0x100000000000000?8:t<0x8000000000000000?9:10},Dp=(e,t)=>{let r=t.byteLength,i=Dd(e),s=i+Dd(r),n=new Uint8Array(s+r);return Df(e,n,0),Df(r,n,i),n.set(t,s),new Dg(e,r,t,n)};class Dg{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const Db=({name:e,code:t,encode:r})=>new Dy(e,t,r);class Dy{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Dp(this.code,t):t.then(e=>Dp(this.code,e))}throw Error("Unknown type, must be binary type")}}const Dm=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var Dv=Object.freeze({__proto__:null,sha256:Db({name:"sha2-256",code:18,encode:Dm("SHA-256")}),sha512:Db({name:"sha2-512",code:19,encode:Dm("SHA-512")})}),Dw=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:wK,digest:e=>Dp(0,wK(e))}});new TextEncoder,new TextDecoder;const DD={...wQ,...w0,...w1,...w2,...w3,...Dt,...Dr,...Di,...Do,...Du};function Dx(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...Dv,...Dw});const DE=Dx("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),D_=Dx("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),DS={utf8:DE,"utf-8":DE,hex:DD.base16,latin1:D_,ascii:D_,binary:D_,...DD};function DI(e){return function(e,t="utf8"){let r=DS[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}((0,wI.hash)(function(e,t="utf8"){let r=DS[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}(e,"utf8")),"base16")}var DA=Object.defineProperty,DM=Object.defineProperties,DO=Object.getOwnPropertyDescriptors,DC=Object.getOwnPropertySymbols,DP=Object.prototype.hasOwnProperty,DR=Object.prototype.propertyIsEnumerable,DT=(e,t,r)=>t in e?DA(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,DN=(e,t)=>{for(var r in t||(t={}))DP.call(t,r)&&DT(e,r,t[r]);if(DC)for(var r of DC(t))DR.call(t,r)&&DT(e,r,t[r]);return e},DB=(e,t)=>DM(e,DO(t));class DL extends wC{constructor(e){super(e),this.initialized=!1,this.name="authEngine",this.init=()=>{this.initialized||(this.registerRelayerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(wR)}),this.initialized=!0)},this.request=async(e,t)=>{if(this.isInitialized(),!function(e){let t=gr(e.aud),r=RegExp(`${e.domain}`).test(e.aud),i=!!e.nonce,s=!e.type||"eip4361"===e.type,n=e.expiry;if(n&&!gl(n,wT)){let{message:e}=p8("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${wT.min} and ${wT.max}`);throw Error(e)}return!!(t&&r&&i&&s)}(e))throw Error("Invalid request");if(null!=t&&t.topic)return await this.requestOnKnownPairing(t.topic,e);let{chainId:r,statement:i,aud:s,domain:n,nonce:o,type:a,exp:h,nbf:c}=e,{topic:u,uri:l}=await this.client.core.pairing.create();this.client.logger.info({message:"Generated new pairing",pairing:{topic:u,uri:l}});let f=await this.client.core.crypto.generateKeyPair(),d=pw(f);await this.client.authKeys.set(wL,{responseTopic:d,publicKey:f}),await this.client.pairingTopics.set(d,{topic:d,pairingTopic:u}),await this.client.core.relayer.subscribe(d),this.client.logger.info(`sending request to new pairing topic: ${u}`);let p=await this.sendRequest(u,"wc_authRequest",{payloadParams:{type:a??"eip4361",chainId:r,statement:i,aud:s,domain:n,version:"1",nonce:o,iat:new Date().toISOString(),exp:h,nbf:c},requester:{publicKey:f,metadata:this.client.metadata}},{},e.expiry);return this.client.logger.info(`sent request to new pairing topic: ${u}`),{uri:l,id:p}},this.respond=async(e,t)=>{if(this.isInitialized(),!wF(this.client.requests,e.id))throw Error("Invalid response");let r=wF(this.client.requests,e.id);if(!r)throw Error(`Could not find pending auth request with id ${e.id}`);let i=r.requester.publicKey,s=await this.client.core.crypto.generateKeyPair(),n=pw(i),o={type:1,receiverPublicKey:i,senderPublicKey:s};if("error"in e)return void await this.sendError(r.id,n,e,o);let a={h:{t:"eip4361"},p:DB(DN({},r.cacaoPayload),{iss:t}),s:e.signature};await this.sendResult(r.id,n,a,o),await this.client.core.pairing.activate({topic:r.pairingTopic}),await this.client.requests.update(r.id,DN({},a))},this.getPendingRequests=()=>wz(this.client.requests),this.formatMessage=(e,t)=>{this.client.logger.debug(`formatMessage, cacao is: ${JSON.stringify(e)}`);let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=wk(t),s=e.statement,n=`URI: ${e.aud}`,o=`Version: ${e.version}`,a=`Chain ID: ${function(e){let t=e&&wU(e);if(t)return t[3]}(t)}`,h=`Nonce: ${e.nonce}`,c=`Issued At: ${e.iat}`;return[r,i,"",s,"",n,o,a,h,c,e.exp?`Expiry: ${e.exp}`:void 0,e.resources&&e.resources.length>0?`Resources:
${e.resources.map(e=>`- ${e}`).join(`
`)}`:void 0].filter(e=>null!=e).join(`
`)},this.setExpiry=async(e,t)=>{this.client.core.pairing.pairings.keys.includes(e)&&await this.client.core.pairing.updateExpiry({topic:e,expiry:t}),this.client.core.expirer.set(e,t)},this.sendRequest=async(e,t,r,i,s)=>{let n=gO(t,r),o=await this.client.core.crypto.encode(e,n,i),a=wR[t].req;if(s&&(a.ttl=s),this.client.core.history.set(e,n),uy()){let e=DI(JSON.stringify(n));this.client.core.verify.register({attestationId:e})}return await this.client.core.relayer.publish(e,o,DB(DN({},a),{internal:{throwOnFailedPublish:!0}})),n.id},this.sendResult=async(e,t,r,i)=>{let s=gC(e,r),n=await this.client.core.crypto.encode(t,s,i),o=wR[(await this.client.core.history.get(t,e)).request.method].res;return await this.client.core.relayer.publish(t,n,DB(DN({},o),{internal:{throwOnFailedPublish:!0}})),await this.client.core.history.resolve(s),s.id},this.sendError=async(e,t,r,i)=>{let s=gP(e,r.error),n=await this.client.core.crypto.encode(t,s,i),o=wR[(await this.client.core.history.get(t,e)).request.method].res;return await this.client.core.relayer.publish(t,n,o),await this.client.core.history.resolve(s),s.id},this.requestOnKnownPairing=async(e,t)=>{let r=this.client.core.pairing.pairings.getAll({active:!0}).find(t=>t.topic===e);if(!r)throw Error(`Could not find pairing for provided topic ${e}`);let{publicKey:i}=this.client.authKeys.get(wL),{chainId:s,statement:n,aud:o,domain:a,nonce:h,type:c}=t,u=await this.sendRequest(r.topic,"wc_authRequest",{payloadParams:{type:c??"eip4361",chainId:s,statement:n,aud:o,domain:a,version:"1",nonce:h,iat:new Date().toISOString()},requester:{publicKey:i,metadata:this.client.metadata}},{},t.expiry);return this.client.logger.info(`sent request to known pairing topic: ${r.topic}`),{id:u}},this.onPairingCreated=e=>{let t=this.getPendingRequests();if(t){let r=Object.values(t).find(t=>t.pairingTopic===e.topic);r&&this.handleAuthRequest(r)}},this.onRelayEventRequest=e=>{let{topic:t,payload:r}=e,i=r.method;return"wc_authRequest"===i?this.onAuthRequest(t,r):this.client.logger.info(`Unsupported request method ${i}`)},this.onRelayEventResponse=async e=>{let{topic:t,payload:r}=e,i=(await this.client.core.history.get(t,r.id)).request.method;return"wc_authRequest"===i?this.onAuthResponse(t,r):this.client.logger.info(`Unsupported response method ${i}`)},this.onAuthRequest=async(e,t)=>{let{requester:r,payloadParams:i}=t.params;this.client.logger.info({type:"onAuthRequest",topic:e,payload:t});let s=DI(JSON.stringify(t)),n=await this.getVerifyContext(s,this.client.metadata),o={requester:r,pairingTopic:e,id:t.id,cacaoPayload:i,verifyContext:n};await this.client.requests.set(t.id,o),this.handleAuthRequest(o)},this.handleAuthRequest=async e=>{let{id:t,pairingTopic:r,requester:i,cacaoPayload:s,verifyContext:n}=e;try{this.client.emit("auth_request",{id:t,topic:r,params:{requester:i,cacaoPayload:s},verifyContext:n})}catch(t){await this.sendError(e.id,e.pairingTopic,t),this.client.logger.error(t)}},this.onAuthResponse=async(e,t)=>{let{id:r}=t;if(this.client.logger.info({type:"onAuthResponse",topic:e,response:t}),gj(t)){let{pairingTopic:i}=this.client.pairingTopics.get(e);await this.client.core.pairing.activate({topic:i});let{s:s,p:n}=t.result;await this.client.requests.set(r,DN({id:r,pairingTopic:i},t.result));let o=this.formatMessage(n,n.iss);this.client.logger.debug(`reconstructed message:
`,JSON.stringify(o)),this.client.logger.debug("payload.iss:",n.iss),this.client.logger.debug("signature:",s);let a=wk(n.iss),h=function(e){let t=e&&wU(e);if(t)return t[2]+":"+t[3]}(n.iss);if(!a)throw Error("Could not derive address from `payload.iss`");if(!h)throw Error("Could not derive chainId from `payload.iss`");this.client.logger.debug("walletAddress extracted from `payload.iss`:",a),await wq(a,o,s,h,this.client.projectId)?this.client.emit("auth_response",{id:r,topic:e,params:t}):this.client.emit("auth_response",{id:r,topic:e,params:{message:"Invalid signature",code:-1}})}else gz(t)&&this.client.emit("auth_response",{id:r,topic:e,params:t})},this.getVerifyContext=async(e,t)=>{let r={verified:{verifyUrl:t.verifyUrl||"",validation:"UNKNOWN",origin:t.url||""}};try{let i=await this.client.core.verify.resolve({attestationId:e,verifyUrl:t.verifyUrl});i&&(r.verified.origin=i.origin,r.verified.isScam=i.isScam,r.verified.validation=origin===new URL(t.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.error(e)}return this.client.logger.info(`Verify context: ${JSON.stringify(r)}`),r}}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.client.core.relayer.on(gQ,async e=>{let{topic:t,message:r}=e,{responseTopic:i,publicKey:s}=this.client.authKeys.keys.includes(wL)?this.client.authKeys.get(wL):{responseTopic:void 0,publicKey:void 0};if(i&&t!==i)return void this.client.logger.debug("[Auth] Ignoring message from unknown topic",t);let n=await this.client.core.crypto.decode(t,r,{receiverPublicKey:s});gk(n)?(this.client.core.history.set(t,n),this.onRelayEventRequest({topic:t,payload:n})):gq(n)&&(await this.client.core.history.resolve(n),this.onRelayEventResponse({topic:t,payload:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(bn,e=>this.onPairingCreated(e))}}class DU extends wP{constructor(e){var t;super(e),this.protocol="wc",this.version=1,this.name=wN,this.events=new(0,a.EventEmitter),this.emit=(e,t)=>this.events.emit(e,t),this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.request=async(e,t)=>{try{return await this.engine.request(e,t)}catch(e){throw this.logger.error(e.message),e}},this.respond=async(e,t)=>{try{return await this.engine.respond(e,t)}catch(e){throw this.logger.error(e.message),e}},this.getPendingRequests=()=>{try{return this.engine.getPendingRequests()}catch(e){throw this.logger.error(e.message),e}},this.formatMessage=(e,t)=>{try{return this.engine.formatMessage(e,t)}catch(e){throw this.logger.error(e.message),e}};let r="u">typeof e.logger&&"string"!=typeof e.logger?e.logger:mX(mV(((e,t)=>{for(var r in t||(t={}))mW.call(t,r)&&mJ(e,r,t[r]);if(mG)for(var r of mG(t))mY.call(t,r)&&mJ(e,r,t[r]);return e})({},t={level:e.logger||"error"}),mH({level:t?.level||"info"})));this.name=e?.name||wN,this.metadata=e.metadata,this.projectId=e.projectId,this.core=e.core||new mC(e),this.logger=function(e,t,r=m$){let i=function(e,t,r=m$){let i=mZ(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=m$){return e[r]=t,e}(e.child({context:i}),i,r)}(r,this.name),this.authKeys=new y7(this.core,this.logger,"authKeys",wB,()=>wL),this.pairingTopics=new y7(this.core,this.logger,"pairingTopics",wB),this.requests=new y7(this.core,this.logger,"requests",wB,e=>e.id),this.engine=new DL(this)}static async init(e){let t=new DU(e);return await t.initialize(),t}get context(){return mZ(this.logger)}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.authKeys.init(),await this.requests.init(),await this.pairingTopics.init(),await this.engine.init(),this.logger.info("AuthClient Initialization Success"),this.logger.info({authClient:this})}catch(e){throw this.logger.info("AuthClient Initialization Failure"),this.logger.error(e.message),e}}}var Dk={};Dk=Dj;const Dq=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function Dj(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let s=e.browser.write||Dq;e.browser.write&&(e.browser.asObject=!0);let n=e.serializers||{},o=(t=e.browser.serialize,Array.isArray(t)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(n)),a=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(a=!1),"function"==typeof s&&(s.error=s.fatal=s.warn=s.info=s.debug=s.trace=s),!1===e.enabled&&(e.level="silent");let h=e.level||"info",c=Object.create(s);c.log||(c.log=DG),Object.defineProperty(c,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(c,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,Dz(u,c,"error","log"),Dz(u,c,"fatal","error"),Dz(u,c,"warn","error"),Dz(u,c,"info","log"),Dz(u,c,"debug","log"),Dz(u,c,"trace","log")}});let u={transmit:i,serialize:o,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?DW:DY};return c.levels=Dj.levels,c.level=h,c.setMaxListeners=c.getMaxListeners=c.emit=c.addListener=c.on=c.prependListener=c.once=c.prependOnceListener=c.removeListener=c.removeAllListeners=c.listeners=c.listenerCount=c.eventNames=c.write=c.flush=DG,c.serializers=n,c._serialize=o,c._stdErrSerialize=a,c.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},o&&t.serializers&&(r.serializers=t.serializers);let s=r.serializers;if(o&&s){var a=Object.assign({},n,s),h=!0===e.browser.serialize?Object.keys(a):o;delete t.serializers,DF([t],h,a,this._stdErrSerialize)}function c(e){this._childLevel=(0|e._childLevel)+1,this.error=D$(e,t,"error"),this.fatal=D$(e,t,"fatal"),this.warn=D$(e,t,"warn"),this.info=D$(e,t,"info"),this.debug=D$(e,t,"debug"),this.trace=D$(e,t,"trace"),a&&(this.serializers=a,this._serialize=h),i&&(this._logEvent=DK([].concat(e._logEvent.bindings,t)))}return c.prototype=this,new c(this)},i&&(c._logEvent=DK()),c}function Dz(e,t,r,i){let s=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?DG:s[r]?s[r]:Dq[r]||Dq[i]||DG,function(e,t,r){if(e.transmit||t[r]!==DG){var i;t[r]=(i=t[r],function(){let s=e.timestamp(),n=Array(arguments.length),o=Object.getPrototypeOf&&Object.getPrototypeOf(this)===Dq?Dq:this;for(var a=0;a<n.length;a++)n[a]=arguments[a];if(e.serialize&&!e.asObject&&DF(n,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?i.call(o,function(e,t,r,i){e._serialize&&DF(r,e._serialize,e.serializers,e._stdErrSerialize);let s=r.slice(),n=s[0],o={};i&&(o.time=i),o.level=Dj.levels.values[t];let a=(0|e._childLevel)+1;if(a<1&&(a=1),null!==n&&"object"==typeof n){for(;a--&&"object"==typeof s[0];)Object.assign(o,s.shift());n=s.length?eB(s.shift(),s):void 0}else"string"==typeof n&&(n=eB(s.shift(),s));return void 0!==n&&(o.msg=n),o}(this,r,n,s)):i.apply(o,n),e.transmit){let i=e.transmit.level||t.level,o=Dj.levels.values[i],a=Dj.levels.values[r];if(a<o)return;!function(e,t,r){let i=t.send,s=t.ts,n=t.methodLevel,o=t.methodValue,a=t.val,h=e._logEvent.bindings;DF(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return -1===h.indexOf(e)}),e._logEvent.level.label=n,e._logEvent.level.value=o,i(n,e._logEvent,a),e._logEvent=DK(h)}(this,{ts:s,methodLevel:r,methodValue:a,transmitLevel:i,transmitValue:Dj.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},n)}})}}(e,t,r)}function DF(e,t,r,i){for(let s in e)if(i&&e[s]instanceof Error)e[s]=Dj.stdSerializers.err(e[s]);else if("object"==typeof e[s]&&!Array.isArray(e[s]))for(let i in e[s])t&&t.indexOf(i)>-1&&i in r&&(e[s][i]=r[i](e[s][i]))}function D$(e,t,r){return function(){let i=Array(1+arguments.length);i[0]=t;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return e[r].apply(this,i)}}function DK(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function DV(){return{}}function DH(e){return e}function DG(){}function DW(){return!1}function DY(){return Date.now()}Dj.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},Dj.stdSerializers={mapHttpRequest:DV,mapHttpResponse:DV,wrapRequestSerializer:DH,wrapResponseSerializer:DH,wrapErrorSerializer:DH,req:DV,res:DV,err:function(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}},Dj.stdTimeFunctions=Object.assign({},{nullTime:DW,epochTime:DY,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}});const DJ="custom_context";class DZ{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class DX{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new DZ(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}class DQ{constructor(e,t=1024e3){this.level=e??"error",this.levelValue=Dk.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new DX(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===Dk.levels.values.error?console.error(e):t===Dk.levels.values.warn?console.warn(e):t===Dk.levels.values.debug?console.debug(e):t===Dk.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(e_({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new DX(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push(e_({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class D0{constructor(e,t=1024e3){this.baseChunkLogger=new DQ(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class D1{constructor(e,t=1024e3){this.baseChunkLogger=new DQ(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var D2=Object.defineProperty,D3=Object.defineProperties,D8=Object.getOwnPropertyDescriptors,D6=Object.getOwnPropertySymbols,D5=Object.prototype.hasOwnProperty,D4=Object.prototype.propertyIsEnumerable,D9=(e,t,r)=>t in e?D2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,D7=(e,t)=>{for(var r in t||(t={}))D5.call(t,r)&&D9(e,r,t[r]);if(D6)for(var r of D6(t))D4.call(t,r)&&D9(e,r,t[r]);return e},xe=(e,t)=>D3(e,D8(t));function xt(e){return xe(D7({},e),{level:e?.level||"info"})}function xr(e,t=DJ){return typeof e.bindings>"u"?function(e,t=DJ){return e[t]||""}(e,t):e.bindings().context||""}function xi(e,t,r=DJ){let i=function(e,t,r=DJ){let i=xr(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=DJ){return e[r]=t,e}(e.child({context:i}),i,r)}class xs extends _{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}class xn extends _{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}}class xo{constructor(e,t){this.logger=e,this.core=t}}class xa extends _{constructor(e,t){super(),this.relayer=e,this.logger=t}}class xh extends _{constructor(e){super()}}class xc{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class xu extends _{constructor(e,t){super(),this.relayer=e,this.logger=t}}class xl extends _{constructor(e,t){super(),this.core=e,this.logger=t}}class xf{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class xd{constructor(e,t){this.projectId=e,this.logger=t}}class xp{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}class xg{constructor(e){this.opts=e,this.protocol="wc",this.version=2}}a.EventEmitter;class xb{constructor(e){this.client=e}}var xy={};e(xy,"generateKeyPair",()=>Es),e(xy,"signJWT",()=>En),e(xy,"decodeJWT",()=>Ei),e(xy,"encodeIss",()=>Er);var xm={};Object.defineProperty(xm,"__esModule",{value:!0}),xm.convertSecretKeyToX25519=xm.convertPublicKeyToX25519=xm.verify=xm.sign=xm.extractPublicKeyFromSecretKey=xm.generateKeyPair=xm.generateKeyPairFromSeed=xm.SEED_LENGTH=xm.SECRET_KEY_LENGTH=xm.PUBLIC_KEY_LENGTH=xm.SIGNATURE_LENGTH=void 0;var xv={};Object.defineProperty(xv,"__esModule",{value:!0}),xv.DIGEST_LENGTH=64,xv.BLOCK_SIZE=128;var xw=function(){function e(){this.digestLength=xv.DIGEST_LENGTH,this.blockSize=xv.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._stateHi[0]=0x6a09e667,this._stateHi[1]=0xbb67ae85,this._stateHi[2]=0x3c6ef372,this._stateHi[3]=0xa54ff53a,this._stateHi[4]=0x510e527f,this._stateHi[5]=0x9b05688c,this._stateHi[6]=0x1f83d9ab,this._stateHi[7]=0x5be0cd19,this._stateLo[0]=0xf3bcc908,this._stateLo[1]=0x84caa73b,this._stateLo[2]=0xfe94f82b,this._stateLo[3]=0x5f1d36f1,this._stateLo[4]=0xade682d1,this._stateLo[5]=0x2b3e6c1f,this._stateLo[6]=0xfb41bd6b,this._stateLo[7]=0x137e2179},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){wu.wipe(this._buffer),wu.wipe(this._tempHi),wu.wipe(this._tempLo),this.reset()},e.prototype.update=function(e,t){if(void 0===t&&(t=e.length),this._finished)throw Error("SHA512: can't update because hash was finished.");var r=0;if(this._bytesHashed+=t,this._bufferLength>0){for(;this._bufferLength<xv.BLOCK_SIZE&&t>0;)this._buffer[this._bufferLength++]=e[r++],t--;this._bufferLength===this.blockSize&&(xx(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(t>=this.blockSize&&(r=xx(this._tempHi,this._tempLo,this._stateHi,this._stateLo,e,r,t),t%=this.blockSize);t>0;)this._buffer[this._bufferLength++]=e[r++],t--;return this},e.prototype.finish=function(e){if(!this._finished){var t=this._bytesHashed,r=this._bufferLength,i=t%128<112?128:256;this._buffer[r]=128;for(var s=r+1;s<i-8;s++)this._buffer[s]=0;wl.writeUint32BE(t/0x20000000|0,this._buffer,i-8),wl.writeUint32BE(t<<3,this._buffer,i-4),xx(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,i),this._finished=!0}for(var s=0;s<this.digestLength/8;s++)wl.writeUint32BE(this._stateHi[s],e,8*s),wl.writeUint32BE(this._stateLo[s],e,8*s+4);return this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(this._finished)throw Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(e){return this._stateHi.set(e.stateHi),this._stateLo.set(e.stateLo),this._bufferLength=e.bufferLength,e.buffer&&this._buffer.set(e.buffer),this._bytesHashed=e.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(e){wu.wipe(e.stateHi),wu.wipe(e.stateLo),e.buffer&&wu.wipe(e.buffer),e.bufferLength=0,e.bytesHashed=0},e}();xv.SHA512=xw;var xD=new Int32Array([0x428a2f98,0xd728ae22,0x71374491,0x23ef65cd,0xb5c0fbcf,0xec4d3b2f,0xe9b5dba5,0x8189dbbc,0x3956c25b,0xf348b538,0x59f111f1,0xb605d019,0x923f82a4,0xaf194f9b,0xab1c5ed5,0xda6d8118,0xd807aa98,0xa3030242,0x12835b01,0x45706fbe,0x243185be,0x4ee4b28c,0x550c7dc3,0xd5ffb4e2,0x72be5d74,0xf27b896f,0x80deb1fe,0x3b1696b1,0x9bdc06a7,0x25c71235,0xc19bf174,0xcf692694,0xe49b69c1,0x9ef14ad2,0xefbe4786,0x384f25e3,0xfc19dc6,0x8b8cd5b5,0x240ca1cc,0x77ac9c65,0x2de92c6f,0x592b0275,0x4a7484aa,0x6ea6e483,0x5cb0a9dc,0xbd41fbd4,0x76f988da,0x831153b5,0x983e5152,0xee66dfab,0xa831c66d,0x2db43210,0xb00327c8,0x98fb213f,0xbf597fc7,0xbeef0ee4,0xc6e00bf3,0x3da88fc2,0xd5a79147,0x930aa725,0x6ca6351,0xe003826f,0x14292967,0xa0e6e70,0x27b70a85,0x46d22ffc,0x2e1b2138,0x5c26c926,0x4d2c6dfc,0x5ac42aed,0x53380d13,0x9d95b3df,0x650a7354,0x8baf63de,0x766a0abb,0x3c77b2a8,0x81c2c92e,0x47edaee6,0x92722c85,0x1482353b,0xa2bfe8a1,0x4cf10364,0xa81a664b,0xbc423001,0xc24b8b70,0xd0f89791,0xc76c51a3,0x654be30,0xd192e819,0xd6ef5218,0xd6990624,0x5565a910,0xf40e3585,0x5771202a,0x106aa070,0x32bbd1b8,0x19a4c116,0xb8d2d0c8,0x1e376c08,0x5141ab53,0x2748774c,0xdf8eeb99,0x34b0bcb5,0xe19b48a8,0x391c0cb3,0xc5c95a63,0x4ed8aa4a,0xe3418acb,0x5b9cca4f,0x7763e373,0x682e6ff3,0xd6b2b8a3,0x748f82ee,0x5defb2fc,0x78a5636f,0x43172f60,0x84c87814,0xa1f0ab72,0x8cc70208,0x1a6439ec,0x90befffa,0x23631e28,0xa4506ceb,0xde82bde9,0xbef9a3f7,0xb2c67915,0xc67178f2,0xe372532b,0xca273ece,0xea26619c,0xd186b8c7,0x21c0c207,0xeada7dd6,0xcde0eb1e,0xf57d4f7f,0xee6ed178,0x6f067aa,0x72176fba,0xa637dc5,0xa2c898a6,0x113f9804,0xbef90dae,0x1b710b35,0x131c471b,0x28db77f5,0x23047d84,0x32caab7b,0x40c72493,0x3c9ebe0a,0x15c9bebc,0x431d67c4,0x9c100d4c,0x4cc5d4be,0xcb3e42b6,0x597f299c,0xfc657e2a,0x5fcb6fab,0x3ad6faec,0x6c44198c,0x4a475817]);function xx(e,t,r,i,s,n,o){for(var a,h,c,u,l,f,d,p,g=r[0],b=r[1],y=r[2],m=r[3],v=r[4],w=r[5],D=r[6],x=r[7],E=i[0],_=i[1],S=i[2],I=i[3],A=i[4],M=i[5],O=i[6],C=i[7];o>=128;){for(var P=0;P<16;P++){var R=8*P+n;e[P]=wl.readUint32BE(s,R),t[P]=wl.readUint32BE(s,R+4)}for(var P=0;P<80;P++){var T=g,N=b,B=y,L=m,U=v,k=w,q=D,j=x,z=E,F=_,$=S,K=I,V=A,H=M,G=O,W=C;if(a=x,l=65535&(h=C),f=h>>>16,d=65535&a,p=a>>>16,a=(v>>>14|A<<18)^(v>>>18|A<<14)^(A>>>9|v<<23),l+=65535&(h=(A>>>14|v<<18)^(A>>>18|v<<14)^(v>>>9|A<<23)),f+=h>>>16,d+=65535&a,p+=a>>>16,a=v&w^~v&D,l+=65535&(h=A&M^~A&O),f+=h>>>16,d+=65535&a,p+=a>>>16,a=xD[2*P],l+=65535&(h=xD[2*P+1]),f+=h>>>16,d+=65535&a,p+=a>>>16,a=e[P%16],l+=65535&(h=t[P%16]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,c=65535&d|p<<16,u=65535&l|f<<16,a=c,l=65535&(h=u),f=h>>>16,d=65535&a,p=a>>>16,a=(g>>>28|E<<4)^(E>>>2|g<<30)^(E>>>7|g<<25),l+=65535&(h=(E>>>28|g<<4)^(g>>>2|E<<30)^(g>>>7|E<<25)),f+=h>>>16,d+=65535&a,p+=a>>>16,a=g&b^g&y^b&y,l+=65535&(h=E&_^E&S^_&S),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,j=65535&d|p<<16,W=65535&l|f<<16,a=L,l=65535&(h=K),f=h>>>16,d=65535&a,p=a>>>16,a=c,l+=65535&(h=u),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,L=65535&d|p<<16,K=65535&l|f<<16,b=T,y=N,m=B,v=L,w=U,D=k,x=q,g=j,_=z,S=F,I=$,A=K,M=V,O=H,C=G,E=W,P%16==15)for(var R=0;R<16;R++)a=e[R],l=65535&(h=t[R]),f=h>>>16,d=65535&a,p=a>>>16,a=e[(R+9)%16],l+=65535&(h=t[(R+9)%16]),f+=h>>>16,d+=65535&a,p+=a>>>16,a=((c=e[(R+1)%16])>>>1|(u=t[(R+1)%16])<<31)^(c>>>8|u<<24)^c>>>7,l+=65535&(h=(u>>>1|c<<31)^(u>>>8|c<<24)^(u>>>7|c<<25)),f+=h>>>16,d+=65535&a,p+=a>>>16,a=((c=e[(R+14)%16])>>>19|(u=t[(R+14)%16])<<13)^(u>>>29|c<<3)^c>>>6,l+=65535&(h=(u>>>19|c<<13)^(c>>>29|u<<3)^(u>>>6|c<<26)),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,e[R]=65535&d|p<<16,t[R]=65535&l|f<<16}a=g,l=65535&(h=E),f=h>>>16,d=65535&a,p=a>>>16,a=r[0],l+=65535&(h=i[0]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[0]=g=65535&d|p<<16,i[0]=E=65535&l|f<<16,a=b,l=65535&(h=_),f=h>>>16,d=65535&a,p=a>>>16,a=r[1],l+=65535&(h=i[1]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[1]=b=65535&d|p<<16,i[1]=_=65535&l|f<<16,a=y,l=65535&(h=S),f=h>>>16,d=65535&a,p=a>>>16,a=r[2],l+=65535&(h=i[2]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[2]=y=65535&d|p<<16,i[2]=S=65535&l|f<<16,a=m,l=65535&(h=I),f=h>>>16,d=65535&a,p=a>>>16,a=r[3],l+=65535&(h=i[3]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[3]=m=65535&d|p<<16,i[3]=I=65535&l|f<<16,a=v,l=65535&(h=A),f=h>>>16,d=65535&a,p=a>>>16,a=r[4],l+=65535&(h=i[4]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[4]=v=65535&d|p<<16,i[4]=A=65535&l|f<<16,a=w,l=65535&(h=M),f=h>>>16,d=65535&a,p=a>>>16,a=r[5],l+=65535&(h=i[5]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[5]=w=65535&d|p<<16,i[5]=M=65535&l|f<<16,a=D,l=65535&(h=O),f=h>>>16,d=65535&a,p=a>>>16,a=r[6],l+=65535&(h=i[6]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[6]=D=65535&d|p<<16,i[6]=O=65535&l|f<<16,a=x,l=65535&(h=C),f=h>>>16,d=65535&a,p=a>>>16,a=r[7],l+=65535&(h=i[7]),f+=h>>>16,d+=65535&a,p+=a>>>16,f+=l>>>16,d+=f>>>16,p+=d>>>16,r[7]=x=65535&d|p<<16,i[7]=C=65535&l|f<<16,n+=128,o-=128}return n}function xE(e){let t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}xv.hash=function(e){var t=new xw;t.update(e);var r=t.digest();return t.clean(),r},xm.SIGNATURE_LENGTH=64,xm.PUBLIC_KEY_LENGTH=32,xm.SECRET_KEY_LENGTH=64,xm.SEED_LENGTH=32,new Uint8Array(32)[0]=9;const x_=xE(),xS=xE([1]),xI=xE([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),xA=xE([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),xM=xE([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),xO=xE([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),xC=xE([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function xP(e,t){for(let r=0;r<16;r++)e[r]=0|t[r]}function xR(e){let t=1;for(let r=0;r<16;r++){let i=e[r]+t+65535;t=Math.floor(i/65536),e[r]=i-65536*t}e[0]+=t-1+37*(t-1)}function xT(e,t,r){let i=~(r-1);for(let r=0;r<16;r++){let s=i&(e[r]^t[r]);e[r]^=s,t[r]^=s}}function xN(e,t){let r=xE(),i=xE();for(let e=0;e<16;e++)i[e]=t[e];xR(i),xR(i),xR(i);for(let e=0;e<2;e++){r[0]=i[0]-65517;for(let e=1;e<15;e++)r[e]=i[e]-65535-(r[e-1]>>16&1),r[e-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);let e=r[15]>>16&1;r[14]&=65535,xT(i,r,1-e)}for(let t=0;t<16;t++)e[2*t]=255&i[t],e[2*t+1]=i[t]>>8}function xB(e,t){let r=0;for(let i=0;i<32;i++)r|=e[i]^t[i];return(1&r-1>>>8)-1}function xL(e,t){let r=new Uint8Array(32),i=new Uint8Array(32);return xN(r,e),xN(i,t),xB(r,i)}function xU(e){let t=new Uint8Array(32);return xN(t,e),1&t[0]}function xk(e,t,r){for(let i=0;i<16;i++)e[i]=t[i]+r[i]}function xq(e,t,r){for(let i=0;i<16;i++)e[i]=t[i]-r[i]}function xj(e,t,r){let i,s,n=0,o=0,a=0,h=0,c=0,u=0,l=0,f=0,d=0,p=0,g=0,b=0,y=0,m=0,v=0,w=0,D=0,x=0,E=0,_=0,S=0,I=0,A=0,M=0,O=0,C=0,P=0,R=0,T=0,N=0,B=0,L=r[0],U=r[1],k=r[2],q=r[3],j=r[4],z=r[5],F=r[6],$=r[7],K=r[8],V=r[9],H=r[10],G=r[11],W=r[12],Y=r[13],J=r[14],Z=r[15];n+=(i=t[0])*L,o+=i*U,a+=i*k,h+=i*q,c+=i*j,u+=i*z,l+=i*F,f+=i*$,d+=i*K,p+=i*V,g+=i*H,b+=i*G,y+=i*W,m+=i*Y,v+=i*J,w+=i*Z,o+=(i=t[1])*L,a+=i*U,h+=i*k,c+=i*q,u+=i*j,l+=i*z,f+=i*F,d+=i*$,p+=i*K,g+=i*V,b+=i*H,y+=i*G,m+=i*W,v+=i*Y,w+=i*J,D+=i*Z,a+=(i=t[2])*L,h+=i*U,c+=i*k,u+=i*q,l+=i*j,f+=i*z,d+=i*F,p+=i*$,g+=i*K,b+=i*V,y+=i*H,m+=i*G,v+=i*W,w+=i*Y,D+=i*J,x+=i*Z,h+=(i=t[3])*L,c+=i*U,u+=i*k,l+=i*q,f+=i*j,d+=i*z,p+=i*F,g+=i*$,b+=i*K,y+=i*V,m+=i*H,v+=i*G,w+=i*W,D+=i*Y,x+=i*J,E+=i*Z,c+=(i=t[4])*L,u+=i*U,l+=i*k,f+=i*q,d+=i*j,p+=i*z,g+=i*F,b+=i*$,y+=i*K,m+=i*V,v+=i*H,w+=i*G,D+=i*W,x+=i*Y,E+=i*J,_+=i*Z,u+=(i=t[5])*L,l+=i*U,f+=i*k,d+=i*q,p+=i*j,g+=i*z,b+=i*F,y+=i*$,m+=i*K,v+=i*V,w+=i*H,D+=i*G,x+=i*W,E+=i*Y,_+=i*J,S+=i*Z,l+=(i=t[6])*L,f+=i*U,d+=i*k,p+=i*q,g+=i*j,b+=i*z,y+=i*F,m+=i*$,v+=i*K,w+=i*V,D+=i*H,x+=i*G,E+=i*W,_+=i*Y,S+=i*J,I+=i*Z,f+=(i=t[7])*L,d+=i*U,p+=i*k,g+=i*q,b+=i*j,y+=i*z,m+=i*F,v+=i*$,w+=i*K,D+=i*V,x+=i*H,E+=i*G,_+=i*W,S+=i*Y,I+=i*J,A+=i*Z,d+=(i=t[8])*L,p+=i*U,g+=i*k,b+=i*q,y+=i*j,m+=i*z,v+=i*F,w+=i*$,D+=i*K,x+=i*V,E+=i*H,_+=i*G,S+=i*W,I+=i*Y,A+=i*J,M+=i*Z,p+=(i=t[9])*L,g+=i*U,b+=i*k,y+=i*q,m+=i*j,v+=i*z,w+=i*F,D+=i*$,x+=i*K,E+=i*V,_+=i*H,S+=i*G,I+=i*W,A+=i*Y,M+=i*J,O+=i*Z,g+=(i=t[10])*L,b+=i*U,y+=i*k,m+=i*q,v+=i*j,w+=i*z,D+=i*F,x+=i*$,E+=i*K,_+=i*V,S+=i*H,I+=i*G,A+=i*W,M+=i*Y,O+=i*J,C+=i*Z,b+=(i=t[11])*L,y+=i*U,m+=i*k,v+=i*q,w+=i*j,D+=i*z,x+=i*F,E+=i*$,_+=i*K,S+=i*V,I+=i*H,A+=i*G,M+=i*W,O+=i*Y,C+=i*J,P+=i*Z,y+=(i=t[12])*L,m+=i*U,v+=i*k,w+=i*q,D+=i*j,x+=i*z,E+=i*F,_+=i*$,S+=i*K,I+=i*V,A+=i*H,M+=i*G,O+=i*W,C+=i*Y,P+=i*J,R+=i*Z,m+=(i=t[13])*L,v+=i*U,w+=i*k,D+=i*q,x+=i*j,E+=i*z,_+=i*F,S+=i*$,I+=i*K,A+=i*V,M+=i*H,O+=i*G,C+=i*W,P+=i*Y,R+=i*J,T+=i*Z,v+=(i=t[14])*L,w+=i*U,D+=i*k,x+=i*q,E+=i*j,_+=i*z,S+=i*F,I+=i*$,A+=i*K,M+=i*V,O+=i*H,C+=i*G,P+=i*W,R+=i*Y,T+=i*J,N+=i*Z,w+=(i=t[15])*L,D+=i*U,x+=i*k,E+=i*q,_+=i*j,S+=i*z,I+=i*F,A+=i*$,M+=i*K,O+=i*V,C+=i*H,P+=i*G,R+=i*W,T+=i*Y,N+=i*J,B+=i*Z,n+=38*D,o+=38*x,a+=38*E,h+=38*_,c+=38*S,u+=38*I,l+=38*A,f+=38*M,d+=38*O,p+=38*C,g+=38*P,b+=38*R,y+=38*T,m+=38*N,v+=38*B,s=Math.floor((i=n+(s=1)+65535)/65536),n=i-65536*s,s=Math.floor((i=o+s+65535)/65536),o=i-65536*s,s=Math.floor((i=a+s+65535)/65536),a=i-65536*s,s=Math.floor((i=h+s+65535)/65536),h=i-65536*s,s=Math.floor((i=c+s+65535)/65536),c=i-65536*s,s=Math.floor((i=u+s+65535)/65536),u=i-65536*s,s=Math.floor((i=l+s+65535)/65536),l=i-65536*s,s=Math.floor((i=f+s+65535)/65536),f=i-65536*s,s=Math.floor((i=d+s+65535)/65536),d=i-65536*s,s=Math.floor((i=p+s+65535)/65536),p=i-65536*s,s=Math.floor((i=g+s+65535)/65536),g=i-65536*s,s=Math.floor((i=b+s+65535)/65536),b=i-65536*s,s=Math.floor((i=y+s+65535)/65536),y=i-65536*s,s=Math.floor((i=m+s+65535)/65536),m=i-65536*s,s=Math.floor((i=v+s+65535)/65536),v=i-65536*s,s=Math.floor((i=w+s+65535)/65536),w=i-65536*s,n+=s-1+37*(s-1),s=Math.floor((i=n+(s=1)+65535)/65536),n=i-65536*s,s=Math.floor((i=o+s+65535)/65536),o=i-65536*s,s=Math.floor((i=a+s+65535)/65536),a=i-65536*s,s=Math.floor((i=h+s+65535)/65536),h=i-65536*s,s=Math.floor((i=c+s+65535)/65536),c=i-65536*s,s=Math.floor((i=u+s+65535)/65536),u=i-65536*s,s=Math.floor((i=l+s+65535)/65536),l=i-65536*s,s=Math.floor((i=f+s+65535)/65536),f=i-65536*s,s=Math.floor((i=d+s+65535)/65536),d=i-65536*s,s=Math.floor((i=p+s+65535)/65536),p=i-65536*s,s=Math.floor((i=g+s+65535)/65536),g=i-65536*s,s=Math.floor((i=b+s+65535)/65536),b=i-65536*s,s=Math.floor((i=y+s+65535)/65536),y=i-65536*s,s=Math.floor((i=m+s+65535)/65536),m=i-65536*s,s=Math.floor((i=v+s+65535)/65536),v=i-65536*s,s=Math.floor((i=w+s+65535)/65536),w=i-65536*s,n+=s-1+37*(s-1),e[0]=n,e[1]=o,e[2]=a,e[3]=h,e[4]=c,e[5]=u,e[6]=l,e[7]=f,e[8]=d,e[9]=p,e[10]=g,e[11]=b,e[12]=y,e[13]=m,e[14]=v,e[15]=w}function xz(e,t){let r,i=xE();for(r=0;r<16;r++)i[r]=t[r];for(r=253;r>=0;r--)xj(i,i,i),2!==r&&4!==r&&xj(i,i,t);for(r=0;r<16;r++)e[r]=i[r]}function xF(e,t){let r=xE(),i=xE(),s=xE(),n=xE(),o=xE(),a=xE(),h=xE(),c=xE(),u=xE();xq(r,e[1],e[0]),xq(u,t[1],t[0]),xj(r,r,u),xk(i,e[0],e[1]),xk(u,t[0],t[1]),xj(i,i,u),xj(s,e[3],t[3]),xj(s,s,xA),xj(n,e[2],t[2]),xk(n,n,n),xq(o,i,r),xq(a,n,s),xk(h,n,s),xk(c,i,r),xj(e[0],o,a),xj(e[1],c,h),xj(e[2],h,a),xj(e[3],o,c)}function x$(e,t,r){for(let i=0;i<4;i++)xT(e[i],t[i],r)}function xK(e,t){let r=xE(),i=xE(),s=xE();xz(s,t[2]),xj(r,t[0],s),xj(i,t[1],s),xN(e,i),e[31]^=xU(r)<<7}function xV(e,t,r){xP(e[0],x_),xP(e[1],xS),xP(e[2],xS),xP(e[3],x_);for(let i=255;i>=0;--i){let s=r[i/8|0]>>(7&i)&1;x$(e,t,s),xF(t,e),xF(e,e),x$(e,t,s)}}function xH(e,t){let r=[xE(),xE(),xE(),xE()];xP(r[0],xM),xP(r[1],xO),xP(r[2],xS),xj(r[3],xM,xO),xV(e,r,t)}function xG(e){if(e.length!==xm.SEED_LENGTH)throw Error(`ed25519: seed must be ${xm.SEED_LENGTH} bytes`);let t=(0,xv.hash)(e);t[0]&=248,t[31]&=127,t[31]|=64;let r=new Uint8Array(32),i=[xE(),xE(),xE(),xE()];xH(i,t),xK(r,i);let s=new Uint8Array(64);return s.set(e),s.set(r,32),{publicKey:r,secretKey:s}}xm.generateKeyPairFromSeed=xG,xm.generateKeyPair=function(e){let t=(0,wo.randomBytes)(32,e),r=xG(t);return(0,wu.wipe)(t),r},xm.extractPublicKeyFromSecretKey=function(e){if(e.length!==xm.SECRET_KEY_LENGTH)throw Error(`ed25519: secret key must be ${xm.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(e.subarray(32))};const xW=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function xY(e,t){let r,i,s,n;for(i=63;i>=32;--i){for(r=0,s=i-32,n=i-12;s<n;++s)t[s]+=r-16*t[i]*xW[s-(i-32)],r=Math.floor((t[s]+128)/256),t[s]-=256*r;t[s]+=r,t[i]=0}for(s=0,r=0;s<32;s++)t[s]+=r-(t[31]>>4)*xW[s],r=t[s]>>8,t[s]&=255;for(s=0;s<32;s++)t[s]-=r*xW[s];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function xJ(e){let t=new Float64Array(64);for(let r=0;r<64;r++)t[r]=e[r];for(let t=0;t<64;t++)e[t]=0;xY(e,t)}function xZ(e,t){let r,i=xE(),s=xE(),n=xE(),o=xE(),a=xE(),h=xE(),c=xE();xP(e[2],xS);var u,l,f,d=e[1];for(let e=0;e<16;e++)d[e]=t[2*e]+(t[2*e+1]<<8);d[15]&=32767,xj(n,u=e[1],u),xj(o,n,xI),xq(n,n,e[2]),xk(o,e[2],o),xj(a,o,o),xj(h,a,a),xj(c,h,a),xj(i,c,n),xj(i,i,o);let p=xE();for(r=0;r<16;r++)p[r]=i[r];for(r=250;r>=0;r--)xj(p,p,p),1!==r&&xj(p,p,i);for(r=0;r<16;r++)i[r]=p[r];return(xj(i,i,n),xj(i,i,o),xj(i,i,o),xj(e[0],i,o),xj(s,l=e[0],l),xj(s,s,o),xL(s,n)&&xj(e[0],e[0],xC),xj(s,f=e[0],f),xj(s,s,o),xL(s,n))?-1:(xU(e[0])===t[31]>>7&&xq(e[0],x_,e[0]),xj(e[3],e[0],e[1]),0)}xm.sign=function(e,t){let r=new Float64Array(64),i=[xE(),xE(),xE(),xE()],s=(0,xv.hash)(e.subarray(0,32));s[0]&=248,s[31]&=127,s[31]|=64;let n=new Uint8Array(64);n.set(s.subarray(32),32);let o=new xv.SHA512;o.update(n.subarray(32)),o.update(t);let a=o.digest();o.clean(),xJ(a),xH(i,a),xK(n,i),o.reset(),o.update(n.subarray(0,32)),o.update(e.subarray(32)),o.update(t);let h=o.digest();xJ(h);for(let e=0;e<32;e++)r[e]=a[e];for(let e=0;e<32;e++)for(let t=0;t<32;t++)r[e+t]+=h[e]*s[t];return xY(n.subarray(32),r),n},xm.verify=function(e,t,r){let i=new Uint8Array(32),s=[xE(),xE(),xE(),xE()],n=[xE(),xE(),xE(),xE()];if(r.length!==xm.SIGNATURE_LENGTH)throw Error(`ed25519: signature must be ${xm.SIGNATURE_LENGTH} bytes`);if(xZ(n,e))return!1;let o=new xv.SHA512;o.update(r.subarray(0,32)),o.update(e),o.update(t);let a=o.digest();return xJ(a),xV(s,n,a),xH(n,r.subarray(32)),xF(s,n),xK(i,s),!xB(r,i)},xm.convertPublicKeyToX25519=function(e){let t=[xE(),xE(),xE(),xE()];if(xZ(t,e))throw Error("Ed25519: invalid public key");let r=xE(),i=xE(),s=t[1];xk(r,xS,s),xq(i,xS,s),xz(i,i),xj(r,r,i);let n=new Uint8Array(32);return xN(n,r),n},xm.convertSecretKeyToX25519=function(e){let t=(0,xv.hash)(e.subarray(0,32));t[0]&=248,t[31]&=127,t[31]|=64;let r=new Uint8Array(t.subarray(0,32));return(0,wu.wipe)(t),r};const xX="base64url",xQ="utf8",x0="utf8",x1="base58btc";var x2={};Object.defineProperty(x2,"__esModule",{value:!0});var x3={};Object.defineProperty(x3,"__esModule",{value:!0}),x3.alloc=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.alloc?globalThis.Buffer.alloc(e):new Uint8Array(e)},x3.allocUnsafe=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)},x2.concat=function(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=x3.allocUnsafe(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return r};var x8={};Object.defineProperty(x8,"__esModule",{value:!0});var x6={};function x5(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}const x4=x5("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),x9=x5("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=x3.allocUnsafe(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t});x6={utf8:x4,"utf-8":x4,hex:hm.bases.base16,latin1:x9,ascii:x9,binary:x9,...hm.bases},x8.toString=function(e,t="utf8"){let r=x6[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)};var x7={};function Ee(e){return eE((0,x8.toString)((0,x7.fromString)(e,xX),xQ))}function Et(e){return(0,x8.toString)((0,x7.fromString)(e_(e),xQ),xX)}function Er(e){let t=(0,x7.fromString)("K36",x1);return["did:key","z"+(0,x8.toString)((0,x2.concat)([t,e]),x1)].join(":")}function Ei(e){var t;let r=e.split("."),i=Ee(r[0]),s=Ee(r[1]);return{header:i,payload:s,signature:(t=r[2],(0,x7.fromString)(t,xX)),data:(0,x7.fromString)(r.slice(0,2).join("."),x0)}}function Es(e=(0,wo.randomBytes)(32)){return xm.generateKeyPairFromSeed(e)}async function En(e,t,r,i,s=(0,x.fromMiliseconds)(Date.now())){var n,o,a;let h={alg:"EdDSA",typ:"JWT"},c={iss:Er(i.publicKey),sub:e,aud:t,iat:s,exp:s+r},u=(n={header:h,payload:c},(0,x7.fromString)([Et(n.header),Et(n.payload)].join("."),x0));return[Et((o={header:h,payload:c,signature:xm.sign(i.secretKey,u)}).header),Et(o.payload),(a=o.signature,(0,x8.toString)(a,xX))].join(".")}Object.defineProperty(x7,"__esModule",{value:!0}),x7.fromString=function(e,t="utf8"){let r=x6[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)},Object.keys(A9={}).forEach(function(e){"default"===e||"__esModule"===e||Object.prototype.hasOwnProperty.call(xy,e)||Object.defineProperty(xy,e,{enumerable:!0,get:function(){return A9[e]}})});var Eo={};Eo=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`);var Ea={},Eh="%[a-f0-9]{2}",Ec=RegExp("("+Eh+")|([^%]+?)","gi"),Eu=RegExp("("+Eh+")+","gi");Ea=function(e){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"","%FF%FE":""},r=Eu.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch(e){var i=function(e){try{return decodeURIComponent(e)}catch(i){for(var t=e.match(Ec)||[],r=1;r<t.length;r++)t=(e=(function e(t,r){try{return[decodeURIComponent(t.join(""))]}catch(e){}if(1===t.length)return t;r=r||1;var i=t.slice(0,r),s=t.slice(r);return Array.prototype.concat.call([],e(i),e(s))})(t,r).join("")).match(Ec)||[];return e}}(r[0]);i!==r[0]&&(t[r[0]]=i)}r=Eu.exec(e)}t["%C2"]="";for(var s=Object.keys(t),n=0;n<s.length;n++){var o=s[n];e=e.replace(RegExp(o,"g"),t[o])}return e}(e)}};var El={};El=(e,t)=>{if("string"!=typeof e||"string"!=typeof t)throw TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];let r=e.indexOf(t);return -1===r?[e]:[e.slice(0,r),e.slice(r+t.length)]};function Ef(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function Ed(e,t){return t.encode?t.strict?Eo(e):encodeURIComponent(e):e}function Ep(e,t){return t.decode?Ea(e):e}Symbol("encodeFragmentIdentifier");function Eg(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())&&(e="true"===e.toLowerCase()),e}function Eb(e,t){Ef((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);let r=function(e){let t;switch(e.arrayFormat){case"index":return(e,r,i)=>{if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t){i[e]=r;return}void 0===i[e]&&(i[e]={}),i[e][t[1]]=r};case"bracket":return(e,r,i)=>{if(t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),!t){i[e]=r;return}if(void 0===i[e]){i[e]=[r];return}i[e]=[].concat(i[e],r)};case"colon-list-separator":return(e,r,i)=>{if(t=/(:list)$/.exec(e),e=e.replace(/:list$/,""),!t){i[e]=r;return}if(void 0===i[e]){i[e]=[r];return}i[e]=[].concat(i[e],r)};case"comma":case"separator":return(t,r,i)=>{let s="string"==typeof r&&r.includes(e.arrayFormatSeparator),n="string"==typeof r&&!s&&Ep(r,e).includes(e.arrayFormatSeparator);r=n?Ep(r,e):r;let o=s||n?r.split(e.arrayFormatSeparator).map(t=>Ep(t,e)):null===r?r:Ep(r,e);i[t]=o};case"bracket-separator":return(t,r,i)=>{let s=/(\[\])$/.test(t);if(t=t.replace(/\[\]$/,""),!s){i[t]=r?Ep(r,e):r;return}let n=null===r?[]:r.split(e.arrayFormatSeparator).map(t=>Ep(t,e));if(void 0===i[t]){i[t]=n;return}i[t]=[].concat(i[t],n)};default:return(e,t,r)=>{if(void 0===r[e]){r[e]=t;return}r[e]=[].concat(r[e],t)}}}(t),i=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return i;for(let s of e.split("&")){if(""===s)continue;let[e,n]=El(t.decode?s.replace(/\+/g," "):s,"=");n=void 0===n?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?n:Ep(n,t),r(Ep(e,t),n,i)}for(let e of Object.keys(i)){let r=i[e];if("object"==typeof r&&null!==r)for(let e of Object.keys(r))r[e]=Eg(r[e],t);else i[e]=Eg(r,t)}return!1===t.sort?i:(!0===t.sort?Object.keys(i).sort():Object.keys(i).sort(t.sort)).reduce((e,t)=>{let r=i[t];return r&&"object"==typeof r&&!Array.isArray(r)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(r):e[t]=r,e},Object.create(null))}function Ey(e){return"string"==typeof e&&(e=vp(e)),vl(vi([vp("\x19Ethereum Signed Message:\n"),vp(String(e.length)),e]))}Mp=(e,t)=>{if(!e)return"";Ef((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);let r=r=>t.skipNull&&null==e[r]||t.skipEmptyString&&""===e[r],i=function(e){switch(e.arrayFormat){case"index":return t=>(r,i)=>{let s=r.length;return void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:null===i?[...r,Ed(t,e)+"["+s+"]"]:[...r,Ed(t,e)+"["+Ed(s,e)+"]="+Ed(i,e)]};case"bracket":return t=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:null===i?[...r,Ed(t,e)+"[]"]:[...r,Ed(t,e)+"[]="+Ed(i,e)];case"colon-list-separator":return t=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:null===i?[...r,Ed(t,e)+":list="]:[...r,Ed(t,e)+":list="+Ed(i,e)];case"comma":case"separator":case"bracket-separator":{let t="bracket-separator"===e.arrayFormat?"[]=":"=";return r=>(i,s)=>void 0===s||e.skipNull&&null===s||e.skipEmptyString&&""===s?i:(s=null===s?"":s,0===i.length)?[[Ed(r,e),t,Ed(s,e)].join("")]:[[i,Ed(s,e)].join(e.arrayFormatSeparator)]}default:return t=>(r,i)=>void 0===i||e.skipNull&&null===i||e.skipEmptyString&&""===i?r:null===i?[...r,Ed(t,e)]:[...r,Ed(t,e)+"="+Ed(i,e)]}}(t),s={};for(let t of Object.keys(e))r(t)||(s[t]=e[t]);let n=Object.keys(s);return!1!==t.sort&&n.sort(t.sort),n.map(r=>{let s=e[r];return void 0===s?"":null===s?Ed(r,t):Array.isArray(s)?0===s.length&&"bracket-separator"===t.arrayFormat?Ed(r,t)+"[]":s.reduce(i(r),[]).join("&"):Ed(r,t)+"="+Ed(s,t)}).filter(e=>e.length>0).join("&")},new m5("transactions/5.7.0"),(A7=Mg||(Mg={}))[A7.legacy=0]="legacy",A7[A7.eip2930=1]="eip2930",A7[A7.eip1559=2]="eip1559";var Em={};Object.defineProperty(Em,"__esModule",{value:!0});var Ev={};function Ew(e,t,r,i,s){if(void 0===s&&(s=0),32!==e.length)throw Error("ChaCha: key size must be 32 bytes");if(i.length<r.length)throw Error("ChaCha: destination is shorter than source");if(0===s){if(8!==t.length&&12!==t.length)throw Error("ChaCha nonce must be 8 or 12 bytes");o=(n=new Uint8Array(16)).length-t.length,n.set(t,o)}else{if(16!==t.length)throw Error("ChaCha nonce with counter must be 16 bytes");n=t,o=s}for(var n,o,a=new Uint8Array(64),h=0;h<r.length;h+=64){!function(e,t,r){for(var i=r[3]<<24|r[2]<<16|r[1]<<8|r[0],s=r[7]<<24|r[6]<<16|r[5]<<8|r[4],n=r[11]<<24|r[10]<<16|r[9]<<8|r[8],o=r[15]<<24|r[14]<<16|r[13]<<8|r[12],a=r[19]<<24|r[18]<<16|r[17]<<8|r[16],h=r[23]<<24|r[22]<<16|r[21]<<8|r[20],c=r[27]<<24|r[26]<<16|r[25]<<8|r[24],u=r[31]<<24|r[30]<<16|r[29]<<8|r[28],l=t[3]<<24|t[2]<<16|t[1]<<8|t[0],f=t[7]<<24|t[6]<<16|t[5]<<8|t[4],d=t[11]<<24|t[10]<<16|t[9]<<8|t[8],p=t[15]<<24|t[14]<<16|t[13]<<8|t[12],g=0x61707865,b=0x3320646e,y=0x79622d32,m=0x6b206574,v=i,w=s,D=n,x=o,E=a,_=h,S=c,I=u,A=l,M=f,O=d,C=p,P=0;P<20;P+=2)A^=g=g+v|0,v^=E=E+(A=A>>>16|A<<16)|0,v=v>>>20|v<<12,M^=b=b+w|0,w^=_=_+(M=M>>>16|M<<16)|0,w=w>>>20|w<<12,O^=y=y+D|0,D^=S=S+(O=O>>>16|O<<16)|0,D=D>>>20|D<<12,C^=m=m+x|0,x^=I=I+(C=C>>>16|C<<16)|0,x=x>>>20|x<<12,O^=y=y+D|0,D^=S=S+(O=O>>>24|O<<8)|0,D=D>>>25|D<<7,C^=m=m+x|0,x^=I=I+(C=C>>>24|C<<8)|0,x=x>>>25|x<<7,M^=b=b+w|0,w^=_=_+(M=M>>>24|M<<8)|0,w=w>>>25|w<<7,A^=g=g+v|0,v^=E=E+(A=A>>>24|A<<8)|0,v=v>>>25|v<<7,C^=g=g+w|0,w^=S=S+(C=C>>>16|C<<16)|0,w=w>>>20|w<<12,A^=b=b+D|0,D^=I=I+(A=A>>>16|A<<16)|0,D=D>>>20|D<<12,M^=y=y+x|0,x^=E=E+(M=M>>>16|M<<16)|0,x=x>>>20|x<<12,O^=m=m+v|0,v^=_=_+(O=O>>>16|O<<16)|0,v=v>>>20|v<<12,M^=y=y+x|0,x^=E=E+(M=M>>>24|M<<8)|0,x=x>>>25|x<<7,O^=m=m+v|0,v^=_=_+(O=O>>>24|O<<8)|0,v=v>>>25|v<<7,A^=b=b+D|0,D^=I=I+(A=A>>>24|A<<8)|0,D=D>>>25|D<<7,C^=g=g+w|0,w^=S=S+(C=C>>>24|C<<8)|0,w=w>>>25|w<<7;wl.writeUint32LE(g+0x61707865|0,e,0),wl.writeUint32LE(b+0x3320646e|0,e,4),wl.writeUint32LE(y+0x79622d32|0,e,8),wl.writeUint32LE(m+0x6b206574|0,e,12),wl.writeUint32LE(v+i|0,e,16),wl.writeUint32LE(w+s|0,e,20),wl.writeUint32LE(D+n|0,e,24),wl.writeUint32LE(x+o|0,e,28),wl.writeUint32LE(E+a|0,e,32),wl.writeUint32LE(_+h|0,e,36),wl.writeUint32LE(S+c|0,e,40),wl.writeUint32LE(I+u|0,e,44),wl.writeUint32LE(A+l|0,e,48),wl.writeUint32LE(M+f|0,e,52),wl.writeUint32LE(O+d|0,e,56),wl.writeUint32LE(C+p|0,e,60)}(a,n,e);for(var c=h;c<h+64&&c<r.length;c++)i[c]=r[c]^a[c-h];for(var u=n,l=0,f=o,d=1;f--;)d=d+(255&u[l])|0,u[l]=255&d,d>>>=8,l++;if(d>0)throw Error("ChaCha: counter overflow")}return wu.wipe(a),0===s&&wu.wipe(n),i}Object.defineProperty(Ev,"__esModule",{value:!0}),Ev.streamXOR=Ew,Ev.stream=function(e,t,r,i){return void 0===i&&(i=0),wu.wipe(r),Ew(e,t,r,r,i)};var ED={};Object.defineProperty(ED,"__esModule",{value:!0});var Ex={};function EE(e,t){if(e.length!==t.length)return 0;for(var r=0,i=0;i<e.length;i++)r|=e[i]^t[i];return 1&r-1>>>8}Object.defineProperty(Ex,"__esModule",{value:!0}),Ex.select=function(e,t,r){return~(e-1)&t|e-1&r},Ex.lessOrEqual=function(e,t){return(0|e)-(0|t)-1>>>31&1},Ex.compare=EE,Ex.equal=function(e,t){return 0!==e.length&&0!==t.length&&0!==EE(e,t)},ED.DIGEST_LENGTH=16;var E_=function(){function e(e){this.digestLength=ED.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var t=e[0]|e[1]<<8;this._r[0]=8191&t;var r=e[2]|e[3]<<8;this._r[1]=(t>>>13|r<<3)&8191;var i=e[4]|e[5]<<8;this._r[2]=(r>>>10|i<<6)&7939;var s=e[6]|e[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var n=e[8]|e[9]<<8;this._r[4]=(s>>>4|n<<12)&255,this._r[5]=n>>>1&8190;var o=e[10]|e[11]<<8;this._r[6]=(n>>>14|o<<2)&8191;var a=e[12]|e[13]<<8;this._r[7]=(o>>>11|a<<5)&8065;var h=e[14]|e[15]<<8;this._r[8]=(a>>>8|h<<8)&8191,this._r[9]=h>>>5&127,this._pad[0]=e[16]|e[17]<<8,this._pad[1]=e[18]|e[19]<<8,this._pad[2]=e[20]|e[21]<<8,this._pad[3]=e[22]|e[23]<<8,this._pad[4]=e[24]|e[25]<<8,this._pad[5]=e[26]|e[27]<<8,this._pad[6]=e[28]|e[29]<<8,this._pad[7]=e[30]|e[31]<<8}return e.prototype._blocks=function(e,t,r){for(var i=2048*!this._fin,s=this._h[0],n=this._h[1],o=this._h[2],a=this._h[3],h=this._h[4],c=this._h[5],u=this._h[6],l=this._h[7],f=this._h[8],d=this._h[9],p=this._r[0],g=this._r[1],b=this._r[2],y=this._r[3],m=this._r[4],v=this._r[5],w=this._r[6],D=this._r[7],x=this._r[8],E=this._r[9];r>=16;){var _,S=e[t+0]|e[t+1]<<8;s+=8191&S;var I=e[t+2]|e[t+3]<<8;n+=(S>>>13|I<<3)&8191;var A=e[t+4]|e[t+5]<<8;o+=(I>>>10|A<<6)&8191;var M=e[t+6]|e[t+7]<<8;a+=(A>>>7|M<<9)&8191;var O=e[t+8]|e[t+9]<<8;h+=(M>>>4|O<<12)&8191,c+=O>>>1&8191;var C=e[t+10]|e[t+11]<<8;u+=(O>>>14|C<<2)&8191;var P=e[t+12]|e[t+13]<<8;l+=(C>>>11|P<<5)&8191;var R=e[t+14]|e[t+15]<<8;f+=(P>>>8|R<<8)&8191,d+=R>>>5|i;var T=0;T=(_=0+s*p+5*E*n+5*x*o+5*D*a+5*w*h)>>>13,_&=8191,_+=5*v*c,_+=5*m*u,_+=5*y*l,_+=5*b*f,_+=5*g*d,T+=_>>>13,_&=8191;var N=T;N+=s*g,N+=n*p,N+=5*E*o,N+=5*x*a,N+=5*D*h,T=N>>>13,N&=8191,N+=5*w*c,N+=5*v*u,N+=5*m*l,N+=5*y*f,N+=5*b*d,T+=N>>>13,N&=8191;var B=T;B+=s*b,B+=n*g,B+=o*p,B+=5*E*a,B+=5*x*h,T=B>>>13,B&=8191,B+=5*D*c,B+=5*w*u,B+=5*v*l,B+=5*m*f,B+=5*y*d,T+=B>>>13,B&=8191;var L=T;L+=s*y,L+=n*b,L+=o*g,L+=a*p,L+=5*E*h,T=L>>>13,L&=8191,L+=5*x*c,L+=5*D*u,L+=5*w*l,L+=5*v*f,L+=5*m*d,T+=L>>>13,L&=8191;var U=T;U+=s*m,U+=n*y,U+=o*b,U+=a*g,U+=h*p,T=U>>>13,U&=8191,U+=5*E*c,U+=5*x*u,U+=5*D*l,U+=5*w*f,U+=5*v*d,T+=U>>>13,U&=8191;var k=T;k+=s*v,k+=n*m,k+=o*y,k+=a*b,k+=h*g,T=k>>>13,k&=8191,k+=c*p,k+=5*E*u,k+=5*x*l,k+=5*D*f,k+=5*w*d,T+=k>>>13,k&=8191;var q=T;q+=s*w,q+=n*v,q+=o*m,q+=a*y,q+=h*b,T=q>>>13,q&=8191,q+=c*g,q+=u*p,q+=5*E*l,q+=5*x*f,q+=5*D*d,T+=q>>>13,q&=8191;var j=T;j+=s*D,j+=n*w,j+=o*v,j+=a*m,j+=h*y,T=j>>>13,j&=8191,j+=c*b,j+=u*g,j+=l*p,j+=5*E*f,j+=5*x*d,T+=j>>>13,j&=8191;var z=T;z+=s*x,z+=n*D,z+=o*w,z+=a*v,z+=h*m,T=z>>>13,z&=8191,z+=c*y,z+=u*b,z+=l*g,z+=f*p,z+=5*E*d,T+=z>>>13,z&=8191;var F=T;F+=s*E,F+=n*x,F+=o*D,F+=a*w,F+=h*v,T=F>>>13,F&=8191,F+=c*m,F+=u*y,F+=l*b,F+=f*g,F+=d*p,T+=F>>>13,F&=8191,_=8191&(T=(T=(T<<2)+T|0)+_|0),T>>>=13,N+=T,s=_,n=N,o=B,a=L,h=U,c=k,u=q,l=j,f=z,d=F,t+=16,r-=16}this._h[0]=s,this._h[1]=n,this._h[2]=o,this._h[3]=a,this._h[4]=h,this._h[5]=c,this._h[6]=u,this._h[7]=l,this._h[8]=f,this._h[9]=d},e.prototype.finish=function(e,t){void 0===t&&(t=0);var r,i,s,n,o=new Uint16Array(10);if(this._leftover){for(n=this._leftover,this._buffer[n++]=1;n<16;n++)this._buffer[n]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(r=this._h[1]>>>13,this._h[1]&=8191,n=2;n<10;n++)this._h[n]+=r,r=this._h[n]>>>13,this._h[n]&=8191;for(this._h[0]+=5*r,r=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=r,r=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=r,o[0]=this._h[0]+5,r=o[0]>>>13,o[0]&=8191,n=1;n<10;n++)o[n]=this._h[n]+r,r=o[n]>>>13,o[n]&=8191;for(o[9]-=8192,i=(1^r)-1,n=0;n<10;n++)o[n]&=i;for(n=0,i=~i;n<10;n++)this._h[n]=this._h[n]&i|o[n];for(n=1,this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,s=this._h[0]+this._pad[0],this._h[0]=65535&s;n<8;n++)s=(this._h[n]+this._pad[n]|0)+(s>>>16)|0,this._h[n]=65535&s;return e[t+0]=this._h[0]>>>0,e[t+1]=this._h[0]>>>8,e[t+2]=this._h[1]>>>0,e[t+3]=this._h[1]>>>8,e[t+4]=this._h[2]>>>0,e[t+5]=this._h[2]>>>8,e[t+6]=this._h[3]>>>0,e[t+7]=this._h[3]>>>8,e[t+8]=this._h[4]>>>0,e[t+9]=this._h[4]>>>8,e[t+10]=this._h[5]>>>0,e[t+11]=this._h[5]>>>8,e[t+12]=this._h[6]>>>0,e[t+13]=this._h[6]>>>8,e[t+14]=this._h[7]>>>0,e[t+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(e){var t,r=0,i=e.length;if(this._leftover){(t=16-this._leftover)>i&&(t=i);for(var s=0;s<t;s++)this._buffer[this._leftover+s]=e[r+s];if(i-=t,r+=t,this._leftover+=t,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(i>=16&&(t=i-i%16,this._blocks(e,r,t),r+=t,i-=t),i){for(var s=0;s<i;s++)this._buffer[this._leftover+s]=e[r+s];this._leftover+=i}return this},e.prototype.digest=function(){if(this._finished)throw Error("Poly1305 was finished");var e=new Uint8Array(16);return this.finish(e),e},e.prototype.clean=function(){return wu.wipe(this._buffer),wu.wipe(this._r),wu.wipe(this._h),wu.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();ED.Poly1305=E_,ED.oneTimeAuth=function(e,t){var r=new E_(e);r.update(t);var i=r.digest();return r.clean(),i},ED.equal=function(e,t){return e.length===ED.DIGEST_LENGTH&&t.length===ED.DIGEST_LENGTH&&Ex.equal(e,t)},Em.KEY_LENGTH=32,Em.NONCE_LENGTH=12,Em.TAG_LENGTH=16;var ES=new Uint8Array(16),EI=function(){function e(e){if(this.nonceLength=Em.NONCE_LENGTH,this.tagLength=Em.TAG_LENGTH,e.length!==Em.KEY_LENGTH)throw Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(e)}return e.prototype.seal=function(e,t,r,i){if(e.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");var s,n=new Uint8Array(16);n.set(e,n.length-e.length);var o=new Uint8Array(32);Ev.stream(this._key,n,o,4);var a=t.length+this.tagLength;if(i){if(i.length!==a)throw Error("ChaCha20Poly1305: incorrect destination length");s=i}else s=new Uint8Array(a);return Ev.streamXOR(this._key,n,t,s,4),this._authenticate(s.subarray(s.length-this.tagLength,s.length),o,s.subarray(0,s.length-this.tagLength),r),wu.wipe(n),s},e.prototype.open=function(e,t,r,i){if(e.length>16)throw Error("ChaCha20Poly1305: incorrect nonce length");if(t.length<this.tagLength)return null;var s,n=new Uint8Array(16);n.set(e,n.length-e.length);var o=new Uint8Array(32);Ev.stream(this._key,n,o,4);var a=new Uint8Array(this.tagLength);if(this._authenticate(a,o,t.subarray(0,t.length-this.tagLength),r),!Ex.equal(a,t.subarray(t.length-this.tagLength,t.length)))return null;var h=t.length-this.tagLength;if(i){if(i.length!==h)throw Error("ChaCha20Poly1305: incorrect destination length");s=i}else s=new Uint8Array(h);return Ev.streamXOR(this._key,n,t.subarray(0,t.length-this.tagLength),s,4),wu.wipe(n),s},e.prototype.clean=function(){return wu.wipe(this._key),this},e.prototype._authenticate=function(e,t,r,i){var s=new ED.Poly1305(t);i&&(s.update(i),i.length%16>0&&s.update(ES.subarray(i.length%16))),s.update(r),r.length%16>0&&s.update(ES.subarray(r.length%16));var n=new Uint8Array(8);i&&wl.writeUint64LE(i.length,n),s.update(n),wl.writeUint64LE(r.length,n),s.update(n);for(var o=s.digest(),a=0;a<o.length;a++)e[a]=o[a];s.clean(),wu.wipe(o),wu.wipe(n)},e}();Em.ChaCha20Poly1305=EI;var EA={};Object.defineProperty(EA,"__esModule",{value:!0});var EM={};Object.defineProperty(EM,"__esModule",{value:!0});var EO={};Object.defineProperty(EO,"__esModule",{value:!0}),EO.isSerializableHash=function(e){return void 0!==e.saveState&&void 0!==e.restoreState&&void 0!==e.cleanSavedState};var EC=function(){function e(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var r=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(r).clean():r.set(t);for(var i=0;i<r.length;i++)r[i]^=54;this._inner.update(r);for(var i=0;i<r.length;i++)r[i]^=106;this._outer.update(r),EO.isSerializableHash(this._inner)&&EO.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),wu.wipe(r)}return e.prototype.reset=function(){if(!EO.isSerializableHash(this._inner)||!EO.isSerializableHash(this._outer))throw Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){EO.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),EO.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(e){return this._inner.update(e),this},e.prototype.finish=function(e){return this._finished?this._outer.finish(e):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0),this},e.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},e.prototype.saveState=function(){if(!EO.isSerializableHash(this._inner))throw Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(e){if(!EO.isSerializableHash(this._inner)||!EO.isSerializableHash(this._outer))throw Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(e){if(!EO.isSerializableHash(this._inner))throw Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},e}();EM.HMAC=EC,EM.hmac=function(e,t,r){var i=new EC(e,t);i.update(r);var s=i.digest();return i.clean(),s},EM.equal=Ex.equal,EA.HKDF=function(){function e(e,t,r,i){void 0===r&&(r=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=i;var s=EM.hmac(this._hash,r,t);this._hmac=new EM.HMAC(e,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(0===e)throw Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(e){for(var t=new Uint8Array(e),r=0;r<t.length;r++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[r]=this._buffer[this._bufpos++];return t},e.prototype.clean=function(){this._hmac.clean(),wu.wipe(this._buffer),wu.wipe(this._counter),this._bufpos=0},e}();var EP={};function ER(e){let t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}Object.defineProperty(EP,"__esModule",{value:!0}),EP.sharedKey=EP.generateKeyPair=EP.generateKeyPairFromSeed=EP.scalarMultBase=EP.scalarMult=EP.SHARED_KEY_LENGTH=EP.SECRET_KEY_LENGTH=EP.PUBLIC_KEY_LENGTH=void 0,EP.PUBLIC_KEY_LENGTH=32,EP.SECRET_KEY_LENGTH=32,EP.SHARED_KEY_LENGTH=32;const ET=new Uint8Array(32);ET[0]=9;const EN=ER([56129,1]);function EB(e){let t=1;for(let r=0;r<16;r++){let i=e[r]+t+65535;t=Math.floor(i/65536),e[r]=i-65536*t}e[0]+=t-1+37*(t-1)}function EL(e,t,r){let i=~(r-1);for(let r=0;r<16;r++){let s=i&(e[r]^t[r]);e[r]^=s,t[r]^=s}}function EU(e,t,r){for(let i=0;i<16;i++)e[i]=t[i]+r[i]}function Ek(e,t,r){for(let i=0;i<16;i++)e[i]=t[i]-r[i]}function Eq(e,t,r){let i,s,n=0,o=0,a=0,h=0,c=0,u=0,l=0,f=0,d=0,p=0,g=0,b=0,y=0,m=0,v=0,w=0,D=0,x=0,E=0,_=0,S=0,I=0,A=0,M=0,O=0,C=0,P=0,R=0,T=0,N=0,B=0,L=r[0],U=r[1],k=r[2],q=r[3],j=r[4],z=r[5],F=r[6],$=r[7],K=r[8],V=r[9],H=r[10],G=r[11],W=r[12],Y=r[13],J=r[14],Z=r[15];n+=(i=t[0])*L,o+=i*U,a+=i*k,h+=i*q,c+=i*j,u+=i*z,l+=i*F,f+=i*$,d+=i*K,p+=i*V,g+=i*H,b+=i*G,y+=i*W,m+=i*Y,v+=i*J,w+=i*Z,o+=(i=t[1])*L,a+=i*U,h+=i*k,c+=i*q,u+=i*j,l+=i*z,f+=i*F,d+=i*$,p+=i*K,g+=i*V,b+=i*H,y+=i*G,m+=i*W,v+=i*Y,w+=i*J,D+=i*Z,a+=(i=t[2])*L,h+=i*U,c+=i*k,u+=i*q,l+=i*j,f+=i*z,d+=i*F,p+=i*$,g+=i*K,b+=i*V,y+=i*H,m+=i*G,v+=i*W,w+=i*Y,D+=i*J,x+=i*Z,h+=(i=t[3])*L,c+=i*U,u+=i*k,l+=i*q,f+=i*j,d+=i*z,p+=i*F,g+=i*$,b+=i*K,y+=i*V,m+=i*H,v+=i*G,w+=i*W,D+=i*Y,x+=i*J,E+=i*Z,c+=(i=t[4])*L,u+=i*U,l+=i*k,f+=i*q,d+=i*j,p+=i*z,g+=i*F,b+=i*$,y+=i*K,m+=i*V,v+=i*H,w+=i*G,D+=i*W,x+=i*Y,E+=i*J,_+=i*Z,u+=(i=t[5])*L,l+=i*U,f+=i*k,d+=i*q,p+=i*j,g+=i*z,b+=i*F,y+=i*$,m+=i*K,v+=i*V,w+=i*H,D+=i*G,x+=i*W,E+=i*Y,_+=i*J,S+=i*Z,l+=(i=t[6])*L,f+=i*U,d+=i*k,p+=i*q,g+=i*j,b+=i*z,y+=i*F,m+=i*$,v+=i*K,w+=i*V,D+=i*H,x+=i*G,E+=i*W,_+=i*Y,S+=i*J,I+=i*Z,f+=(i=t[7])*L,d+=i*U,p+=i*k,g+=i*q,b+=i*j,y+=i*z,m+=i*F,v+=i*$,w+=i*K,D+=i*V,x+=i*H,E+=i*G,_+=i*W,S+=i*Y,I+=i*J,A+=i*Z,d+=(i=t[8])*L,p+=i*U,g+=i*k,b+=i*q,y+=i*j,m+=i*z,v+=i*F,w+=i*$,D+=i*K,x+=i*V,E+=i*H,_+=i*G,S+=i*W,I+=i*Y,A+=i*J,M+=i*Z,p+=(i=t[9])*L,g+=i*U,b+=i*k,y+=i*q,m+=i*j,v+=i*z,w+=i*F,D+=i*$,x+=i*K,E+=i*V,_+=i*H,S+=i*G,I+=i*W,A+=i*Y,M+=i*J,O+=i*Z,g+=(i=t[10])*L,b+=i*U,y+=i*k,m+=i*q,v+=i*j,w+=i*z,D+=i*F,x+=i*$,E+=i*K,_+=i*V,S+=i*H,I+=i*G,A+=i*W,M+=i*Y,O+=i*J,C+=i*Z,b+=(i=t[11])*L,y+=i*U,m+=i*k,v+=i*q,w+=i*j,D+=i*z,x+=i*F,E+=i*$,_+=i*K,S+=i*V,I+=i*H,A+=i*G,M+=i*W,O+=i*Y,C+=i*J,P+=i*Z,y+=(i=t[12])*L,m+=i*U,v+=i*k,w+=i*q,D+=i*j,x+=i*z,E+=i*F,_+=i*$,S+=i*K,I+=i*V,A+=i*H,M+=i*G,O+=i*W,C+=i*Y,P+=i*J,R+=i*Z,m+=(i=t[13])*L,v+=i*U,w+=i*k,D+=i*q,x+=i*j,E+=i*z,_+=i*F,S+=i*$,I+=i*K,A+=i*V,M+=i*H,O+=i*G,C+=i*W,P+=i*Y,R+=i*J,T+=i*Z,v+=(i=t[14])*L,w+=i*U,D+=i*k,x+=i*q,E+=i*j,_+=i*z,S+=i*F,I+=i*$,A+=i*K,M+=i*V,O+=i*H,C+=i*G,P+=i*W,R+=i*Y,T+=i*J,N+=i*Z,w+=(i=t[15])*L,D+=i*U,x+=i*k,E+=i*q,_+=i*j,S+=i*z,I+=i*F,A+=i*$,M+=i*K,O+=i*V,C+=i*H,P+=i*G,R+=i*W,T+=i*Y,N+=i*J,B+=i*Z,n+=38*D,o+=38*x,a+=38*E,h+=38*_,c+=38*S,u+=38*I,l+=38*A,f+=38*M,d+=38*O,p+=38*C,g+=38*P,b+=38*R,y+=38*T,m+=38*N,v+=38*B,s=Math.floor((i=n+(s=1)+65535)/65536),n=i-65536*s,s=Math.floor((i=o+s+65535)/65536),o=i-65536*s,s=Math.floor((i=a+s+65535)/65536),a=i-65536*s,s=Math.floor((i=h+s+65535)/65536),h=i-65536*s,s=Math.floor((i=c+s+65535)/65536),c=i-65536*s,s=Math.floor((i=u+s+65535)/65536),u=i-65536*s,s=Math.floor((i=l+s+65535)/65536),l=i-65536*s,s=Math.floor((i=f+s+65535)/65536),f=i-65536*s,s=Math.floor((i=d+s+65535)/65536),d=i-65536*s,s=Math.floor((i=p+s+65535)/65536),p=i-65536*s,s=Math.floor((i=g+s+65535)/65536),g=i-65536*s,s=Math.floor((i=b+s+65535)/65536),b=i-65536*s,s=Math.floor((i=y+s+65535)/65536),y=i-65536*s,s=Math.floor((i=m+s+65535)/65536),m=i-65536*s,s=Math.floor((i=v+s+65535)/65536),v=i-65536*s,s=Math.floor((i=w+s+65535)/65536),w=i-65536*s,n+=s-1+37*(s-1),s=Math.floor((i=n+(s=1)+65535)/65536),n=i-65536*s,s=Math.floor((i=o+s+65535)/65536),o=i-65536*s,s=Math.floor((i=a+s+65535)/65536),a=i-65536*s,s=Math.floor((i=h+s+65535)/65536),h=i-65536*s,s=Math.floor((i=c+s+65535)/65536),c=i-65536*s,s=Math.floor((i=u+s+65535)/65536),u=i-65536*s,s=Math.floor((i=l+s+65535)/65536),l=i-65536*s,s=Math.floor((i=f+s+65535)/65536),f=i-65536*s,s=Math.floor((i=d+s+65535)/65536),d=i-65536*s,s=Math.floor((i=p+s+65535)/65536),p=i-65536*s,s=Math.floor((i=g+s+65535)/65536),g=i-65536*s,s=Math.floor((i=b+s+65535)/65536),b=i-65536*s,s=Math.floor((i=y+s+65535)/65536),y=i-65536*s,s=Math.floor((i=m+s+65535)/65536),m=i-65536*s,s=Math.floor((i=v+s+65535)/65536),v=i-65536*s,s=Math.floor((i=w+s+65535)/65536),w=i-65536*s,n+=s-1+37*(s-1),e[0]=n,e[1]=o,e[2]=a,e[3]=h,e[4]=c,e[5]=u,e[6]=l,e[7]=f,e[8]=d,e[9]=p,e[10]=g,e[11]=b,e[12]=y,e[13]=m,e[14]=v,e[15]=w}function Ej(e,t){let r=new Uint8Array(32),i=new Float64Array(80),s=ER(),n=ER(),o=ER(),a=ER(),h=ER(),c=ER();for(let t=0;t<31;t++)r[t]=e[t];r[31]=127&e[31]|64,r[0]&=248;for(let e=0;e<16;e++)i[e]=t[2*e]+(t[2*e+1]<<8);i[15]&=32767;for(let e=0;e<16;e++)n[e]=i[e];s[0]=a[0]=1;for(let e=254;e>=0;--e){let t=r[e>>>3]>>>(7&e)&1;EL(s,n,t),EL(o,a,t),EU(h,s,o),Ek(s,s,o),EU(o,n,a),Ek(n,n,a),Eq(a,h,h),Eq(c,s,s),Eq(s,o,s),Eq(o,n,h),EU(h,s,o),Ek(s,s,o),Eq(n,s,s),Ek(o,a,c),Eq(s,o,EN),EU(s,s,a),Eq(o,o,s),Eq(s,a,c),Eq(a,n,i),Eq(n,h,h),EL(s,n,t),EL(o,a,t)}for(let e=0;e<16;e++)i[e+16]=s[e],i[e+32]=o[e],i[e+48]=n[e],i[e+64]=a[e];let u=i.subarray(32),l=i.subarray(16);!function(e,t){let r=ER();for(let e=0;e<16;e++)r[e]=t[e];for(let e=253;e>=0;e--)Eq(r,r,r),2!==e&&4!==e&&Eq(r,r,t);for(let t=0;t<16;t++)e[t]=r[t]}(u,u),Eq(l,l,u);let f=new Uint8Array(32);return!function(e,t){let r=ER(),i=ER();for(let e=0;e<16;e++)i[e]=t[e];EB(i),EB(i),EB(i);for(let e=0;e<2;e++){r[0]=i[0]-65517;for(let e=1;e<15;e++)r[e]=i[e]-65535-(r[e-1]>>16&1),r[e-1]&=65535;r[15]=i[15]-32767-(r[14]>>16&1);let e=r[15]>>16&1;r[14]&=65535,EL(i,r,1-e)}for(let t=0;t<16;t++)e[2*t]=255&i[t],e[2*t+1]=i[t]>>8}(f,l),f}function Ez(e){return Ej(e,ET)}function EF(e){if(e.length!==EP.SECRET_KEY_LENGTH)throw Error(`x25519: seed must be ${EP.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(e);return{publicKey:Ez(t),secretKey:t}}EP.scalarMult=Ej,EP.scalarMultBase=Ez,EP.generateKeyPairFromSeed=EF,EP.generateKeyPair=function(e){let t=(0,wo.randomBytes)(32,e),r=EF(t);return(0,wu.wipe)(t),r},EP.sharedKey=function(e,t,r=!1){if(e.length!==EP.PUBLIC_KEY_LENGTH)throw Error("X25519: incorrect secret key length");if(t.length!==EP.PUBLIC_KEY_LENGTH)throw Error("X25519: incorrect public key length");let i=Ej(e,t);if(r){let e=0;for(let t=0;t<i.length;t++)e|=i[t];if(0===e)throw Error("X25519: invalid shared key")}return i};var E$={};Object.defineProperty(E$,"__esModule",{value:!0});var EK={};Object.defineProperty(EK,"__esModule",{value:!0}),EK.compare=function(e,t){for(let r=0;r<e.byteLength;r++){if(e[r]<t[r])return -1;if(e[r]>t[r])return 1}return e.byteLength>t.byteLength?1:e.byteLength<t.byteLength?-1:0};var EV={};Object.defineProperty(EV,"__esModule",{value:!0}),EV.equals=function(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0};var EH={};Object.defineProperty(EH,"__esModule",{value:!0}),EH.xor=function(e,t){if(e.length!==t.length)throw Error("Inputs should have the same length");let r=x3.allocUnsafe(e.length);for(let i=0;i<e.length;i++)r[i]=e[i]^t[i];return r},E$.compare=EK.compare,E$.concat=x2.concat,E$.equals=EV.equals,E$.fromString=x7.fromString,E$.toString=x8.toString,E$.xor=EH.xor;var EG={};function EW(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function EY(e,t){return e.includes(":")?[e]:t.chains||[]}EG.version=n("5Jl2z").version,EG.utils=n("85hQD"),EG.rand=n("7JHF0"),EG.curve=n("eOn6d"),EG.curves=n("3HkkL"),EG.ec=n("hkMcO"),EG.eddsa=n("4kGlE");var EJ=Object.defineProperty,EZ=Object.getOwnPropertySymbols,EX=Object.prototype.hasOwnProperty,EQ=Object.prototype.propertyIsEnumerable,E0=(e,t,r)=>t in e?EJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E1=(e,t)=>{for(var r in t||(t={}))EX.call(t,r)&&E0(e,r,t[r]);if(EZ)for(var r of EZ(t))EQ.call(t,r)&&E0(e,r,t[r]);return e};const E2="react-native",E3="browser";function E8(){return!(0,sh.getDocument)()&&!!(0,sh.getNavigator)()&&"ReactNative"===navigator.product}function E6(){return!!(0,sh.getNavigator)()&&!!(0,sh.getDocument)()}function E5(){return E8()?E2:E6()?E3:"unknown"}function E4(){return(0,sl.getWindowMetadata)()||{name:"",description:"",url:"",icons:[""]}}function E9(e,r,i){let s=function(){if(E5()===E2&&"u">typeof t&&"u">typeof(null==t?void 0:t.Platform)){let{OS:e,Version:r}=t.Platform;return[e,r].join("-")}let e=so();if(null===e)return"unknown";let r=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[r,e.name,e.version].join("-"):[r,e.version].join("-")}(),n=function(){var e;let t=E5();return t===E3?[t,(null==(e=(0,sh.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,r].join("-"),["js",i].join("-"),s,n].join("/")}function E7(e,t){return e.filter(e=>t.includes(e)).length===e.length}function _e(e){return Object.fromEntries(e.entries())}function _t(e){return new Map(Object.entries(e))}function _r(e=x.FIVE_MINUTES,t){let r,i,s,n=(0,x.toMiliseconds)(e||x.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,o)=>{s=setTimeout(()=>{o(Error(t))},n),r=e,i=o})}}function _i(e,t,r){return new Promise(async(i,s)=>{let n=setTimeout(()=>s(Error(r)),t);try{let t=await e;i(t)}catch(e){s(e)}clearTimeout(n)})}function _s(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function _n(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function _o(e,t){return(0,x.fromMiliseconds)((t||Date.now())+(0,x.toMiliseconds)(e))}function _a(e){return Date.now()>=(0,x.toMiliseconds)(e)}function _h(e,t){return`${e}${t?`:${t}`:""}`}async function _c({id:e,topic:r,wcDeepLink:i}){var s;try{if(!i)return;let n="string"==typeof i?JSON.parse(i):i,o=n?.href;if("string"!=typeof o)return;let a=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let r=F.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else s=`${s}/wc?${i}`;return s}(o,e,r),h=E5();if(h===E3){if(!(null!=(s=(0,sh.getDocument)())&&s.hasFocus()))return void console.warn("Document does not have focus, skipping deeplink.");a.startsWith("https://")||a.startsWith("http://")?window.open(a,"_blank","noreferrer noopener"):window.open(a,"u">typeof window&&(window.TelegramWebviewProxy||window.Telegram||window.TelegramWebviewProxyProto)?"_blank":"_self","noreferrer noopener")}else h===E2&&"u">typeof(null==t?void 0:t.Linking)&&await t.Linking.openURL(a)}catch(e){console.error(e)}}async function _u(e,t){let r="";try{if(E6()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function _l(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function _f(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function _d(e){return F.from(e,"base64").toString("utf-8")}async function _p(e,t,r,i,s,n){switch(r.t){case"eip191":var o,a,h,c,u;return o=e,a=t,h=r.s,(c=Ey(a),u=h,vC(va(vl(va(ws(wi(vr(c),u)),1)),12))).toLowerCase()===o.toLowerCase();case"eip1271":return await _g(e,t,r.s,i,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function _g(e,t,r,i,s,n){let o=EW(i);if(!o.namespace||!o.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let o="0x1626ba7e",a=r.substring(2),h=Ey(t).substring(2),c=o+h+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+a,u=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:c},"latest"]})}),{result:l}=await u.json();return!!l&&l.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var _b=Object.defineProperty,_y=Object.defineProperties,_m=Object.getOwnPropertyDescriptors,_v=Object.getOwnPropertySymbols,_w=Object.prototype.hasOwnProperty,_D=Object.prototype.propertyIsEnumerable,_x=(e,t,r)=>t in e?_b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;const _E=e=>e?.split(":"),__=e=>{let t=e&&_E(e);if(t)return t[2]+":"+t[3]},_S=e=>{let t=e&&_E(e);if(t)return t.pop()};async function _I(e){let{cacao:t,projectId:r}=e,{s:i,p:s}=t,n=_A(s,s.iss),o=_S(s.iss);return await _p(o,n,i,__(s.iss),r)}const _A=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=_S(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${(e=>{let t=e&&_E(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]})(t)}`,h=`Nonce: ${e.nonce}`,c=`Issued At: ${e.iat}`,u=e.exp?`Expiration Time: ${e.exp}`:void 0,l=e.nbf?`Not Before: ${e.nbf}`:void 0,f=e.requestId?`Request ID: ${e.requestId}`:void 0,d=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,p=_T(e.resources);return p&&(s=function(e="",t){_M(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],s=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let n={};r.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let o=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));i.push(o.join(", ").replace(".,","."))});let n=i.join(" "),o=`${r}${n}`;return`${e?e+" ":""}${o}`}(s,_C(p))),[r,i,"",s,"",n,o,a,h,c,u,l,f,d].filter(e=>null!=e).join(`
`)};function _M(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function _O(e){return _M(e),`urn:recap:${F.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function _C(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(F.from(t,"base64").toString("utf-8")));return _M(r),r}function _P(e){var t;let r=_C(e);_M(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function _R(e){let t=_C(e);_M(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function _T(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}const _N="base10",_B="base16",_L="base64pad",_U="base64url",_k="utf8";function _q(){let e=(0,wo.randomBytes)(32);return(0,E$.toString)(e,_B)}function _j(e){let t=(0,wI.hash)((0,E$.fromString)(e,_B));return(0,E$.toString)(t,_B)}function _z(e){let t=(0,wI.hash)((0,E$.fromString)(e,_k));return(0,E$.toString)(t,_B)}function _F(e){return(0,E$.fromString)(`${e}`,_N)}function _$(e){return Number((0,E$.toString)(e,_N))}function _K(e){let{encoding:t=_L}=e;if(2===_$(e.type))return(0,E$.toString)((0,E$.concat)([e.type,e.sealed]),t);if(1===_$(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return(0,E$.toString)((0,E$.concat)([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return(0,E$.toString)((0,E$.concat)([e.type,e.iv,e.sealed]),t)}function _V(e){let{encoded:t,encoding:r=_L}=e,i=(0,E$.fromString)(t,r),s=i.slice(0,1);if(1===_$(s)){let e=i.slice(1,33),t=i.slice(33,45);return{type:s,sealed:i.slice(45),iv:t,senderPublicKey:e}}if(2===_$(s))return{type:s,sealed:i.slice(1),iv:(0,wo.randomBytes)(12)};let n=i.slice(1,13);return{type:s,sealed:i.slice(13),iv:n}}function _H(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function _G(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function _W(e){return e?.relay||{protocol:"irn"}}function _Y(e){let t=cL[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}var _J=Object.defineProperty,_Z=Object.defineProperties,_X=Object.getOwnPropertyDescriptors,_Q=Object.getOwnPropertySymbols,_0=Object.prototype.hasOwnProperty,_1=Object.prototype.propertyIsEnumerable,_2=(e,t,r)=>t in e?_J(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_3=(e,t)=>{for(var r in t||(t={}))_0.call(t,r)&&_2(e,r,t[r]);if(_Q)for(var r of _Q(t))_1.call(t,r)&&_2(e,r,t[r]);return e};function _8(e){var t;if(!e.includes("wc:")){let t=_d(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,r),n=e.substring(r+1,i).split("@"),o=Eb("u">typeof i?e.substring(i):""),a="string"==typeof o.methods?o.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:o.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let s=t.replace(i,""),n=e[t];r[s]=n}}),r}(o),methods:a,expiryTimestamp:o.expiryTimestamp?parseInt(o.expiryTimestamp,10):void 0}}function _6(e){return`${e.protocol}:${e.topic}@${e.version}?`+Mp(_3(_Z(_3({symKey:e.symKey},function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay)),_X({expiryTimestamp:e.expiryTimestamp})),e.methods?{methods:e.methods.join(",")}:{}))}function _5(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}function _4(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function _9(e,t){let r=function(e){let t={};return e?.forEach(e=>{let[r,i]=e.split(":");t[r]||(t[r]={accounts:[],chains:[],events:[]}),t[r].accounts.push(e),t[r].chains.push(`${r}:${i}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,i]of Object.entries(r))i.methods?i.methods=function(e=[],t=[]){return[...new Set([...e,...t])]}(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;const _7={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Se={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function St(e,t){let{message:r,code:i}=Se[e];return{message:t?`${r} ${t}`:r,code:i}}function Sr(e,t){let{message:r,code:i}=_7[e];return{message:t?`${r} ${t}`:r,code:i}}function Si(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function Ss(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function Sn(e){return typeof e>"u"}function So(e,t){return!!(t&&Sn(e))||"string"==typeof e&&!!e.trim().length}function Sa(e,t){return!!(t&&Sn(e))||"number"==typeof e&&!isNaN(e)}function Sh(e){return!!(So(e,!1)&&e.includes(":"))&&2===e.split(":").length}function Sc(e){let t=!0;return Si(e)?e.length&&(t=e.every(e=>So(e,!1))):t=!1,t}function Su(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let s;if(r)return;let n=(i=`${t}, namespace`,s=null,Sc(e?.methods)?Sc(e?.events)||(s=Sr("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):s=Sr("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),s);n&&(r=n)}),r}function Sl(e,t){let r=null;if(e&&Ss(e)){let i,s=Su(e,t);s&&(r=s);let n=(i=null,Object.values(e).forEach(e=>{var r,s;let n;if(i)return;let o=(r=e?.accounts,s=`${t} namespace`,n=null,Si(r)?r.forEach(e=>{n||function(e){if(So(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&Sh(e)}}return!1}(e)||(n=Sr("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=Sr("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);o&&(i=o)}),i);n&&(r=n)}else r=St("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Sf(e){return So(e.protocol,!0)}function Sd(e){return"u">typeof e}function Sp(e,t){return!(!Sh(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(..._4(e.accounts))}),t})(e).includes(t))}function Sg(e,t,r){let i=null,s=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=_4(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(s),a=Object.keys(n),h=Sb(Object.keys(e)),c=Sb(Object.keys(t)),u=h.filter(e=>!c.includes(e));return u.length&&(i=St("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${u.toString()}
      Received: ${Object.keys(t).toString()}`)),E7(o,a)||(i=St("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let s=_4(t[e].accounts);s.includes(e)||(i=St("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),o.forEach(e=>{i||(E7(s[e].methods,n[e].methods)?E7(s[e].events,n[e].events)||(i=St("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=St("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function Sb(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function Sy(){let e=E5();return new Promise(t=>{switch(e){case E3:t(E6()&&navigator?.onLine);break;case E2:t(Sm());break;default:t(!0)}})}async function Sm(){if(E8()&&"u">typeof t&&null!=t&&t.NetInfo){let e=await (null==t?void 0:t.NetInfo.fetch());return e?.isConnected}return!0}const Sv={};class Sw{static get(e){return Sv[e]}static set(e,t){Sv[e]=t}static delete(e){delete Sv[e]}}const SD=e=>e.split("?")[0],Sx="u">typeof WebSocket?WebSocket:"u">typeof t&&"u">typeof t.WebSocket?t.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:n("fvaAM");class SE{constructor(e){if(this.url=e,this.events=new(0,a.EventEmitter),this.registering=!1,!gB(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u")return void t(Error("Connection already closed"));this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(e_(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!gB(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{let s=new URLSearchParams(e).get("origin"),n=(0,gS.isReactNative)()?{headers:{origin:s}}:{rejectUnauthorized:!gL(e)},o=new Sx(e,[],n);"u">typeof WebSocket||"u">typeof t&&"u">typeof t.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket?o.onerror=e=>{i(this.emitError(e.error))}:o.on("error",e=>{i(this.emitError(e))}),o.onopen=()=>{this.onOpen(o),r(o)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?eE(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=gP(e,r.message||r.toString());this.events.emit("payload",i)}parseError(e,t=this.url){return g_(e,SD(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){let t=this.parseError(Error(e?.message||`WebSocket connection failed for host: ${SD(this.url)}`));return this.events.emit("register_error",t),t}}var S_=n("6cqMT");const SS="core",SI=`wc@2:${SS}:`,SA={database:":memory:"},SM="client_ed25519_seed",SO=x.ONE_DAY,SC=x.SIX_HOURS,SP="wss://relay.walletconnect.org",SR="relayer_message",ST="relayer_message_ack",SN="relayer_connection_stalled",SB="relayer_publish",SL="payload",SU="connect",Sk="disconnect",Sq="error",Sj="2.17.1",Sz="link_mode",SF="relay",S$="WALLETCONNECT_LINK_MODE_APPS",SK="subscription_created",SV="subscription_deleted",SH=(x.THIRTY_DAYS,1e3*x.FIVE_SECONDS),SG=(x.THIRTY_DAYS,{wc_pairingDelete:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:x.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:x.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:x.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:x.ONE_DAY,prompt:!1,tag:0},res:{ttl:x.ONE_DAY,prompt:!1,tag:0}}}),SW="pairing_create",SY="pairing_delete",SJ="history_created",SZ="history_updated",SX="history_deleted",SQ="expirer_created",S0="expirer_deleted",S1="expirer_expired",S2=(x.ONE_DAY,"https://verify.walletconnect.org"),S3=`${S2}/v3`,S8=["https://verify.walletconnect.com",S2],S6="malformed_pairing_uri",S5="session_approve_started";var S4=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,h=e.charAt(0),c=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function l(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===h;)i++,t++;for(var n=(e.length-t)*c+1>>>0,o=new Uint8Array(n);e[t];){var u=r[e.charCodeAt(t)];if(255===u)return;for(var l=0,f=n-1;(0!==u||l<s)&&-1!==f;f--,l++)u+=a*o[f]>>>0,o[f]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=l,t++}if(" "!==e[t]){for(var d=n-s;d!==n&&0===o[d];)d++;for(var p=new Uint8Array(i+(n-d)),g=i;d!==n;)p[g++]=o[d++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*u+1>>>0,c=new Uint8Array(o);s!==n;){for(var l=t[s],f=0,d=o-1;(0!==l||f<i)&&-1!==d;d--,f++)l+=256*c[d]>>>0,c[d]=l%a>>>0,l=l/a>>>0;if(0!==l)throw Error("Non-zero carry");i=f,s++}for(var p=o-i;p!==o&&0===c[p];)p++;for(var g=h.repeat(r);p<o;++p)g+=e.charAt(c[p]);return g},decodeUnsafe:l,decode:function(e){var r=l(e);if(r)return r;throw Error(`Non-${t} character`)}}};const S9=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")};class S7{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class Ie{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return Ir(this,e)}}class It{constructor(e){this.decoders=e}or(e){return Ir(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Ir=(e,t)=>new It({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class Ii{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new S7(e,t,r),this.decoder=new Ie(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const Is=({name:e,prefix:t,encode:r,decode:i})=>new Ii(e,t,r,i),In=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=S4(r,t);return Is({prefix:e,name:t,encode:i,decode:e=>S9(s(e))})},Io=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>Is({prefix:t,name:e,encode:e=>((e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n})(e,i,r),decode:t=>((e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,h=0,c=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);h=h<<r|n,(a+=r)>=8&&(a-=8,o[c++]=255&h>>a)}if(a>=r||255&h<<8-a)throw SyntaxError("Unexpected end of data");return o})(t,i,r,e)});var Ia=Object.freeze({__proto__:null,identity:Is({prefix:"\0",name:"identity",encode:e=>new TextDecoder().decode(e),decode:e=>new TextEncoder().encode(e)})}),Ih=Object.freeze({__proto__:null,base2:Io({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),Ic=Object.freeze({__proto__:null,base8:Io({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),Iu=Object.freeze({__proto__:null,base10:In({prefix:"9",name:"base10",alphabet:"0123456789"})}),Il=Object.freeze({__proto__:null,base16:Io({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:Io({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});const If=Io({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Id=Io({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ip=Io({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ig=Io({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Ib=Io({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Iy=Io({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Im=Io({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5});var Iv=Object.freeze({__proto__:null,base32:If,base32upper:Id,base32pad:Ip,base32padupper:Ig,base32hex:Ib,base32hexupper:Iy,base32hexpad:Im,base32hexpadupper:Io({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:Io({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),Iw=Object.freeze({__proto__:null,base36:In({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:In({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),ID=Object.freeze({__proto__:null,base58btc:In({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:In({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});const Ix=Io({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),IE=Io({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6});var I_=Object.freeze({__proto__:null,base64:Ix,base64pad:IE,base64url:Io({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:Io({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});const IS=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),II=IS.reduce((e,t,r)=>(e[r]=t,e),[]),IA=IS.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var IM=Object.freeze({__proto__:null,base256emoji:Is({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=II[t],"")},decode:function(e){let t=[];for(let r of e){let e=IA[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function IO(e,t,r){t=t||[],r=r||0;for(var i=r;e>=0x80000000;)t[r++]=255&e|128,e/=128;for(;-128&e;)t[r++]=255&e|128,e>>>=7;return t[r]=0|e,IO.bytes=r-i+1,t}const IC=(e,t,r=0)=>(IO(e,t,r),t),IP=e=>{var t;return(t=e)<128?1:t<16384?2:t<2097152?3:t<0x10000000?4:t<0x800000000?5:t<0x40000000000?6:t<0x2000000000000?7:t<0x100000000000000?8:t<0x8000000000000000?9:10},IR=(e,t)=>{let r=t.byteLength,i=IP(e),s=i+IP(r),n=new Uint8Array(s+r);return IC(e,n,0),IC(r,n,i),n.set(t,s),new IT(e,r,t,n)};class IT{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}const IN=({name:e,code:t,encode:r})=>new IB(e,t,r);class IB{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?IR(this.code,t):t.then(e=>IR(this.code,e))}throw Error("Unknown type, must be binary type")}}const IL=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var IU=Object.freeze({__proto__:null,sha256:IN({name:"sha2-256",code:18,encode:IL("SHA-256")}),sha512:IN({name:"sha2-512",code:19,encode:IL("SHA-512")})}),Ik=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:S9,digest:e=>IR(0,S9(e))}});new TextEncoder,new TextDecoder;const Iq={...Ia,...Ih,...Ic,...Iu,...Il,...Iv,...Iw,...ID,...I_,...IM};function Ij(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...IU,...Ik});const Iz=Ij("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),IF=Ij("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),I$={utf8:Iz,"utf-8":Iz,hex:Iq.base16,latin1:IF,ascii:IF,binary:IF,...Iq};class IK{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name="keychain",this.version="0.3",this.initialized=!1,this.storagePrefix=SI,this.init=async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}},this.has=e=>(this.isInitialized(),this.keychain.has(e)),this.set=async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()},this.get=e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=St("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t},this.del=async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()},this.core=e,this.logger=xi(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,_e(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?_t(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class IV{constructor(e,t,r){this.core=e,this.logger=t,this.name="crypto",this.randomSessionIdentifier=_q(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=e=>(this.isInitialized(),this.keychain.has(e)),this.getClientId=async()=>(this.isInitialized(),Er(Es(await this.getClientSeed()).publicKey)),this.generateKeyPair=()=>{this.isInitialized();let e=function(){let e=EP.generateKeyPair();return{privateKey:(0,E$.toString)(e.secretKey,_B),publicKey:(0,E$.toString)(e.publicKey,_B)}}();return this.setPrivateKey(e.publicKey,e.privateKey)},this.signJWT=async e=>{this.isInitialized();let t=Es(await this.getClientSeed()),r=this.randomSessionIdentifier;return await En(r,e,SO,t)},this.generateSharedKey=(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=EP.sharedKey((0,E$.fromString)(e,_B),(0,E$.fromString)(t,_B),!0),i=new(0,EA.HKDF)(wI.SHA256,r).expand(32);return(0,E$.toString)(i,_B)}(this.getPrivateKey(e),t);return this.setSymKey(i,r)},this.setSymKey=async(e,t)=>{this.isInitialized();let r=t||_j(e);return await this.keychain.set(r,e),r},this.deleteKeyPair=async e=>{this.isInitialized(),await this.keychain.del(e)},this.deleteSymKey=async e=>{this.isInitialized(),await this.keychain.del(e)},this.encode=async(e,t,r)=>{this.isInitialized();let i=_H(r),s=e_(t);if(2===i.type){var n=r?.encoding;let e=_F(2),t=(0,wo.randomBytes)(12);return _K({type:e,sealed:(0,E$.fromString)(s,_k),iv:t,encoding:n})}if(_G(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let o=this.getSymKey(e),{type:a,senderPublicKey:h}=i;return function(e){let t=_F("u">typeof e.type?e.type:0);if(1===_$(t)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let r="u">typeof e.senderPublicKey?(0,E$.fromString)(e.senderPublicKey,_B):void 0,i="u">typeof e.iv?(0,E$.fromString)(e.iv,_B):(0,wo.randomBytes)(12);return _K({type:t,sealed:new(0,Em.ChaCha20Poly1305)((0,E$.fromString)(e.symKey,_B)).seal(i,(0,E$.fromString)(e.message,_k)),iv:i,senderPublicKey:r,encoding:e.encoding})}({type:a,symKey:o,message:s,senderPublicKey:h,encoding:r?.encoding})},this.decode=async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=_V({encoded:e,encoding:t?.encoding});return _H({type:_$(r.type),senderPublicKey:"u">typeof r.senderPublicKey?(0,E$.toString)(r.senderPublicKey,_B):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type)return eE(function(e,t){let{sealed:r}=_V({encoded:e,encoding:t});return(0,E$.toString)(r,_k)}(t,r?.encoding));if(_G(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),s=function(e){let t=new(0,Em.ChaCha20Poly1305)((0,E$.fromString)(e.symKey,_B)),{sealed:r,iv:i}=_V({encoded:e.encoded,encoding:e?.encoding}),s=t.open(i,r);if(null===s)throw Error("Failed to decrypt");return(0,E$.toString)(s,_k)}({symKey:i,encoded:t,encoding:r?.encoding});return eE(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}},this.getPayloadType=(e,t=_L)=>_$(_V({encoded:e,encoding:t}).type),this.getPayloadSenderPublicKey=(e,t=_L)=>{let r=_V({encoded:e,encoding:t});return r.senderPublicKey?(0,E$.toString)(r.senderPublicKey,_B):void 0},this.core=e,this.logger=xi(t,this.name),this.keychain=r||new IK(this.core,this.logger)}get context(){return xr(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(SM)}catch{e=_q(),await this.keychain.set(SM,e)}return function(e,t="utf8"){let r=I$[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class IH extends xo{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name="messages",this.version="0.3",this.initialized=!1,this.storagePrefix=SI,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}},this.set=async(e,t)=>{this.isInitialized();let r=_z(t),i=this.messages.get(e);return typeof i>"u"&&(i={}),"u">typeof i[r]||(i[r]=t,this.messages.set(e,i),await this.persist()),r},this.get=e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t},this.has=(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[_z(t)]),this.del=async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()},this.logger=xi(e,this.name),this.core=t}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,_e(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?_t(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class IG extends xa{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new(0,a.EventEmitter),this.name="publisher",this.queue=new Map,this.publishTimeout=(0,x.toMiliseconds)(x.ONE_MINUTE),this.failedPublishTimeout=(0,x.toMiliseconds)(x.ONE_SECOND),this.needsTransportRestart=!1,this.publish=async(e,t,r)=>{var i;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let s=r?.ttl||SC,n=_W(r),o=r?.prompt||!1,a=r?.tag||0,h=r?.id||gM().toString(),c={topic:e,message:t,opts:{ttl:s,relay:n,prompt:o,tag:a,id:h,attestation:r?.attestation}},u=`Failed to publish payload, please try again. id:${h} tag:${a}`,l=Date.now(),f,d=1;try{for(;void 0===f;){if(Date.now()-l>this.publishTimeout)throw Error(u);this.logger.trace({id:h,attempts:d},`publisher.publish - attempt ${d}`),f=await await _i(this.rpcPublish(e,t,s,n,o,a,h,r?.attestation).catch(e=>this.logger.warn(e)),this.publishTimeout,u),d++,f||await new Promise(e=>setTimeout(e,this.failedPublishTimeout))}this.relayer.events.emit(SB,c),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{id:h,topic:e,message:t,opts:r}})}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(i=r?.internal)&&i.throwOnFailedPublish)throw e;this.queue.set(h,c)}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.relayer=e,this.logger=xi(t,this.name),this.registerEventListeners()}get context(){return xr(this.logger)}rpcPublish(e,t,r,i,s,n,o,a){var h,c,u,l;let f={method:_Y(i.protocol).publish,params:{topic:e,message:t,ttl:r,prompt:s,tag:n,attestation:a},id:o};return Sn(null==(h=f.params)?void 0:h.prompt)&&(null==(c=f.params)||delete c.prompt),Sn(null==(u=f.params)?void 0:u.tag)&&(null==(l=f.params)||delete l.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:f}),this.relayer.request(f)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{let{topic:t,message:r,opts:i}=e;await this.publish(t,r,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(A,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(SN);return}this.checkQueue()}),this.relayer.on(ST,e=>{this.removeRequestFromQueue(e.id.toString())})}}class IW{constructor(){this.map=new Map,this.set=(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u")return void this.map.delete(e);if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length)return void this.map.delete(e);this.map.set(e,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var IY=Object.defineProperty,IJ=Object.defineProperties,IZ=Object.getOwnPropertyDescriptors,IX=Object.getOwnPropertySymbols,IQ=Object.prototype.hasOwnProperty,I0=Object.prototype.propertyIsEnumerable,I1=(e,t,r)=>t in e?IY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I2=(e,t)=>{for(var r in t||(t={}))IQ.call(t,r)&&I1(e,r,t[r]);if(IX)for(var r of IX(t))I0.call(t,r)&&I1(e,r,t[r]);return e},I3=(e,t)=>IJ(e,IZ(t));class I8 extends xu{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new IW,this.events=new(0,a.EventEmitter),this.name="subscription",this.version="0.3",this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=SI,this.subscribeTimeout=(0,x.toMiliseconds)(x.ONE_MINUTE),this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.pendingBatchMessages=[],this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let r=_W(t),i={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,i);let s=await this.rpcSubscribe(e,r,t);return"string"==typeof s&&(this.onSubscribe(s,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}},this.unsubscribe=async(e,t)=>{await this.restartToComplete(),this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)},this.isSubscribed=async e=>{if(this.topics.includes(e))return!0;let t=`${this.pendingSubscriptionWatchLabel}_${e}`;return await new Promise((r,i)=>{let s=new(0,x.Watch);s.start(t);let n=setInterval(()=>{!this.pending.has(e)&&this.topics.includes(e)&&(clearInterval(n),s.stop(t),r(!0)),s.elapsed(t)>=SH&&(clearInterval(n),s.stop(t),i(Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=xi(t,this.name),this.clientId=""}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=_W(r);await this.rpcUnsubscribe(e,t,i);let s=Sr("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i;r?.transportType===SF&&await this.restartToComplete();let s={method:_Y(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(i=r?.internal)?void 0:i.throwOnFailedPublish;try{let t=_z(e+this.clientId);if(r?.transportType===Sz)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,x.toMiliseconds)(x.ONE_SECOND)),t;let i=await _i(this.relayer.request(s).catch(e=>this.logger.warn(e)),this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!i&&n)throw Error(`Subscribing to ${e} failed, please try again`);return i?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(SN),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:_Y(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{return await await _i(this.relayer.request(t).catch(e=>this.logger.warn(e)),this.subscribeTimeout)}catch{this.relayer.events.emit(SN)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:_Y(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await _i(this.relayer.request(r).catch(e=>this.logger.warn(e)),this.subscribeTimeout)}catch{this.relayer.events.emit(SN)}return t}rpcUnsubscribe(e,t,r){let i={method:_Y(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,I3(I2({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,I2({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,I2({},t)),this.topicMap.set(t.topic,e),this.events.emit(SK,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=St("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(SV,I3(I2({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit("subscription_sync")}async reset(){if(this.cached.length){let e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){let e=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchFetchMessages(e),await this.batchSubscribe(e)}}this.events.emit("subscription_resubscribed")}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=St("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;let t=await this.rpcBatchSubscribe(e);Si(t)&&this.onBatchSubscribe(t.map((t,r)=>I3(I2({},e[r]),{id:t})))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let t=await this.rpcBatchFetchMessages(e);t&&t.messages&&(this.pendingBatchMessages=this.pendingBatchMessages.concat(t.messages))}async onConnect(){await this.restart(),this.onEnable()}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||!this.relayer.connected)return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e),this.pendingBatchMessages.length&&(await this.relayer.handleBatchMessageEvents(this.pendingBatchMessages),this.pendingBatchMessages=[])}registerEventListeners(){this.relayer.core.heartbeat.on(A,async()=>{await this.checkPending()}),this.events.on(SK,async e=>{this.logger.info(`Emitting ${SK}`),this.logger.debug({type:"event",event:SK,data:e}),await this.persist()}),this.events.on(SV,async e=>{this.logger.info(`Emitting ${SV}`),this.logger.debug({type:"event",event:SV,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(){this.relayer.connected||this.relayer.connecting||await this.relayer.transportOpen(),this.restartInProgress&&await new Promise(e=>{let t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var I6=Object.defineProperty,I5=Object.getOwnPropertySymbols,I4=Object.prototype.hasOwnProperty,I9=Object.prototype.propertyIsEnumerable,I7=(e,t,r)=>t in e?I6(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ae=(e,t)=>{for(var r in t||(t={}))I4.call(t,r)&&I7(e,r,t[r]);if(I5)for(var r of I5(t))I9.call(t,r)&&I7(e,r,t[r]);return e};class At extends xh{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new(0,a.EventEmitter),this.name="relayer",this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","stalled","interrupted"],this.hasExperiencedNetworkDisruption=!1,this.requestsInFlight=new Map,this.heartBeatTimeout=(0,x.toMiliseconds)(x.THIRTY_SECONDS+x.ONE_SECOND),this.request=async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||gM().toString();await this.toEstablishConnection();try{let s=this.provider.request(e);this.requestsInFlight.set(i,{promise:s,request:e}),this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - attempt to publish...");let n=await new Promise(async(e,t)=>{let r=()=>{t(Error(`relayer.request - publish interrupted, id: ${i}`))};this.provider.on(Sk,r);let n=await s;this.provider.off(Sk,r),e(n)});return this.logger.trace({id:i,method:e.method,topic:null==(r=e.params)?void 0:r.topic},"relayer.request - published"),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}finally{this.requestsInFlight.delete(i)}},this.resetPingTimeout=()=>{},this.onPayloadHandler=e=>{this.onProviderPayload(e),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.trace("relayer connected"),this.startPingTimeout(),this.events.emit("relayer_connect")},this.onDisconnectHandler=()=>{this.logger.trace("relayer disconnected"),this.onProviderDisconnect()},this.onProviderErrorHandler=e=>{this.logger.error(e),this.events.emit("relayer_error",e),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(SL,this.onPayloadHandler),this.provider.on(SU,this.onConnectHandler),this.provider.on(Sk,this.onDisconnectHandler),this.provider.on(Sq,this.onProviderErrorHandler)},this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?xi(e.logger,this.name):r(Dk)(xt({level:e.logger||"error"})),this.messages=new IH(this.logger,e.core),this.subscriber=new I8(this,this.logger),this.publisher=new IG(this,this.logger),this.relayUrl=e?.relayUrl||SP,this.projectId=e.projectId,this.bundleId=function(){var e;try{return E8()&&"u">typeof t&&"u">typeof(null==t?void 0:t.Application)?null==(e=t.Application)?void 0:e.applicationId:void 0}catch{return}}(),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e)}}get context(){return xr(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:SF})}async subscribe(e,t){var r,i,s;this.isInitialized(),t?.transportType==="relay"&&await this.toEstablishConnection();let n=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),o=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",a,h=t=>{t.topic===e&&(this.subscriber.off(SK,h),a())};return await Promise.all([new Promise(e=>{a=e,this.subscriber.on(SK,h)}),new Promise(async(r,i)=>{o=await this.subscriber.subscribe(e,Ae({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&i(e)})||o,r()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){if(!this.hasExperiencedNetworkDisruption&&this.connected&&this.requestsInFlight.size>0)try{await Promise.all(Array.from(this.requestsInFlight.values()).map(e=>e.promise))}catch(e){this.logger.warn(e)}this.hasExperiencedNetworkDisruption||this.connected?await _i(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),await this.createProvider(),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;try{await new Promise(async(e,t)=>{let r=()=>{this.provider.off(Sk,r),t(Error("Connection interrupted while trying to subscribe"))};this.provider.on(Sk,r),await _i(this.provider.connect(),(0,x.toMiliseconds)(x.ONE_MINUTE),`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),this.subscriber.start().catch(e=>{this.logger.error(e),this.onDisconnectHandler()}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){if(this.logger.error(e),this.hasExperiencedNetworkDisruption=!0,!this.isConnectionStalled(e.message))throw e}finally{this.connectionAttemptInProgress=!1}}async restartTransport(e){this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Sy())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0)return void this.logger.trace("Batch message events is empty. Ignoring...");let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.trace(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=_o(x.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(SR,e),await this.recordMessageEvent(e)}startPingTimeout(){}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new gF(new SE(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:o,bundleId:a}){var h,c;let u=r.split("?"),l=E9(e,t,i),f=(h=u[1]||"",c={auth:s,ua:l,projectId:n,useOnCloseEvent:o||void 0,origin:a||void 0},Mp(E1(E1({},Eb(h)),c)));return u[0]+"?"+f}({sdkVersion:Sj,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(e){let{topic:t,message:r}=e;await this.messages.set(t,r)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.debug(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.debug(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),gk(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:n}=t.data,o={topic:r,message:i,publishedAt:s,transportType:SF,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ae({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else gq(e)&&this.events.emit(ST,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(SR,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){let t=gC(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(SL,this.onPayloadHandler),this.provider.off(SU,this.onConnectHandler),this.provider.off(Sk,this.onDisconnectHandler),this.provider.off(Sq,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await Sy();var r,i,s=async t=>{e!==t&&(e=t,t?await this.restartTransport().catch(e=>this.logger.error(e)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))};switch(E5()){case E3:r=s,!E8()&&E6()&&(window.addEventListener("online",()=>r(!0)),window.addEventListener("offline",()=>r(!1)));break;case E2:i=s,E8()&&"u">typeof t&&null!=t&&t.NetInfo&&t?.NetInfo.addEventListener(e=>i(e?.isConnected))}}async onProviderDisconnect(){await this.subscriber.stop(),this.requestsInFlight.clear(),clearTimeout(this.pingTimeout),this.events.emit("relayer_disconnect"),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e))},(0,x.toMiliseconds)(.1))))}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||(this.connectionAttemptInProgress&&await new Promise(e=>{let t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)}),await this.transportOpen())}}var Ar=Object.defineProperty,Ai=Object.getOwnPropertySymbols,As=Object.prototype.hasOwnProperty,An=Object.prototype.propertyIsEnumerable,Ao=(e,t,r)=>t in e?Ar(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Aa=(e,t)=>{for(var r in t||(t={}))As.call(t,r)&&Ao(e,r,t[r]);if(Ai)for(var r of Ai(t))An.call(t,r)&&Ao(e,r,t[r]);return e};class Ah extends xc{constructor(e,t,i,s=SI,n){super(e,t,i,s),this.core=e,this.logger=t,this.name=i,this.map=new Map,this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=SI,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!Sn(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)},this.set=async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())},this.get=e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e)),this.getAll=e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(i=>r(S_)(t[i],e[i]))):this.values),this.update=async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=Aa(Aa({},this.getData(e)),t);this.map.set(e,r),await this.persist()},this.delete=async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())},this.logger=xi(t,this.name),this.storagePrefix=s,this.getKey=n}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=St("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=St("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=St("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class Ac{constructor(e,t){this.core=e,this.logger=t,this.name="pairing",this.version="0.3",this.events=new(r(a)),this.initialized=!1,this.storagePrefix=SI,this.ignoredPayloadTypes=[1],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]},this.create=async e=>{this.isInitialized();let t=_q(),r=await this.core.crypto.setSymKey(t),i=_o(x.FIVE_MINUTES),s={protocol:"irn"},n={topic:r,expiry:i,relay:s,active:!1,methods:e?.methods},o=_6({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return this.events.emit(SW,n),this.core.expirer.set(r,i),await this.pairings.set(r,n),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:o}},this.pair=async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:["pairing_started"]}});this.isValidPair(e,r);let{topic:i,symKey:s,relay:n,expiryTimestamp:o,methods:a}=_8(e.uri);if(r.props.properties.topic=i,r.addTrace("pairing_uri_validation_success"),r.addTrace("pairing_uri_not_expired"),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace("existing_pairing"),t.active)throw r.setError("active_pairing_already_exists"),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace("pairing_not_expired")}let h=o||_o(x.FIVE_MINUTES),c={topic:i,relay:n,expiry:h,active:!1,methods:a};this.core.expirer.set(i,h),await this.pairings.set(i,c),r.addTrace("store_new_pairing"),e.activatePairing&&await this.activate({topic:i}),this.events.emit(SW,c),r.addTrace("emit_inactive_pairing"),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(s,i),r.addTrace("subscribing_pairing_topic");try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError("no_internet_connection")}try{await this.core.relayer.subscribe(i,{relay:n})}catch(e){throw r.setError("subscribe_pairing_topic_failure"),e}return r.addTrace("subscribe_pairing_topic_success"),c},this.activate=async({topic:e})=>{this.isInitialized();let t=_o(x.THIRTY_DAYS);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})},this.ping=async e=>{this.isInitialized(),await this.isValidPing(e);let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:s}=_r();this.events.once(_h("pairing_ping",e),({error:e})=>{e?s(e):i()}),await r()}},this.updateExpiry=async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})},this.updateMetadata=async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",Sr("USER_DISCONNECTED")),await this.deletePairing(t))},this.formatUriFromPairing=e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:s}=e,n=this.core.crypto.keychain.get(t);return _6({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:r,expiryTimestamp:i,methods:s})},this.sendRequest=async(e,t,r)=>{let i=gO(t,r),s=await this.core.crypto.encode(e,i),n=SG[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,s,n),i.id},this.sendResult=async(e,t,r)=>{let i=gC(e,r),s=await this.core.crypto.encode(t,i),n=SG[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(i)},this.sendError=async(e,t,r)=>{let i=gP(e,r),s=await this.core.crypto.encode(t,i),n=await this.core.history.get(t,e),o=SG[n.request.method]?SG[n.request.method].res:SG.unregistered_method.res;await this.core.relayer.publish(t,s,o),await this.core.history.resolve(i)},this.deletePairing=async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,Sr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])},this.cleanup=async()=>{let e=this.pairings.getAll().filter(e=>_a(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))},this.onRelayEventRequest=e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(t,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,r);default:return this.onUnknownRpcMethodRequest(t,r)}},this.onRelayEventResponse=async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)},this.onPairingPingRequest=async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit("pairing_ping",{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onPairingPingResponse=(e,t)=>{let{id:r}=t;setTimeout(()=>{gj(t)?this.events.emit(_h("pairing_ping",r),{}):gz(t)&&this.events.emit(_h("pairing_ping",r),{error:t.error})},500)},this.onPairingDeleteRequest=async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(SY,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onUnknownRpcMethodRequest=async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=Sr("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}},this.onUnknownRpcMethodResponse=e=>{this.registeredMethods.includes(e)||this.logger.error(Sr("WC_METHOD_UNSUPPORTED",e))},this.isValidPair=(e,t)=>{var r;if(!Sd(e)){let{message:r}=St("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(S6),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(So(e,!1)){if(t(e))return!0;let r=_d(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=St("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(S6),Error(r)}let i=_8(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=St("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(S6),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=St("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(S6),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,x.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError("pairing_expired");let{message:e}=St("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}},this.isValidPing=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidDisconnect=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)},this.isValidPairingTopic=async e=>{if(!So(e,!1)){let{message:t}=St("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=St("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(_a(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=St("EXPIRED",`pairing topic: ${e}`);throw Error(t)}},this.core=e,this.logger=xi(t,this.name),this.pairings=new Ah(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xr(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(SR,async e=>{let{topic:t,message:r,transportType:i}=e;if(!this.pairings.keys.includes(t)||i===Sz||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;let s=await this.core.crypto.decode(t,r);try{gk(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):gq(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(S1,async e=>{let{topic:t}=_n(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class Au extends xn{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new(0,a.EventEmitter),this.name="history",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=SI,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:_o(x.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(SJ,i)},this.resolve=async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=gz(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(SZ,t))},this.get=async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t)),this.delete=(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic===e&&("u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(SX,r)))}),this.persist()},this.exists=async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e),this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=xi(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:gO(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=St("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit("history_sync")}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=St("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(SJ,e=>{this.logger.info(`Emitting ${SJ}`),this.logger.debug({type:"event",event:SJ,record:e})}),this.events.on(SZ,e=>{this.logger.info(`Emitting ${SZ}`),this.logger.debug({type:"event",event:SZ,record:e})}),this.events.on(SX,e=>{this.logger.info(`Emitting ${SX}`),this.logger.debug({type:"event",event:SX,record:e})}),this.core.heartbeat.on(A,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,x.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(SX,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class Al extends xl{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new(0,a.EventEmitter),this.name="expirer",this.version="0.3",this.cached=[],this.initialized=!1,this.storagePrefix=SI,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}},this.set=(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(SQ,{target:r,expiration:i})},this.get=e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)},this.del=e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(S0,{target:t,expiration:r})}},this.on=(e,t)=>{this.events.on(e,t)},this.once=(e,t)=>{this.events.once(e,t)},this.off=(e,t)=>{this.events.off(e,t)},this.removeListener=(e,t)=>{this.events.removeListener(e,t)},this.logger=xi(t,this.name)}get context(){return xr(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return _s("topic",e);if("number"==typeof e)return _s("id",e);let{message:t}=St("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit("expirer_sync")}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=St("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=St("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,x.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(S1,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(A,()=>this.checkExpirations()),this.events.on(SQ,e=>{this.logger.info(`Emitting ${SQ}`),this.logger.debug({type:"event",event:SQ,data:e}),this.persist()}),this.events.on(S1,e=>{this.logger.info(`Emitting ${S1}`),this.logger.debug({type:"event",event:S1,data:e}),this.persist()}),this.events.on(S0,e=>{this.logger.info(`Emitting ${S0}`),this.logger.debug({type:"event",event:S0,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}}class Af extends xf{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,this.name="verify-api",this.verifyUrlV3=S3,this.storagePrefix=SI,this.version=2,this.init=async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,x.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async e=>{if(!E6()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,sh.getDocument)(),t=this.startAbortTimer(5*x.ONE_SECOND),i=await new Promise((i,n)=>{let o=()=>{window.removeEventListener("message",h),e.body.removeChild(a),n("attestation aborted")};this.abortController.signal.addEventListener("abort",o);let a=e.createElement("iframe");a.src=s,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});let h=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if(Ei(n.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",h),i(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",h,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",i),i}catch(e){this.logger.warn(e)}return""},this.resolve=async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t)return void this.logger.debug("resolve: attestationId is empty, skipping");if(t){if(Ei(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e)return e.isVerified?e:void this.logger.warn("resolve: jwt attestation: origin url not verified")}if(!r)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,s)},this.fetchAttestation=async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*x.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0},this.getVerifyUrl=e=>{let t=e||S2;return S8.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${S2}`),t=S2),t},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(x.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}},this.persistPublicKey=async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e},this.validateAttestation=(e,t)=>{let r=function(e,t){let[r,i,s]=e.split("."),n=F.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4;return r>0&&(t+="=".repeat(4-r)),t}(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let o=n.slice(0,32).toString("hex"),a=n.slice(32,64).toString("hex"),h=`${r}.${i}`,c=new(0,wI.SHA256)().update(F.from(h)).digest(),u=new(0,EG.ec)("p256").keyFromPublic({x:F.from(t.x,"base64").toString("hex"),y:F.from(t.y,"base64").toString("hex")},"hex"),l=F.from(c).toString("hex");if(!u.verify(l,{r:o,s:a}))throw Error("Invalid signature");return Ei(e).payload}(e,t.publicKey),i={hasExpired:(0,x.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}},this.logger=xi(t,this.name),this.abortController=new AbortController,this.isDevEnv=!1,this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return xr(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,x.toMiliseconds)(e))}}class Ad extends xd{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.context="echo",this.registerDeviceToken=async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:s})})},this.logger=xi(t,this.context)}}var Ap=Object.defineProperty,Ag=Object.getOwnPropertySymbols,Ab=Object.prototype.hasOwnProperty,Ay=Object.prototype.propertyIsEnumerable,Am=(e,t,r)=>t in e?Ap(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Av=(e,t)=>{for(var r in t||(t={}))Ab.call(t,r)&&Am(e,r,t[r]);if(Ag)for(var r of Ag(t))Ay.call(t,r)&&Am(e,r,t[r]);return e};class Aw extends xp{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,this.context="event-client",this.storagePrefix=SI,this.storageVersion=.1,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{try{let e={eventId:_f(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:E9(this.core.relayer.protocol,this.core.relayer.version,Sj)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}},this.createEvent=e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:s}}=e,n=_f(),o=this.core.projectId||"",a=Av({eventId:n,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:s}},bundleId:o,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,a),this.shouldPersist=!0),a},this.getEvent=e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return Av(Av({},i),this.setMethods(i.eventId))},this.deleteEvent=e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(A,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,x.fromMiliseconds)(Date.now())-(0,x.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})},this.setMethods=e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)}),this.addTrace=(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)},this.setError=(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,Av(Av({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}},this.submit=async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}},this.sendEvent=async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Sj}${t}`,{method:"POST",body:JSON.stringify(e)})},this.getAppDomain=()=>E4().url,this.logger=xi(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var AD=Object.defineProperty,Ax=Object.getOwnPropertySymbols,AE=Object.prototype.hasOwnProperty,A_=Object.prototype.propertyIsEnumerable,AS=(e,t,r)=>t in e?AD(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,AI=(e,t)=>{for(var r in t||(t={}))AE.call(t,r)&&AS(e,r,t[r]);if(Ax)for(var r of Ax(t))A_.call(t,r)&&AS(e,r,t[r]);return e};class AA extends xs{constructor(e){var t,i;super(e),this.protocol="wc",this.version=2,this.name=SS,this.events=new(0,a.EventEmitter),this.initialized=!1,this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.dispatchEnvelope=({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:Sz};this.relayer.onLinkMessageEvent(i,{sessionExists:r})},this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||SP,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let{logger:s,chunkLoggerController:n}="u">typeof(i={opts:xt({level:"string"==typeof e?.logger&&e.logger?e.logger:"error"}),maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger}).loggerOverride&&"string"!=typeof i.loggerOverride?{logger:i.loggerOverride,chunkLoggerController:null}:"u">typeof window?function(e){var t,i;let s=new D0(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r(Dk)(xe(D7({},e.opts),{level:"trace",browser:xe(D7({},null==(i=e.opts)?void 0:i.browser),{write:e=>s.write(e)})})),chunkLoggerController:s}}(i):function(e){var t;let i=new D1(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:r(Dk)(xe(D7({},e.opts),{level:"trace"}),i),chunkLoggerController:i}}(i);this.logChunkController=n,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=xi(s,this.name),this.heartbeat=new M,this.crypto=new IV(this,this.logger,e?.keychain),this.history=new Au(this,this.logger),this.expirer=new Al(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new eT(AI(AI({},SA),e?.storageOptions)),this.relayer=new At({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Ac(this,this.logger),this.verify=new Af(this,this.logger,this.storage),this.echoClient=new Ad(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Aw(this,this.logger,e?.telemetryEnabled)}static async init(e){let t=new AA(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return xr(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(S$,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.eventClient.init(),this.linkModeSupportedApps=await this.storage.getItem(S$)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const AM="client",AO=`wc@2:${AM}:`,AC="WALLETCONNECT_DEEPLINK_CHOICE",AP=(x.THIRTY_DAYS,x.SEVEN_DAYS),AR={wc_sessionPropose:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1104},res:{ttl:x.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1106},res:{ttl:x.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1112},res:{ttl:x.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1114},res:{ttl:x.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:x.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:x.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1119}}},AT={min:x.FIVE_MINUTES,max:x.SEVEN_DAYS},AN="IDLE",AB="ACTIVE",AL=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],AU="wc@1.5:auth:",Ak=`${AU}:PUB_KEY`;var Aq=Object.defineProperty,Aj=Object.defineProperties,Az=Object.getOwnPropertyDescriptors,AF=Object.getOwnPropertySymbols,A$=Object.prototype.hasOwnProperty,AK=Object.prototype.propertyIsEnumerable,AV=(e,t,r)=>t in e?Aq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,AH=(e,t)=>{for(var r in t||(t={}))A$.call(t,r)&&AV(e,r,t[r]);if(AF)for(var r of AF(t))AK.call(t,r)&&AV(e,r,t[r]);return e},AG=(e,t)=>Aj(e,Az(t));class AW extends xb{constructor(e){super(e),this.name="engine",this.events=new(r(a)),this.initialized=!1,this.requestQueue={state:AN,queue:[]},this.sessionRequestQueue={state:AN,queue:[]},this.requestQueueDelay=x.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(AR)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,x.toMiliseconds)(this.requestQueueDelay)))},this.connect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=AG(AH({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,relays:o}=t,a=r,h,c=!1;try{a&&(c=this.client.core.pairing.pairings.get(a).active)}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${a}) failed`),e}if(!a||!c){let{topic:e,uri:t}=await this.client.core.pairing.create();a=e,h=t}if(!a){let{message:e}=St("NO_MATCHING_KEY",`connect() pairing topic: ${a}`);throw Error(e)}let u=await this.client.core.crypto.generateKeyPair(),l=AR.wc_sessionPropose.req.ttl||x.FIVE_MINUTES,f=_o(l),d=AH({requiredNamespaces:i,optionalNamespaces:s,relays:o??[{protocol:"irn"}],proposer:{publicKey:u,metadata:this.client.metadata},expiryTimestamp:f,pairingTopic:a},n&&{sessionProperties:n}),{reject:p,resolve:g,done:b}=_r(l,"Proposal expired");this.events.once(_h("session_connect"),async({error:e,session:t})=>{if(e)p(e);else if(t){t.self.publicKey=u;let e=AG(AH({},t),{pairingTopic:d.pairingTopic,requiredNamespaces:d.requiredNamespaces,optionalNamespaces:d.optionalNamespaces,transportType:SF});await this.client.session.set(t.topic,e),await this.setExpiry(t.topic,t.expiry),a&&await this.client.core.pairing.updateMetadata({topic:a,metadata:t.peer.metadata}),this.cleanupDuplicatePairings(e),g(e)}});let y=await this.sendRequest({topic:a,method:"wc_sessionPropose",params:d,throwOnFailedPublish:!0});return await this.setProposal(y,AH({id:y},d)),{uri:h,approval:b}},this.pair=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}},this.approve=async e=>{var t,r,i;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[S5]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError("no_internet_connection"),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError("proposal_not_found"),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError("session_approve_namespace_validation_failure"),e}let{id:n,relayProtocol:o,namespaces:a,sessionProperties:h,sessionConfig:c}=e,u=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:l,proposer:f,requiredNamespaces:d,optionalNamespaces:p}=u,g=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:l});g||(g=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:S5,properties:{topic:l,trace:[S5,"session_namespaces_validation_success"]}}));let b=await this.client.core.crypto.generateKeyPair(),y=f.publicKey,m=await this.client.core.crypto.generateSharedKey(b,y),v=AH(AH({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:b,metadata:this.client.metadata},expiry:_o(AP)},h&&{sessionProperties:h}),c&&{sessionConfig:c});g.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(m,{transportType:SF})}catch(e){throw g.setError("subscribe_session_topic_failure"),e}g.addTrace("subscribe_session_topic_success");let w=AG(AH({},v),{topic:m,requiredNamespaces:d,optionalNamespaces:p,pairingTopic:l,acknowledged:!1,self:v.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:b,transportType:SF});await this.client.session.set(m,w),g.addTrace("store_session");try{g.addTrace("publishing_session_settle"),await this.sendRequest({topic:m,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(e=>{throw g?.setError("session_settle_publish_failure"),e}),g.addTrace("session_settle_publish_success"),g.addTrace("publishing_session_approve"),await this.sendResult({id:n,topic:l,result:{relay:{protocol:o??"irn"},responderPublicKey:b},throwOnFailedPublish:!0}).catch(e=>{throw g?.setError("session_approve_publish_failure"),e}),g.addTrace("session_approve_publish_success")}catch(e){throw this.client.logger.error(e),this.client.session.delete(m,Sr("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(m),e}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:l,metadata:f.metadata}),await this.client.proposal.delete(n,Sr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}),await this.setExpiry(m,_o(AP)),{topic:m,acknowledged:()=>Promise.resolve(this.client.session.get(m))}},this.reject=async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&(await this.sendError({id:r,topic:t,error:i,rpcOpts:AR.wc_sessionPropose.reject}),await this.client.proposal.delete(r,Sr("USER_DISCONNECTED")))},this.update=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:s,reject:n}=_r(),o=gA(),a=gM().toString(),h=this.client.session.get(t).namespaces;return this.events.once(_h("session_update",o),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:h}),n(e)}),{acknowledged:i}},this.extend=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=gA(),{done:i,resolve:s,reject:n}=_r();return this.events.once(_h("session_extend",r),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,_o(AP)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:i}},this.request=async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:s=AR.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(i);n?.transportType===SF&&await this.confirmOnlineStateOrThrow();let o=gA(),a=gM().toString(),{done:h,resolve:c,reject:u}=_r(s,"Request expired. Please try again.");this.events.once(_h("session_request",o),({error:e,result:t})=>{e?u(e):c(t)});let l=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);return l?(await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:"wc_sessionRequest",params:{request:AG(AH({},r),{expiryTimestamp:_o(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:l}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),await h()):await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:"wc_sessionRequest",params:{request:AG(AH({},r),{expiryTimestamp:_o(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await _u(this.client.core.storage,AC);await _c({id:o,topic:i,wcDeepLink:e})}e()}),h()]).then(e=>e[2])},this.respond=async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:r}=e,{id:i}=r,s=this.client.session.get(t);s.transportType===SF&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);gj(r)?await this.sendResult({id:i,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:n}):gz(r)&&await this.sendError({id:i,topic:t,error:r.error,appLink:n}),this.cleanupAfterResponse(e)},this.ping=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=gA(),r=gM().toString(),{done:i,resolve:s,reject:n}=_r();this.events.once(_h("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&await this.client.core.pairing.ping({topic:t})},this.emit=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,s=gM().toString();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:s})},this.disconnect=async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:Sr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=St("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}},this.find=e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r),n=!0;return!!E7(s,i)&&(i.forEach(t=>{let{accounts:i,methods:s,events:o}=e.namespaces[t],a=_4(i),h=r[t];E7(EY(t,h),a)&&E7(h.methods,s)&&E7(h.events,o)||(n=!1)}),n)})(t,e))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(e,t)=>{var r,i,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let o=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),a=o?Sz:SF;a===SF&&await this.confirmOnlineStateOrThrow();let{chains:h,statement:c="",uri:u,domain:l,nonce:f,type:d,exp:p,nbf:g,methods:b=[],expiry:y}=e,m=[...e.resources||[]],{topic:v,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:w}});let D=await this.client.core.crypto.generateKeyPair(),x=_j(D);if(await Promise.all([this.client.auth.authKeys.set(Ak,{responseTopic:x,publicKey:D}),this.client.auth.pairingTopics.set(x,{topic:x,pairingTopic:v})]),await this.client.core.relayer.subscribe(x,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${v}`),b.length>0){let{namespace:e}=EW(h[0]),t=_O(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(e,"request",b));_T(m)&&(i=t,s=m.pop(),t=_O(function(e,t){_M(e),_M(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[r])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,o;i.att[r]=_y(((e,t)=>{for(var r in t||(t={}))_w.call(t,r)&&_x(e,r,t[r]);if(_v)for(var r of _v(t))_D.call(t,r)&&_x(e,r,t[r]);return e})({},i.att[r]),_m({[s]:(null==(n=e.att[r])?void 0:n[s])||(null==(o=t.att[r])?void 0:o[s])}))})}),i}(_C(i),_C(s)))),m.push(t)}let E=y&&y>AR.wc_sessionAuthenticate.req.ttl?y:AR.wc_sessionAuthenticate.req.ttl,_={authPayload:{type:d??"caip122",chains:h,statement:c,aud:u,domain:l,version:"1",nonce:f,iat:new Date().toISOString(),exp:p,nbf:g,resources:m},requester:{publicKey:D,metadata:this.client.metadata},expiryTimestamp:_o(E)},S={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:h,methods:[...new Set(["personal_sign",...b])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:D,metadata:this.client.metadata},expiryTimestamp:_o(AR.wc_sessionPropose.req.ttl)},{done:I,resolve:A,reject:M}=_r(E,"Request expired"),O=async({error:e,session:t})=>{if(this.events.off(_h("session_request",P),C),e)M(e);else if(t){t.self.publicKey=D,await this.client.session.set(t.topic,t),await this.setExpiry(t.topic,t.expiry),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:t.peer.metadata});let e=this.client.session.get(t.topic);await this.deleteProposal(R),A({session:e})}},C=async e=>{var r,i,s;let n;if(await this.deletePendingAuthRequest(P,{message:"fulfilled",code:0}),e.error){let t=Sr("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(_h("session_connect"),O),M(e.error.message))}await this.deleteProposal(R),this.events.off(_h("session_connect"),O);let{cacaos:o,responder:h}=e.result,c=[],u=[];for(let e of o){await _I({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),M(Sr("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=_T(t.resources),i=[__(t.iss)],s=_S(t.iss);if(r){let e=_P(r),t=_R(r);c.push(...e),i.push(...t)}for(let e of i)u.push(`${e}:${s}`)}let l=await this.client.core.crypto.generateSharedKey(D,h.publicKey);c.length>0&&(n={topic:l,acknowledged:!0,self:{publicKey:D,metadata:this.client.metadata},peer:h,controller:h.publicKey,expiry:_o(AP),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:_9([...new Set(c)],[...new Set(u)]),transportType:a},await this.client.core.relayer.subscribe(l,{transportType:a}),await this.client.session.set(l,n),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:h.metadata}),n=this.client.session.get(l)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=h.metadata.redirect)&&i.linkMode&&null!=(s=h.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(h.metadata.redirect.universal),this.client.session.update(l,{transportType:Sz})),A({auths:o,session:n})},P=gA(),R=gA();this.events.once(_h("session_connect"),O),this.events.once(_h("session_request",P),C);try{if(o){let e=gO("wc_sessionAuthenticate",_,P);this.client.core.history.set(v,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:_U});n=_5(t,v,r)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:_,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:P}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:S,expiry:AR.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:R})])}catch(e){throw this.events.off(_h("session_connect"),O),this.events.off(_h("session_request",P),C),e}return await this.setProposal(R,AH({id:R},S)),await this.setAuthRequest(P,{request:AG(AH({},_),{verifyContext:{}}),pairingTopic:v,transportType:a}),{uri:n??w,response:I}},this.approveSessionAuthenticate=async e=>{let t,{id:r,auths:i}=e,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(e){throw s.setError("no_internet_connection"),e}let n=this.getPendingAuthRequest(r);if(!n)throw s.setError("authenticated_session_pending_request_not_found"),Error(`Could not find pending auth request with id ${r}`);let o=n.transportType||SF;o===SF&&await this.confirmOnlineStateOrThrow();let a=n.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),c=_j(a),u={type:1,receiverPublicKey:a,senderPublicKey:h},l=[],f=[];for(let e of i){if(!await _I({cacao:e,projectId:this.client.core.projectId})){s.setError("invalid_cacao");let e=Sr("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:c,error:e,encodeOpts:u}),Error(e.message)}s.addTrace("cacaos_verified");let{p:t}=e,i=_T(t.resources),n=[__(t.iss)],o=_S(t.iss);if(i){let e=_P(i),t=_R(i);l.push(...e),n.push(...t)}for(let e of n)f.push(`${e}:${o}`)}let d=await this.client.core.crypto.generateSharedKey(h,a);if(s.addTrace("create_authenticated_session_topic"),l?.length>0){t={topic:d,acknowledged:!0,self:{publicKey:h,metadata:this.client.metadata},peer:{publicKey:a,metadata:n.requester.metadata},controller:a,expiry:_o(AP),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:_9([...new Set(l)],[...new Set(f)]),transportType:o},s.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(d,{transportType:o})}catch(e){throw s.setError("subscribe_authenticated_session_topic_failure"),e}s.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(d,t),s.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:c,id:r,result:{cacaos:i,responder:{publicKey:h,metadata:this.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,o)})}catch(e){throw s.setError("authenticated_session_approve_publish_failure"),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}},this.rejectSessionAuthenticate=async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===SF&&await this.confirmOnlineStateOrThrow();let s=i.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),o=_j(s);await this.sendError({id:t,topic:o,error:r,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:AR.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,Sr("USER_DISCONNECTED"))},this.formatAuthMessage=e=>{this.isInitialized();let{request:t,iss:r}=e;return _A(t,r)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)},this.cleanupDuplicatePairings=async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,s;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(s=r.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}},this.deleteSession=async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:s=!0,id:n=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,Sr("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(AC).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,Sr("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=AN),s&&this.client.events.emit("session_delete",{id:n,topic:r})},this.deleteProposal=async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(e,Sr("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")},this.deletePendingSessionRequest=async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=AN,this.client.events.emit("session_request_expire",{id:e}))},this.deletePendingAuthRequest=async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])},this.setExpiry=async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))},this.setProposal=async(e,t)=>{this.client.core.expirer.set(e,_o(AR.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)},this.setAuthRequest=async(e,t)=>{let{request:r,pairingTopic:i,transportType:s=SF}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:s})},this.setPendingSessionRequest=async e=>{let{id:t,topic:r,params:i,verifyContext:s}=e,n=i.request.expiryTimestamp||_o(AR.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:s})},this.sendRequest=async e=>{let r,i,{topic:s,method:n,params:o,expiry:a,relayRpcId:h,clientRpcId:c,throwOnFailedPublish:u,appLink:l}=e,f=gO(n,o,c),d=!!l;try{let e=d?_U:_L;r=await this.client.core.crypto.encode(s,f,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(AL.includes(n)){let e=_z(JSON.stringify(f)),t=_z(r);i=await this.client.core.verify.register({id:t,decryptedId:e})}let p=AR[n].req;if(p.attestation=i,a&&(p.ttl=a),h&&(p.id=h),this.client.core.history.set(s,f),d){let e=_5(l,s,r);await t.Linking.openURL(e,this.client.name)}else{let e=AR[n].req;a&&(e.ttl=a),h&&(e.id=h),u?(e.internal=AG(AH({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,r,e)):this.client.core.relayer.publish(s,r,e).catch(e=>this.client.logger.error(e))}return f.id},this.sendResult=async e=>{let r,i,{id:s,topic:n,result:o,throwOnFailedPublish:a,encodeOpts:h,appLink:c}=e,u=gC(s,o),l=c&&"u">typeof(null==t?void 0:t.Linking);try{let e=l?_U:_L;r=await this.client.core.crypto.encode(n,u,AG(AH({},h||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${s}) failed`),e}if(l){let e=_5(c,n,r);await t.Linking.openURL(e,this.client.name)}else{let e=AR[i.request.method].res;a?(e.internal=AG(AH({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,r,e)):this.client.core.relayer.publish(n,r,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(u)},this.sendError=async e=>{let r,i,{id:s,topic:n,error:o,encodeOpts:a,rpcOpts:h,appLink:c}=e,u=gP(s,o),l=c&&"u">typeof(null==t?void 0:t.Linking);try{let e=l?_U:_L;r=await this.client.core.crypto.encode(n,u,AG(AH({},a||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(l){let e=_5(c,n,r);await t.Linking.openURL(e,this.client.name)}else{let e=h||AR[i.request.method].res;this.client.core.relayer.publish(n,r,e)}await this.client.core.history.resolve(u)},this.cleanup=async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;_a(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{_a(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])},this.onRelayEventRequest=async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===AB)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=AB;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=AN},this.processRequest=async e=>{let{topic:t,payload:r,attestation:i,transportType:s,encryptedId:n}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${o}`)}},this.onRelayEventResponse=async e=>{let{topic:t,payload:r,transportType:i}=e,s=(await this.client.core.history.get(t,r.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onRelayEventUnknownPayload=e=>{let{topic:t}=e,{message:r}=St("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)},this.shouldIgnorePairingRequest=e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async e=>{let{topic:t,payload:r,attestation:i,encryptedId:s}=e,{params:n,id:o}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});this.isValidConnect(AH({},r.params));let a=n.expiryTimestamp||_o(AR.wc_sessionPropose.req.ttl),h=AH({id:o,pairingTopic:t,expiryTimestamp:a},n);await this.setProposal(o,h);let c=await this.getVerifyContext({attestationId:i,hash:_z(JSON.stringify(r)),encryptedId:s,metadata:h.proposer.metadata});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),e?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:o,params:h,verifyContext:c})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:AR.wc_sessionPropose.autoReject}),this.client.logger.error(e)}},this.onSessionProposeResponse=async(e,t,r)=>{let{id:i}=t;if(gj(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let o=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});let a=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});let h=await this.client.core.crypto.generateSharedKey(o,a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:h});let c=await this.client.core.relayer.subscribe(h,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else if(gz(t)){await this.client.proposal.delete(i,Sr("USER_DISCONNECTED"));let e=_h("session_connect");if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(_h("session_connect"),{error:t.error})}},this.onSessionSettleRequest=async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:s,expiry:n,namespaces:o,sessionProperties:a,sessionConfig:h}=t.params,c=AG(AH(AH({topic:e,relay:r,expiry:n,namespaces:o,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:s.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},a&&{sessionProperties:a}),h&&{sessionConfig:h}),{transportType:SF}),u=_h("session_connect");if(0===this.events.listenerCount(u))throw Error(`emitting ${u} without any listeners 997`);this.events.emit(_h("session_connect"),{session:c}),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionSettleResponse=async(e,t)=>{let{id:r}=t;gj(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(_h("session_approve",r),{})):gz(t)&&(await this.client.session.delete(e,Sr("USER_DISCONNECTED")),this.events.emit(_h("session_approve",r),{error:t.error}))},this.onSessionUpdateRequest=async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,s=Sw.get(t);if(s&&this.isRequestOutOfSync(s,i)){this.client.logger.info(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:Sr("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(AH({topic:e},r));try{Sw.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw Sw.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}},this.isRequestOutOfSync=(e,t)=>parseInt(t.toString().slice(0,-3))<=parseInt(e.toString().slice(0,-3)),this.onSessionUpdateResponse=(e,t)=>{let{id:r}=t,i=_h("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(_h("session_update",r),{}):gz(t)&&this.events.emit(_h("session_update",r),{error:t.error})},this.onSessionExtendRequest=async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,_o(AP)),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionExtendResponse=(e,t)=>{let{id:r}=t,i=_h("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(_h("session_extend",r),{}):gz(t)&&this.events.emit(_h("session_extend",r),{error:t.error})},this.onSessionPingRequest=async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionPingResponse=(e,t)=>{let{id:r}=t,i=_h("session_ping",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);setTimeout(()=>{gj(t)?this.events.emit(_h("session_ping",r),{}):gz(t)&&this.events.emit(_h("session_ping",r),{error:t.error})},500)},this.onSessionDeleteRequest=async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(SB,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:Sr("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}},this.onSessionRequest=async e=>{var t,r,i;let{topic:s,payload:n,attestation:o,encryptedId:a,transportType:h}=e,{id:c,params:u}=n;try{await this.isValidRequest(AH({topic:s},u));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:o,hash:_z(JSON.stringify(gO("wc_sessionRequest",u,c))),encryptedId:a,metadata:e.peer.metadata,transportType:h}),l={id:c,topic:s,params:u,verifyContext:n};await this.setPendingSessionRequest(l),h===Sz&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(l):(this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue())}catch(e){await this.sendError({id:c,topic:s,error:e}),this.client.logger.error(e)}},this.onSessionRequestResponse=(e,t)=>{let{id:r}=t,i=_h("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(_h("session_request",r),{result:t.result}):gz(t)&&this.events.emit(_h("session_request",r),{error:t.error})},this.onSessionEventRequest=async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,s=Sw.get(t);if(s&&this.isRequestOutOfSync(s,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(AH({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),Sw.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}},this.onSessionAuthenticateResponse=(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),gj(t)?this.events.emit(_h("session_request",r),{result:t.result}):gz(t)&&this.events.emit(_h("session_request",r),{error:t.error})},this.onSessionAuthenticateRequest=async e=>{var t;let{topic:r,payload:i,attestation:s,encryptedId:n,transportType:o}=e;try{let{requester:e,authPayload:a,expiryTimestamp:h}=i.params,c=await this.getVerifyContext({attestationId:s,hash:_z(JSON.stringify(i)),encryptedId:n,metadata:e.metadata,transportType:o}),u={requester:e,pairingTopic:r,id:i.id,authPayload:a,verifyContext:c,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:u,pairingTopic:r,transportType:o}),o===Sz&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:c})}catch(n){this.client.logger.error(n);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,o);await this.sendError({id:i.id,topic:r,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:AR.wc_sessionAuthenticate.autoReject,appLink:s})}},this.addSessionRequestToSessionRequestQueue=e=>{this.sessionRequestQueue.queue.push(e)},this.cleanupAfterResponse=e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=AN,this.processSessionRequestQueue()},(0,x.toMiliseconds)(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=_h("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(_h("session_request",e.request.id),{error:t})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===AB)return void this.client.logger.info("session request queue is already active.");let e=this.sessionRequestQueue.queue[0];if(!e)return void this.client.logger.info("session request queue is empty.");try{this.sessionRequestQueue.state=AB,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}},this.emitSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onPairingCreated=e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:gO("wc_sessionPropose",{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties},t.id)})},this.isValidConnect=async e=>{let t;if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,relays:o}=e;if(Sn(r)||await this.isValidPairingTopic(r),t=!1,o?o&&Si(o)&&o.length&&o.forEach(e=>{t=Sf(e)}):t=!0,!t){let{message:e}=St("MISSING_OR_INVALID",`connect() relays: ${o}`);throw Error(e)}Sn(i)||0===Ss(i)||this.validateNamespaces(i,"requiredNamespaces"),Sn(s)||0===Ss(s)||this.validateNamespaces(s,"optionalNamespaces"),Sn(n)||this.validateSessionProps(n,"sessionProperties")},this.validateNamespaces=(e,t)=>{let r=function(e,t,r){let i=null;if(e&&Ss(e)){let s,n=Su(e,t);n&&(i=n);let o=(s=null,Object.entries(e).forEach(([e,i])=>{var n,o;let a;if(s)return;let h=(n=EY(e,i),o=`${t} ${r}`,a=null,Si(n)&&n.length?n.forEach(e=>{a||Sh(e)||(a=Sr("UNSUPPORTED_CHAINS",`${o}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):Sh(e)||(a=Sr("UNSUPPORTED_CHAINS",`${o}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),a);h&&(s=h)}),s);o&&(i=o)}else i=St("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)},this.isValidApprove=async e=>{if(!Sd(e))throw Error(St("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let n=this.client.proposal.get(t),o=Sl(r,"approve()");if(o)throw Error(o.message);let a=Sg(n.requiredNamespaces,r,"approve()");if(a)throw Error(a.message);if(!So(i,!0)){let{message:e}=St("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}Sn(s)||this.validateSessionProps(s,"sessionProperties")},this.isValidReject=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!Sa(r.code,!1)||!r.message||!So(r.message,!1)){let{message:e}=St("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}},this.isValidSessionSettleRequest=e=>{let t;if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:s,expiry:n}=e;if(!Sf(r)){let{message:e}=St("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let o=(t=null,So(i?.publicKey,!1)||(t=St("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(o)throw Error(o.message);let a=Sl(s,"onSessionSettleRequest()");if(a)throw Error(a.message);if(_a(n)){let{message:e}=St("EXPIRED","onSessionSettleRequest()");throw Error(e)}},this.isValidUpdate=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),s=Sl(r,"update()");if(s)throw Error(s.message);let n=Sg(i.requiredNamespaces,r,"update()");if(n)throw Error(n.message)},this.isValidExtend=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)},this.isValidRequest=async e=>{var t;if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:s,expiry:n}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!Sp(o,s)){let{message:e}=St("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(Sn(i)||!So(i.method,!1)){let{message:e}=St("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(So(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{_4(e.accounts).includes(t)&&r.push(...e.methods)}),r})(o,s).includes(t))){let{message:e}=St("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(n&&(!Sa(n,!1)||!(n<=AT.max)||!(n>=AT.min))){let{message:e}=St("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${AT.min} and ${AT.max}`);throw Error(e)}},this.isValidRespond=async e=>{var t;if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(Sn(i)||Sn(i.result)&&Sn(i.error)||!Sa(i.id,!1)||!So(i.jsonrpc,!1)){let{message:e}=St("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}},this.isValidPing=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidEmit=async e=>{var t;if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:s}=e;await this.isValidSessionTopic(r);let{namespaces:n}=this.client.session.get(r);if(!Sp(n,s)){let{message:e}=St("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(Sn(i)||!So(i.name,!1)||!(So(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{_4(e.accounts).includes(t)&&r.push(...e.events)}),r})(n,s).includes(t))){let{message:e}=St("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}},this.isValidDisconnect=async e=>{if(!Sd(e)){let{message:t}=St("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)},this.isValidAuthenticate=e=>{let{chains:t,uri:r,domain:i,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!So(r,!1))throw Error("uri is required parameter");if(!So(i,!1))throw Error("domain is required parameter");if(!So(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>EW(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=EW(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:s,transportType:n}=e,o={verified:{verifyUrl:s.verifyUrl||S2,validation:"UNKNOWN",origin:s.url||""}};try{if(n===Sz){let e=this.getAppLinkIfEnabled(s,n);return o.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",o}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:s.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(e,t)=>{Object.values(e).forEach(e=>{if(!So(e,!1)){let{message:r}=St("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw Error(r)}})},this.getPendingAuthRequest=e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0},this.addToRecentlyDeleted=(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}},this.checkRecentlyDeleted=e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=St("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}},this.isLinkModeEnabled=(e,r)=>{var i,s,n,o,a,h,c,u,l;return!!e&&r===Sz&&(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.linkMode)===!0&&(null==(o=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:o.universal)!==void 0&&(null==(h=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:h.universal)!==""&&(null==(c=e?.redirect)?void 0:c.universal)!==void 0&&(null==(u=e?.redirect)?void 0:u.universal)!==""&&(null==(l=e?.redirect)?void 0:l.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==t?void 0:t.Linking)},this.getAppLinkIfEnabled=(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0},this.handleLinkModeMessage=({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=_l(e,"topic")||"",r=decodeURIComponent(_l(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:Sz}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})},this.registerLinkModeListeners=async()=>{var e;if(E8()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==t?void 0:t.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}}isInitialized(){if(!this.initialized){let{message:e}=St("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(SR,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(Ak)?this.client.auth.authKeys.get(Ak):{responseTopic:void 0,publicKey:void 0},o=await this.client.core.crypto.decode(t,r,{receiverPublicKey:n,encoding:s===Sz?_U:_L});try{gk(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o,attestation:i,transportType:s,encryptedId:_z(r)})):gq(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o,transportType:s}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o,transportType:s})}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(S1,async e=>{let{topic:t,id:r}=_n(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,St("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,St("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(SW,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(SY,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!So(e,!1)){let{message:t}=St("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=St("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(_a(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=St("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!So(e,!1)){let{message:t}=St("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=St("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(_a(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=St("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=St("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(So(e,!1)){let{message:t}=St("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=St("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=St("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=St("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(_a(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=St("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class AY extends Ah{constructor(e,t){super(e,t,"proposal",AO),this.core=e,this.logger=t}}class AJ extends Ah{constructor(e,t){super(e,t,"session",AO),this.core=e,this.logger=t}}class AZ extends Ah{constructor(e,t){super(e,t,"request",AO,e=>e.id),this.core=e,this.logger=t}}class AX extends Ah{constructor(e,t){super(e,t,"authKeys",AU,()=>Ak),this.core=e,this.logger=t}}class AQ extends Ah{constructor(e,t){super(e,t,"pairingTopics",AU),this.core=e,this.logger=t}}class A0 extends Ah{constructor(e,t){super(e,t,"requests",AU,e=>e.id),this.core=e,this.logger=t}}class A1{constructor(e,t){this.core=e,this.logger=t,this.authKeys=new AX(this.core,this.logger),this.pairingTopics=new AQ(this.core,this.logger),this.requests=new A0(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}class A2 extends xg{constructor(e){super(e),this.protocol="wc",this.version=2,this.name=AM,this.events=new(0,a.EventEmitter),this.on=(e,t)=>this.events.on(e,t),this.once=(e,t)=>this.events.once(e,t),this.off=(e,t)=>this.events.off(e,t),this.removeListener=(e,t)=>this.events.removeListener(e,t),this.removeAllListeners=e=>this.events.removeAllListeners(e),this.connect=async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}},this.pair=async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}},this.approve=async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}},this.reject=async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}},this.update=async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}},this.extend=async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}},this.request=async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}},this.respond=async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}},this.ping=async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}},this.emit=async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}},this.disconnect=async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}},this.find=e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.authenticate=async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}},this.formatAuthMessage=e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}},this.approveSessionAuthenticate=async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.rejectSessionAuthenticate=async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.name=e?.name||AM,this.metadata=e?.metadata||E4(),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:r(Dk)(xt({level:e?.logger||"error"}));this.core=e?.core||new AA(e),this.logger=xi(t,this.name),this.session=new AJ(this.core,this.logger),this.proposal=new AY(this.core,this.logger),this.pendingRequest=new AZ(this.core,this.logger),this.engine=new AW(this),this.auth=new A1(this.core,this.logger)}static async init(e){let t=new A2(e);return await t.initialize(),t}get context(){return xr(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),this.engine.processRelayMessageCache()}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var A3,A8,A6,A5,A4,A9,A7,Me,Mt,Mr,Mi,Ms,Mn,Mo,Ma,Mh,Mc,Mu,Ml,Mf,Md,Mp,Mg,Mb,My={exports:{}},Mm="object"==typeof Reflect?Reflect:null,Mv=Mm&&"function"==typeof Mm.apply?Mm.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};Mb=Mm&&"function"==typeof Mm.ownKeys?Mm.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var Mw=Number.isNaN||function(e){return e!=e};function MD(){MD.init.call(this)}My.exports=MD,My.exports.once=function(e,t){return new Promise(function(r,i){var s,n,o;function a(r){e.removeListener(t,h),i(r)}function h(){"function"==typeof e.removeListener&&e.removeListener("error",a),r([].slice.call(arguments))}MP(e,t,h,{once:!0}),"error"!==t&&(s=e,n=a,o={once:!0},"function"==typeof s.on&&MP(s,"error",n,o))})},MD.EventEmitter=MD,MD.prototype._events=void 0,MD.prototype._eventsCount=0,MD.prototype._maxListeners=void 0;var Mx=10;function ME(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function M_(e){return void 0===e._maxListeners?MD.defaultMaxListeners:e._maxListeners}function MS(e,t,r,i){var s,n,o;if(ME(r),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),n=e._events),o=n[t]),void 0===o)o=n[t]=r,++e._eventsCount;else if("function"==typeof o?o=n[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(s=M_(e))>0&&o.length>s&&!o.warned){o.warned=!0;var a=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=e,a.type=t,a.count=o.length,console&&console.warn&&console.warn(a)}return e}function MI(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function MA(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=MI.bind(i);return s.listener=r,i.wrapFn=s,s}function MM(e,t,r){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):MC(s,s.length)}function MO(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function MC(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function MP(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function s(n){i.once&&e.removeEventListener(t,s),r(n)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(MD,"defaultMaxListeners",{enumerable:!0,get:function(){return Mx},set:function(e){if("number"!=typeof e||e<0||Mw(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Mx=e}}),MD.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},MD.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||Mw(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},MD.prototype.getMaxListeners=function(){return M_(this)},MD.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){if(t.length>0&&(n=t[0]),n instanceof Error)throw n;var n,o=Error("Unhandled error."+(n?" ("+n.message+")":""));throw o.context=n,o}var a=s[e];if(void 0===a)return!1;if("function"==typeof a)Mv(a,this,t);else for(var h=a.length,c=MC(a,h),r=0;r<h;++r)Mv(c[r],this,t);return!0},MD.prototype.addListener=function(e,t){return MS(this,e,t,!1)},MD.prototype.on=MD.prototype.addListener,MD.prototype.prependListener=function(e,t){return MS(this,e,t,!0)},MD.prototype.once=function(e,t){return ME(t),this.on(e,MA(this,e,t)),this},MD.prototype.prependOnceListener=function(e,t){return ME(t),this.prependListener(e,MA(this,e,t)),this},MD.prototype.removeListener=function(e,t){var r,i,s,n,o;if(ME(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,n=r.length-1;n>=0;n--)if(r[n]===t||r[n].listener===t){o=r[n].listener,s=n;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},MD.prototype.off=MD.prototype.removeListener,MD.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var s,n=Object.keys(r);for(i=0;i<n.length;++i)"removeListener"!==(s=n[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},MD.prototype.listeners=function(e){return MM(this,e,!0)},MD.prototype.rawListeners=function(e){return MM(this,e,!1)},MD.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):MO.call(e,t)},MD.prototype.listenerCount=MO,MD.prototype.eventNames=function(){return this._eventsCount>0?Mb(this._events):[]};My.exports;class MR{constructor(e){this.opts=e}}class MT{constructor(e){this.client=e}}var MN=Object.defineProperty,MB=Object.defineProperties,ML=Object.getOwnPropertyDescriptors,MU=Object.getOwnPropertySymbols,Mk=Object.prototype.hasOwnProperty,Mq=Object.prototype.propertyIsEnumerable,Mj=(e,t,r)=>t in e?MN(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class Mz extends MT{constructor(e){super(e),this.init=async()=>{this.signClient=await A2.init({core:this.client.core,metadata:this.client.metadata,signConfig:this.client.signConfig}),this.authClient=await DU.init({core:this.client.core,projectId:"",metadata:this.client.metadata})},this.pair=async e=>{await this.client.core.pairing.pair(e)},this.approveSession=async e=>{let{topic:t,acknowledged:r}=await this.signClient.approve(MB(((e,t)=>{for(var r in t||(t={}))Mk.call(t,r)&&Mj(e,r,t[r]);if(MU)for(var r of MU(t))Mq.call(t,r)&&Mj(e,r,t[r]);return e})({},e),ML({id:e.id,namespaces:e.namespaces,sessionProperties:e.sessionProperties,sessionConfig:e.sessionConfig})));return await r(),this.signClient.session.get(t)},this.rejectSession=async e=>await this.signClient.reject(e),this.updateSession=async e=>await this.signClient.update(e),this.extendSession=async e=>await this.signClient.extend(e),this.respondSessionRequest=async e=>await this.signClient.respond(e),this.disconnectSession=async e=>await this.signClient.disconnect(e),this.emitSessionEvent=async e=>await this.signClient.emit(e),this.getActiveSessions=()=>this.signClient.session.getAll().reduce((e,t)=>(e[t.topic]=t,e),{}),this.getPendingSessionProposals=()=>this.signClient.proposal.getAll(),this.getPendingSessionRequests=()=>this.signClient.getPendingSessionRequests(),this.respondAuthRequest=async(e,t)=>await this.authClient.respond(e,t),this.getPendingAuthRequests=()=>this.authClient.requests.getAll().filter(e=>"requester"in e),this.formatMessage=(e,t)=>this.authClient.formatMessage(e,t),this.approveSessionAuthenticate=async e=>await this.signClient.approveSessionAuthenticate(e),this.rejectSessionAuthenticate=async e=>await this.signClient.rejectSessionAuthenticate(e),this.formatAuthMessage=e=>this.signClient.formatAuthMessage(e),this.registerDeviceToken=e=>this.client.core.echoClient.registerDeviceToken(e),this.on=(e,t)=>(this.setEvent(e,"off"),this.setEvent(e,"on"),this.client.events.on(e,t)),this.once=(e,t)=>(this.setEvent(e,"off"),this.setEvent(e,"once"),this.client.events.once(e,t)),this.off=(e,t)=>(this.setEvent(e,"off"),this.client.events.off(e,t)),this.removeListener=(e,t)=>(this.setEvent(e,"removeListener"),this.client.events.removeListener(e,t)),this.onSessionRequest=e=>{this.client.events.emit("session_request",e)},this.onSessionProposal=e=>{this.client.events.emit("session_proposal",e)},this.onSessionDelete=e=>{this.client.events.emit("session_delete",e)},this.onAuthRequest=e=>{this.client.events.emit("auth_request",e)},this.onProposalExpire=e=>{this.client.events.emit("proposal_expire",e)},this.onSessionRequestExpire=e=>{this.client.events.emit("session_request_expire",e)},this.onSessionRequestAuthenticate=e=>{this.client.events.emit("session_authenticate",e)},this.setEvent=(e,t)=>{switch(e){case"session_request":this.signClient.events[t]("session_request",this.onSessionRequest);break;case"session_proposal":this.signClient.events[t]("session_proposal",this.onSessionProposal);break;case"session_delete":this.signClient.events[t]("session_delete",this.onSessionDelete);break;case"auth_request":this.authClient[t]("auth_request",this.onAuthRequest);break;case"proposal_expire":this.signClient.events[t]("proposal_expire",this.onProposalExpire);break;case"session_request_expire":this.signClient.events[t]("session_request_expire",this.onSessionRequestExpire);break;case"session_authenticate":this.signClient.events[t]("session_authenticate",this.onSessionRequestAuthenticate)}},this.signClient={},this.authClient={}}}const MF=class extends MR{constructor(e){super(e),this.events=new My.exports,this.on=(e,t)=>this.engine.on(e,t),this.once=(e,t)=>this.engine.once(e,t),this.off=(e,t)=>this.engine.off(e,t),this.removeListener=(e,t)=>this.engine.removeListener(e,t),this.pair=async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}},this.approveSession=async e=>{try{return await this.engine.approveSession(e)}catch(e){throw this.logger.error(e.message),e}},this.rejectSession=async e=>{try{return await this.engine.rejectSession(e)}catch(e){throw this.logger.error(e.message),e}},this.updateSession=async e=>{try{return await this.engine.updateSession(e)}catch(e){throw this.logger.error(e.message),e}},this.extendSession=async e=>{try{return await this.engine.extendSession(e)}catch(e){throw this.logger.error(e.message),e}},this.respondSessionRequest=async e=>{try{return await this.engine.respondSessionRequest(e)}catch(e){throw this.logger.error(e.message),e}},this.disconnectSession=async e=>{try{return await this.engine.disconnectSession(e)}catch(e){throw this.logger.error(e.message),e}},this.emitSessionEvent=async e=>{try{return await this.engine.emitSessionEvent(e)}catch(e){throw this.logger.error(e.message),e}},this.getActiveSessions=()=>{try{return this.engine.getActiveSessions()}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionProposals=()=>{try{return this.engine.getPendingSessionProposals()}catch(e){throw this.logger.error(e.message),e}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}},this.respondAuthRequest=async(e,t)=>{try{return await this.engine.respondAuthRequest(e,t)}catch(e){throw this.logger.error(e.message),e}},this.getPendingAuthRequests=()=>{try{return this.engine.getPendingAuthRequests()}catch(e){throw this.logger.error(e.message),e}},this.formatMessage=(e,t)=>{try{return this.engine.formatMessage(e,t)}catch(e){throw this.logger.error(e.message),e}},this.registerDeviceToken=e=>{try{return this.engine.registerDeviceToken(e)}catch(e){throw this.logger.error(e.message),e}},this.approveSessionAuthenticate=e=>{try{return this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.rejectSessionAuthenticate=e=>{try{return this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}},this.formatAuthMessage=e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}},this.metadata=e.metadata,this.name=e.name||"Web3Wallet",this.signConfig=e.signConfig,this.core=e.core,this.logger=this.core.logger,this.engine=new Mz(this)}static async init(e){let t=new MF(e);return await t.initialize(),t}async initialize(){this.logger.trace("Initialized");try{await this.engine.init(),this.logger.info("Web3Wallet Initialization Success")}catch(e){throw this.logger.info("Web3Wallet Initialization Failure"),this.logger.error(e.message),e}}};MF.notifications={decryptMessage:async e=>{let t={core:new AA({storageOptions:e.storageOptions,storage:e.storage})};await t.core.crypto.init();let r=t.core.crypto.decode(e.topic,e.encryptedMessage);return t.core=null,r},getMetadata:async e=>{let t={core:new AA({storageOptions:e.storageOptions,storage:e.storage}),sessionStore:null};t.sessionStore=new AJ(t.core,t.core.logger),await t.sessionStore.init();let r=t.sessionStore.get(e.topic),i=r?.peer.metadata;return t.core=null,t.sessionStore=null,i}};const M$="client",MK=`wc@2:${M$}:`,MV="WALLETCONNECT_DEEPLINK_CHOICE",MH=(x.THIRTY_DAYS,"Proposal expired"),MG=x.SEVEN_DAYS,MW={wc_sessionPropose:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1104},res:{ttl:x.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1106},res:{ttl:x.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:x.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1112},res:{ttl:x.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:x.ONE_DAY,prompt:!1,tag:1114},res:{ttl:x.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:x.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:x.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:x.FIVE_MINUTES,prompt:!1,tag:1119}}},MY={min:x.FIVE_MINUTES,max:x.SEVEN_DAYS},MJ="IDLE",MZ="ACTIVE",MX={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"},sui_signAndExecuteTransaction:{key:"digest"},sui_signTransaction:{key:""},hedera_signAndExecuteTransaction:{key:"transactionId"},hedera_executeTransaction:{key:"transactionId"},near_signTransaction:{key:""},near_signTransactions:{key:""},tron_signTransaction:{key:"txID"},xrpl_signTransaction:{key:""},xrpl_signTransactionFor:{key:""},algo_signTxn:{key:""},sendTransfer:{key:"txid"},stacks_stxTransfer:{key:"txId"},polkadot_signTransaction:{key:""},cosmos_signDirect:{key:""}},MQ=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],M0="wc@1.5:auth:",M1=`${M0}:PUB_KEY`;var M2=Object.defineProperty,M3=Object.defineProperties,M8=Object.getOwnPropertyDescriptors,M6=Object.getOwnPropertySymbols,M5=Object.prototype.hasOwnProperty,M4=Object.prototype.propertyIsEnumerable,M9=(e,t,r)=>t in e?M2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,M7=(e,t)=>{for(var r in t||(t={}))M5.call(t,r)&&M9(e,r,t[r]);if(M6)for(var r of M6(t))M4.call(t,r)&&M9(e,r,t[r]);return e},Oe=(e,t)=>M3(e,M8(t)),Ot=(e,t,r)=>M9(e,"symbol"!=typeof t?t+"":t,r);class Or extends tC{constructor(e){super(e),Ot(this,"name","engine"),Ot(this,"events",new(r(a))),Ot(this,"initialized",!1),Ot(this,"requestQueue",{state:MJ,queue:[]}),Ot(this,"sessionRequestQueue",{state:MJ,queue:[]}),Ot(this,"emittedSessionRequests",new uk({limit:500})),Ot(this,"requestQueueDelay",x.ONE_SECOND),Ot(this,"expectedPairingMethodMap",new Map),Ot(this,"recentlyDeletedMap",new Map),Ot(this,"recentlyDeletedLimit",200),Ot(this,"relayMessageCache",[]),Ot(this,"pendingSessions",new Map),Ot(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(MW)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,x.toMiliseconds)(this.requestQueueDelay)))}),Ot(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=Oe(M7({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t),t.optionalNamespaces=function(e,t){var r,i,s,n,o,a;let h=p0(e),c=p0(t),u={};for(let e of Object.keys(h).concat(Object.keys(c)))u[e]={chains:uR(null==(r=h[e])?void 0:r.chains,null==(i=c[e])?void 0:i.chains),methods:uR(null==(s=h[e])?void 0:s.methods,null==(n=c[e])?void 0:n.methods),events:uR(null==(o=h[e])?void 0:o.events,null==(a=c[e])?void 0:a.events)};return u}(t.requiredNamespaces,t.optionalNamespaces),t.requiredNamespaces={};let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:o,relays:a}=t,h=r,c,u=!1;try{if(h){let e=this.client.core.pairing.pairings.get(h);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),u=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${h}) failed`),e}if(!h||!u){let{topic:e,uri:t}=await this.client.core.pairing.create({internal:{skipSubscribe:!0}});h=e,c=t}if(!h){let{message:e}=p8("NO_MATCHING_KEY",`connect() pairing topic: ${h}`);throw Error(e)}let l=await this.client.core.crypto.generateKeyPair(),f=MW.wc_sessionPropose.req.ttl||x.FIVE_MINUTES,d=uO(f),p=Oe(M7(M7({requiredNamespaces:i,optionalNamespaces:s,relays:a??[{protocol:"irn"}],proposer:{publicKey:l,metadata:this.client.metadata},expiryTimestamp:d,pairingTopic:h},n&&{sessionProperties:n}),o&&{scopedProperties:o}),{id:gA()}),g=uP("session_connect",p.id),{reject:b,resolve:y,done:m}=uS(f,MH),v=({id:e})=>{e===p.id&&(this.client.events.off("proposal_expire",v),this.pendingSessions.delete(p.id),this.events.emit(g,{error:{message:MH,code:0}}))};return this.client.events.on("proposal_expire",v),this.events.once(g,({error:e,session:t})=>{this.client.events.off("proposal_expire",v),e?b(e):t&&y(t)}),await this.sendProposeSession({proposal:p,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:p.id}}}),await this.setProposal(p.id,p),{uri:c,approval:m}}),Ot(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),Ot(this,"approve",async e=>{var t,r,i;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[by]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError("no_internet_connection"),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError("proposal_not_found"),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError("session_approve_namespace_validation_failure"),e}let{id:n,relayProtocol:o,namespaces:a,sessionProperties:h,scopedProperties:c,sessionConfig:u}=e,l=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:f,proposer:d,requiredNamespaces:p,optionalNamespaces:g}=l,b=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:f});b||(b=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:by,properties:{topic:f,trace:[by,"session_namespaces_validation_success"]}}));let y=await this.client.core.crypto.generateKeyPair(),m=d.publicKey,v=await this.client.core.crypto.generateSharedKey(y,m),w=M7(M7(M7({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:y,metadata:this.client.metadata},expiry:uO(MG)},h&&{sessionProperties:h}),c&&{scopedProperties:c}),u&&{sessionConfig:u});b.addTrace("subscribing_session_topic");try{await this.client.core.relayer.subscribe(v,{transportType:g7,internal:{skipSubscribe:!0}})}catch(e){throw b.setError("subscribe_session_topic_failure"),e}b.addTrace("subscribe_session_topic_success");let D=Oe(M7({},w),{topic:v,requiredNamespaces:p,optionalNamespaces:g,pairingTopic:f,acknowledged:!1,self:w.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:y,transportType:g7});await this.client.session.set(v,D),b.addTrace("store_session");try{await this.sendApproveSession({sessionTopic:v,proposal:l,pairingProposalResponse:{relay:{protocol:o??"irn"},responderPublicKey:y},sessionSettleRequest:w,publishOpts:{internal:{throwOnFailedPublish:!0},tvf:{correlationId:n}}}),b.addTrace("session_approve_publish_success")}catch(e){throw this.client.logger.error(e),this.client.session.delete(v,p6("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(v),e}return this.client.core.eventClient.deleteEvent({eventId:b.eventId}),await this.client.core.pairing.updateMetadata({topic:f,metadata:d.metadata}),await this.deleteProposal(n),await this.client.core.pairing.activate({topic:f}),await this.setExpiry(v,uO(MG)),{topic:v,acknowledged:()=>Promise.resolve(this.client.session.get(v))}}),Ot(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&await this.sendError({id:r,topic:t,error:i,rpcOpts:MW.wc_sessionPropose.reject}),await this.deleteProposal(r)}),Ot(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:s,reject:n}=uS(),o=gA(),a=gM().toString(),h=this.client.session.get(t).namespaces;return this.events.once(uP("session_update",o),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:h}),n(e)}),{acknowledged:i}}),Ot(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=gA(),{done:i,resolve:s,reject:n}=uS();return this.events.once(uP("session_extend",r),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,uO(MG)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:i}}),Ot(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:s=MW.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(i);n?.transportType===g7&&await this.confirmOnlineStateOrThrow();let o=gA(),a=gM().toString(),{done:h,resolve:c,reject:u}=uS(s,"Request expired. Please try again.");this.events.once(uP("session_request",o),({error:e,result:t})=>{e?u(e):c(t)});let l="wc_sessionRequest",f=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(f)return await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:l,params:{request:Oe(M7({},r),{expiryTimestamp:uO(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:f}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),await h();let d={request:Oe(M7({},r),{expiryTimestamp:uO(s)}),chainId:t};return await Promise.all([new Promise(async e=>{await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:l,params:d,expiry:s,throwOnFailedPublish:!0,tvf:this.getTVFParams(o,d)}).catch(e=>u(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await uN(this.client.core.storage,MV);await uT({id:o,topic:i,wcDeepLink:e})}e()}),h()]).then(e=>e[2])}),Ot(this,"respond",async e=>{var t,r;this.isInitialized();let i=this.client.core.eventClient.createEvent({properties:{topic:e?.topic||(null==(r=null==(t=e?.response)?void 0:t.id)?void 0:r.toString()),trace:["session_request_response_started"]}});try{await this.isValidRespond(e)}catch(e){throw i.addTrace(e?.message),i.setError("session_request_response_validation_failure"),e}i.addTrace("session_request_response_validation_success");let{topic:s,response:n}=e,{id:o}=n,a=this.client.session.get(s);a.transportType===g7&&await this.confirmOnlineStateOrThrow();let h=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);try{i.addTrace("session_request_response_publish_started"),gj(n)?await this.sendResult({id:o,topic:s,result:n.result,throwOnFailedPublish:!0,appLink:h}):gz(n)&&await this.sendError({id:o,topic:s,error:n.error,appLink:h}),this.cleanupAfterResponse(e)}catch(e){throw i.addTrace(e?.message),i.setError("session_request_response_publish_failure"),e}}),Ot(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=gA(),r=gM().toString(),{done:i,resolve:s,reject:n}=uS();this.events.once(uP("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),Ot(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,s=gM().toString(),n=gA();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),Ot(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:p6("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=p8("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),Ot(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r),n=!0;return!!ux(s,i)&&(i.forEach(t=>{let{accounts:i,methods:s,events:o}=e.namespaces[t],a=pX(i),h=r[t];ux(us(t,h),a)&&ux(h.methods,s)&&ux(h.events,o)||(n=!1)}),n)})(t,e)))),Ot(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),Ot(this,"authenticate",async(e,t)=>{var r,i,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let o=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),a=o?g9:g7;a===g7&&await this.confirmOnlineStateOrThrow();let{chains:h,statement:c="",uri:u,domain:l,nonce:f,type:d,exp:p,nbf:g,methods:b=[],expiry:y}=e,m=[...e.resources||[]],{topic:v,uri:w}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:v,uri:w}});let D=await this.client.core.crypto.generateKeyPair(),x=pw(D);if(await Promise.all([this.client.auth.authKeys.set(M1,{responseTopic:x,publicKey:D}),this.client.auth.pairingTopics.set(x,{topic:x,pairingTopic:v})]),await this.client.core.relayer.subscribe(x,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${v}`),b.length>0){let{namespace:e}=ui(h[0]),t=fy(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(e,"request",b));fD(m)&&(i=t,s=m.pop(),t=fy(function(e,t){fb(e),fb(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[r])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,o;i.att[r]=fn(((e,t)=>{for(var r in t||(t={}))fh.call(t,r)&&fu(e,r,t[r]);if(fa)for(var r of fa(t))fc.call(t,r)&&fu(e,r,t[r]);return e})({},i.att[r]),fo({[s]:(null==(n=e.att[r])?void 0:n[s])||(null==(o=t.att[r])?void 0:o[s])}))})}),i}(fm(i),fm(s)))),m.push(t)}let E=y&&y>MW.wc_sessionAuthenticate.req.ttl?y:MW.wc_sessionAuthenticate.req.ttl,_={authPayload:{type:d??"caip122",chains:h,statement:c,aud:u,domain:l,version:"1",nonce:f,iat:new Date().toISOString(),exp:p,nbf:g,resources:m},requester:{publicKey:D,metadata:this.client.metadata},expiryTimestamp:uO(E)},S={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:h,methods:[...new Set(["personal_sign",...b])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:v,proposer:{publicKey:D,metadata:this.client.metadata},expiryTimestamp:uO(MW.wc_sessionPropose.req.ttl),id:gA()},{done:I,resolve:A,reject:M}=uS(E,"Request expired"),O=gA(),C=uP("session_connect",S.id),P=uP("session_request",O),R=async({error:e,session:t})=>{this.events.off(P,T),e?M(e):t&&A({session:t})},T=async e=>{var r,i,s;let n;if(await this.deletePendingAuthRequest(O,{message:"fulfilled",code:0}),e.error){let t=p6("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(C,R),M(e.error.message))}await this.deleteProposal(S.id),this.events.off(C,R);let{cacaos:o,responder:h}=e.result,c=[],u=[];for(let e of o){await fp({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),M(p6("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=fD(t.resources),i=[ff(t.iss)],s=fd(t.iss);if(r){let e=fv(r),t=fw(r);c.push(...e),i.push(...t)}for(let e of i)u.push(`${e}:${s}`)}let l=await this.client.core.crypto.generateSharedKey(D,h.publicKey);c.length>0&&(n={topic:l,acknowledged:!0,self:{publicKey:D,metadata:this.client.metadata},peer:h,controller:h.publicKey,expiry:uO(MG),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:v,namespaces:p1([...new Set(c)],[...new Set(u)]),transportType:a},await this.client.core.relayer.subscribe(l,{transportType:a}),await this.client.session.set(l,n),v&&await this.client.core.pairing.updateMetadata({topic:v,metadata:h.metadata}),n=this.client.session.get(l)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=h.metadata.redirect)&&i.linkMode&&null!=(s=h.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(h.metadata.redirect.universal),this.client.session.update(l,{transportType:g9})),A({auths:o,session:n})};this.events.once(C,R),this.events.once(P,T);try{if(o){let e=gO("wc_sessionAuthenticate",_,O);this.client.core.history.set(v,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:py});n=pF(t,v,r)}else await Promise.all([this.sendRequest({topic:v,method:"wc_sessionAuthenticate",params:_,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:O}),this.sendRequest({topic:v,method:"wc_sessionPropose",params:S,expiry:MW.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(e){throw this.events.off(C,R),this.events.off(P,T),e}return await this.setProposal(S.id,S),await this.setAuthRequest(O,{request:Oe(M7({},_),{verifyContext:{}}),pairingTopic:v,transportType:a}),{uri:n??w,response:I}}),Ot(this,"approveSessionAuthenticate",async e=>{let t,{id:r,auths:i}=e,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:["authenticated_session_approve_started"]}});try{this.isInitialized()}catch(e){throw s.setError("no_internet_connection"),e}let n=this.getPendingAuthRequest(r);if(!n)throw s.setError("authenticated_session_pending_request_not_found"),Error(`Could not find pending auth request with id ${r}`);let o=n.transportType||g7;o===g7&&await this.confirmOnlineStateOrThrow();let a=n.requester.publicKey,h=await this.client.core.crypto.generateKeyPair(),c=pw(a),u={type:1,receiverPublicKey:a,senderPublicKey:h},l=[],f=[];for(let e of i){if(!await fp({cacao:e,projectId:this.client.core.projectId})){s.setError("invalid_cacao");let e=p6("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:c,error:e,encodeOpts:u}),Error(e.message)}s.addTrace("cacaos_verified");let{p:t}=e,i=fD(t.resources),n=[ff(t.iss)],o=fd(t.iss);if(i){let e=fv(i),t=fw(i);l.push(...e),n.push(...t)}for(let e of n)f.push(`${e}:${o}`)}let d=await this.client.core.crypto.generateSharedKey(h,a);if(s.addTrace("create_authenticated_session_topic"),l?.length>0){t={topic:d,acknowledged:!0,self:{publicKey:h,metadata:this.client.metadata},peer:{publicKey:a,metadata:n.requester.metadata},controller:a,expiry:uO(MG),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:p1([...new Set(l)],[...new Set(f)]),transportType:o},s.addTrace("subscribing_authenticated_session_topic");try{await this.client.core.relayer.subscribe(d,{transportType:o})}catch(e){throw s.setError("subscribe_authenticated_session_topic_failure"),e}s.addTrace("subscribe_authenticated_session_topic_success"),await this.client.session.set(d,t),s.addTrace("store_authenticated_session"),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace("publishing_authenticated_session_approve");try{await this.sendResult({topic:c,id:r,result:{cacaos:i,responder:{publicKey:h,metadata:this.client.metadata}},encodeOpts:u,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,o)})}catch(e){throw s.setError("authenticated_session_approve_publish_failure"),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),Ot(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===g7&&await this.confirmOnlineStateOrThrow();let s=i.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),o=pw(s);await this.sendError({id:t,topic:o,error:r,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:MW.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.deleteProposal(t)}),Ot(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return fg(t,r)}),Ot(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),Ot(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,s;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(s=r.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),Ot(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:s=!0,id:n=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,p6("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(MV).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,p6("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=MJ),s&&this.client.events.emit("session_delete",{id:n,topic:r})}),Ot(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError("proposal_expired")}catch{}await Promise.all([this.client.proposal.delete(e,p6("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),Ot(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=MJ,this.client.events.emit("session_request_expire",{id:e}))}),Ot(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),Ot(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),Ot(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,uO(MW.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),Ot(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:s=g7}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:s})}),Ot(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:s}=e,n=i.request.expiryTimestamp||uO(MW.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:s})}),Ot(this,"sendRequest",async e=>{let r,i,{topic:s,method:n,params:o,expiry:a,relayRpcId:h,clientRpcId:c,throwOnFailedPublish:u,appLink:l,tvf:f,publishOpts:d={}}=e,p=gO(n,o,c),g=!!l;try{let e=g?py:pb;r=await this.client.core.crypto.encode(s,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(MQ.includes(n)){let e=pD(JSON.stringify(p)),t=pD(r);i=await this.client.core.verify.register({id:t,decryptedId:e})}let b=M7(M7({},MW[n].req),d);if(b.attestation=i,a&&(b.ttl=a),h&&(b.id=h),this.client.core.history.set(s,p),g){let e=pF(l,s,r);await t.Linking.openURL(e,this.client.name)}else b.tvf=Oe(M7({},f),{correlationId:p.id}),u?(b.internal=Oe(M7({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,r,b)):this.client.core.relayer.publish(s,r,b).catch(e=>this.client.logger.error(e));return p.id}),Ot(this,"sendProposeSession",async e=>{let{proposal:t,publishOpts:r}=e,i=gO("wc_sessionPropose",t,t.id);this.client.core.history.set(t.pairingTopic,i);let s=await this.client.core.crypto.encode(t.pairingTopic,i,{encoding:pb}),n=pD(JSON.stringify(i)),o=pD(s),a=await this.client.core.verify.register({id:o,decryptedId:n});await this.client.core.relayer.publishCustom({payload:{pairingTopic:t.pairingTopic,sessionProposal:s},opts:Oe(M7({},r),{publishMethod:"wc_proposeSession",attestation:a})})}),Ot(this,"sendApproveSession",async e=>{let{sessionTopic:t,pairingProposalResponse:r,proposal:i,sessionSettleRequest:s,publishOpts:n}=e,o=gC(i.id,r),a=await this.client.core.crypto.encode(i.pairingTopic,o,{encoding:pb}),h=gO("wc_sessionSettle",s,n?.id),c=await this.client.core.crypto.encode(t,h,{encoding:pb});this.client.core.history.set(t,h),await this.client.core.relayer.publishCustom({payload:{sessionTopic:t,pairingTopic:i.pairingTopic,sessionProposalResponse:a,sessionSettlementRequest:c},opts:Oe(M7({},n),{publishMethod:"wc_approveSession"})})}),Ot(this,"sendResult",async e=>{let r,i,s,{id:n,topic:o,result:a,throwOnFailedPublish:h,encodeOpts:c,appLink:u}=e,l=gC(n,a),f=u&&"u">typeof(null==t?void 0:t.Linking);try{let e=f?py:pb;r=await this.client.core.crypto.encode(o,l,Oe(M7({},c||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${o} failed`),e}try{let e=(i=await this.client.core.history.get(o,n)).request;try{s=this.getTVFParams(n,e.params,a)}catch(e){this.client.logger.warn(`sendResult() -> getTVFParams() failed: ${e?.message}`)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${o}, ${n}) failed`),e}if(f){let e=pF(u,o,r);await t.Linking.openURL(e,this.client.name)}else{let e=MW[i.request.method].res;e.tvf=Oe(M7({},s),{correlationId:n}),h?(e.internal=Oe(M7({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,r,e)):this.client.core.relayer.publish(o,r,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(l)}),Ot(this,"sendError",async e=>{let r,i,{id:s,topic:n,error:o,encodeOpts:a,rpcOpts:h,appLink:c}=e,u=gP(s,o),l=c&&"u">typeof(null==t?void 0:t.Linking);try{let e=l?py:pb;r=await this.client.core.crypto.encode(n,u,Oe(M7({},a||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(l){let e=pF(c,n,r);await t.Linking.openURL(e,this.client.name)}else{let e=i.request.method,t=h||MW[e].res;this.client.core.relayer.publish(n,r,t)}await this.client.core.history.resolve(u)}),Ot(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;uC(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{uC(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),Ot(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),Ot(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),Ot(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===MZ)return void this.client.logger.info("Request queue already active, skipping...");for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=MZ;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=MJ}),Ot(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:s,encryptedId:n}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${o}`)}}),Ot(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,s=(await this.client.core.history.get(t,r.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),Ot(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=p8("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),Ot(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),Ot(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:s}=e,{params:n,id:o}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError("proposal_listener_not_found")),this.isValidConnect(M7({},r.params));let a=n.expiryTimestamp||uO(MW.wc_sessionPropose.req.ttl),h=M7({id:o,pairingTopic:t,expiryTimestamp:a,attestation:i,encryptedId:s},n);await this.setProposal(o,h);let c=await this.getVerifyContext({attestationId:i,hash:pD(JSON.stringify(r)),encryptedId:s,metadata:h.proposer.metadata});e?.addTrace("emit_session_proposal"),this.client.events.emit("session_proposal",{id:o,params:h,verifyContext:c})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:MW.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),Ot(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if(gj(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let o=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});let a=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});let h=await this.client.core.crypto.generateSharedKey(o,a);this.pendingSessions.set(i,{sessionTopic:h,pairingTopic:e,proposalId:i,publicKey:o});let c=await this.client.core.relayer.subscribe(h,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:c}),await this.client.core.pairing.activate({topic:e})}else if(gz(t)){await this.deleteProposal(i);let e=uP("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),Ot(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:s,expiry:n,namespaces:o,sessionProperties:a,scopedProperties:h,sessionConfig:c}=t.params,u=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!u)return this.client.logger.error(`Pending session not found for topic ${e}`);let l=this.client.proposal.get(u.proposalId),f=Oe(M7(M7(M7({topic:e,relay:r,expiry:n,namespaces:o,acknowledged:!0,pairingTopic:u.pairingTopic,requiredNamespaces:l.requiredNamespaces,optionalNamespaces:l.optionalNamespaces,controller:s.publicKey,self:{publicKey:u.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},a&&{sessionProperties:a}),h&&{scopedProperties:h}),c&&{sessionConfig:c}),{transportType:g7});await this.client.session.set(f.topic,f),await this.setExpiry(f.topic,f.expiry),await this.client.core.pairing.updateMetadata({topic:u.pairingTopic,metadata:f.peer.metadata}),this.client.events.emit("session_connect",{session:f}),this.events.emit(uP("session_connect",u.proposalId),{session:f}),this.pendingSessions.delete(u.proposalId),this.deleteProposal(u.proposalId,!1),this.cleanupDuplicatePairings(f),await this.sendResult({id:t.id,topic:e,result:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),Ot(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;gj(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(uP("session_approve",r),{})):gz(t)&&(await this.client.session.delete(e,p6("USER_DISCONNECTED")),this.events.emit(uP("session_approve",r),{error:t.error}))}),Ot(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,s=gg.get(t);if(s&&this.isRequestOutOfSync(s,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:p6("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(M7({topic:e},r));try{gg.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0})}catch(e){throw gg.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),Ot(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),Ot(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=uP("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(uP("session_update",r),{}):gz(t)&&this.events.emit(uP("session_update",r),{error:t.error})}),Ot(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,uO(MG)),await this.sendResult({id:r,topic:e,result:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),Ot(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=uP("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(uP("session_extend",r),{}):gz(t)&&this.events.emit(uP("session_extend",r),{error:t.error})}),Ot(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),Ot(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=uP("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners 2176`);gj(t)?this.events.emit(uP("session_ping",r),{}):gz(t)&&this.events.emit(uP("session_ping",r),{error:t.error})},500)}),Ot(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),await Promise.all([new Promise(t=>{this.client.core.relayer.once(g2,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:p6("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),Ot(this,"onSessionRequest",async e=>{var t,r,i;let{topic:s,payload:n,attestation:o,encryptedId:a,transportType:h}=e,{id:c,params:u}=n;try{await this.isValidRequest(M7({topic:s},u));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:o,hash:pD(JSON.stringify(gO("wc_sessionRequest",u,c))),encryptedId:a,metadata:e.peer.metadata,transportType:h}),l={id:c,topic:s,params:u,verifyContext:n};await this.setPendingSessionRequest(l),h===g9&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(l):(this.addSessionRequestToSessionRequestQueue(l),this.processSessionRequestQueue())}catch(e){await this.sendError({id:c,topic:s,error:e}),this.client.logger.error(e)}}),Ot(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=uP("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);gj(t)?this.events.emit(uP("session_request",r),{result:t.result}):gz(t)&&this.events.emit(uP("session_request",r),{error:t.error})}),Ot(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,s=gg.get(t);if(s&&this.isRequestOutOfSync(s,r))return void this.client.logger.info(`Discarding out of sync request - ${r}`);this.isValidEmit(M7({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),gg.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),Ot(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),gj(t)?this.events.emit(uP("session_request",r),{result:t.result}):gz(t)&&this.events.emit(uP("session_request",r),{error:t.error})}),Ot(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:s,encryptedId:n,transportType:o}=e;try{let{requester:e,authPayload:a,expiryTimestamp:h}=i.params,c=await this.getVerifyContext({attestationId:s,hash:pD(JSON.stringify(i)),encryptedId:n,metadata:e.metadata,transportType:o}),u={requester:e,pairingTopic:r,id:i.id,authPayload:a,verifyContext:c,expiryTimestamp:h};await this.setAuthRequest(i.id,{request:u,pairingTopic:r,transportType:o}),o===g9&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:c})}catch(n){this.client.logger.error(n);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,o);await this.sendError({id:i.id,topic:r,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:MW.wc_sessionAuthenticate.autoReject,appLink:s})}}),Ot(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),Ot(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=MJ,this.processSessionRequestQueue()},(0,x.toMiliseconds)(this.requestQueueDelay))}),Ot(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=uP("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(uP("session_request",e.request.id),{error:t})})}),Ot(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===MZ)return void this.client.logger.info("session request queue is already active.");let e=this.sessionRequestQueue.queue[0];if(!e)return void this.client.logger.info("session request queue is empty.");try{this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),Ot(this,"emitSessionRequest",e=>{if(this.emittedSessionRequests.has(e.id))return void this.client.logger.warn({id:e.id},`Skipping emitting \`session_request\` event for duplicate request. id: ${e.id}`);this.sessionRequestQueue.state=MZ,this.emittedSessionRequests.add(e.id),this.client.events.emit("session_request",e)}),Ot(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:gO("wc_sessionPropose",Oe(M7({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id),attestation:t.attestation,encryptedId:t.encryptedId})}),Ot(this,"isValidConnect",async e=>{let t;if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:o,relays:a}=e;if(p9(r)||await this.isValidPairingTopic(r),t=!1,a?a&&p5(a)&&a.length&&a.forEach(e=>{t=go(e)}):t=!0,!t){let{message:e}=p8("MISSING_OR_INVALID",`connect() relays: ${a}`);throw Error(e)}if(i&&!p9(i)&&0!==p4(i)){let e="requiredNamespaces are deprecated and are automatically assigned to optionalNamespaces";["fatal","error","silent"].includes(this.client.logger.level)?console.warn(e):this.client.logger.warn(e),this.validateNamespaces(i,"requiredNamespaces")}if(s&&!p9(s)&&0!==p4(s)&&this.validateNamespaces(s,"optionalNamespaces"),n&&!p9(n)&&this.validateSessionProps(n,"sessionProperties"),o&&!p9(o)){this.validateSessionProps(o,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(o).every(t=>e.includes(t.split(":")[0])))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(o)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),Ot(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&p4(e)){let s,n=gs(e,t);n&&(i=n);let o=(s=null,Object.entries(e).forEach(([e,i])=>{var n,o;let a;if(s)return;let h=(n=us(e,i),o=`${t} ${r}`,a=null,p5(n)&&n.length?n.forEach(e=>{a||gt(e)||(a=p6("UNSUPPORTED_CHAINS",`${o}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):gt(e)||(a=p6("UNSUPPORTED_CHAINS",`${o}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),a);h&&(s=h)}),s);o&&(i=o)}else i=p8("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),Ot(this,"isValidApprove",async e=>{if(!ga(e))throw Error(p8("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:s,scopedProperties:n}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let o=this.client.proposal.get(t),a=gn(r,"approve()");if(a)throw Error(a.message);let h=gc(o.requiredNamespaces,r,"approve()");if(h)throw Error(h.message);if(!p7(i,!0)){let{message:e}=p8("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}if(s&&!p9(s)&&this.validateSessionProps(s,"sessionProperties"),n&&!p9(n)){this.validateSessionProps(n,"scopedProperties");let e=new Set(Object.keys(r));if(!Object.keys(n).every(t=>e.has(t.split(":")[0])))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(n)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),Ot(this,"isValidReject",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!ge(r.code,!1)||!r.message||!p7(r.message,!1)){let{message:e}=p8("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),Ot(this,"isValidSessionSettleRequest",e=>{let t;if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:s,expiry:n}=e;if(!go(r)){let{message:e}=p8("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let o=(t=null,p7(i?.publicKey,!1)||(t=p8("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(o)throw Error(o.message);let a=gn(s,"onSessionSettleRequest()");if(a)throw Error(a.message);if(uC(n)){let{message:e}=p8("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),Ot(this,"isValidUpdate",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),s=gn(r,"update()");if(s)throw Error(s.message);let n=gc(i.requiredNamespaces,r,"update()");if(n)throw Error(n.message)}),Ot(this,"isValidExtend",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),Ot(this,"isValidRequest",async e=>{var t;if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:s,expiry:n}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!gh(o,s)){let{message:e}=p8("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(p9(i)||!p7(i.method,!1)){let{message:e}=p8("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(p7(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{pX(e.accounts).includes(t)&&r.push(...e.methods)}),r})(o,s).includes(t))){let{message:e}=p8("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(n&&!gl(n,MY)){let{message:e}=p8("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${MY.min} and ${MY.max}`);throw Error(e)}}),Ot(this,"isValidRespond",async e=>{var t;if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(p9(i)||p9(i.result)&&p9(i.error)||!ge(i.id,!1)||!p7(i.jsonrpc,!1)){let{message:e}=p8("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}let s=this.client.pendingRequest.get(i.id);if(s.topic!==r){let{message:e}=p8("MISMATCHED_TOPIC",`Request response topic mismatch. reqId: ${i.id}, expected topic: ${s.topic}, received topic: ${r}`);throw Error(e)}}),Ot(this,"isValidPing",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),Ot(this,"isValidEmit",async e=>{var t;if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:s}=e;await this.isValidSessionTopic(r);let{namespaces:n}=this.client.session.get(r);if(!gh(n,s)){let{message:e}=p8("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(p9(i)||!p7(i.name,!1)||!(p7(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{pX(e.accounts).includes(t)&&r.push(...e.events)}),r})(n,s).includes(t))){let{message:e}=p8("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),Ot(this,"isValidDisconnect",async e=>{if(!ga(e)){let{message:t}=p8("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),Ot(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!p7(r,!1))throw Error("uri is required parameter");if(!p7(i,!1))throw Error("domain is required parameter");if(!p7(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>ui(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=ui(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),Ot(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:s,transportType:n}=e,o={verified:{verifyUrl:s.verifyUrl||bd,validation:"UNKNOWN",origin:s.url||""}};try{if(n===g9){let e=this.getAppLinkIfEnabled(s,n);return o.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",o}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:s.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o}),Ot(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,i)=>{if(null==r){let{message:s}=p8("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[i]}`);throw Error(s)}})}),Ot(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),Ot(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),Ot(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=p8("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),Ot(this,"isLinkModeEnabled",(e,r)=>{var i,s,n,o,a,h,c,u,l;return!!e&&r===g9&&(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.linkMode)===!0&&(null==(o=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:o.universal)!==void 0&&(null==(h=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:h.universal)!==""&&(null==(c=e?.redirect)?void 0:c.universal)!==void 0&&(null==(u=e?.redirect)?void 0:u.universal)!==""&&(null==(l=e?.redirect)?void 0:l.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==t?void 0:t.Linking)}),Ot(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),Ot(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=uB(e,"topic")||"",r=decodeURIComponent(uB(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:g9}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),Ot(this,"registerLinkModeListeners",async()=>{var e;if(ub()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==t?void 0:t.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),Ot(this,"getTVFParams",(e,t,r)=>{var i,s,n;if(!(null!=(i=t.request)&&i.method))return{};let o={correlationId:e,rpcMethods:[t.request.method],chainId:t.chainId};try{o.txHashes=this.extractTxHashesFromResult(t.request,r),o.contractAddresses=this.isValidContractData(t.request.params)?[null==(n=null==(s=t.request.params)?void 0:s[0])?void 0:n.to]:[]}catch(e){this.client.logger.warn(e,"Error getting TVF params")}return o}),Ot(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),Ot(this,"extractTxHashesFromResult",(e,t)=>{var r,i,s;try{if(!t)return[];let n=e.method,o=MX[n];if("sui_signTransaction"===n)return[function(e){let t=new Uint8Array(F.from(e,"base64")),r=Array.from("TransactionData::").map(e=>e.charCodeAt(0)),i=new Uint8Array(r.length+t.length);i.set(r),i.set(t,r.length);let s=l4(i,{dkLen:32});return ak.encode(s)}(t.transactionBytes)];if("near_signTransaction"===n)return[ft(t)];if("near_signTransactions"===n)return t.map(e=>ft(e));if("xrpl_signTransactionFor"===n||"xrpl_signTransaction"===n)return[null==(r=t.tx_json)?void 0:r.hash];if("polkadot_signTransaction"===n)return[function(e){let t=Uint8Array.from(F.from(e.signature,"hex")),r=function({publicKey:e,signature:t,payload:r}){var i,s;let n=gb(r.method),o=128|parseInt((null==(i=r.version)?void 0:i.toString())||"4"),a=function(e){let t=ak.decode(e)[0];return 42===t?0:60===t?2:1}(r.address),h="00"===r.era?new Uint8Array([0]):gb(r.era);if(1!==h.length&&2!==h.length)throw Error("Invalid era length");let c=parseInt(r.nonce,16),u=new Uint8Array([255&c,c>>8&255]),l=new Uint8Array([0,...e,a,...t,...h,...u,...function(e){if(e<BigInt(1)<<BigInt(6))return new Uint8Array([Number(e<<BigInt(2))]);if(e<BigInt(1)<<BigInt(14)){let t=e<<BigInt(2)|BigInt(1);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255))])}if(e<BigInt(1)<<BigInt(30)){let t=e<<BigInt(2)|BigInt(2);return new Uint8Array([Number(t&BigInt(255)),Number(t>>BigInt(8)&BigInt(255)),Number(t>>BigInt(16)&BigInt(255)),Number(t>>BigInt(24)&BigInt(255))])}throw Error("BigInt compact encoding not supported > 2^30")}(BigInt(`0x${(s=r.tip).startsWith("0x")?s.slice(2):s}`)),...n]);return new Uint8Array([...function(e){if(e<64)return new Uint8Array([e<<2]);if(e<16384){let t=e<<2|1;return new Uint8Array([255&t,t>>8&255])}if(e<0x40000000){let t=e<<2|2;return new Uint8Array([255&t,t>>8&255,t>>16&255,t>>24&255])}throw Error("Compact encoding > 2^30 not supported")}(l.length+1),o,...l])}({publicKey:function(e){let t=ak.decode(e);if(t.length<33)throw Error("Too short to contain a public key");return t.slice(1,33)}(e.transaction.address),signature:t,payload:e.transaction});var i=F.from(r).toString("hex");let s=gb(i),n=(0,cU.blake2b)(s,void 0,32);return"0x"+F.from(n).toString("hex")}({transaction:e.params.transactionPayload,signature:t.signature})];if("algo_signTxn"===n)return p5(t)?t.map(e=>fr(e)):[fr(t)];if("cosmos_signDirect"===n)return[function(e){let t=F.from(e.signed.bodyBytes,"base64"),r=F.from(e.signed.authInfoBytes,"base64"),i=F.from(e.signature.signature,"base64"),s=[];s.push(F.from([10])),s.push(fi(t.length)),s.push(t),s.push(F.from([18])),s.push(fi(r.length)),s.push(r),s.push(F.from([26])),s.push(fi(i.length)),s.push(i);let n=lJ(F.concat(s));return F.from(n).toString("hex").toUpperCase()}(t)];if("wallet_sendCalls"===n){let e=[];try{if("string"==typeof t)return e.push(t),e;if("object"!=typeof t)return e;null!=t&&t.id&&e.push(t.id);let r=null==(s=null==(i=t?.capabilities)?void 0:i.caip345)?void 0:s.transactionHashes;r&&e.push(...r)}catch(e){console.warn("getWalletSendCallsHashes failed: ",e)}return e}if("string"==typeof t)return[t];let a=t[o.key];if(p5(a))return"solana_signAllTransactions"===n?a.map(e=>(function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=r[0];if(0===i)throw Error("No signatures found");if(r.length<1+64*i)throw Error("Transaction data too short for claimed signature count");if(r.length<100)throw Error("Transaction too short");let s=F.from(e,"base64").slice(1,65);return ak.encode(s)})(e)):a;if("string"==typeof a)return[a]}catch(e){this.client.logger.warn(e,"Error extracting tx hashes from result")}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,r]of Object.entries(t))for(let t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn(e,"processPendingMessageEvents failed")}}isInitialized(){if(!this.initialized){let{message:e}=p8("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(gQ,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(M1)?this.client.auth.authKeys.get(M1):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:n,encoding:s===g9?py:pb});gk(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:s,encryptedId:pD(r)})):gq(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:s}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:s}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(bf,async e=>{let{topic:t,id:r}=uM(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,p8("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,p8("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(bn,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(bo,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!p7(e,!1)){let{message:t}=p8("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=p8("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(uC(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=p8("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!p7(e,!1)){let{message:t}=p8("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=p8("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(uC(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=p8("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=p8("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(p7(e,!1)){let{message:t}=p8("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=p8("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=p8("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=p8("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(uC(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=p8("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class Oi extends y7{constructor(e,t){super(e,t,"proposal",MK),this.core=e,this.logger=t}}class Os extends y7{constructor(e,t){super(e,t,"session",MK),this.core=e,this.logger=t}}class On extends y7{constructor(e,t){super(e,t,"request",MK,e=>e.id),this.core=e,this.logger=t}}class Oo extends y7{constructor(e,t){super(e,t,"authKeys",M0,()=>M1),this.core=e,this.logger=t}}class Oa extends y7{constructor(e,t){super(e,t,"pairingTopics",M0),this.core=e,this.logger=t}}class Oh extends y7{constructor(e,t){super(e,t,"requests",M0,e=>e.id),this.core=e,this.logger=t}}var Oc=Object.defineProperty,Ou=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?Oc(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class Ol{constructor(e,t){this.core=e,this.logger=t,Ou(this,"authKeys"),Ou(this,"pairingTopics"),Ou(this,"requests"),this.authKeys=new Oo(this.core,this.logger),this.pairingTopics=new Oa(this.core,this.logger),this.requests=new Oh(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var Of=Object.defineProperty,Od=(e,t,r)=>{let i;return(i="symbol"!=typeof t?t+"":t)in e?Of(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r};class Op extends tO{constructor(e){super(e),Od(this,"protocol","wc"),Od(this,"version",2),Od(this,"name",M$),Od(this,"metadata"),Od(this,"core"),Od(this,"logger"),Od(this,"events",new(0,a.EventEmitter)),Od(this,"engine"),Od(this,"session"),Od(this,"proposal"),Od(this,"pendingRequest"),Od(this,"auth"),Od(this,"signConfig"),Od(this,"on",(e,t)=>this.events.on(e,t)),Od(this,"once",(e,t)=>this.events.once(e,t)),Od(this,"off",(e,t)=>this.events.off(e,t)),Od(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),Od(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),Od(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),Od(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),Od(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||M$,this.metadata=function(e){var t,r;let i=uw();try{let s,n;return null!=e&&e.url&&i.url&&new URL(e.url).host!==new URL(i.url).host&&(console.warn(`The configured WalletConnect 'metadata.url':${e.url} differs from the actual page url:${i.url}. This is probably unintended and can lead to issues.`),e.url=i.url),null!=(t=e?.icons)&&t.length&&e.icons.length>0&&(e.icons=e.icons.filter(e=>""!==e)),s=uf(uf({},i),e),n={url:e?.url||i.url,name:e?.name||i.name,description:e?.description||i.description,icons:null!=(r=e?.icons)&&r.length&&e.icons.length>0?e.icons:i.icons},uo(s,ua(n))}catch(t){return console.warn("Error populating app metadata",t),e||i}}(e?.metadata),this.signConfig=e?.signConfig;let t=gy({logger:e?.logger||"error",name:this.name});this.logger=t,this.core=e?.core||new mC(e),this.session=new Os(this.core,this.logger),this.proposal=new Oi(this.core,this.logger),this.pendingRequest=new On(this.core,this.logger),this.engine=new Or(this),this.auth=new Ol(this.core,this.logger)}static async init(e){let t=new Op(e);return await t.initialize(),t}get context(){return tu(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}const Og="YOUR_PROJECT_ID";let Ob=null,Oy=null;async function Om(){try{let e=new mC({projectId:Og});Oy=await Op.init({projectId:Og,metadata:{name:"Sunflower Land Mobile",description:"Sunflower Land Mobile App",url:window.location.origin,icons:["https://walletconnect.com/walletconnect-logo.png"]}}),Ob=await MF.init({core:e,metadata:{name:"Sunflower Land Mobile",description:"Sunflower Land Mobile App",url:window.location.origin,icons:["https://walletconnect.com/walletconnect-logo.png"]}}),window.ethereum={isMetaMask:!1,isWalletConnect:!0,request:async({method:e,params:t})=>{try{let r=Oy.session.getAll()[0];if(!r)throw Error("No active session");return await Oy.request({topic:r.topic,chainId:"eip155:1",request:{method:e,params:t}})}catch(e){throw console.error("WalletConnect request error:",e),e}}},Oy.on("session_proposal",async e=>{try{let{id:t,params:r}=e,{requiredNamespaces:i,relays:s}=r,n={};Object.keys(i).forEach(e=>{n[e]={chains:i[e].chains,methods:i[e].methods,events:i[e].events,accounts:["eip155:1:0x..."]}}),await Oy.approve({id:t,namespaces:n})&&(document.getElementById("connectOverlay").classList.remove("active"),document.getElementById("gameFrame").src="https://play.sunflower-land.com")}catch(t){console.error("Failed to approve session:",t),await Oy.reject({id:e.id,reason:{code:0,message:"User rejected."}})}})}catch(e){console.error("Failed to initialize WalletConnect:",e),document.getElementById("connectOverlay").classList.add("active")}}document.getElementById("connectWallet").addEventListener("click",async()=>{try{let e=await Ob.core.pairing.create();console.log("Connect with URI:",e)}catch(e){console.error("Failed to create pairing:",e)}}),window.addEventListener("load",Om);
//# sourceMappingURL=mobile.653ec8b6.js.map
